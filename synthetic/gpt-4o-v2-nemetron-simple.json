[
    {
        "id": "9421f908-f430-45de-b536-6b9e1ebdfb1c",
        "question": "What were the total assets and total liabilities of Vietcombank, Techcombank, and ACB at the end of 2022?",
        "answer": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VCB          | BS_300          | 1.81382e+09 |\n| VCB          | BS_400          | 1.67817e+09 |\n| ACB          | BS_300          | 6.07875e+08 |\n| ACB          | BS_400          | 5.49437e+08 |\n| TCB          | BS_300          | 6.99033e+08 |\n| TCB          | BS_400          | 5.85608e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    category_code,\n    data\nFROM \n    bank_financial_report\nWHERE \n    year = 2022\n    AND quarter = 0\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND category_code IN ('BS_300', 'BS_400');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | financial_category   |        data |\n|:-------------|:---------------------|------------:|\n| ACB          | Total assets         | 6.07875e+08 |\n| ACB          | Total liabilities    | 5.49437e+08 |\n| TCB          | Total assets         | 6.99033e+08 |\n| TCB          | Total liabilities    | 5.85608e+08 |\n| VCB          | Total assets         | 1.81382e+09 |\n| VCB          | Total liabilities    | 1.67817e+09 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    bfr.stock_code,\n    mccb.en_caption AS financial_category,\n    bfr.data\nFROM \n    bank_financial_report bfr\nINNER JOIN \n    map_category_code_bank mccb ON bfr.category_code = mccb.category_code\nWHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND bfr.year = 2022\n    AND bfr.quarter = 0\n    AND bfr.category_code IN ('BS_300', 'BS_400')\nORDER BY \n    bfr.stock_code, mccb.en_caption\nLIMIT 100;\n"
            }
        ],
        "time": 24.042506217956543,
        "evaluate": 1,
        "input_token": 2688,
        "output_token": 896
    },
    {
        "id": "05531948-0c7c-4c04-b5b6-ed8dc6ba4d19",
        "question": "What were the Debt-to-Equity ratios of Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   |     dter |\n|:-------------|---------:|\n| TCB          |  5.16295 |\n| VCB          | 12.3717  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS dter\nFROM financial_ratio\nWHERE ratio_code = 'DTER'\nAND stock_code IN ('VCB', 'TCB')\nAND year = 2022\nAND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   |   year |   debt_to_equity_ratio |\n|:-------------|-------:|-----------------------:|\n| TCB          |   2022 |                5.16295 |\n| VCB          |   2022 |               12.3717  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  fr.year,\n  fr.data AS Debt_To_Equity_Ratio\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('VCB', 'TCB')\n  AND fr.year = 2022\n  AND fr.quarter = 0  -- For annual report\n  AND mcr.ratio_name = 'Debt To Equity Ratio'\nLIMIT 100;\n"
            }
        ],
        "time": 26.68987011909485,
        "evaluate": 0.5,
        "input_token": 1943,
        "output_token": 564
    },
    {
        "id": "6ee96cd0-65dc-4dca-b7d0-0320dc63353c",
        "question": "What is the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| HPG          | 0.0661282 |\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN', 'HPG')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   | metric           |   year |   roe_value |\n|:-------------|:-----------------|-------:|------------:|\n| HPG          | Return On Equity |   2023 |   0.0661282 |\n| MSN          | Return On Equity |   2023 |   0.0489033 |\n| VNM          | Return On Equity |   2023 |   0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  mcr.ratio_name AS Metric,\n  fr.year,\n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('VNM', 'MSN', 'HPG')  -- Target companies\n  AND fr.year = 2023  -- Target year\n  AND fr.quarter = 0  -- Annual data\n  AND mcr.ratio_name = 'Return On Equity'  -- Target metric\nLIMIT 100;  -- Adding a limit as per database note\n"
            }
        ],
        "time": 30.038520097732544,
        "evaluate": 0.5,
        "input_token": 1802,
        "output_token": 490
    },
    {
        "id": "52880a2b-08dd-4e7e-b453-7bfa90617938",
        "question": "Compare the Return on Assets (ROA) and Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.  Additionally, provide the total assets and total equity for both companies for the same period.",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | ROA          |     0.0126875 |\n| MSN          | ROE          |     0.0489033 |\n| VNM          | ROA          |     0.171232  |\n| VNM          | ROE          |     0.257506  |\n\nTable 2\n| stock_code   | en_caption     |       value |\n|:-------------|:---------------|------------:|\n| VNM          | TOTAL ASSETS   | 5.26734e+07 |\n| VNM          | Owner's equity | 3.50257e+07 |\n| MSN          | TOTAL ASSETS   | 1.47383e+08 |\n| MSN          | Owner's equity | 3.82372e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve ROA and ROE for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    fr.stock_code,\n    fr.ratio_code,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nWHERE \n    fr.stock_code IN ('VNM', 'MSN') AND\n    fr.year = 2023 AND\n    fr.quarter = 0 AND\n    fr.ratio_code IN ('ROA', 'ROE');\n\n-- Step 2: Retrieve total assets and total equity for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data AS value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN') AND\n    nfr.year = 2023 AND\n    nfr.quarter = 0 AND\n    mcc.category_code IN ('BS_270', 'BS_410'); -- BS_270: TOTAL ASSETS, BS_410: Owner's equity\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | ratio_code   |      data |\n|:-------------|:-------------|----------:|\n| VNM          | ROA          | 0.171232  |\n| VNM          | ROE          | 0.257506  |\n| MSN          | ROA          | 0.0126875 |\n| MSN          | ROE          | 0.0489033 |\n\nTable 2\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VNM          | BS_100          | 3.59359e+07 |\n| VNM          | BS_300          | 1.76476e+07 |\n| MSN          | BS_100          | 4.37635e+07 |\n| MSN          | BS_300          | 1.09146e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Given the assumptions above, the actual category codes for Total Assets and Total Equity should be verified from map_category_code_non_bank\n\n-- Part 1: ROA and ROE for VNM and MSN in 2023\nSELECT \n  fr.stock_code,\n  fr.ratio_code,\n  fr.data\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n  fr.year = 2023 AND fr.quarter = 0\n  AND fr.stock_code IN ('VNM', 'MSN')\n  AND mcr.ratio_name IN ('Return On Assets', 'Return On Equity')\nLIMIT 100;\n\n-- Part 2: Total Assets and Total Equity for VNM and MSN in 2023\n-- **NOTE:** Actual category codes should replace 'BS_100' and 'BS_300'\nSELECT \n  nfr.stock_code,\n  nfr.category_code,\n  nfr.data\nFROM \n  non_bank_financial_report nfr\n  INNER JOIN company_info ci ON nfr.stock_code = ci.stock_code\nWHERE \n  nfr.year = 2023 AND nfr.quarter = 0\n  AND nfr.stock_code IN ('VNM', 'MSN')\n  AND nfr.category_code IN ('BS_100', 'BS_300')  -- **Verify these codes**\nLIMIT 100;\n"
            }
        ],
        "time": 37.715919971466064,
        "evaluate": 0,
        "input_token": 2179,
        "output_token": 973
    },
    {
        "id": "481ebd36-c43a-4af2-901b-99a8e6964217",
        "question": "Compare the Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| ratio_code   |\n|:-------------|\n| ROE          |\n\nTable 2\n| stock_code   | en_company_name                            |   year |   quarter |   roe_value |\n|:-------------|:-------------------------------------------|-------:|----------:|------------:|\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2023 |         0 |   0.257506  |\n| MSN          | Masan Group Corporation                    |   2023 |         0 |   0.0489033 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT ratio_code \nFROM map_category_code_ratio \nWHERE ratio_name = 'Return On Equity';\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.en_company_name, -- Assuming en_company_name exists in company_info for clarity\n  fr.year,\n  fr.quarter,\n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n  fr.ratio_code = 'ROE' -- Use the actual ratio_code if different\n  AND fr.stock_code IN ('VNM', 'MSN')\n  AND fr.year = 2023\n  AND fr.quarter = 0\nLIMIT 100; -- Adding a limit as per the database access note\n"
            }
        ],
        "time": 31.379652976989746,
        "evaluate": 0.5,
        "input_token": 2096,
        "output_token": 1069
    },
    {
        "id": "61803c95-30e1-4a6f-8f02-ebde74c1120c",
        "question": "What were the operating cash flows and capital expenditures for Vietcombank, Techcombank, and VPBank in Q2 2024?  Calculate the free cash flow for each bank.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |   free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|-----------------:|\n| TCB          |   2024 |         2 |                     0 |                -280254 |           280254 |\n| VPB          |   2024 |         2 |                     0 |                  -1490 |             1490 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) AS operating_cash_flow,\n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS capital_expenditures,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) - \n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS free_cash_flow\nFROM \n    bank_financial_report bfr\nWHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'VPB') AND\n    bfr.year = 2024 AND\n    bfr.quarter = 2 AND\n    bfr.category_code IN ('CF_009', 'CF_025')\nGROUP BY \n    bfr.stock_code, bfr.year, bfr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| metric   | stock_code   | year   | quarter   | metric_value   |\n|----------|--------------|--------|-----------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Assuming CF_009 is correct for Operating Cash Flow for banks\n-- AND assuming a hypothetical CF_021_bank for Capital Expenditures (TO BE REPLACED WITH ACTUAL CODE)\n\nSELECT \n    'Operating Cash Flow' AS Metric,\n    stock_code,\n    year,\n    quarter,\n    data AS Metric_Value\nFROM \n    bank_financial_report\nWHERE \n    stock_code IN ('VCB', 'TCB', 'VPB')\n    AND year = 2024\n    AND quarter = 2  -- Q2\n    AND category_code = 'CF_009'  -- Operating Cash Flow\n\nUNION ALL\n\nSELECT \n    'Capital Expenditures' AS Metric,\n    stock_code,\n    year,\n    quarter,\n    data AS Metric_Value\nFROM \n    bank_financial_report\nWHERE \n    stock_code IN ('VCB', 'TCB', 'VPB')\n    AND year = 2024\n    AND quarter = 2  -- Q2\n    AND category_code = 'ACTUAL_CAPITAL_EXPENDITURES_CODE_FOR_BANKS'  -- TO BE REPLACED\n\nLIMIT 100;  -- Adjust the limit as necessary\n"
            }
        ],
        "time": 38.336710929870605,
        "evaluate": 0,
        "input_token": 2071,
        "output_token": 1065
    },
    {
        "id": "5972ee68-a39a-4051-b3d5-59aa6a533359",
        "question": "For the year 2023, what was the total revenue, net income, and total assets of  Masan Group, Vinamilk, and  PetroVietnam Gas?  Additionally, provide the percentage of total assets attributable to subsidiaries or investments for each company.",
        "answer": "Table 1\n| stock_code   |   total_revenue |   net_income |   total_assets |   percentage_investment_assets |\n|:-------------|----------------:|-------------:|---------------:|-------------------------------:|\n| GAS          |     8.99539e+07 |  1.46395e+07 |    8.77545e+07 |                        2.05086 |\n| MSN          |     7.82516e+07 |  2.56297e+06 |    1.47383e+08 |                        0       |\n| VNM          |     6.03689e+07 |  1.09679e+07 |    5.26734e+07 |                        0       |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH financial_data AS (\n    SELECT\n        nfr.stock_code,\n        SUM(CASE WHEN mcc.category_code = 'IS_010' THEN nfr.data ELSE 0 END) AS total_revenue,\n        SUM(CASE WHEN mcc.category_code = 'IS_050' THEN nfr.data ELSE 0 END) AS net_income,\n        SUM(CASE WHEN mcc.category_code = 'BS_270' THEN nfr.data ELSE 0 END) AS total_assets\n    FROM\n        non_bank_financial_report nfr\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND nfr.stock_code IN ('MSN', 'VNM', 'GAS')\n    GROUP BY\n        nfr.stock_code\n),\ninvestment_data AS (\n    SELECT\n        s.stock_code,\n        SUM(nfr.data) AS investment_assets\n    FROM\n        sub_and_shareholder s\n    JOIN\n        non_bank_financial_report nfr ON s.invest_on = nfr.stock_code\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND mcc.category_code = 'BS_270'\n    GROUP BY\n        s.stock_code\n)\nSELECT\n    fd.stock_code,\n    fd.total_revenue,\n    fd.net_income,\n    fd.total_assets,\n    COALESCE(id.investment_assets / NULLIF(fd.total_assets, 0) * 100, 0) AS percentage_investment_assets\nFROM\n    financial_data fd\nLEFT JOIN\n    investment_data id ON fd.stock_code = id.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Part 1: Financial Metrics for 2023 (Annual Reports, so quarter = 0)\nWITH \n  -- Assuming category codes for demonstration; replace with actual codes\n  FinancialMetrics AS (\n    SELECT \n      'Total Revenue' AS Metric,\n      'IS_001' AS category_code, -- Replace with actual code for Total Revenue\n      stock_code,\n      year,\n      quarter,\n      data\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 0 AND category_code = 'IS_001' -- Replace category_code\n    \n    UNION ALL\n    \n    SELECT \n      'Net Income' AS Metric,\n      'IS_999' AS category_code, -- Replace with actual code for Net Income\n      stock_code,\n      year,\n      quarter,\n      data\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 0 AND category_code = 'IS_999' -- Replace category_code\n    \n    UNION ALL\n    \n    SELECT \n      'Total Assets' AS Metric,\n      'BS_001' AS category_code, -- Replace with actual code for Total Assets\n      stock_code,\n      year,\n      quarter,\n      data\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_001' -- Replace category_code\n  ),\n\n  -- Part 2: Percentage of Subsidiaries/Investments\n  SubsidiaryInvestmentPercentage AS (\n    SELECT \n      CO.stock_code,\n      COUNT(DISTINCT SI.invest_on) AS Number_of_Subsidiaries,\n      CI.issue_share AS Total_Shares,\n      (COUNT(DISTINCT SI.invest_on) * 100.0 / CI.issue_share) AS Percentage\n    FROM company_info CI\n    JOIN sub_and_shareholder SI ON CI.stock_code = SI.stock_code\n    JOIN company_info CO ON SI.invest_on = CO.stock_code\n    WHERE CO.stock_code IN ('MSN', 'VNM', 'GAS')\n    GROUP BY CO.stock_code, CI.issue_share\n  )\n\n-- Combine Results\nSELECT \n  FM.stock_code,\n  FM.Metric,\n  FM.data AS Metric_Value,\n  SIP.Number_of_Subsidiaries,\n  SIP.Percentage AS Subsidiary_Investment_Percentage\nFROM FinancialMetrics FM\nLEFT JOIN SubsidiaryInvestmentPercentage SIP ON FM.stock_code = SIP.stock_code\nWHERE FM.stock_code IN ('MSN', 'VNM', 'GAS')\nORDER BY FM.stock_code, FM.Metric\nLIMIT 100; -- Ensure a limit is always applied\n"
            }
        ],
        "time": 84.58309125900269,
        "evaluate": 0,
        "input_token": 2237,
        "output_token": 1372
    },
    {
        "id": "74f9babe-9421-4bb7-a88f-a5c664b5a6da",
        "question": "What is the trend of the Current Ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |   current_ratio |\n|-------:|----------:|:-------------|----------------:|\n|   2020 |         0 | ACB          |         3.69815 |\n|   2021 |         0 | ACB          |         3.97544 |\n|   2022 |         0 | ACB          |         3.81624 |\n|   2023 |         0 | ACB          |         3.04283 |\n|   2024 |         1 | ACB          |         3.29123 |\n|   2020 |         0 | TCB          |         2.83619 |\n|   2021 |         0 | TCB          |         4.35343 |\n|   2022 |         0 | TCB          |         3.29776 |\n|   2023 |         0 | TCB          |         2.66367 |\n|   2024 |         1 | TCB          |         2.40445 |\n|   2024 |         2 | TCB          |         2.88946 |\n|   2020 |         0 | VCB          |         7.25011 |\n|   2021 |         0 | VCB          |         6.29498 |\n|   2022 |         0 | VCB          |         3.56816 |\n|   2023 |         0 | VCB          |         4.7828  |\n|   2024 |         1 | VCB          |         3.48899 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    fr.stock_code, \n    fr.data AS current_ratio\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    mccr.ratio_name = 'Current Ratio'\n    AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR \n         (fr.year = 2024 AND fr.quarter BETWEEN 1 AND 2))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | year   | quarter   | currentratio   |\n|--------------|--------|-----------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Conceptual Query: Adjust based on actual category codes for Current Assets and Current Liabilities\n\nWITH \n  -- Assuming CA_category_code and CL_category_code are the actual codes for Current Assets and Current Liabilities\n  CurrentAssets AS (\n    SELECT stock_code, year, quarter, SUM(data) AS TotalCurrentAssets\n    FROM bank_financial_report\n    WHERE category_code = 'CA_category_code'  -- Replace with actual code\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND year BETWEEN 2020 AND 2024\n    AND quarter IN (0, 2)  -- For annual and Q2 reports\n    GROUP BY stock_code, year, quarter\n  ),\n  \n  CurrentLiabilities AS (\n    SELECT stock_code, year, quarter, SUM(data) AS TotalCurrentLiabilities\n    FROM bank_financial_report\n    WHERE category_code = 'CL_category_code'  -- Replace with actual code\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND year BETWEEN 2020 AND 2024\n    AND quarter IN (0, 2)  -- For annual and Q2 reports\n    GROUP BY stock_code, year, quarter\n  )\n\nSELECT \n  CA.stock_code,\n  CA.year,\n  CA.quarter,\n  CA.TotalCurrentAssets / CL.TotalCurrentLiabilities AS CurrentRatio\nFROM CurrentAssets CA\nJOIN CurrentLiabilities CL ON CA.stock_code = CL.stock_code AND CA.year = CL.year AND CA.quarter = CL.quarter\nORDER BY CA.stock_code, CA.year, CA.quarter\nLIMIT 100;  -- Adjust the limit as necessary\n"
            }
        ],
        "time": 82.8832368850708,
        "evaluate": 0,
        "input_token": 2235,
        "output_token": 1061
    },
    {
        "id": "b8a00999-b6af-4a1f-9e41-60a2aa7e4d01",
        "question": "Compare the Return on Equity (ROE) of Vinamilk, Masan Group, and Sabeco for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |   return_on_equity |\n|:-------------|-------------------:|\n| MSN          |          0.0489033 |\n| SAB          |          0.166962  |\n| VNM          |          0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    data AS return_on_equity\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    year = 2023 AND\n    quarter = 0 AND\n    stock_code IN ('VNM', 'MSN', 'SAB');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| ratio_name       | company_code   | company_name                                 |   fiscal_year |   report_quarter |   roe_value |\n|:-----------------|:---------------|:---------------------------------------------|--------------:|-----------------:|------------:|\n| Return On Equity | MSN            | Masan Group Corporation                      |          2023 |                0 |   0.0489033 |\n| Return On Equity | SAB            | Saigon Beer - Alcohol - Beverage Corporation |          2023 |                0 |   0.166962  |\n| Return On Equity | VNM            | Vietnam Dairy Products Joint Stock Company   |          2023 |                0 |   0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  cr.ratio_name AS Ratio_Name,\n  ci.stock_code AS Company_Code,\n  ci.en_company_name AS Company_Name,\n  fr.year AS Fiscal_Year,\n  fr.quarter AS Report_Quarter,\n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio cr ON fr.ratio_code = cr.ratio_code\nWHERE \n  fr.year = 2023 \n  AND fr.quarter = 0  -- For Annual Reports\n  AND cr.ratio_name = 'Return On Equity'  -- Explicitly selecting ROE\n  AND ci.stock_code IN ('VNM', 'MSN', 'SAB')  -- Filtering for the specified companies\nLIMIT 100;  -- Adding a limit as per instructions\n"
            }
        ],
        "time": 61.496108293533325,
        "evaluate": 0.5,
        "input_token": 1977,
        "output_token": 624
    },
    {
        "id": "3bdd12bf-a669-4f11-bd82-b368cc2c608f",
        "question": "What is the trend of the current ratio and quick ratio for BIDV, Eximbank, and OCB Bank from 2020 to Q2 2024,  considering their respective subsidiaries and investments?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name    |     data |\n|:-------------|-------:|----------:|:--------------|---------:|\n| BID          |   2020 |         0 | Current Ratio | 2.57276  |\n| BID          |   2021 |         0 | Current Ratio | 3.94763  |\n| BID          |   2022 |         0 | Current Ratio | 5.04924  |\n| BID          |   2023 |         0 | Current Ratio | 2.5701   |\n| BID          |   2024 |         1 | Current Ratio | 2.94967  |\n| BID          |   2024 |         2 | Current Ratio | 3.65939  |\n| EIB          |   2020 |         0 | Current Ratio | 6.67582  |\n| EIB          |   2021 |         0 | Current Ratio | 5.72966  |\n| EIB          |   2022 |         0 | Current Ratio | 5.16642  |\n| EIB          |   2023 |         0 | Current Ratio | 6.12482  |\n| EIB          |   2024 |         1 | Current Ratio | 6.11042  |\n| HDB          |   2020 |         0 | Current Ratio | 4.83941  |\n| HDB          |   2021 |         0 | Current Ratio | 5.9133   |\n| HDB          |   2022 |         0 | Current Ratio | 4.00626  |\n| HDB          |   2023 |         0 | Current Ratio | 3.6528   |\n| HDB          |   2024 |         1 | Current Ratio | 3.1524   |\n| OCB          |   2020 |         0 | Current Ratio | 1.11545  |\n| OCB          |   2021 |         0 | Current Ratio | 4.2912   |\n| OCB          |   2022 |         0 | Current Ratio | 2.74653  |\n| OCB          |   2023 |         0 | Current Ratio | 1.68853  |\n| OCB          |   2024 |         1 | Current Ratio | 2.58278  |\n| STB          |   2020 |         0 | Current Ratio | 1.56301  |\n| STB          |   2021 |         0 | Current Ratio | 1.02262  |\n| STB          |   2022 |         0 | Current Ratio | 1.09035  |\n| STB          |   2023 |         0 | Current Ratio | 0.700152 |\n| STB          |   2024 |         1 | Current Ratio | 1.0368   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH relevant_companies AS (\n    SELECT stock_code\n    FROM company_info\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n    UNION\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n),\nratios AS (\n    SELECT ratio_code\n    FROM map_category_code_ratio\n    WHERE ratio_name IN ('Current Ratio', 'Quick Ratio')\n)\nSELECT fr.stock_code, fr.year, fr.quarter, mcr.ratio_name, fr.data\nFROM financial_ratio fr\nJOIN ratios r ON fr.ratio_code = r.ratio_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE fr.stock_code IN (SELECT stock_code FROM relevant_companies)\nAND ((fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY fr.stock_code, fr.year, fr.quarter, mcr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | year   | quarter   | quickratio   |\n|--------------|--------|-----------|--------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantCompanies AS (\n  SELECT stock_code \n  FROM company_info \n  WHERE stock_code IN ('BID', 'EIB', 'OCB')\n  \n  UNION ALL\n  \n  SELECT invest_on AS stock_code \n  FROM sub_and_shareholder \n  WHERE stock_code IN ('BID', 'EIB', 'OCB')\n  \n  UNION ALL\n  \n  SELECT stock_code \n  FROM sub_and_shareholder \n  WHERE invest_on IN ('BID', 'EIB', 'OCB')\n),\n  \nFilteredRatios AS (\n  SELECT fr.stock_code, fr.year, fr.quarter, fr.data AS QuickRatio\n  FROM financial_ratio fr\n  JOIN RelevantCompanies rc ON fr.stock_code = rc.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE mcr.ratio_name = 'Quick Ratio'\n  AND fr.year BETWEEN 2020 AND 2024\n  AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\n)\n  \nSELECT * FROM FilteredRatios\nORDER BY stock_code, year, quarter\nLIMIT 100;\n"
            }
        ],
        "time": 61.75420880317688,
        "evaluate": 0,
        "input_token": 2514,
        "output_token": 986
    },
    {
        "id": "e4a9ec26-1d13-431d-854f-90f02a2024dd",
        "question": "What was the total equity of  Vietcombank's subsidiaries and associated companies as a percentage of Vietcombank's total equity at the end of Q2 2024?",
        "answer": "Table 1\n| equity_percentage   |\n|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify Vietcombank's subsidiaries and associated companies\nWITH vcb_subsidiaries AS (\n    SELECT invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VCB'\n),\n\n-- Step 2: Retrieve the total equity of these subsidiaries and associated companies\nsubsidiaries_equity AS (\n    SELECT SUM(data) AS total_subsidiaries_equity\n    FROM (\n        SELECT data\n        FROM bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n        UNION ALL\n        SELECT data\n        FROM non_bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for non-banks\n        UNION ALL\n        SELECT data\n        FROM securities_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for securities\n    ) AS equity_data\n),\n\n-- Step 3: Retrieve Vietcombank's total equity\nvcb_equity AS (\n    SELECT data AS total_vcb_equity\n    FROM bank_financial_report\n    WHERE stock_code = 'VCB'\n      AND year = 2024\n      AND quarter = 2\n      AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n)\n\n-- Step 4: Calculate the percentage\nSELECT (subsidiaries_equity.total_subsidiaries_equity / vcb_equity.total_vcb_equity) * 100 AS equity_percentage\nFROM subsidiaries_equity, vcb_equity;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| percentage_invested   |\n|:----------------------|\n|                       |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  -- Calculate percentage of investments in subsidiaries and associated companies to total equity\n  (( \n    -- Sum of investments in subsidiaries and associated companies\n    (SELECT SUM(data) \n     FROM bank_financial_report \n     WHERE stock_code = 'VCB' \n     AND year = 2024 \n     AND quarter = 2 \n     AND category_code IN ('BS_211', 'BS_213')\n    ) \n  ) / \n  -- Total equity of Vietcombank\n  (SELECT data \n   FROM bank_financial_report \n   WHERE stock_code = 'VCB' \n   AND year = 2024 \n   AND quarter = 2 \n   AND category_code = 'BS_500'\n  )\n  ) * 100 AS percentage_invested\nFROM \n  -- Dummy table to allow for calculation (since we're not directly selecting from a table)\n  (SELECT 1) AS dummy\nLIMIT 1;\n"
            }
        ],
        "time": 32.81927537918091,
        "evaluate": 0,
        "input_token": 1918,
        "output_token": 725
    },
    {
        "id": "e0c17ae2-f308-486c-b62b-97f32e813cff",
        "question": "How has the Debt-to-Equity ratio of Vinamilk, Masan Group, and SABECO changed from 2020 to Q2 2024?  Compare their respective Quick Ratios over the same period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_code   |     data |\n|:-------------|-------:|----------:|:-------------|---------:|\n| MSN          |   2020 |         0 | DTER         | 3.62386  |\n| MSN          |   2020 |         0 | QR           | 0.451862 |\n| MSN          |   2020 |         2 | DTER         | 2.36354  |\n| MSN          |   2020 |         2 | QR           | 0.356423 |\n| MSN          |   2021 |         0 | DTER         | 1.97835  |\n| MSN          |   2021 |         0 | QR           | 0.899436 |\n| MSN          |   2021 |         2 | DTER         | 2.83936  |\n| MSN          |   2021 |         2 | QR           | 0.572475 |\n| MSN          |   2022 |         0 | DTER         | 2.85795  |\n| MSN          |   2022 |         0 | QR           | 0.514436 |\n| MSN          |   2022 |         2 | DTER         | 2.22866  |\n| MSN          |   2022 |         2 | QR           | 0.44704  |\n| MSN          |   2023 |         0 | DTER         | 2.85445  |\n| MSN          |   2023 |         0 | QR           | 0.61315  |\n| MSN          |   2023 |         2 | DTER         | 2.75379  |\n| MSN          |   2023 |         2 | QR           | 0.563175 |\n| SAB          |   2020 |         0 | DTER         | 0.290342 |\n| SAB          |   2020 |         0 | QR           | 3.52024  |\n| SAB          |   2020 |         2 | DTER         | 0.32508  |\n| SAB          |   2020 |         2 | QR           | 3.0425   |\n| SAB          |   2021 |         0 | DTER         | 0.349295 |\n| SAB          |   2021 |         0 | QR           | 2.93441  |\n| SAB          |   2021 |         2 | DTER         | 0.288778 |\n| SAB          |   2021 |         2 | QR           | 3.55591  |\n| SAB          |   2022 |         0 | DTER         | 0.401541 |\n| SAB          |   2022 |         0 | QR           | 2.69688  |\n| SAB          |   2022 |         2 | DTER         | 0.280909 |\n| SAB          |   2022 |         2 | QR           | 3.53308  |\n| SAB          |   2023 |         0 | DTER         | 0.336332 |\n| SAB          |   2023 |         0 | QR           | 2.9677   |\n| SAB          |   2023 |         2 | DTER         | 0.318275 |\n| SAB          |   2023 |         2 | QR           | 3.13189  |\n| SAB          |   2024 |         2 | DTER         | 0.359095 |\n| SAB          |   2024 |         2 | QR           | 2.9152   |\n| VNM          |   2020 |         0 | DTER         | 0.439424 |\n| VNM          |   2020 |         0 | QR           | 1.7462   |\n| VNM          |   2020 |         2 | DTER         | 0.532862 |\n| VNM          |   2020 |         2 | QR           | 1.46628  |\n| VNM          |   2021 |         0 | DTER         | 0.487649 |\n| VNM          |   2021 |         0 | QR           | 1.72213  |\n| VNM          |   2021 |         2 | DTER         | 0.543159 |\n| VNM          |   2021 |         2 | QR           | 1.56154  |\n| VNM          |   2022 |         0 | DTER         | 0.477386 |\n| VNM          |   2022 |         0 | QR           | 1.70628  |\n| VNM          |   2022 |         2 | DTER         | 0.462287 |\n| VNM          |   2022 |         2 | QR           | 1.79426  |\n| VNM          |   2023 |         0 | DTER         | 0.503847 |\n| VNM          |   2023 |         0 | QR           | 1.74405  |\n| VNM          |   2023 |         2 | DTER         | 0.390309 |\n| VNM          |   2023 |         2 | QR           | 1.97817  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.ratio_code,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR fr.quarter = 2) -- Include annual reports and Q2 reports\n    AND mccr.ratio_code IN ('DTER', 'QR') -- Debt-to-Equity Ratio and Quick Ratio\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, fr.ratio_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| ratio_type   |   year |   quarter | stock_code   | industry           | ratio_name           |   ratio_value |\n|:-------------|-------:|----------:|:-------------|:-------------------|:---------------------|--------------:|\n| QR           |   2020 |         0 | MSN          | Food and Beverages | Quick Ratio          |      0.451862 |\n| QR           |   2021 |         0 | MSN          | Food and Beverages | Quick Ratio          |      0.899436 |\n| QR           |   2023 |         0 | MSN          | Food and Beverages | Quick Ratio          |      0.61315  |\n| QR           |   2020 |         0 | SAB          | Food and Beverages | Quick Ratio          |      3.52024  |\n| QR           |   2021 |         0 | SAB          | Food and Beverages | Quick Ratio          |      2.93441  |\n| QR           |   2021 |         0 | VNM          | Food and Beverages | Quick Ratio          |      1.72213  |\n| QR           |   2023 |         0 | VNM          | Food and Beverages | Quick Ratio          |      1.74405  |\n| QR           |   2022 |         0 | MSN          | Food and Beverages | Quick Ratio          |      0.514436 |\n| QR           |   2022 |         0 | SAB          | Food and Beverages | Quick Ratio          |      2.69688  |\n| QR           |   2023 |         0 | SAB          | Food and Beverages | Quick Ratio          |      2.9677   |\n| QR           |   2024 |         2 | SAB          | Food and Beverages | Quick Ratio          |      2.9152   |\n| QR           |   2020 |         0 | VNM          | Food and Beverages | Quick Ratio          |      1.7462   |\n| QR           |   2022 |         0 | VNM          | Food and Beverages | Quick Ratio          |      1.70628  |\n| DTER         |   2020 |         0 | MSN          | Food and Beverages | Debt To Equity Ratio |      3.62386  |\n| DTER         |   2021 |         0 | MSN          | Food and Beverages | Debt To Equity Ratio |      1.97835  |\n| DTER         |   2022 |         0 | MSN          | Food and Beverages | Debt To Equity Ratio |      2.85795  |\n| DTER         |   2023 |         0 | MSN          | Food and Beverages | Debt To Equity Ratio |      2.85445  |\n| DTER         |   2020 |         0 | SAB          | Food and Beverages | Debt To Equity Ratio |      0.290342 |\n| DTER         |   2021 |         0 | SAB          | Food and Beverages | Debt To Equity Ratio |      0.349295 |\n| DTER         |   2022 |         0 | SAB          | Food and Beverages | Debt To Equity Ratio |      0.401541 |\n| DTER         |   2023 |         0 | SAB          | Food and Beverages | Debt To Equity Ratio |      0.336332 |\n| DTER         |   2024 |         2 | SAB          | Food and Beverages | Debt To Equity Ratio |      0.359095 |\n| DTER         |   2020 |         0 | VNM          | Food and Beverages | Debt To Equity Ratio |      0.439424 |\n| DTER         |   2021 |         0 | VNM          | Food and Beverages | Debt To Equity Ratio |      0.487649 |\n| DTER         |   2022 |         0 | VNM          | Food and Beverages | Debt To Equity Ratio |      0.477386 |\n| DTER         |   2023 |         0 | VNM          | Food and Beverages | Debt To Equity Ratio |      0.503847 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Query for Debt-to-Equity Ratio (DTER) and Quick Ratio (QR) for specified companies\n-- from 2020 to Q2 2024. We use UNION ALL to combine both ratio queries.\n\nSELECT \n  'DTER' AS Ratio_Type,\n  fr.year,\n  fr.quarter,\n  ci.stock_code,\n  ci.industry,\n  mcr.ratio_name,\n  fr.data AS Ratio_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.ratio_code = 'DTER'  -- Debt-to-Equity Ratio\n  AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\n  AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter = 2))\n\nUNION ALL\n\nSELECT \n  'QR' AS Ratio_Type,\n  fr.year,\n  fr.quarter,\n  ci.stock_code,\n  ci.industry,\n  mcr.ratio_name,\n  fr.data AS Ratio_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.ratio_code = 'QR'  -- Quick Ratio\n  AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\n  AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter = 2))\n\n-- Add a LIMIT clause as per the database access note\nLIMIT 100;\n"
            }
        ],
        "time": 46.75732088088989,
        "evaluate": 0.5,
        "input_token": 1914,
        "output_token": 910
    },
    {
        "id": "1ef436da-be56-41ad-a474-7be82fff814b",
        "question": "Rank the top 5 companies with the highest Debt-to-Equity ratio as of December 31, 2023.",
        "answer": "Table 1\n| stock_code   | industry   |   debt_to_equity_ratio |\n|:-------------|:-----------|-----------------------:|\n| BID          | Banking    |                17.7184 |\n| CTG          | Banking    |                15.1483 |\n| STB          | Banking    |                13.746  |\n| HDB          | Banking    |                12.5012 |\n| SHB          | Banking    |                11.5853 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry   |   debttoequityratio |\n|:-------------|:-----------|--------------------:|\n| BID          | Banking    |             17.7184 |\n| CTG          | Banking    |             15.1483 |\n| STB          | Banking    |             13.746  |\n| HDB          | Banking    |             12.5012 |\n| SHB          | Banking    |             11.5853 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    ci.industry, \n    fr.data AS DebtToEquityRatio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nJOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.year = 2023 \n    AND fr.quarter = 0 \n    AND mcr.ratio_name = 'Debt To Equity Ratio'\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "time": 30.94948434829712,
        "evaluate": 1,
        "input_token": 2690,
        "output_token": 1264
    },
    {
        "id": "23ea7012-1827-4ab6-b0cd-b24116d380df",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and Sacombank from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| STB          |   2020 |         0 | 0.0926219 |\n| STB          |   2021 |         0 | 0.0995728 |\n| STB          |   2022 |         0 | 0.130497  |\n| STB          |   2023 |         0 | 0.168772  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS ROE\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'STB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual data from 2020 to 2023\n        OR (year = 2024 AND quarter = 2) -- Q2 data for 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry   |   year |   quarter |   roe_value |\n|:-------------|:-----------|-------:|----------:|------------:|\n| STB          | Banking    |   2020 |         0 |   0.0926219 |\n| STB          | Banking    |   2021 |         0 |   0.0995728 |\n| STB          | Banking    |   2022 |         0 |   0.130497  |\n| STB          | Banking    |   2023 |         0 |   0.168772  |\n| TCB          | Banking    |   2020 |         0 |   0.168632  |\n| TCB          | Banking    |   2021 |         0 |   0.197927  |\n| TCB          | Banking    |   2022 |         0 |   0.180176  |\n| TCB          | Banking    |   2023 |         0 |   0.139608  |\n| TCB          | Banking    |   2024 |         2 |   0.0457096 |\n| VCB          | Banking    |   2020 |         0 |   0.196318  |\n| VCB          | Banking    |   2021 |         0 |   0.201059  |\n| VCB          | Banking    |   2022 |         0 |   0.220567  |\n| VCB          | Banking    |   2023 |         0 |   0.200315  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry, -- Optional, for context\n    fr.year,\n    fr.quarter,\n    fr.data AS ROE_Value\nFROM \n    financial_ratio fr\nINNER JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nINNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    mcr.ratio_name = 'Return On Equity' -- Ensuring we get ROE\n    AND fr.stock_code IN ('VCB', 'TCB', 'STB') -- Focusing on the specified banks\n    AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) -- Annual reports for 2020-2023\n         OR (fr.year = 2024 AND fr.quarter = 2)) -- Q2 for 2024\nORDER BY \n    fr.stock_code, fr.year, fr.quarter\nLIMIT 100; -- To adhere to the query limit requirement\n"
            }
        ],
        "time": 36.805373191833496,
        "evaluate": 0.5,
        "input_token": 2096,
        "output_token": 676
    },
    {
        "id": "650a1eb0-378d-4d82-b07a-acedf00aa716",
        "question": "For the year 2023, what was the combined net income of  VinGroup's subsidiaries and the net income of VinGroup itself, and what percentage of VinGroup's total net income came from its subsidiaries?",
        "answer": "Table 1\n|   total_net_income |   subsidiaries_net_income |   percentage_from_subsidiaries |\n|-------------------:|--------------------------:|-------------------------------:|\n|        4.45219e+07 |               4.94273e+07 |                        111.018 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH vin_subsidiaries AS (\n    SELECT invest_on AS subsidiary_code\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VIC'\n),\nvin_and_subsidiaries_net_income AS (\n    SELECT stock_code, SUM(data) AS net_income\n    FROM non_bank_financial_report\n    WHERE (stock_code = 'VIC' OR stock_code IN (SELECT subsidiary_code FROM vin_subsidiaries))\n      AND year = 2023\n      AND quarter = 0\n      AND category_code = 'IS_030'\n    GROUP BY stock_code\n),\ntotal_net_income AS (\n    SELECT SUM(net_income) AS total_net_income\n    FROM vin_and_subsidiaries_net_income\n),\nsubsidiaries_net_income AS (\n    SELECT SUM(net_income) AS subsidiaries_net_income\n    FROM vin_and_subsidiaries_net_income\n    WHERE stock_code IN (SELECT subsidiary_code FROM vin_subsidiaries)\n)\nSELECT \n    tni.total_net_income,\n    sni.subsidiaries_net_income,\n    (sni.subsidiaries_net_income / tni.total_net_income) * 100 AS percentage_from_subsidiaries\nFROM total_net_income tni, subsidiaries_net_income sni;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| combinednetincome   | percentagefromsubsidiaries   |\n|:--------------------|:-----------------------------|\n|                     |                              |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Identify VinGroup's Subsidiaries\nSubsidiaries AS (\n  SELECT invest_on AS stock_code\n  FROM sub_and_shareholder\n  WHERE stock_code = 'VIC'\n),\n\n-- Calculate Net Income for VinGroup and its Subsidiaries for 2023\nNetIncome AS (\n  SELECT \n    stock_code,\n    SUM(data) AS TotalNetIncome\n  FROM non_bank_financial_report\n  WHERE (stock_code = 'VIC' OR stock_code IN (SELECT stock_code FROM Subsidiaries))\n    AND year = 2023\n    AND quarter = 0\n    AND category_code = 'IS_012'  -- Replace with actual net income category code\n  GROUP BY stock_code\n)\n\n-- Calculate Combined Net Income and Percentage from Subsidiaries\nSELECT \n  -- Combined Net Income\n  (SELECT SUM(TotalNetIncome) FROM NetIncome) AS CombinedNetIncome,\n  \n  -- Percentage of Net Income from Subsidiaries\n  (SELECT \n     SUM(CASE WHEN stock_code!= 'VIC' THEN TotalNetIncome ELSE 0 END) \n   * 100.0 \n   / (SELECT TotalNetIncome FROM NetIncome WHERE stock_code = 'VIC')\n   FROM NetIncome\n  ) AS PercentageFromSubsidiaries\n\nLIMIT 1;\n"
            }
        ],
        "time": 42.060402154922485,
        "evaluate": 0,
        "input_token": 2069,
        "output_token": 899
    },
    {
        "id": "4705a2ab-1bb2-400f-895d-b1eea6557de9",
        "question": "What was the average Return on Equity (ROE) for  Vietcombank,  Techcombank, and  Sacombank in 2022, and how did this compare to their respective subsidiaries' average ROE for the same year?",
        "answer": "Table 1\n| bank_code   |   bank_avg_roe |   subsidiary_avg_roe |\n|:------------|---------------:|---------------------:|\n| STB         |       0.130497 |           nan        |\n| TCB         |       0.180176 |           nan        |\n| VCB         |       0.220567 |             0.170252 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_roe AS (\n    SELECT stock_code, AVG(data) AS avg_roe\n    FROM financial_ratio\n    WHERE ratio_code = 'ROE'\n      AND stock_code IN ('VCB', 'TCB', 'STB')\n      AND year = 2022\n      AND quarter = 0\n    GROUP BY stock_code\n),\nsubsidiary_roe AS (\n    SELECT s.stock_code, AVG(fr.data) AS avg_roe\n    FROM sub_and_shareholder s\n    JOIN financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE s.stock_code IN ('VCB', 'TCB', 'STB')\n      AND fr.ratio_code = 'ROE'\n      AND fr.year = 2022\n      AND fr.quarter = 0\n    GROUP BY s.stock_code\n)\nSELECT b.stock_code AS bank_code, b.avg_roe AS bank_avg_roe, s.avg_roe AS subsidiary_avg_roe\nFROM bank_roe b\nLEFT JOIN subsidiary_roe s ON b.stock_code = s.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Error in getting the answer",
        "code_response": "Error in getting the code",
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "ba73d2eb-be40-43aa-aae0-07913d6003b2",
        "question": "What are the top 10 companies with the lowest Return on Equity (ROE) for the fiscal year 2022?",
        "answer": "Table 1\n| stock_code   | industry                             |    roe_value |\n|:-------------|:-------------------------------------|-------------:|\n| VJC          | Travel and Leisure                   | -0.151828    |\n| NKG          | Basic Resources                      | -0.0234384   |\n| NVB          | Banking                              |  1.38787e-06 |\n| DBC          | Food and Beverages                   |  0.0011191   |\n| NHA          | Construction and Materials           |  0.00438288  |\n| HLD          | Real Estate                          |  0.0115416   |\n| VIC          | Real Estate                          |  0.0150701   |\n| YEG          | Media                                |  0.0274488   |\n| PVG          | Utilities (Electricity, Water & Gas) |  0.032697    |\n| PVC          | Oil and Gas                          |  0.0327001   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe_value\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2022\n    AND fr.quarter = 0\nORDER BY \n    fr.data ASC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |    roe_value |\n|:-------------|-------------:|\n| VJC          | -0.151828    |\n| NKG          | -0.0234384   |\n| NVB          |  1.38787e-06 |\n| DBC          |  0.0011191   |\n| NHA          |  0.00438288  |\n| HLD          |  0.0115416   |\n| VIC          |  0.0150701   |\n| YEG          |  0.0274488   |\n| PVG          |  0.032697    |\n| PVC          |  0.0327001   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  ci.stock_code, \n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Return On Equity' \n  AND fr.year = 2022 \n  AND fr.quarter = 0\nORDER BY \n  fr.data ASC\nLIMIT 10;\n"
            }
        ],
        "time": 24.55763840675354,
        "evaluate": 1,
        "input_token": 2373,
        "output_token": 962
    },
    {
        "id": "48a8fa57-c0d7-4ba7-879f-5dbe2a9228cc",
        "question": "Compare the Net Profit Margin and the Debt-to-Equity ratio of Vinamilk and Masan Group from 2020 to Q2 2024.  Analyze the changes in their total assets and total liabilities during this period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_code   |   ratio_value |\n|:-------------|-------:|----------:|:-------------|--------------:|\n| MSN          |   2020 |         0 | DTER         |      3.62386  |\n| MSN          |   2021 |         0 | DTER         |      1.97835  |\n| MSN          |   2022 |         0 | DTER         |      2.85795  |\n| MSN          |   2023 |         0 | DTER         |      2.85445  |\n| VNM          |   2020 |         0 | DTER         |      0.439424 |\n| VNM          |   2021 |         0 | DTER         |      0.487649 |\n| VNM          |   2022 |         0 | DTER         |      0.477386 |\n| VNM          |   2023 |         0 | DTER         |      0.503847 |\n\nTable 2\n| stock_code   |   year |   quarter | category_code   |       value |\n|:-------------|-------:|----------:|:----------------|------------:|\n| MSN          |   2020 |         0 | BS_270          | 1.15737e+08 |\n| MSN          |   2020 |         0 | BS_300          | 9.07063e+07 |\n| MSN          |   2021 |         0 | BS_270          | 1.26093e+08 |\n| MSN          |   2021 |         0 | BS_300          | 8.37568e+07 |\n| MSN          |   2022 |         0 | BS_270          | 1.41343e+08 |\n| MSN          |   2022 |         0 | BS_300          | 1.04706e+08 |\n| MSN          |   2023 |         0 | BS_270          | 1.47383e+08 |\n| MSN          |   2023 |         0 | BS_300          | 1.09146e+08 |\n| VNM          |   2020 |         0 | BS_270          | 4.84325e+07 |\n| VNM          |   2020 |         0 | BS_300          | 1.47854e+07 |\n| VNM          |   2021 |         0 | BS_270          | 5.33324e+07 |\n| VNM          |   2021 |         0 | BS_300          | 1.74823e+07 |\n| VNM          |   2022 |         0 | BS_270          | 4.84827e+07 |\n| VNM          |   2022 |         0 | BS_300          | 1.56661e+07 |\n| VNM          |   2023 |         0 | BS_270          | 5.26734e+07 |\n| VNM          |   2023 |         0 | BS_300          | 1.76476e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    ratio_code,\n    data AS ratio_value\nFROM \n    financial_ratio\nWHERE \n    stock_code IN ('VNM', 'MSN')\n    AND ratio_code IN ('NPM', 'DTER')\n    AND ((year = 2020 AND quarter = 0) OR (year = 2021 AND quarter = 0) OR (year = 2022 AND quarter = 0) OR (year = 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter, ratio_code;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    category_code,\n    data AS value\nFROM \n    non_bank_financial_report\nWHERE \n    stock_code IN ('VNM', 'MSN')\n    AND category_code IN ('BS_270', 'BS_300') -- BS_270 for Total Assets, BS_300 for Total Liabilities\n    AND ((year = 2020 AND quarter = 0) OR (year = 2021 AND quarter = 0) OR (year = 2022 AND quarter = 0) OR (year = 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter, category_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter | net_profit_margin   |   debt_to_equity_ratio |   total_assets |   total_liabilities |\n|:-------------|-------:|----------:|:--------------------|-----------------------:|---------------:|--------------------:|\n| MSN          |   2020 |         0 |                     |               3.62386  |    3.88747e+07 |         8.59759e+07 |\n| MSN          |   2021 |         0 |                     |               1.97835  |    3.45478e+07 |         8.24633e+07 |\n| MSN          |   2022 |         0 |                     |               2.85795  |    6.53209e+07 |         9.36682e+07 |\n| MSN          |   2023 |         0 |                     |               2.85445  |    5.04225e+07 |         1.0362e+08  |\n| VNM          |   2020 |         0 |                     |               0.439424 |    1.42126e+07 |         1.87668e+07 |\n| VNM          |   2021 |         0 |                     |               0.487649 |    1.70684e+07 |         1.72225e+07 |\n| VNM          |   2022 |         0 |                     |               0.477386 |    1.53084e+07 |         1.69223e+07 |\n| VNM          |   2023 |         0 |                     |               0.503847 |    1.71387e+07 |         1.67375e+07 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Assuming BS_310 for Total Assets and BS_200 for Total Liabilities in map_category_code_non_bank\n-- Actual codes should replace these if different\n\nWITH \n-- Total Assets and Total Liabilities for context (not directly requested but for 'analyze changes')\nAssets_Liabilities AS (\n  SELECT \n    'VNM' AS stock_code, \n    year, \n    quarter, \n    -- Assuming category codes for demonstration\n    SUM(CASE WHEN category_code = 'BS_310' THEN data ELSE 0 END) AS Total_Assets,\n    SUM(CASE WHEN category_code = 'BS_200' THEN data ELSE 0 END) AS Total_Liabilities\n  FROM non_bank_financial_report\n  WHERE stock_code = 'VNM' AND year BETWEEN 2020 AND 2024 AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n  GROUP BY year, quarter\n  UNION ALL\n  SELECT \n    'MSN' AS stock_code, \n    year, \n    quarter, \n    SUM(CASE WHEN category_code = 'BS_310' THEN data ELSE 0 END) AS Total_Assets,\n    SUM(CASE WHEN category_code = 'BS_200' THEN data ELSE 0 END) AS Total_Liabilities\n  FROM non_bank_financial_report\n  WHERE stock_code = 'MSN' AND year BETWEEN 2020 AND 2024 AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n  GROUP BY year, quarter\n),\n\n-- Main Query for Net Profit Margin and Debt-to-Equity Ratio\nFinancial_Ratios AS (\n  SELECT \n    stock_code, \n    year, \n    quarter, \n    -- Directly selecting the requested ratios\n    MAX(CASE WHEN ratio_code = 'NPM' THEN data END) AS Net_Profit_Margin,\n    MAX(CASE WHEN ratio_code = 'DTER' THEN data END) AS Debt_To_Equity_Ratio\n  FROM financial_ratio\n  WHERE stock_code IN ('VNM', 'MSN') AND ratio_code IN ('NPM', 'DTER') \n        AND year BETWEEN 2020 AND 2024 AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n  GROUP BY stock_code, year, quarter\n)\n\n-- Combining for comprehensive view\nSELECT \n  FR.stock_code, \n  FR.year, \n  FR.quarter, \n  FR.Net_Profit_Margin, \n  FR.Debt_To_Equity_Ratio,\n  AL.Total_Assets, \n  AL.Total_Liabilities\nFROM Financial_Ratios FR\nLEFT JOIN Assets_Liabilities AL ON FR.stock_code = AL.stock_code AND FR.year = AL.year AND FR.quarter = AL.quarter\nORDER BY FR.stock_code, FR.year, FR.quarter\nLIMIT 100; -- Adjust limit as necessary\n"
            }
        ],
        "time": 71.96365284919739,
        "evaluate": 0,
        "input_token": 2026,
        "output_token": 1121
    },
    {
        "id": "94513aff-57b5-4d36-8a98-bdf527d9190f",
        "question": "What is the trend of the Net Profit Margin ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_profit_margin\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'NPM'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (1, 2))\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry   | year   | quarter   | net_profit_margin   |\n|--------------|------------|--------|-----------|---------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry, -- Optional, for context\n    fr.year,\n    fr.quarter,\n    fr.data AS Net_Profit_Margin\nFROM \n    financial_ratio fr\nINNER JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nINNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.ratio_code = 'NPM' -- Assuming 'NPM' is the correct ratio_code for Net Profit Margin\n    AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2)) -- Condition to include up to Q2 2024\nORDER BY \n    fr.stock_code, fr.year, fr.quarter\nLIMIT 100; -- Adjust the limit as necessary\n"
            }
        ],
        "time": 38.58313608169556,
        "evaluate": 0,
        "input_token": 2235,
        "output_token": 754
    },
    {
        "id": "090710f9-3867-4922-9703-fd2af16e09e9",
        "question": "Calculate the Debt-to-Equity ratio for  Vinamilk,  Masan Group, and their significant subsidiaries in 2023 Q2.  Analyze the differences in leverage between the parent companies and their subsidiaries.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|-------:|----------:|-----------------------:|\n| MSN          |   2023 |         2 |               2.75379  |\n| VNM          |   2023 |         2 |               0.390309 |\n| TCB          |   2023 |         2 |               4.98106  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH parent_companies AS (\n    SELECT 'VNM' AS stock_code\n    UNION\n    SELECT 'MSN'\n),\nsubsidiaries AS (\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN (SELECT stock_code FROM parent_companies)\n),\nall_relevant_companies AS (\n    SELECT stock_code FROM parent_companies\n    UNION\n    SELECT stock_code FROM subsidiaries\n)\nSELECT fr.stock_code, fr.year, fr.quarter, fr.data AS debt_to_equity_ratio\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Debt To Equity Ratio'\nAND fr.stock_code IN (SELECT stock_code FROM all_relevant_companies)\nAND fr.year = 2023\nAND fr.quarter = 2;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| company_name                                          |   dter_value |\n|:------------------------------------------------------|-------------:|\n| Masan Group Corporation                               |     2.75379  |\n| Vietnam Dairy Products Joint Stock Company            |     0.390309 |\n| Vietnam Technological And Commercial Joint Stock Bank |     4.98106  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Identify Parent Companies and Their Subsidiaries\ncompanies AS (\n  SELECT 'VNM' AS stock_code UNION\n  SELECT 'MSN' UNION\n  SELECT invest_on \n  FROM sub_and_shareholder \n  WHERE stock_code IN ('VNM', 'MSN')\n),\n\n-- Filter Relevant Financial Ratios for Q2 2023\nrelevant_ratios AS (\n  SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS DTER_value\n  FROM \n    financial_ratio fr\n  INNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  INNER JOIN \n    companies c ON fr.stock_code = c.stock_code\n  WHERE \n    mcr.ratio_code = 'DTER' \n    AND fr.year = 2023 \n    AND fr.quarter = 2\n)\n\n-- Final Query to Display Results\nSELECT \n  ci.en_company_name AS Company_Name,\n  rr.DTER_value\nFROM \n  relevant_ratios rr\nINNER JOIN \n  company_info ci ON rr.stock_code = ci.stock_code\nORDER BY \n  ci.en_company_name\nLIMIT 100;  -- To adhere to the 'must add limit' instruction\n"
            }
        ],
        "time": 42.46808099746704,
        "evaluate": 1,
        "input_token": 1786,
        "output_token": 706
    },
    {
        "id": "bb6f60b5-01dc-41a5-a518-ba2edf9f457b",
        "question": "Compare the evolution of the Debt-to-Equity ratio and the Current Ratio for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Analyze the implications of these ratios on the financial risk profile of each company.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name           |   ratio_value |\n|:-------------|-------:|----------:|:---------------------|--------------:|\n| HPG          |   2020 |         0 | Current Ratio        |      1.09453  |\n| HPG          |   2020 |         0 | Debt To Equity Ratio |      1.22073  |\n| HPG          |   2021 |         0 | Current Ratio        |      1.28577  |\n| HPG          |   2021 |         0 | Debt To Equity Ratio |      0.963375 |\n| HPG          |   2022 |         0 | Current Ratio        |      1.29573  |\n| HPG          |   2022 |         0 | Debt To Equity Ratio |      0.772243 |\n| HPG          |   2023 |         0 | Current Ratio        |      1.16128  |\n| HPG          |   2023 |         0 | Debt To Equity Ratio |      0.826032 |\n| HPG          |   2024 |         2 | Current Ratio        |      1.15441  |\n| HPG          |   2024 |         2 | Debt To Equity Ratio |      0.901137 |\n| MSN          |   2020 |         0 | Current Ratio        |      0.773354 |\n| MSN          |   2020 |         0 | Debt To Equity Ratio |      3.62386  |\n| MSN          |   2021 |         0 | Current Ratio        |      1.27032  |\n| MSN          |   2021 |         0 | Debt To Equity Ratio |      1.97835  |\n| MSN          |   2022 |         0 | Current Ratio        |      0.73558  |\n| MSN          |   2022 |         0 | Debt To Equity Ratio |      2.85795  |\n| MSN          |   2023 |         0 | Current Ratio        |      0.874439 |\n| MSN          |   2023 |         0 | Debt To Equity Ratio |      2.85445  |\n| VNM          |   2020 |         0 | Current Ratio        |      2.09132  |\n| VNM          |   2020 |         0 | Debt To Equity Ratio |      0.439424 |\n| VNM          |   2021 |         0 | Current Ratio        |      2.11895  |\n| VNM          |   2021 |         0 | Debt To Equity Ratio |      0.487649 |\n| VNM          |   2022 |         0 | Current Ratio        |      2.06801  |\n| VNM          |   2022 |         0 | Debt To Equity Ratio |      0.477386 |\n| VNM          |   2023 |         0 | Current Ratio        |      2.1016   |\n| VNM          |   2023 |         0 | Debt To Equity Ratio |      0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'HPG')\n    AND mccr.ratio_name IN ('Debt To Equity Ratio', 'Current Ratio')\n    AND (\n        (fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR\n        (fr.year = 2024 AND fr.quarter = 2)\n    )\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, mccr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry           | ratio                |   year |   quarter |   ratio_value |\n|:-------------|:-------------------|:---------------------|-------:|----------:|--------------:|\n| HPG          | Basic Resources    | Current Ratio        |   2020 |         0 |      1.09453  |\n| HPG          | Basic Resources    | Current Ratio        |   2021 |         0 |      1.28577  |\n| HPG          | Basic Resources    | Current Ratio        |   2022 |         0 |      1.29573  |\n| HPG          | Basic Resources    | Current Ratio        |   2023 |         0 |      1.16128  |\n| HPG          | Basic Resources    | Current Ratio        |   2024 |         2 |      1.15441  |\n| HPG          | Basic Resources    | Debt To Equity Ratio |   2020 |         0 |      1.22073  |\n| HPG          | Basic Resources    | Debt To Equity Ratio |   2021 |         0 |      0.963375 |\n| HPG          | Basic Resources    | Debt To Equity Ratio |   2022 |         0 |      0.772243 |\n| HPG          | Basic Resources    | Debt To Equity Ratio |   2023 |         0 |      0.826032 |\n| HPG          | Basic Resources    | Debt To Equity Ratio |   2024 |         2 |      0.901137 |\n| MSN          | Food and Beverages | Current Ratio        |   2020 |         0 |      0.773354 |\n| MSN          | Food and Beverages | Current Ratio        |   2021 |         0 |      1.27032  |\n| MSN          | Food and Beverages | Current Ratio        |   2022 |         0 |      0.73558  |\n| MSN          | Food and Beverages | Current Ratio        |   2023 |         0 |      0.874439 |\n| MSN          | Food and Beverages | Debt To Equity Ratio |   2020 |         0 |      3.62386  |\n| MSN          | Food and Beverages | Debt To Equity Ratio |   2021 |         0 |      1.97835  |\n| MSN          | Food and Beverages | Debt To Equity Ratio |   2022 |         0 |      2.85795  |\n| MSN          | Food and Beverages | Debt To Equity Ratio |   2023 |         0 |      2.85445  |\n| VNM          | Food and Beverages | Current Ratio        |   2020 |         0 |      2.09132  |\n| VNM          | Food and Beverages | Current Ratio        |   2021 |         0 |      2.11895  |\n| VNM          | Food and Beverages | Current Ratio        |   2022 |         0 |      2.06801  |\n| VNM          | Food and Beverages | Current Ratio        |   2023 |         0 |      2.1016   |\n| VNM          | Food and Beverages | Debt To Equity Ratio |   2020 |         0 |      0.439424 |\n| VNM          | Food and Beverages | Debt To Equity Ratio |   2021 |         0 |      0.487649 |\n| VNM          | Food and Beverages | Debt To Equity Ratio |   2022 |         0 |      0.477386 |\n| VNM          | Food and Beverages | Debt To Equity Ratio |   2023 |         0 |      0.503847 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.industry,\n  mcr.ratio_name AS Ratio,\n  fr.year,\n  fr.quarter,\n  fr.data AS Ratio_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('VNM', 'MSN', 'HPG')  -- Companies of Interest\n  AND fr.ratio_code IN ('DTER', 'CurrentR')  -- Ratios of Interest\n  AND (\n    (fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0)  -- Annual Data from 2020 to 2023\n    OR (fr.year = 2024 AND fr.quarter = 2)  -- Q2 2024\n  )\nORDER BY \n  fr.stock_code, fr.ratio_code, fr.year, fr.quarter\nLIMIT 100;  -- To adhere to the instruction of adding a LIMIT\n"
            }
        ],
        "time": 31.441285610198975,
        "evaluate": 0.5,
        "input_token": 2224,
        "output_token": 766
    },
    {
        "id": "1f330071-6ed3-48d3-912a-2bad5446636b",
        "question": "For Q4 2023, what was the Debt-to-Equity ratio for Mobile World Investment and Vinamilk, and how do these ratios change when considering the debt and equity of their subsidiaries and associated companies?",
        "answer": "Table 1\n| entity_type   | stock_code   | invest_on   |     dter |\n|:--------------|:-------------|:------------|---------:|\n| Parent        | MWG          |             | 1.57316  |\n| Parent        | VNM          |             | 0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify subsidiaries and associated companies for MWG and VNM\nWITH subsidiaries AS (\n    SELECT stock_code, invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('MWG', 'VNM')\n),\n\n-- Step 2: Retrieve Debt-to-Equity Ratio for MWG and VNM for Q4 2023\nparent_dter AS (\n    SELECT stock_code, data AS dter\n    FROM financial_ratio\n    WHERE ratio_code = 'DTER'\n      AND stock_code IN ('MWG', 'VNM')\n      AND year = 2023\n      AND quarter = 4\n),\n\n-- Step 3: Retrieve Debt-to-Equity Ratio for subsidiaries and associated companies for Q4 2023\nsubsidiary_dter AS (\n    SELECT s.stock_code, s.invest_on, fr.data AS dter\n    FROM subsidiaries s\n    JOIN financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE fr.ratio_code = 'DTER'\n      AND fr.year = 2023\n      AND fr.quarter = 4\n)\n\n-- Step 4: Combine the results\nSELECT 'Parent' AS entity_type, stock_code, NULL AS invest_on, dter\nFROM parent_dter\nUNION ALL\nSELECT 'Subsidiary', stock_code, invest_on, dter\nFROM subsidiary_dter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | company_name                            |   year |   quarter | ratio_name           |   dter_value |\n|:-------------|:----------------------------------------|-------:|----------:|:---------------------|-------------:|\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng |   2023 |         4 | Debt To Equity Ratio |     1.57316  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam            |   2023 |         4 | Debt To Equity Ratio |     0.503847 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.company_name,\n  fr.year,\n  fr.quarter,\n  mcr.ratio_name,\n  fr.data AS DTER_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('MWG', 'VNM')\n  AND fr.year = 2023\n  AND fr.quarter = 4  -- Note: Q4 is specified, but typically, quarterly financial ratios might not directly compare to annual. This query assumes availability.\n  AND mcr.ratio_code = 'DTER'\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "-- Step 1: Identify Subsidiaries\nWITH subsidiaries AS (\n  SELECT invest_on AS stock_code\n  FROM sub_and_shareholder\n  WHERE stock_code IN ('MWG', 'VNM')\n)\n-- Step 2: Would involve joining with financial reports and mapping tables, calculating DTER\n-- This step is omitted due to the lack of specific category codes for debt and equity in the provided snapshot.\n"
            }
        ],
        "time": 32.71036911010742,
        "evaluate": 0.5,
        "input_token": 3810,
        "output_token": 1286
    },
    {
        "id": "113431fd-d8a9-4fcc-b8e4-44bb3cc73663",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) in 2023, based on their financial statements.",
        "answer": "Table 1\n| stock_code   | industry           |      roe |\n|:-------------|:-------------------|---------:|\n| TMB          | Basic Resources    | 0.476625 |\n| SLS          | Food and Beverages | 0.443074 |\n| CAP          | Basic Resources    | 0.43171  |\n| SAF          | Food and Beverages | 0.2894   |\n| DGC          | Chemicals          | 0.269533 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |      roe |\n|:-------------|---------:|\n| TMB          | 0.476625 |\n| SLS          | 0.443074 |\n| CAP          | 0.43171  |\n| SAF          | 0.2894   |\n| DGC          | 0.269533 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  stock_code, \n  data AS ROE\nFROM \n  financial_ratio\nWHERE \n  ratio_code = 'ROE' \n  AND year = 2023 \n  AND quarter = 0\nORDER BY \n  data DESC  -- Highest ROE first\nLIMIT 5;\n"
            }
        ],
        "time": 21.19929838180542,
        "evaluate": 1,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "12a7a240-a91a-45cd-b870-50f2826a2e66",
        "question": "What are the top 10 companies with the lowest Debt-to-Equity ratio from 2020 to Q2 2024, calculated as Total Debt divided by Total Equity, and how did this ratio change for each company over this period?",
        "answer": "Table 1\n| stock_code   | company_name                                                  |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|:--------------------------------------------------------------|-------:|----------:|-----------------------:|\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2023 |         0 |               0.102494 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2020 |         0 |               0.125015 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2023 |         0 |               0.136624 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2020 |         0 |               0.17039  |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2023 |         0 |               0.176222 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2024 |         2 |               0.179365 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2021 |         0 |               0.188442 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2022 |         0 |               0.200008 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2024 |         2 |               0.206202 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2024 |         2 |               0.209858 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2022 |         0 |               0.216221 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2021 |         0 |               0.235643 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2022 |         0 |               0.237365 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2023 |         0 |               0.259786 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2020 |         0 |               0.276946 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2022 |         0 |               0.277531 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2021 |         0 |               0.277955 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2021 |         0 |               0.287564 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2020 |         0 |               0.290342 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2023 |         0 |               0.291759 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2023 |         0 |               0.297329 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2024 |         2 |               0.310486 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2022 |         0 |               0.33581  |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2023 |         0 |               0.336332 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2023 |         0 |               0.343894 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2023 |         0 |               0.344899 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2021 |         0 |               0.345608 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2021 |         0 |               0.349295 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2022 |         0 |               0.351281 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2022 |         0 |               0.353514 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2020 |         0 |               0.357263 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2024 |         2 |               0.359095 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2022 |         0 |               0.368554 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2024 |         2 |               0.369029 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2020 |         0 |               0.377942 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2023 |         0 |               0.394739 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2022 |         0 |               0.401541 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2022 |         0 |               0.402429 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2021 |         0 |               0.406165 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2020 |         0 |               0.408761 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2021 |         0 |               0.414164 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2023 |         0 |               0.419899 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2020 |         0 |               0.423653 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2024 |         2 |               0.435372 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2022 |         0 |               0.43865  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2020 |         0 |               0.439424 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2020 |         0 |               0.444683 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2023 |         0 |               0.457793 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2020 |         0 |               0.463731 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2022 |         0 |               0.46592  |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2023 |         0 |               0.471272 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2020 |         0 |               0.474374 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2022 |         0 |               0.477386 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2021 |         0 |               0.480607 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2024 |         2 |               0.483638 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2021 |         0 |               0.487649 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2023 |         0 |               0.503847 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2020 |         0 |               0.504436 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2023 |         0 |               0.508928 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2021 |         0 |               0.509177 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2021 |         0 |               0.521258 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2023 |         0 |               0.529397 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2021 |         0 |               0.543834 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2020 |         0 |               0.545038 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2023 |         0 |               0.554623 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2020 |         0 |               0.560901 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2022 |         0 |               0.561239 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2021 |         0 |               0.563492 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2020 |         0 |               0.569625 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2021 |         0 |               0.571747 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2024 |         2 |               0.576112 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2022 |         0 |               0.579462 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2023 |         0 |               0.581221 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2023 |         0 |               0.593005 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2023 |         0 |               0.603542 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2020 |         0 |               0.618346 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2022 |         0 |               0.632072 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2021 |         0 |               0.642793 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2023 |         0 |               0.660318 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2022 |         0 |               0.682692 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2024 |         2 |               0.687472 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2022 |         0 |               0.694971 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2021 |         0 |               0.702049 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2024 |         2 |               0.705204 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2023 |         0 |               0.705913 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2022 |         0 |               0.707956 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2020 |         0 |               0.708054 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2023 |         0 |               0.719185 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2021 |         0 |               0.722437 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2023 |         0 |               0.722593 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2022 |         0 |               0.725978 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2022 |         0 |               0.728122 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2020 |         0 |               0.728687 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2023 |         0 |               0.750505 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2021 |         0 |               0.751401 |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2021 |         0 |               0.754212 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2021 |         0 |               0.755797 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2021 |         0 |               0.766117 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2020 |         0 |               0.766169 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2022 |         0 |               0.772243 |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2023 |         0 |               0.772254 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2022 |         0 |               0.778332 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2021 |         0 |               0.779472 |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2024 |         2 |               0.78104  |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2022 |         0 |               0.788825 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2021 |         0 |               0.794179 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2021 |         0 |               0.808803 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2022 |         0 |               0.815038 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2021 |         0 |               0.816257 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2023 |         0 |               0.826032 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2022 |         0 |               0.826206 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2022 |         0 |               0.839544 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2021 |         0 |               0.845713 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2024 |         2 |               0.874097 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2022 |         0 |               0.898412 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2024 |         2 |               0.901137 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2024 |         2 |               0.93525  |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2023 |         0 |               0.936787 |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2021 |         0 |               0.941665 |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2024 |         2 |               0.949132 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2023 |         0 |               0.950352 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2021 |         0 |               0.963375 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2020 |         0 |               0.974251 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2020 |         0 |               0.975521 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2021 |         0 |               0.982156 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2021 |         0 |               0.991947 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2022 |         0 |               0.994639 |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2023 |         0 |               1.01392  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2023 |         0 |               1.02916  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2020 |         0 |               1.03173  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2022 |         0 |               1.037    |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2020 |         0 |               1.03966  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2023 |         0 |               1.04948  |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2023 |         0 |               1.06223  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2022 |         0 |               1.09689  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2022 |         0 |               1.10132  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2021 |         0 |               1.11143  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2024 |         2 |               1.12275  |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2022 |         0 |               1.13455  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2020 |         0 |               1.14525  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2022 |         0 |               1.1527   |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2020 |         0 |               1.22073  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2023 |         0 |               1.22591  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2020 |         0 |               1.2431   |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2023 |         0 |               1.25617  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2021 |         0 |               1.25925  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2024 |         2 |               1.26119  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2021 |         0 |               1.29267  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2021 |         0 |               1.31812  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2021 |         0 |               1.32573  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2022 |         0 |               1.33297  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2021 |         0 |               1.34428  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2024 |         2 |               1.35003  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2023 |         0 |               1.35495  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2023 |         0 |               1.36439  |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2024 |         2 |               1.36986  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2022 |         0 |               1.37252  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2024 |         2 |               1.39121  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2020 |         0 |               1.40109  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2020 |         0 |               1.41587  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2023 |         0 |               1.43451  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2022 |         0 |               1.43609  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2020 |         0 |               1.44044  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2023 |         0 |               1.46271  |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2021 |         0 |               1.47419  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2024 |         2 |               1.48784  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2021 |         0 |               1.50714  |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2023 |         0 |               1.51354  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2022 |         0 |               1.53038  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2020 |         0 |               1.53275  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2021 |         0 |               1.54511  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2020 |         0 |               1.5662   |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2023 |         0 |               1.5733   |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2024 |         2 |               1.60012  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2022 |         0 |               1.68066  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2021 |         0 |               1.68459  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2021 |         0 |               1.69044  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2022 |         0 |               1.69096  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2022 |         0 |               1.69426  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2024 |         2 |               1.72785  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2023 |         0 |               1.7435   |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2024 |         2 |               1.77546  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2023 |         0 |               1.78848  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2022 |         0 |               1.7954   |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2023 |         0 |               1.81978  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2021 |         0 |               1.84053  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2021 |         0 |               1.85522  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2021 |         0 |               1.89752  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2024 |         2 |               1.90154  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2020 |         0 |               1.91758  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2022 |         0 |               1.92198  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2022 |         0 |               1.95208  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2020 |         0 |               1.97325  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2021 |         0 |               1.97835  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2021 |         0 |               1.98675  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2022 |         0 |               2.00309  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2023 |         0 |               2.00446  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2020 |         0 |               2.01747  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2021 |         0 |               2.06474  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2021 |         0 |               2.09013  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2020 |         0 |               2.09671  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2020 |         0 |               2.11001  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2023 |         0 |               2.15907  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2022 |         0 |               2.20557  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2024 |         2 |               2.21151  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2020 |         0 |               2.22173  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2023 |         0 |               2.22761  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2024 |         2 |               2.26609  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2020 |         0 |               2.28019  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2021 |         0 |               2.51506  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2021 |         0 |               2.53892  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2021 |         0 |               2.71025  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2023 |         0 |               2.72341  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2020 |         0 |               2.74222  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2022 |         0 |               2.76126  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2023 |         0 |               2.85445  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2022 |         0 |               2.85795  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2020 |         0 |               2.88006  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2023 |         0 |               3.0692   |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2022 |         0 |               3.07163  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2021 |         0 |               3.09964  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2022 |         0 |               3.12368  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2022 |         0 |               3.25643  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2021 |         0 |               3.27534  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2020 |         0 |               3.39756  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2024 |         2 |               3.41035  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2024 |         2 |               3.44847  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2023 |         0 |               3.50444  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2020 |         0 |               3.52636  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2022 |         0 |               3.56676  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2020 |         0 |               3.62386  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2021 |         0 |               3.90207  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2022 |         0 |               4.03591  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2022 |         0 |               4.13522  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2020 |         0 |               4.17725  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2023 |         0 |               4.33049  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2021 |         0 |               4.3342   |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2023 |         0 |               4.66769  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2023 |         0 |               4.69525  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2023 |         0 |               4.69885  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2022 |         0 |               4.73317  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2022 |         0 |               4.75073  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2023 |         0 |               4.84831  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2020 |         0 |               4.89163  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2021 |         0 |               5.01874  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2022 |         0 |               5.09663  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2021 |         0 |               5.11264  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2022 |         0 |               5.16295  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2024 |         2 |               5.26066  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2021 |         0 |               5.34471  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2021 |         0 |               5.42305  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2023 |         0 |               5.50936  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2024 |         2 |               5.6117   |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2024 |         2 |               5.64646  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2020 |         0 |               5.67617  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2022 |         0 |               5.71337  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2020 |         0 |               5.90465  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2023 |         0 |               6.61905  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2022 |         0 |               6.67618  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2020 |         0 |               6.93709  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2024 |         2 |               7.08423  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2023 |         0 |               7.41452  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2021 |         0 |               7.46095  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2020 |         0 |               7.74824  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2023 |         0 |               7.9738   |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2022 |         0 |               8.03598  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2022 |         0 |               8.1509   |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2023 |         0 |               8.16639  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2021 |         0 |               8.32431  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2020 |         0 |               8.53865  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2021 |         0 |               8.71642  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2023 |         0 |               8.77089  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2020 |         0 |               8.87998  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2020 |         0 |               8.96134  |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2022 |         0 |               8.97033  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2023 |         0 |               9.13015  |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2022 |         0 |               9.19368  |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2021 |         0 |               9.31087  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2022 |         0 |               9.40194  |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2022 |         0 |               9.49887  |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2022 |         0 |               9.67507  |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2023 |         0 |               9.80353  |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2023 |         0 |               9.89194  |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2023 |         0 |              10.1483   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2023 |         0 |              10.2219   |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2021 |         0 |              10.2682   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2024 |         2 |              10.3055   |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2021 |         0 |              10.7541   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2024 |         2 |              10.8215   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2023 |         0 |              11.0259   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2021 |         0 |              11.1666   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2020 |         0 |              11.2966   |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2020 |         0 |              11.3214   |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2020 |         0 |              11.5403   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2023 |         0 |              11.5853   |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2021 |         0 |              11.7422   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2022 |         0 |              11.8402   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2020 |         0 |              11.918    |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2021 |         0 |              11.9647   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2020 |         0 |              12.0583   |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2022 |         0 |              12.3717   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2023 |         0 |              12.5012   |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2020 |         0 |              12.6129   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2022 |         0 |              12.6248   |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2020 |         0 |              13.0946   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2021 |         0 |              13.2578   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2023 |         0 |              13.746    |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2021 |         0 |              14.2101   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2022 |         0 |              14.3237   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2022 |         0 |              14.587    |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2020 |         0 |              14.7056   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2023 |         0 |              15.1483   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2021 |         0 |              15.3545   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2022 |         0 |              15.7188   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2020 |         0 |              16.009    |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2020 |         0 |              16.0284   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2021 |         0 |              16.212    |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2021 |         0 |              16.3027   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2024 |         2 |              17.7161   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2023 |         0 |              17.7184   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2020 |         0 |              18.0427   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2024 |         2 |              19.2545   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2022 |         0 |              19.3533   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2021 |         0 |              19.4068   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2020 |         0 |              20.0192   |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2022 |         0 |             nan        |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH RankedCompanies AS (\n    SELECT \n        fr.stock_code,\n        ci.company_name,\n        fr.year,\n        fr.quarter,\n        fr.data AS debt_to_equity_ratio,\n        ROW_NUMBER() OVER (PARTITION BY fr.stock_code ORDER BY fr.data ASC) AS rn\n    FROM \n        financial_ratio fr\n    JOIN \n        company_info ci ON fr.stock_code = ci.stock_code\n    WHERE \n        fr.ratio_code = 'DTER'\n        AND ((fr.year = 2020 AND fr.quarter = 0) OR\n             (fr.year = 2021 AND fr.quarter = 0) OR\n             (fr.year = 2022 AND fr.quarter = 0) OR\n             (fr.year = 2023 AND fr.quarter = 0) OR\n             (fr.year = 2024 AND fr.quarter = 2))\n)\nSELECT \n    rc.stock_code,\n    rc.company_name,\n    rc.year,\n    rc.quarter,\n    rc.debt_to_equity_ratio\nFROM \n    RankedCompanies rc\nWHERE \n    rc.rn <= 10\nORDER BY \n    rc.debt_to_equity_ratio ASC, rc.stock_code, rc.year, rc.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Calculate Debt to Equity Ratio for each company type (bank, non-bank, securities) for annual reports (2020-2023)\nAnnual_DTE AS (\n  SELECT \n    'Bank' AS CompanyType,\n    bfr.stock_code,\n    bfr.year,\n    0 AS quarter, -- Denote annual\n    (bfr_debt.data / bfr_equity.data) AS DTE_Ratio\n  FROM \n    bank_financial_report bfr_debt\n  JOIN \n    bank_financial_report bfr_equity ON bfr_debt.stock_code = bfr_equity.stock_code AND bfr_debt.year = bfr_equity.year\n  WHERE \n    bfr_debt.category_code = 'BS_400' AND -- Total Liabilities (approximating debt)\n    bfr_equity.category_code = 'BS_500' AND -- Shareholders\u2019 equity\n    bfr_debt.year IN (2020, 2021, 2022, 2023) AND\n    bfr_debt.quarter = 0\n  UNION ALL\n  SELECT \n    'Non-Bank' AS CompanyType,\n    nbfr.stock_code,\n    nbfr.year,\n    0 AS quarter,\n    ((nbfr_liab.data - nbfr_equity.data) / nbfr_equity.data) AS DTE_Ratio\n  FROM \n    non_bank_financial_report nbfr_liab\n  JOIN \n    non_bank_financial_report nbfr_equity ON nbfr_liab.stock_code = nbfr_equity.stock_code AND nbfr_liab.year = nbfr_equity.year\n  WHERE \n    nbfr_liab.category_code = 'BS_440' AND -- Total Liabilities and Equity\n    nbfr_equity.category_code = 'BS_400' AND -- Equity\n    nbfr_liab.year IN (2020, 2021, 2022, 2023) AND\n    nbfr_liab.quarter = 0\n  UNION ALL\n  SELECT \n    'Securities' AS CompanyType,\n    sfr.stock_code,\n    sfr.year,\n    0 AS quarter,\n    (sfr_debt.data / sfr_equity.data) AS DTE_Ratio\n  FROM \n    securities_financial_report sfr_debt\n  JOIN \n    securities_financial_report sfr_equity ON sfr_debt.stock_code = sfr_equity.stock_code AND sfr_debt.year = sfr_equity.year\n  WHERE \n    sfr_debt.category_code = 'BS_114' AND -- Loans (closest to debt for securities)\n    sfr_equity.category_code = 'BS_400' AND -- Owner's Equity\n    sfr_debt.year IN (2020, 2021, 2022, 2023) AND\n    sfr_debt.quarter = 0\n),\n-- Calculate DTE Ratio for Q2 2024\nQ2_2024_DTE AS (\n  SELECT \n    'Bank' AS CompanyType,\n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    (bfr_debt.data / bfr_equity.data) AS DTE_Ratio\n  FROM \n    bank_financial_report bfr_debt\n  JOIN \n    bank_financial_report bfr_equity ON bfr_debt.stock_code = bfr_equity.stock_code AND bfr_debt.year = bfr_equity.year AND bfr_debt.quarter = bfr_equity.quarter\n  WHERE \n    bfr_debt.category_code = 'BS_400' AND \n    bfr_equity.category_code = 'BS_500' AND \n    bfr_debt.year = 2024 AND\n    bfr_debt.quarter = 2\n  UNION ALL\n  -- Repeat for Non-Bank and Securities with respective category codes and conditions\n  SELECT \n    'Non-Bank' AS CompanyType,\n    nbfr.stock_code,\n    nbfr.year,\n    nbfr.quarter,\n    ((nbfr_liab.data - nbfr_equity.data) / nbfr_equity.data) AS DTE_Ratio\n  FROM \n    non_bank_financial_report nbfr_liab\n  JOIN \n    non_bank_financial_report nbfr_equity ON nbfr_liab.stock_code = nbfr_equity.stock_code AND nbfr_liab.year = nbfr_equity.year AND nbfr_liab.quarter = nbfr_equity.quarter\n  WHERE \n    nbfr_liab.category_code = 'BS_440' AND \n    nbfr_equity.category_code = 'BS_400' AND \n    nbfr_liab.year = 2024 AND\n    nbfr_liab.quarter = 2\n  UNION ALL\n  SELECT \n    'Securities' AS CompanyType,\n    sfr.stock_code,\n    sfr.year,\n    sfr.quarter,\n    (sfr_debt.data / sfr_equity.data) AS DTE_Ratio\n  FROM \n    securities_financial_report sfr_debt\n  JOIN \n    securities_financial_report sfr_equity ON sfr_debt.stock_code = sfr_equity.stock_code AND sfr_debt.year = sfr_equity.year AND sfr_debt.quarter = sfr_equity.quarter\n  WHERE \n    sfr_debt.category_code = 'BS_114' AND \n    sfr_equity.category_code = 'BS_400' AND \n    sfr_debt.year = 2024 AND\n    sfr_debt.quarter = 2\n),\n-- Combine Annual and Q2 2024 DTE Ratios\nCombined_DTE AS (\n  SELECT * FROM Annual_DTE\n  UNION ALL\n  SELECT * FROM Q2_2024_DTE\n)\n-- Final Query: Top 10 Companies with Lowest DTE Ratio and Change Over Time\nSELECT \n  stock_code,\n  CompanyType,\n  -- Lowest DTE Ratio (assuming the first year for simplicity, adjust as needed)\n  MIN(DTE_Ratio) OVER (PARTITION BY stock_code) AS Lowest_DTE_Ratio,\n  -- Change in DTE Ratio from first year to Q2 2024\n  (MAX(DTE_Ratio) OVER (PARTITION BY stock_code) - MIN(DTE_Ratio) OVER (PARTITION BY stock_code)) AS Change_In_DTE\nFROM \n  Combined_DTE\nORDER BY \n  Lowest_DTE_Ratio ASC\nLIMIT 10;\n"
            }
        ],
        "time": 75.89603042602539,
        "evaluate": 0,
        "input_token": 1996,
        "output_token": 1773
    },
    {
        "id": "6ef05b65-adaa-4959-805b-0f7a613617fd",
        "question": "What is the trend of Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (1, 2))\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Error in getting the answer",
        "code_response": "Error in getting the code",
        "evaluate": 0,
        "input_token": 721,
        "output_token": 385
    },
    {
        "id": "5c4964d0-adc2-4847-9751-de6fad125d24",
        "question": "Calculate the Gross Profit Margin for Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.  Further, compute the year-on-year growth rate of the Gross Profit Margin for each company during this period.",
        "answer": "Table 1\n| stock_code   |   year |   avg_gpm |   yoy_growth_rate |\n|:-------------|-------:|----------:|------------------:|\n| MSN          |   2020 |  0.231665 |         nan       |\n| MSN          |   2021 |  0.249747 |           7.80519 |\n| MSN          |   2022 |  0.276089 |          10.5474  |\n| MSN          |   2023 |  0.282692 |           2.39156 |\n| SAB          |   2020 |  0.30403  |         nan       |\n| SAB          |   2021 |  0.28849  |          -5.11146 |\n| SAB          |   2022 |  0.307918 |           6.73451 |\n| SAB          |   2023 |  0.298455 |          -3.07321 |\n| VNM          |   2020 |  0.463956 |         nan       |\n| VNM          |   2021 |  0.431363 |          -7.02496 |\n| VNM          |   2022 |  0.398578 |          -7.60046 |\n| VNM          |   2023 |  0.406579 |           2.00742 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH GPM_data AS (\n    SELECT \n        fr.stock_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS gpm\n    FROM \n        financial_ratio fr\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Gross Profit Margin' AND\n        fr.stock_code IN ('VNM', 'MSN', 'SAB') AND\n        ((fr.year BETWEEN 2020 AND 2024) AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter <= 2)))\n),\nYearly_GPM AS (\n    SELECT \n        stock_code,\n        year,\n        AVG(gpm) AS avg_gpm\n    FROM \n        GPM_data\n    WHERE \n        quarter = 0\n    GROUP BY \n        stock_code, year\n),\nGrowth_Rate AS (\n    SELECT \n        a.stock_code,\n        a.year,\n        a.avg_gpm,\n        ((a.avg_gpm - b.avg_gpm) / NULLIF(b.avg_gpm, 0)) * 100 AS yoy_growth_rate\n    FROM \n        Yearly_GPM a\n    LEFT JOIN \n        Yearly_GPM b ON a.stock_code = b.stock_code AND a.year = b.year + 1\n)\nSELECT \n    stock_code,\n    year,\n    avg_gpm,\n    yoy_growth_rate\nFROM \n    Growth_Rate\nORDER BY \n    stock_code, year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Step 1: Extract relevant GPM data for the companies across the specified years\nGPM_Data AS (\n  SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS GPM_Value\n  FROM \n    financial_ratio fr\n  INNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  INNER JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\n  WHERE \n    mcr.ratio_name = 'Gross Profit Margin'\n    AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter = 2))\n),\n\n-- Step 2: Calculate Year-on-Year Growth Rate for GPM\nYoY_Growth AS (\n  SELECT \n    stock_code,\n    year,\n    quarter,\n    GPM_Value,\n    -- Calculate YoY growth rate; assuming previous year's value exists for all relevant years\n    (GPM_Value / LAG(GPM_Value, 1, 0) OVER (PARTITION BY stock_code ORDER BY year, quarter) - 1) * 100 AS YoY_Growth_Rate\n  FROM \n    GPM_Data\n)\n-- Final Step: Present both GPM and its YoY Growth Rate\nSELECT \n  stock_code,\n  year,\n  quarter,\n  GPM_Value,\n  YoY_Growth_Rate\nFROM \n  YoY_Growth\nORDER BY \n  stock_code, year, quarter\nLIMIT 100;  -- To adhere to the database access note\n"
            }
        ],
        "time": 34.62280607223511,
        "evaluate": 0,
        "input_token": 2159,
        "output_token": 812
    },
    {
        "id": "a43c12a4-c2cc-4354-b458-0878a4f70bd0",
        "question": "Rank the top 5 companies with the highest Current Ratio as of December 31, 2023, among companies with total assets exceeding 100 billion VND.",
        "answer": "Table 1\n| stock_code   | industry           |   current_ratio |\n|:-------------|:-------------------|----------------:|\n| HLD          | Real Estate        |         7.25278 |\n| EIB          | Banking            |         6.12482 |\n| TCH          | Real Estate        |         6.00022 |\n| ABB          | Banking            |         5.488   |\n| SLS          | Food and Beverages |         4.98219 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TotalAssets AS (\n    SELECT stock_code\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n    UNION\n    SELECT stock_code\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n    UNION\n    SELECT stock_code\n    FROM securities_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n),\nCurrentRatios AS (\n    SELECT fr.stock_code, fr.data AS current_ratio\n    FROM financial_ratio fr\n    JOIN TotalAssets ta ON fr.stock_code = ta.stock_code\n    WHERE fr.ratio_code = 'CurrentR' AND fr.year = 2023 AND fr.quarter = 0\n)\nSELECT ci.stock_code, ci.industry, cr.current_ratio\nFROM CurrentRatios cr\nJOIN company_info ci ON cr.stock_code = ci.stock_code\nORDER BY cr.current_ratio DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | currentratio   |\n|--------------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine all financial reports\nAllReports AS (\n  SELECT 'bank' AS report_type, stock_code, year, quarter, category_code, data \n  FROM bank_financial_report\n  UNION ALL\n  SELECT 'non_bank' AS report_type, stock_code, year, quarter, category_code, data \n  FROM non_bank_financial_report\n  UNION ALL\n  SELECT 'securities' AS report_type, stock_code, year, quarter, category_code, data \n  FROM securities_financial_report\n),\n\n-- Map category codes to captions for easier filtering\nMappedReports AS (\n  SELECT \n    AR.report_type,\n    AR.stock_code,\n    AR.year,\n    AR.quarter,\n    COALESCE(\n      MB.en_caption, \n      MNB.en_caption, \n      MS.en_caption\n    ) AS en_caption,\n    AR.data\n  FROM AllReports AR\n  LEFT JOIN map_category_code_bank MB ON AR.category_code = MB.category_code AND AR.report_type = 'bank'\n  LEFT JOIN map_category_code_non_bank MNB ON AR.category_code = MNB.category_code AND AR.report_type = 'non_bank'\n  LEFT JOIN map_category_code_securities MS ON AR.category_code = MS.category_code AND AR.report_type = 'securities'\n),\n\n-- Filter for Total Assets and calculate Current Ratio\nCompanyRatios AS (\n  SELECT \n    stock_code,\n    -- Assuming Current Assets = A. CURRENT ASSETS and Current Liabilities = I. Current liabilities\n    -- Note: Actual category_codes might vary based on the mapping tables provided\n    SUM(CASE WHEN en_caption = 'A. CURRENT ASSETS' THEN data ELSE 0 END) AS CurrentAssets,\n    SUM(CASE WHEN en_caption = 'I. Current liabilities' THEN data ELSE 0 END) AS CurrentLiabilities,\n    SUM(CASE WHEN en_caption = 'TOTAL ASSETS' THEN data ELSE 0 END) AS TotalAssets\n  FROM MappedReports\n  WHERE year = 2023 AND quarter = 0\n  GROUP BY stock_code\n  HAVING SUM(CASE WHEN en_caption = 'TOTAL ASSETS' THEN data ELSE 0 END) > 100000000000  -- Total Assets > 100 billion VND\n),\n\n-- Calculate Current Ratio and Rank\nRankedRatios AS (\n  SELECT \n    stock_code,\n    CurrentAssets / CurrentLiabilities AS CurrentRatio,\n    ROW_NUMBER() OVER (ORDER BY CurrentAssets / CurrentLiabilities DESC) AS Rank\n  FROM CompanyRatios\n  WHERE CurrentLiabilities <> 0  -- Avoid division by zero\n)\n\n-- Select top 5 companies by Current Ratio\nSELECT stock_code, CurrentRatio\nFROM RankedRatios\nWHERE Rank <= 5\nLIMIT 5;\n"
            }
        ],
        "time": 40.84120178222656,
        "evaluate": 0,
        "input_token": 3901,
        "output_token": 1917
    },
    {
        "id": "eefe39ae-6424-47d5-ac08-482fc8f15531",
        "question": "For the top 10 companies with Net Income greater than 1,000,000,000,000 VND in 2023, what are their respective Net Profit Margins and Current Ratios?",
        "answer": "Table 1\n| stock_code   | net_profit_margin   | current_ratio   |\n|--------------|---------------------|-----------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TopCompanies AS (\n    SELECT\n        stock_code,\n        SUM(data) AS net_income\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'IS_021' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'IS_030' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'IS_400' AND year = 2023 AND quarter = 0\n    ) AS combined_reports\n    GROUP BY stock_code\n    HAVING SUM(data) > 1000000\n    ORDER BY net_income DESC\n    LIMIT 10\n)\n\nSELECT\n    tc.stock_code,\n    fr1.data AS net_profit_margin,\n    fr2.data AS current_ratio\nFROM\n    TopCompanies tc\nJOIN financial_ratio fr1 ON tc.stock_code = fr1.stock_code\n    AND fr1.ratio_code = 'NPM' AND fr1.year = 2023 AND fr1.quarter = 0\nJOIN financial_ratio fr2 ON tc.stock_code = fr2.stock_code\n    AND fr2.ratio_code = 'CurrentR' AND fr2.year = 2023 AND fr2.quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | netprofitmargin   | currentratio   |\n|--------------|-------------------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine all financial reports for annual data in 2023, filtering by inferred Net Income codes\nAnnualReports2023 AS (\n  SELECT 'Non-Bank' AS ReportType, stock_code, data AS NetIncome\n  FROM non_bank_financial_report\n  WHERE year = 2023 AND quarter = 0 AND category_code = 'IS_NetIncome'  -- REPLACE WITH ACTUAL CODE\n  UNION ALL\n  SELECT 'Bank' AS ReportType, stock_code, data AS NetIncome\n  FROM bank_financial_report\n  WHERE year = 2023 AND quarter = 0 AND category_code = 'IS_NetIncome_Bank'  -- REPLACE WITH ACTUAL CODE\n  UNION ALL\n  SELECT 'Securities' AS ReportType, stock_code, data AS NetIncome\n  FROM securities_financial_report\n  WHERE year = 2023 AND quarter = 0 AND category_code = 'IS_NetIncome_Securities'  -- REPLACE WITH ACTUAL CODE\n),\n-- Rank companies by Net Income\nRankedCompanies AS (\n  SELECT stock_code, NetIncome,\n         ROW_NUMBER() OVER (ORDER BY NetIncome DESC) AS Rank\n  FROM AnnualReports2023\n  WHERE NetIncome > 1000000000000  -- 1,000,000,000,000 VND\n),\n-- Fetch NPM and Current Ratio for top 10 companies\nTop10CompanyRatios AS (\n  SELECT RC.stock_code,\n         FR1.data AS NetProfitMargin,\n         FR2.data AS CurrentRatio\n  FROM RankedCompanies RC\n  JOIN financial_ratio FR1 ON RC.stock_code = FR1.stock_code AND FR1.year = 2023 AND FR1.quarter = 0 AND FR1.ratio_code = 'NPM'\n  JOIN financial_ratio FR2 ON RC.stock_code = FR2.stock_code AND FR2.year = 2023 AND FR2.quarter = 0 AND FR2.ratio_code = 'CurrentR'\n  WHERE RC.Rank <= 10\n)\n-- Final selection with limit\nSELECT *\nFROM Top10CompanyRatios\nLIMIT 100;  -- Ensure to see all top 10 results, adjust limit as necessary\n"
            }
        ],
        "time": 41.74131226539612,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "5f48b85d-d6f3-4010-a6f8-22f11cfaa754",
        "question": "What is the breakdown of equity investments (including both subsidiaries and other investments) for Mobile World Investment and its return on equity (ROE) for the fiscal year 2023?",
        "answer": "Table 1\n| category_code   | en_caption                                  |   data |\n|:----------------|:--------------------------------------------|-------:|\n| BS_213          | Business capital at subsidiaries            |      0 |\n| BS_251          | Investment in subsidiaries                  |      0 |\n| BS_252          | Investment in associates and joint ventures | 286632 |\n| BS_253          | Investment in other entities                |      0 |\n\nTable 2\n|       roe |\n|----------:|\n| 0.0071846 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to get the breakdown of equity investments for MWG in 2023\nSELECT \n    nbfr.category_code,\n    mccnb.en_caption,\n    nbfr.data\nFROM \n    non_bank_financial_report nbfr\nJOIN \n    map_category_code_non_bank mccnb ON nbfr.category_code = mccnb.category_code\nWHERE \n    nbfr.stock_code = 'MWG'\n    AND nbfr.year = 2023\n    AND nbfr.quarter = 0\n    AND nbfr.category_code IN ('BS_213', 'BS_251', 'BS_252', 'BS_253');\n\n-- Query to get the ROE for MWG in 2023\nSELECT \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code = 'MWG'\n    AND fr.year = 2023\n    AND fr.quarter = 0\n    AND mccr.ratio_name = 'Return On Equity';\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| report_type   | category_code   |              data |\n|:--------------|:----------------|------------------:|\n| Non-Bank      | BS_151          |  481240           |\n| Non-Bank      | BS_152          |  159821           |\n| Non-Bank      | BS_153          |   23473           |\n| Non-Bank      | BS_154          |       0           |\n| Non-Bank      | BS_155          |       0           |\n| Non-Bank      | BS_200          |       8.1609e+06  |\n| Non-Bank      | BS_210          |  457569           |\n| Non-Bank      | BS_211          |       0           |\n| Non-Bank      | BS_212          |       0           |\n| Non-Bank      | BS_213          |       0           |\n| Non-Bank      | BS_214          |       0           |\n| Non-Bank      | BS_215          |    9244           |\n| Non-Bank      | BS_216          |  448325           |\n| Non-Bank      | BS_219          |       0           |\n| Non-Bank      | BS_220          |       6.50014e+06 |\n| Non-Bank      | BS_221          |       6.43132e+06 |\n| Non-Bank      | BS_222          |       2.01393e+07 |\n| Non-Bank      | BS_223          |      -1.3708e+07  |\n| Non-Bank      | BS_224          |       0           |\n| Non-Bank      | BS_225          |       0           |\n| Non-Bank      | BS_226          |       0           |\n| Non-Bank      | BS_227          |   68820           |\n| Non-Bank      | BS_228          |   90297           |\n| Non-Bank      | BS_229          |  -21477           |\n| Non-Bank      | BS_230          |       0           |\n| Non-Bank      | BS_231          |       0           |\n| Non-Bank      | BS_232          |       0           |\n| Non-Bank      | BS_240          |    4493           |\n| Non-Bank      | BS_241          |       0           |\n| Non-Bank      | BS_242          |    4493           |\n| Non-Bank      | BS_250          |  746632           |\n| Non-Bank      | BS_251          |       0           |\n| Non-Bank      | BS_252          |  286632           |\n| Non-Bank      | BS_253          |       0           |\n| Non-Bank      | BS_254          |       0           |\n| Non-Bank      | BS_255          |  460000           |\n| Non-Bank      | BS_260          |  452067           |\n| Non-Bank      | BS_261          |  105411           |\n| Non-Bank      | BS_262          |  101088           |\n| Non-Bank      | BS_263          |       0           |\n| Non-Bank      | BS_268          |       0           |\n| Non-Bank      | BS_269          |  245567           |\n| Non-Bank      | BS_270          |       6.01112e+07 |\n| Non-Bank      | BS_300          |       3.67517e+07 |\n| Non-Bank      | BS_310          |       3.07653e+07 |\n| Non-Bank      | IS_001          |       1.19234e+08 |\n| Non-Bank      | IS_002          |  954396           |\n| Non-Bank      | IS_010          |       1.1828e+08  |\n| Non-Bank      | IS_011          |       9.57592e+07 |\n| Non-Bank      | IS_020          |       2.25206e+07 |\n| Non-Bank      | IS_021          |       2.16696e+06 |\n| Non-Bank      | IS_022          |       1.55615e+06 |\n| Non-Bank      | IS_023          |       1.44772e+06 |\n| Non-Bank      | IS_024          |       0           |\n| Non-Bank      | IS_025          |       2.09167e+07 |\n| Non-Bank      | IS_026          |       1.16765e+06 |\n| Non-Bank      | IS_030          |       1.04707e+06 |\n| Non-Bank      | IS_031          |   36883           |\n| Non-Bank      | IS_032          |  394259           |\n| Non-Bank      | IS_040          | -357375           |\n| Non-Bank      | IS_050          |  689692           |\n| Non-Bank      | IS_051          |  433257           |\n| Non-Bank      | IS_052          |   88606           |\n| Non-Bank      | IS_060          |  167829           |\n| Non-Bank      | IS_061          |  167669           |\n| Non-Bank      | IS_062          |     159           |\n| Non-Bank      | IS_070          |     115           |\n| Non-Bank      | IS_071          |     115           |\n| Non-Bank      | BS_100          |       5.19503e+07 |\n| Non-Bank      | BS_110          |       5.3657e+06  |\n| Non-Bank      | BS_111          |       4.79564e+06 |\n| Non-Bank      | BS_112          |  570068           |\n| Non-Bank      | BS_120          |       1.8937e+07  |\n| Non-Bank      | BS_121          |       0           |\n| Non-Bank      | BS_122          |       0           |\n| Non-Bank      | BS_123          |       1.8937e+07  |\n| Non-Bank      | BS_130          |       5.15885e+06 |\n| Non-Bank      | BS_131          |  308474           |\n| Non-Bank      | BS_132          |   95981           |\n| Non-Bank      | BS_133          |       0           |\n| Non-Bank      | BS_134          |       0           |\n| Non-Bank      | BS_135          |       2.08592e+06 |\n| Non-Bank      | BS_136          |       2.66848e+06 |\n| Non-Bank      | BS_137          |       0           |\n| Non-Bank      | BS_139          |       0           |\n| Non-Bank      | BS_140          |       2.18242e+07 |\n| Non-Bank      | BS_141          |       2.20287e+07 |\n| Non-Bank      | BS_149          | -204448           |\n| Non-Bank      | BS_150          |  664536           |\n| Non-Bank      | BS_311          |       7.92707e+06 |\n| Non-Bank      | BS_312          |   88995           |\n| Non-Bank      | BS_313          |  421532           |\n| Non-Bank      | BS_314          |  438404           |\n| Non-Bank      | BS_315          |       1.37281e+06 |\n| Non-Bank      | BS_316          |       0           |\n| Non-Bank      | BS_317          |       0           |\n| Non-Bank      | BS_318          |    3405           |\n| Non-Bank      | BS_319          |       1.31657e+06 |\n| Non-Bank      | BS_320          |       1.91285e+07 |\n| Non-Bank      | BS_321          |   67935           |\n\nTable 2\n|   roe_value |\n|------------:|\n|   0.0071846 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Part 1: Attempt to find investment-related data for MWG in 2023 (Annual Report, quarter=0)\n-- Note: Without specific category codes for \"Equity Investments\", this part is partially inferential.\nWITH investment_data AS (\n  SELECT 'Non-Bank' AS report_type, category_code, data\n  FROM non_bank_financial_report\n  WHERE stock_code = 'MWG' AND year = 2023 AND quarter = 0\n  UNION ALL\n  SELECT 'Bank' AS report_type, category_code, data\n  FROM bank_financial_report\n  WHERE stock_code = 'MWG' AND year = 2023 AND quarter = 0\n  UNION ALL\n  SELECT 'Securities' AS report_type, category_code, data\n  FROM securities_financial_report\n  WHERE stock_code = 'MWG' AND year = 2023 AND quarter = 0\n)\nSELECT * FROM investment_data\nWHERE category_code LIKE '%IS_%' OR category_code LIKE '%BS_%'  -- Focusing on Income Statement (IS) and Balance Sheet (BS) as potential sources\nLIMIT 100;\n\n-- Part 2: Directly query ROE for MWG in 2023\nSELECT fr.data AS ROE_Value\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nJOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE mcr.ratio_name = 'Return On Equity' AND ci.stock_code = 'MWG' AND fr.year = 2023 AND fr.quarter = 0\nLIMIT 1;\n"
            }
        ],
        "time": 33.04758405685425,
        "evaluate": 0.5,
        "input_token": 1883,
        "output_token": 784
    },
    {
        "id": "6ebec9aa-2d66-4d22-a45a-a7e6114dad2b",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) \n        OR (year = 2024 AND quarter BETWEEN 1 AND 2)\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n|   year |   quarter | stock_code   | industry   | ratio_name       |   roe_value |\n|-------:|----------:|:-------------|:-----------|:-----------------|------------:|\n|   2020 |         0 | ACB          | Banking    | Return On Equity |   0.216734  |\n|   2021 |         0 | ACB          | Banking    | Return On Equity |   0.213865  |\n|   2022 |         0 | ACB          | Banking    | Return On Equity |   0.234232  |\n|   2023 |         0 | ACB          | Banking    | Return On Equity |   0.226122  |\n|   2024 |         1 | ACB          | Banking    | Return On Equity |   0.052218  |\n|   2020 |         0 | TCB          | Banking    | Return On Equity |   0.168632  |\n|   2021 |         0 | TCB          | Banking    | Return On Equity |   0.197927  |\n|   2022 |         0 | TCB          | Banking    | Return On Equity |   0.180176  |\n|   2023 |         0 | TCB          | Banking    | Return On Equity |   0.139608  |\n|   2024 |         1 | TCB          | Banking    | Return On Equity |   0.0459854 |\n|   2024 |         2 | TCB          | Banking    | Return On Equity |   0.0457096 |\n|   2020 |         0 | VCB          | Banking    | Return On Equity |   0.196318  |\n|   2021 |         0 | VCB          | Banking    | Return On Equity |   0.201059  |\n|   2022 |         0 | VCB          | Banking    | Return On Equity |   0.220567  |\n|   2023 |         0 | VCB          | Banking    | Return On Equity |   0.200315  |\n|   2024 |         1 | VCB          | Banking    | Return On Equity |   0.0494831 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.year, \n  fr.quarter, \n  ci.stock_code, \n  ci.industry, \n  mcr.ratio_name, \n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  ci.stock_code IN ('VCB', 'TCB', 'ACB') \n  AND mcr.ratio_name = 'Return On Equity'\n  AND fr.year BETWEEN 2020 AND 2024\n  AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter IN (1, 2)))\nORDER BY \n  ci.stock_code, \n  fr.year, \n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 35.427712202072144,
        "evaluate": 1,
        "input_token": 2595,
        "output_token": 1054
    },
    {
        "id": "514613cf-7002-4698-a3b7-93db835122c6",
        "question": "Rank the top 5 companies with total assets greater than 100,000 billion VND as of December 31, 2023, based on their Return on Equity (ROE).",
        "answer": "Table 1\n| stock_code   | industry   |      roe |\n|:-------------|:-----------|---------:|\n| HDB          | Banking    | 0.232433 |\n| ACB          | Banking    | 0.226122 |\n| VIB          | Banking    | 0.225702 |\n| MBB          | Banking    | 0.217698 |\n| VCB          | Banking    | 0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT \n        stock_code,\n        SUM(data) AS total_assets\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n    ) AS combined_assets\n    GROUP BY stock_code\n    HAVING SUM(data) > 100000000\n)\n\nSELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    total_assets ta ON fr.stock_code = ta.stock_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE' AND fr.year = 2023 AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |      roe |   totalassets |\n|:-------------|---------:|--------------:|\n| HDB          | 0.232433 |   6.02315e+08 |\n| ACB          | 0.226122 |   7.18795e+08 |\n| VIB          | 0.225702 |   4.09881e+08 |\n| MBB          | 0.217698 |   9.44954e+08 |\n| VCB          | 0.200315 |   1.83961e+09 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine financial reports for total assets, filtering by date and value\nTotalAssets AS (\n  SELECT 'bank' AS report_type, stock_code, data \n  FROM bank_financial_report \n  WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_300' AND data > 100000000\n  UNION ALL\n  SELECT 'non_bank' AS report_type, stock_code, data \n  FROM non_bank_financial_report \n  WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_270' AND data > 100000000\n  UNION ALL\n  SELECT 'securities' AS report_type, stock_code, data \n  FROM securities_financial_report \n  WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_270' AND data > 100000000\n),\n\n-- Link companies with their ROE for 2023\nCompanyROE AS (\n  SELECT stock_code, data AS ROE \n  FROM financial_ratio \n  WHERE year = 2023 AND quarter = 0 AND ratio_code = 'ROE'\n)\n\n-- Final query ranking companies by ROE\nSELECT \n  C.stock_code, \n  C.ROE,\n  T.data AS TotalAssets\nFROM \n  CompanyROE C\n  JOIN TotalAssets T ON C.stock_code = T.stock_code\n  LEFT JOIN company_info CI ON C.stock_code = CI.stock_code\nORDER BY \n  C.ROE DESC\nLIMIT 5;\n"
            }
        ],
        "time": 35.50445342063904,
        "evaluate": 0.5,
        "input_token": 2028,
        "output_token": 873
    },
    {
        "id": "0529969a-2008-4b24-bc19-022d11d2ecc6",
        "question": "What were the values of Total Assets, Total Liabilities, and Net Income for Vinamilk, Masan Group, and PetroVietnam Gas for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   | en_caption                           |        data |\n|:-------------|:-------------------------------------|------------:|\n| VNM          | Net profit from operating activities | 1.09036e+07 |\n| MSN          | Net profit from operating activities | 2.35043e+06 |\n| GAS          | Net profit from operating activities | 1.46191e+07 |\n| GAS          | TOTAL ASSETS                         | 8.77545e+07 |\n| GAS          | C. LIABILITIES                       | 2.24558e+07 |\n| VNM          | TOTAL ASSETS                         | 5.26734e+07 |\n| VNM          | C. LIABILITIES                       | 1.76476e+07 |\n| MSN          | TOTAL ASSETS                         | 1.47383e+08 |\n| MSN          | C. LIABILITIES                       | 1.09146e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN', 'GAS') \n    AND nfr.year = 2023 \n    AND nfr.quarter = 0 \n    AND nfr.category_code IN ('BS_270', 'BS_300', 'IS_030');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| metric            | stock_code   |   year |       value |\n|:------------------|:-------------|-------:|------------:|\n| Total Assets      | VNM          |   2023 | 3.59359e+07 |\n| Total Assets      | MSN          |   2023 | 4.37635e+07 |\n| Total Assets      | GAS          |   2023 | 6.22178e+07 |\n| Total Liabilities | GAS          |   2023 | 2.55367e+07 |\n| Total Liabilities | VNM          |   2023 | 1.67375e+07 |\n| Total Liabilities | MSN          |   2023 | 1.0362e+08  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  'Total Assets' AS Metric,\n  T1.stock_code,\n  T1.year,\n  T1.data AS Value\nFROM \n  non_bank_financial_report T1\n  INNER JOIN map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code IN ('VNM', 'MSN', 'GAS')\n  AND T1.year = 2023\n  AND T1.quarter = 0\n  AND T2.category_code IN ('BS_100')  -- Hypothetical code for Total Assets\n\nUNION ALL\n\nSELECT \n  'Total Liabilities' AS Metric,\n  T1.stock_code,\n  T1.year,\n  T1.data AS Value\nFROM \n  non_bank_financial_report T1\n  INNER JOIN map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code IN ('VNM', 'MSN', 'GAS')\n  AND T1.year = 2023\n  AND T1.quarter = 0\n  AND T2.category_code IN ('BS_200')  -- Hypothetical code for Total Liabilities\n\nUNION ALL\n\nSELECT \n  'Net Income' AS Metric,\n  T1.stock_code,\n  T1.year,\n  T1.data AS Value\nFROM \n  non_bank_financial_report T1\n  INNER JOIN map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code IN ('VNM', 'MSN', 'GAS')\n  AND T1.year = 2023\n  AND T1.quarter = 0\n  AND T2.category_code IN ('IS_300')  -- Hypothetical code for Net Income\n\nLIMIT 100;  -- To adhere to the requirement of adding a LIMIT\n"
            }
        ],
        "time": 41.22376489639282,
        "evaluate": 0,
        "input_token": 1805,
        "output_token": 846
    },
    {
        "id": "c831d896-2da0-445e-8184-0699fc43e0db",
        "question": "What is the trend of Net Profit Margin for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_profit_margin\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'NPM' \n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual reports from 2020 to 2023\n        OR \n        (year = 2024 AND quarter IN (1, 2)) -- Quarterly reports for Q1 and Q2 of 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name   | year   | quarter   | netprofitmargin   |\n|--------------|----------------|--------|-----------|-------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.company_name, -- Assuming 'company_name' exists in 'company_info' for demonstration\n  fr.year,\n  fr.quarter,\n  fr.data AS NetProfitMargin\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n  fr.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND fr.ratio_code = 'NPM'\n  AND (\n    (fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0)\n    OR (fr.year = 2024 AND fr.quarter <= 2)\n  )\nORDER BY \n  fr.stock_code, fr.year, fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 39.18908333778381,
        "evaluate": 0,
        "input_token": 2067,
        "output_token": 742
    },
    {
        "id": "a6c11447-d4dd-4ae8-99b8-57138309a422",
        "question": "Show the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Calculate the average ROE for each company over this period.",
        "answer": "Table 1\n| stock_code   |   average_roe |\n|:-------------|--------------:|\n| HPG          |     0.136672  |\n| MSN          |     0.0970669 |\n| VNM          |     0.242186  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    AVG(data) AS average_roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    stock_code IN ('VNM', 'MSN', 'HPG') AND\n    ((year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n    (year = 2024 AND quarter IN (1, 2)))\nGROUP BY \n    stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | ratio_name       |   year |   quarter |   roe_value |   avg_roe |\n|:-------------|:-----------------|-------:|----------:|------------:|----------:|\n| HPG          | Return On Equity |   2022 |         0 |   0.0878594 |  0.158574 |\n| HPG          | Return On Equity |   2024 |         2 |   0.0305454 |  0.158574 |\n| HPG          | Return On Equity |   2020 |         0 |   0.228068  |  0.158574 |\n| HPG          | Return On Equity |   2023 |         0 |   0.0661282 |  0.158574 |\n| HPG          | Return On Equity |   2021 |         0 |   0.380268  |  0.158574 |\n| MSN          | Return On Equity |   2023 |         0 |   0.0489033 |  0.118251 |\n| MSN          | Return On Equity |   2022 |         0 |   0.129771  |  0.118251 |\n| MSN          | Return On Equity |   2020 |         0 |   0.055733  |  0.118251 |\n| MSN          | Return On Equity |   2021 |         0 |   0.238597  |  0.118251 |\n| VNM          | Return On Equity |   2023 |         0 |   0.257506  |  0.287349 |\n| VNM          | Return On Equity |   2021 |         0 |   0.296583  |  0.287349 |\n| VNM          | Return On Equity |   2022 |         0 |   0.26138   |  0.287349 |\n| VNM          | Return On Equity |   2020 |         0 |   0.333928  |  0.287349 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  -- Assuming company names are not required in the output, \n  -- if needed, join with company_info and select en_company_name\n  mcr.ratio_name, \n  fr.year, \n  fr.quarter, \n  fr.data AS roe_value,\n  AVG(fr.data) OVER (PARTITION BY fr.stock_code) AS avg_roe\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('VNM', 'MSN', 'HPG') \n  AND mcr.ratio_name = 'Return On Equity'\n  AND fr.year BETWEEN 2020 AND 2024\n  AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))  -- Q2 2024 condition\nLIMIT 100;  -- Add limit as per the database access note\n"
            }
        ],
        "time": 26.288711309432983,
        "evaluate": 0.5,
        "input_token": 2185,
        "output_token": 844
    },
    {
        "id": "14f189a3-a158-450b-9b00-6970b80da60a",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) among Vietcombank, Techcombank, ACB, BIDV, and VPBank for the period from 2020 to Q2 2024.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |      roe |\n|:-------------|-------:|----------:|---------:|\n| ACB          |   2022 |         0 | 0.234232 |\n| ACB          |   2023 |         0 | 0.226122 |\n| VCB          |   2022 |         0 | 0.220567 |\n| ACB          |   2020 |         0 | 0.216734 |\n| ACB          |   2021 |         0 | 0.213865 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, year, quarter, data AS roe\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'VPB')\n  AND (\n    (year = 2024 AND quarter <= 2) OR\n    (year BETWEEN 2020 AND 2023 AND quarter = 0)\n  )\nORDER BY roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name                                          |   year |   quarter |   roe_value |\n|:-------------|:---------------------------------------------------------|-------:|----------:|------------:|\n| ACB          | Asia Commercial Joint Stock Bank                         |   2022 |         0 |    0.234232 |\n| ACB          | Asia Commercial Joint Stock Bank                         |   2023 |         0 |    0.226122 |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   2022 |         0 |    0.220567 |\n| ACB          | Asia Commercial Joint Stock Bank                         |   2020 |         0 |    0.216734 |\n| ACB          | Asia Commercial Joint Stock Bank                         |   2021 |         0 |    0.213865 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code, \n  ci.en_company_name, \n  fr.year, \n  fr.quarter, \n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Return On Equity' \n  AND fr.stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'VPB')\n  AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter IN (0, 2)))\nORDER BY \n  fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "time": 28.769458532333374,
        "evaluate": 0.5,
        "input_token": 2175,
        "output_token": 552
    },
    {
        "id": "0139ac4a-8687-4aac-a031-3b29b413d83a",
        "question": "For the period 2020-Q2 2024, which 10 companies have the highest total assets,  with the condition that total assets must be greater than 100 billion VND?",
        "answer": "Table 1\n| stock_code   |   total_assets |\n|:-------------|---------------:|\n| BID          |    3.1738e+10  |\n| CTG          |    2.57372e+10 |\n| VCB          |    2.56522e+10 |\n| TCB          |    1.1165e+10  |\n| VPB          |    9.8242e+09  |\n| VIC          |    9.36372e+09 |\n| MBB          |    9.02315e+09 |\n| STB          |    8.76012e+09 |\n| SHB          |    8.57265e+09 |\n| ACB          |    7.8037e+09  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN bank_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_300'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n\n    UNION ALL\n\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN non_bank_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_270'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n\n    UNION ALL\n\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN securities_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_270'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n)\n\nSELECT\n    t.stock_code,\n    t.total_assets\nFROM\n    total_assets t\nWHERE\n    t.total_assets > 100000\nORDER BY\n    t.total_assets DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| companytype   | stock_code   | year   | totalassets   |\n|---------------|--------------|--------|---------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine financial reports for all company types, filtering for Total Assets and the specified period\nCombinedReports AS (\n  SELECT 'Bank' AS CompanyType, stock_code, year, quarter, data AS TotalAssets\n  FROM bank_financial_report\n  WHERE category_code = 'BS_300' AND year BETWEEN 2020 AND 2024 AND quarter = 2  -- Adjusted to reflect Q2 specifically\n  UNION ALL\n  SELECT 'Non-Bank' AS CompanyType, stock_code, year, quarter, data AS TotalAssets\n  FROM non_bank_financial_report\n  WHERE category_code = 'BS_270' AND year BETWEEN 2020 AND 2024 AND quarter = 2\n  UNION ALL\n  SELECT 'Securities' AS CompanyType, stock_code, year, quarter, data AS TotalAssets\n  FROM securities_financial_report\n  WHERE category_code = 'BS_270' AND year BETWEEN 2020 AND 2024 AND quarter = 2\n),\n\n-- Filter for Total Assets > 100 Billion VND and rank companies\nRankedCompanies AS (\n  SELECT CompanyType, stock_code, year, TotalAssets,\n         ROW_NUMBER() OVER (ORDER BY TotalAssets DESC) AS Rank\n  FROM CombinedReports\n  WHERE TotalAssets > 100000000000  -- 100 Billion VND\n)\n\n-- Select the top 10 companies\nSELECT CompanyType, stock_code, year, TotalAssets\nFROM RankedCompanies\nWHERE Rank <= 10\nLIMIT 10;\n"
            }
        ],
        "time": 42.7582106590271,
        "evaluate": 0,
        "input_token": 1784,
        "output_token": 794
    },
    {
        "id": "62907a1f-3544-4f00-acbc-9099a5fa6f67",
        "question": "What were the Return on Equity (ROE) and Debt-to-Equity ratios for Vietcombank and Techcombank in 2023?",
        "answer": "Table 1\n| stock_code   | ratio_code   |      data |\n|:-------------|:-------------|----------:|\n| TCB          | DTER         |  5.50936  |\n| VCB          | DTER         | 10.1483   |\n| TCB          | ROE          |  0.139608 |\n| VCB          | ROE          |  0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    ratio_code, \n    data \nFROM \n    financial_ratio \nWHERE \n    (stock_code = 'VCB' OR stock_code = 'TCB') \n    AND year = 2023 \n    AND quarter = 0 \n    AND (ratio_code = 'ROE' OR ratio_code = 'DTER');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   | industry   | ratio_name           |      data |   year |\n|:-------------|:-----------|:---------------------|----------:|-------:|\n| TCB          | Banking    | Debt To Equity Ratio |  5.50936  |   2023 |\n| VCB          | Banking    | Debt To Equity Ratio | 10.1483   |   2023 |\n| TCB          | Banking    | Return On Equity     |  0.139608 |   2023 |\n| VCB          | Banking    | Return On Equity     |  0.200315 |   2023 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    ci.stock_code,\n    ci.industry,\n    mcr.ratio_name,\n    fr.data,\n    fr.year\nFROM \n    financial_ratio fr\nINNER JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nINNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    ci.stock_code IN ('VCB', 'TCB')  -- Filter for Vietcombank and Techcombank\n    AND fr.year = 2023  -- Filter for the year 2023\n    AND fr.quarter = 0  -- Annual reports\n    AND mcr.ratio_code IN ('ROE', 'DTER')  -- Filter for ROE and Debt-to-Equity ratios\nLIMIT 100;  -- Adding a limit as per the database access note\n"
            }
        ],
        "time": 34.09050107002258,
        "evaluate": 0.5,
        "input_token": 2866,
        "output_token": 832
    },
    {
        "id": "360e3adc-d07d-4357-9c84-5526619e7f5f",
        "question": "How has the Net Profit Margin of Vinamilk, Masan Group, and other companies with significant investments in subsidiaries evolved from 2020 to Q2 2024?  Analyze this considering the profitability contributions from their subsidiaries.",
        "answer": "Table 1\n| stock_code   | en_company_name   | year   | quarter   | net_profit_margin   |\n|--------------|-------------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.en_company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS net_profit_margin\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nLEFT JOIN \n    sub_and_shareholder ss ON ci.stock_code = ss.stock_code\nWHERE \n    mccr.ratio_name = 'Net profit margin'\n    AND (ci.stock_code = 'VNM' OR ci.stock_code = 'MSN' OR ss.stock_code IS NOT NULL)\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | company_name   | year   | quarter   | netprofitmargin   |\n|--------------|----------------|--------|-----------|-------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Identify companies with significant investments in subsidiaries (assuming having more than one subsidiary is significant)\nSignificantSubsidiaryHolders AS (\n  SELECT stock_code\n  FROM sub_and_shareholder\n  GROUP BY stock_code\n  HAVING COUNT(invest_on) > 1\n),\n\n-- Combine financial ratios for Net Profit Margin for all companies, focusing on VNM, MSN, and significant subsidiary holders\nNetProfitMarginEvolution AS (\n  SELECT \n    fr.stock_code,\n    ci.company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS NetProfitMargin\n  FROM \n    financial_ratio fr\n  JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code AND mcr.ratio_name = 'Net profit margin'\n  JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\n  WHERE \n    (fr.stock_code IN ('VNM', 'MSN') OR fr.stock_code IN (SELECT stock_code FROM SignificantSubsidiaryHolders))\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))  -- Annual data or Q2 2024\n)\n\n-- Final Query to Analyze Evolution\nSELECT \n  stock_code,\n  company_name,\n  year,\n  quarter,\n  NetProfitMargin\nFROM \n  NetProfitMarginEvolution\nORDER BY \n  stock_code, year, quarter\nLIMIT 100;  -- Adding a limit as per database usage notes\n"
            }
        ],
        "time": 35.19155287742615,
        "evaluate": 0,
        "input_token": 1776,
        "output_token": 759
    },
    {
        "id": "c7ee3213-142c-4b94-ac63-6f90c9317169",
        "question": "What is the trend of Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024, considering their respective subsidiaries' financial performance?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |       roe |\n|-------:|----------:|:-------------|----------:|\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2020 |         0 | EIB          | 0.0636274 |\n|   2020 |         0 | EIB          | 0.0636274 |\n|   2020 |         0 | EIB          | 0.0636274 |\n|   2021 |         0 | EIB          | 0.0542841 |\n|   2021 |         0 | EIB          | 0.0542841 |\n|   2021 |         0 | EIB          | 0.0542841 |\n|   2022 |         0 | EIB          | 0.143836  |\n|   2022 |         0 | EIB          | 0.143836  |\n|   2022 |         0 | EIB          | 0.143836  |\n|   2023 |         0 | EIB          | 0.0964624 |\n|   2023 |         0 | EIB          | 0.0964624 |\n|   2023 |         0 | EIB          | 0.0964624 |\n|   2024 |         1 | EIB          | 0.0229559 |\n|   2024 |         1 | EIB          | 0.0229559 |\n|   2024 |         1 | EIB          | 0.0229559 |\n|   2020 |         0 | MBB          | 0.171779  |\n|   2020 |         0 | MBB          | 0.171779  |\n|   2021 |         0 | MBB          | 0.21159   |\n|   2021 |         0 | MBB          | 0.21159   |\n|   2022 |         0 | MBB          | 0.228042  |\n|   2022 |         0 | MBB          | 0.228042  |\n|   2023 |         0 | MBB          | 0.217698  |\n|   2023 |         0 | MBB          | 0.217698  |\n|   2020 |         0 | MSN          | 0.055733  |\n|   2021 |         0 | MSN          | 0.238597  |\n|   2022 |         0 | MSN          | 0.129771  |\n|   2023 |         0 | MSN          | 0.0489033 |\n|   2024 |         1 | MSN          | 0.0123309 |\n|   2020 |         0 | OCB          | 0.202736  |\n|   2020 |         0 | OCB          | 0.202736  |\n|   2021 |         0 | OCB          | 0.202016  |\n|   2021 |         0 | OCB          | 0.202016  |\n|   2022 |         0 | OCB          | 0.138876  |\n|   2022 |         0 | OCB          | 0.138876  |\n|   2023 |         0 | OCB          | 0.11576   |\n|   2023 |         0 | OCB          | 0.11576   |\n|   2024 |         1 | OCB          | 0.03233   |\n|   2024 |         1 | OCB          | 0.03233   |\n|   2020 |         0 | PVT          | 0.132256  |\n|   2021 |         0 | PVT          | 0.119846  |\n|   2022 |         0 | PVT          | 0.144227  |\n|   2023 |         0 | PVT          | 0.135265  |\n|   2024 |         1 | PVT          | 0.0327416 |\n|   2024 |         2 | PVT          | 0.0394265 |\n|   2020 |         0 | TCB          | 0.168632  |\n|   2020 |         0 | TCB          | 0.168632  |\n|   2020 |         0 | TCB          | 0.168632  |\n|   2021 |         0 | TCB          | 0.197927  |\n|   2021 |         0 | TCB          | 0.197927  |\n|   2021 |         0 | TCB          | 0.197927  |\n|   2022 |         0 | TCB          | 0.180176  |\n|   2022 |         0 | TCB          | 0.180176  |\n|   2022 |         0 | TCB          | 0.180176  |\n|   2023 |         0 | TCB          | 0.139608  |\n|   2023 |         0 | TCB          | 0.139608  |\n|   2023 |         0 | TCB          | 0.139608  |\n|   2024 |         1 | TCB          | 0.0459854 |\n|   2024 |         1 | TCB          | 0.0459854 |\n|   2024 |         1 | TCB          | 0.0459854 |\n|   2024 |         2 | TCB          | 0.0457096 |\n|   2024 |         2 | TCB          | 0.0457096 |\n|   2024 |         2 | TCB          | 0.0457096 |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    fr.stock_code, \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    sub_and_shareholder ssh ON fr.stock_code = ssh.stock_code OR fr.stock_code = ssh.invest_on\nWHERE \n    mccr.ratio_name = 'Return On Equity'\n    AND (ssh.stock_code IN ('VCB', 'TCB', 'ACB') OR ssh.invest_on IN ('VCB', 'TCB', 'ACB'))\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY \n    fr.stock_code, \n    fr.year, \n    fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |   year |   quarter |   roe_value |\n|:-------------|-------:|----------:|------------:|\n| ACB          |   2020 |         0 |   0.216734  |\n| ACB          |   2021 |         0 |   0.213865  |\n| ACB          |   2022 |         0 |   0.234232  |\n| ACB          |   2023 |         0 |   0.226122  |\n| EIB          |   2020 |         0 |   0.0636274 |\n| EIB          |   2021 |         0 |   0.0542841 |\n| EIB          |   2022 |         0 |   0.143836  |\n| EIB          |   2023 |         0 |   0.0964624 |\n| MBB          |   2020 |         0 |   0.171779  |\n| MBB          |   2021 |         0 |   0.21159   |\n| MBB          |   2022 |         0 |   0.228042  |\n| MBB          |   2023 |         0 |   0.217698  |\n| OCB          |   2020 |         0 |   0.202736  |\n| OCB          |   2021 |         0 |   0.202016  |\n| OCB          |   2022 |         0 |   0.138876  |\n| OCB          |   2023 |         0 |   0.11576   |\n| PVT          |   2020 |         0 |   0.132256  |\n| PVT          |   2021 |         0 |   0.119846  |\n| PVT          |   2022 |         0 |   0.144227  |\n| PVT          |   2023 |         0 |   0.135265  |\n| PVT          |   2024 |         2 |   0.0394265 |\n| TCB          |   2020 |         0 |   0.168632  |\n| TCB          |   2021 |         0 |   0.197927  |\n| TCB          |   2022 |         0 |   0.180176  |\n| TCB          |   2023 |         0 |   0.139608  |\n| TCB          |   2024 |         2 |   0.0457096 |\n| VCB          |   2020 |         0 |   0.196318  |\n| VCB          |   2021 |         0 |   0.201059  |\n| VCB          |   2022 |         0 |   0.220567  |\n| VCB          |   2023 |         0 |   0.200315  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Identify the stock codes of interest and their subsidiaries\nCompaniesOfInterest AS (\n  SELECT stock_code FROM company_info WHERE stock_code IN ('VCB', 'TCB', 'ACB')\n  UNION \n  SELECT invest_on FROM sub_and_shareholder WHERE stock_code IN ('VCB', 'TCB', 'ACB')\n),\n\n-- Filter ROE data for the companies of interest from 2020 to Q2 2024\nROETrend AS (\n  SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS ROE_Value\n  FROM \n    financial_ratio fr\n  INNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  INNER JOIN \n    CompaniesOfInterest coi ON fr.stock_code = coi.stock_code\n  WHERE \n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\n)\n\n-- Present the ROE trend\nSELECT \n  stock_code,\n  year,\n  quarter,\n  ROE_Value\nFROM \n  ROETrend\nORDER BY \n  stock_code, year, quarter\nLIMIT 100;  -- To adhere to the instruction of adding a LIMIT\n"
            }
        ],
        "time": 39.9250431060791,
        "evaluate": 0,
        "input_token": 2256,
        "output_token": 826
    },
    {
        "id": "e2b68420-a9fe-4c34-b33a-0b2f2f44c423",
        "question": "Compare the operating cash flow and capital expenditures of Vinamilk and Masan Group for the period from 2020 to Q2 2024.  Calculate the free cash flow for each company during this period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |   free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|-----------------:|\n| MSN          |   2020 |         0 |           1.3513e+06  |           -3.67816e+06 |      5.02946e+06 |\n| MSN          |   2021 |         0 |           1.14391e+06 |           -2.80543e+06 |      3.94934e+06 |\n| MSN          |   2022 |         0 |          -3.78885e+06 |           -4.16532e+06 | 376469           |\n| MSN          |   2023 |         0 |      500461           |           -2.2288e+06  |      2.72926e+06 |\n| MSN          |   2024 |         1 |      -35373           |      -396763           | 361390           |\n| VNM          |   2020 |         0 |           1.01802e+07 |           -1.26482e+06 |      1.1445e+07  |\n| VNM          |   2021 |         0 |           9.43197e+06 |           -1.53102e+06 |      1.0963e+07  |\n| VNM          |   2022 |         0 |           8.82727e+06 |           -1.45691e+06 |      1.02842e+07 |\n| VNM          |   2023 |         0 |           7.88742e+06 |           -1.57964e+06 |      9.46706e+06 |\n| VNM          |   2024 |         1 |      907549           |      -378452           |      1.286e+06   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nbfr.stock_code,\n    nbfr.year,\n    nbfr.quarter,\n    SUM(CASE WHEN nbfr.category_code = 'CF_020' THEN nbfr.data ELSE 0 END) AS operating_cash_flow,\n    SUM(CASE WHEN nbfr.category_code = 'CF_021' THEN nbfr.data ELSE 0 END) AS capital_expenditures,\n    SUM(CASE WHEN nbfr.category_code = 'CF_020' THEN nbfr.data ELSE 0 END) - \n    SUM(CASE WHEN nbfr.category_code = 'CF_021' THEN nbfr.data ELSE 0 END) AS free_cash_flow\nFROM \n    non_bank_financial_report nbfr\nWHERE \n    nbfr.stock_code IN ('VNM', 'MSN') AND\n    ((nbfr.year = 2020 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2021 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2022 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2023 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2024 AND nbfr.quarter <= 2))\n    AND nbfr.category_code IN ('CF_020', 'CF_021')\nGROUP BY \n    nbfr.stock_code, nbfr.year, nbfr.quarter\nORDER BY \n    nbfr.stock_code, nbfr.year, nbfr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | company_name                   |   year |   quarter |   freecashflow |\n|:-------------|:-------------------------------|-------:|----------:|---------------:|\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam   |   2020 |         0 |    2.4254e+07  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam   |   2023 |         0 |    2.0475e+07  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam   |   2021 |         0 |    2.20982e+07 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam   |   2022 |         0 |    2.19656e+07 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan |   2022 |         0 |    1.2966e+07  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan |   2020 |         0 |    1.98463e+07 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan |   2021 |         0 |    1.66562e+07 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan |   2023 |         0 |    3.16468e+07 |\n\nTable 2\n| stock_code   | company_name   | year   | quarter   | operatingcashflow   | capitalexpenditures   |\n|--------------|----------------|--------|-----------|---------------------|-----------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.company_name, -- Assuming 'company_name' exists in 'company_info' for simplicity\n  fr.year,\n  fr.quarter,\n  fr.data AS FreeCashFlow\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n  fr.ratio_code = 'FCF'\n  AND fr.stock_code IN ('VNM', 'MSN')\n  AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) \n       OR (fr.year = 2024 AND fr.quarter = 2))\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.company_name,\n  fr.year,\n  fr.quarter,\n  -- Assuming separate queries for each due to different category codes\n  CASE \n    WHEN fr.category_code = 'CF_[Operating Cash Flow Code]' THEN fr.data\n  END AS OperatingCashFlow,\n  CASE \n    WHEN fr.category_code = 'CF_[Capital Expenditures Code]' THEN fr.data\n  END AS CapitalExpenditures\nFROM \n  non_bank_financial_report fr -- Since both are non-bank corporations\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n  fr.stock_code IN ('VNM', 'MSN')\n  AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) \n       OR (fr.year = 2024 AND fr.quarter = 2))\n  AND fr.category_code IN ('CF_[Operating Cash Flow Code]', 'CF_[Capital Expenditures Code]')\nLIMIT 100;\n"
            }
        ],
        "time": 42.37049865722656,
        "evaluate": 0,
        "input_token": 1783,
        "output_token": 841
    },
    {
        "id": "0759f255-d239-4e78-be61-78f7c00f8b42",
        "question": "What is the total amount of  property, plant, and equipment (PP&E) for Vinamilk, Masan Group, and Hoa Phat Group at the end of 2023?",
        "answer": "Table 1\n| stock_code   |   total_ppe |\n|:-------------|------------:|\n| HPG          | 7.19984e+07 |\n| MSN          | 4.28858e+07 |\n| VNM          | 1.26897e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    SUM(data) AS total_ppe\nFROM \n    non_bank_financial_report\nWHERE \n    year = 2023 \n    AND quarter = 0 \n    AND stock_code IN ('VNM', 'MSN', 'HPG')\n    AND category_code IN ('BS_221', 'BS_224', 'BS_227')\nGROUP BY \n    stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry   | total_pp_e   |\n|--------------|------------|--------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    CI.stock_code,\n    CI.industry,\n    NFR.data AS Total_PP_E\nFROM \n    company_info CI\nINNER JOIN \n    non_bank_financial_report NFR ON CI.stock_code = NFR.stock_code\nINNER JOIN \n    map_category_code_non_bank MCCNB ON NFR.category_code = MCCNB.category_code\nWHERE \n    CI.stock_code IN ('VNM', 'MSN', 'HPG') \n    AND NFR.year = 2023 \n    AND NFR.quarter = 0  -- For annual reports\n    AND MCCNB.en_caption = 'Property, Plant and Equipment'  -- Assuming this matches the caption for PP&E\n    -- If you know the exact category_code, you can directly use:\n    -- AND NFR.category_code = 'BS_200'  -- Replace 'BS_200' with the actual code if different\nLIMIT 100;  -- Always add a limit as per the instructions\n"
            }
        ],
        "time": 36.029712200164795,
        "evaluate": 0,
        "input_token": 2315,
        "output_token": 1012
    },
    {
        "id": "b7305bbf-5414-4848-8c0d-223f54960820",
        "question": "Rank the top 5 companies with total assets greater than 100,000 billion VND as of December 31, 2023, based on their Return on Equity (ROE).",
        "answer": "Table 1\n| stock_code   | industry   |      roe |\n|:-------------|:-----------|---------:|\n| HDB          | Banking    | 0.232433 |\n| ACB          | Banking    | 0.226122 |\n| VIB          | Banking    | 0.225702 |\n| MBB          | Banking    | 0.217698 |\n| VCB          | Banking    | 0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT stock_code, data AS total_assets\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM securities_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n),\nfiltered_companies AS (\n    SELECT stock_code\n    FROM total_assets\n    WHERE total_assets > 100000000\n),\nroe_data AS (\n    SELECT stock_code, data AS roe\n    FROM financial_ratio\n    WHERE ratio_code = 'ROE' AND year = 2023 AND quarter = 0\n)\nSELECT ci.stock_code, ci.industry, roe_data.roe\nFROM filtered_companies fc\nJOIN roe_data ON fc.stock_code = roe_data.stock_code\nJOIN company_info ci ON fc.stock_code = ci.stock_code\nORDER BY roe_data.roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine all financial reports for total assets, filtering by date and value\nTotalAssets AS (\n  SELECT stock_code, data AS total_assets\n  FROM (\n    SELECT stock_code, year, quarter, category_code, data\n    FROM bank_financial_report\n    WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_300'\n    UNION ALL\n    SELECT stock_code, year, quarter, category_code, data\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_270'\n    UNION ALL\n    SELECT stock_code, year, quarter, category_code, data\n    FROM securities_financial_report\n    WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_270'\n  ) AS CombinedReports\n  WHERE data > 100,000,000  -- Adjusted for Million VND assumption\n),\n\n-- Retrieve ROE for the filtered companies\nCompanyROE AS (\n  SELECT fr.stock_code, fr.data AS roe\n  FROM financial_ratio fr\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE mcr.ratio_name = 'Return On Equity' AND fr.year = 2023 AND fr.quarter = 0\n  AND fr.stock_code IN (SELECT stock_code FROM TotalAssets)\n)\n\n-- Rank companies by ROE and limit to top 5\nSELECT stock_code, roe\nFROM CompanyROE\nORDER BY roe DESC\nLIMIT 5;\n"
            }
        ],
        "time": 36.73663687705994,
        "evaluate": 0,
        "input_token": 1841,
        "output_token": 784
    },
    {
        "id": "2021f2a2-50f4-49c3-8242-38373e361aa0",
        "question": "What is the trend of total assets and total liabilities for Vietcombank, Techcombank, and VPBank from 2020 to Q2 2024, broken down by the assets and liabilities of their subsidiaries and other investments?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | category          |   bank_data |   subsidiary_data |\n|:-------------|-------:|----------:|:------------------|------------:|------------------:|\n| TCB          |   2020 |         0 | Total assets      | 4.39603e+08 |                 0 |\n| TCB          |   2020 |         0 | Total liabilities | 3.64988e+08 |                 0 |\n| TCB          |   2021 |         0 | Total assets      | 5.68729e+08 |                 0 |\n| TCB          |   2021 |         0 | Total liabilities | 4.75687e+08 |                 0 |\n| TCB          |   2022 |         0 | Total assets      | 6.99033e+08 |                 0 |\n| TCB          |   2022 |         0 | Total liabilities | 5.85608e+08 |                 0 |\n| TCB          |   2023 |         0 | Total assets      | 8.49482e+08 |                 0 |\n| TCB          |   2023 |         0 | Total liabilities | 7.17866e+08 |                 0 |\n| TCB          |   2024 |         2 | Total assets      | 9.08307e+08 |                 0 |\n| TCB          |   2024 |         2 | Total liabilities | 7.69755e+08 |                 0 |\n| VCB          |   2020 |         0 | Total assets      | 1.32623e+09 |                 0 |\n| VCB          |   2020 |         0 | Total liabilities | 1.23214e+09 |                 0 |\n| VCB          |   2021 |         0 | Total assets      | 1.41467e+09 |                 0 |\n| VCB          |   2021 |         0 | Total liabilities | 1.30556e+09 |                 0 |\n| VCB          |   2022 |         0 | Total assets      | 1.81382e+09 |                 0 |\n| VCB          |   2022 |         0 | Total liabilities | 1.67817e+09 |                 0 |\n| VCB          |   2023 |         0 | Total assets      | 1.83961e+09 |                 0 |\n| VCB          |   2023 |         0 | Total liabilities | 1.6746e+09  |                 0 |\n| VPB          |   2020 |         0 | Total assets      | 4.19027e+08 |                 0 |\n| VPB          |   2020 |         0 | Total liabilities | 3.66233e+08 |                 0 |\n| VPB          |   2021 |         0 | Total assets      | 5.47409e+08 |                 0 |\n| VPB          |   2021 |         0 | Total liabilities | 4.61131e+08 |                 0 |\n| VPB          |   2022 |         0 | Total assets      | 6.31013e+08 |                 0 |\n| VPB          |   2022 |         0 | Total liabilities | 5.27511e+08 |                 0 |\n| VPB          |   2023 |         0 | Total assets      | 8.17567e+08 |                 0 |\n| VPB          |   2023 |         0 | Total liabilities | 6.77771e+08 |                 0 |\n| VPB          |   2024 |         2 | Total assets      | 8.64392e+08 |                 0 |\n| VPB          |   2024 |         2 | Total liabilities | 7.26325e+08 |                 0 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_assets_liabilities AS (\n    SELECT\n        stock_code,\n        year,\n        quarter,\n        category_code,\n        data\n    FROM\n        bank_financial_report\n    WHERE\n        stock_code IN ('VCB', 'TCB', 'VPB')\n        AND category_code IN ('BS_300', 'BS_400') -- Total assets and total liabilities\n        AND ((year BETWEEN 2020 AND 2024) AND (quarter = 0 OR (year = 2024 AND quarter = 2)))\n),\nsubsidiary_investments AS (\n    SELECT\n        ss.stock_code,\n        ss.invest_on,\n        bf.year,\n        bf.quarter,\n        bf.category_code,\n        bf.data\n    FROM\n        sub_and_shareholder ss\n    JOIN\n        bank_financial_report bf ON ss.invest_on = bf.stock_code\n    WHERE\n        ss.stock_code IN ('VCB', 'TCB', 'VPB')\n        AND bf.category_code IN ('BS_211', 'BS_213', 'BS_214') -- Investments in subsidiaries and other entities\n        AND ((bf.year BETWEEN 2020 AND 2024) AND (bf.quarter = 0 OR (bf.year = 2024 AND bf.quarter = 2)))\n)\nSELECT\n    ba.stock_code,\n    ba.year,\n    ba.quarter,\n    mc.en_caption AS category,\n    ba.data AS bank_data,\n    COALESCE(SUM(si.data), 0) AS subsidiary_data\nFROM\n    bank_assets_liabilities ba\nJOIN\n    map_category_code_bank mc ON ba.category_code = mc.category_code\nLEFT JOIN\n    subsidiary_investments si ON ba.stock_code = si.stock_code AND ba.year = si.year AND ba.quarter = si.quarter AND ba.category_code = si.category_code\nGROUP BY\n    ba.stock_code, ba.year, ba.quarter, mc.en_caption, ba.data\nORDER BY\n    ba.stock_code, ba.year, ba.quarter, mc.en_caption;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| metric            | stock_code   |   year |   quarter | en_caption        |        data |\n|:------------------|:-------------|-------:|----------:|:------------------|------------:|\n| Total Assets      | VCB          |   2020 |         0 | Total assets      | 1.32623e+09 |\n| Total Assets      | VCB          |   2021 |         0 | Total assets      | 1.41467e+09 |\n| Total Assets      | VCB          |   2022 |         0 | Total assets      | 1.81382e+09 |\n| Total Assets      | VCB          |   2023 |         0 | Total assets      | 1.83961e+09 |\n| Total Assets      | VPB          |   2020 |         0 | Total assets      | 4.19027e+08 |\n| Total Assets      | VPB          |   2021 |         0 | Total assets      | 5.47409e+08 |\n| Total Assets      | VPB          |   2022 |         0 | Total assets      | 6.31013e+08 |\n| Total Assets      | VPB          |   2023 |         0 | Total assets      | 8.17567e+08 |\n| Total Assets      | TCB          |   2020 |         0 | Total assets      | 4.39603e+08 |\n| Total Assets      | TCB          |   2021 |         0 | Total assets      | 5.68729e+08 |\n| Total Assets      | TCB          |   2022 |         0 | Total assets      | 6.99033e+08 |\n| Total Assets      | VPB          |   2024 |         2 | Total assets      | 8.64392e+08 |\n| Total Assets      | TCB          |   2024 |         2 | Total assets      | 9.08307e+08 |\n| Total Assets      | TCB          |   2023 |         0 | Total assets      | 8.49482e+08 |\n| Total Liabilities | VCB          |   2020 |         0 | Total liabilities | 1.23214e+09 |\n| Total Liabilities | VCB          |   2021 |         0 | Total liabilities | 1.30556e+09 |\n| Total Liabilities | VCB          |   2022 |         0 | Total liabilities | 1.67817e+09 |\n| Total Liabilities | VCB          |   2023 |         0 | Total liabilities | 1.6746e+09  |\n| Total Liabilities | VPB          |   2020 |         0 | Total liabilities | 3.66233e+08 |\n| Total Liabilities | VPB          |   2021 |         0 | Total liabilities | 4.61131e+08 |\n| Total Liabilities | VPB          |   2022 |         0 | Total liabilities | 5.27511e+08 |\n| Total Liabilities | VPB          |   2023 |         0 | Total liabilities | 6.77771e+08 |\n| Total Liabilities | TCB          |   2020 |         0 | Total liabilities | 3.64988e+08 |\n| Total Liabilities | TCB          |   2021 |         0 | Total liabilities | 4.75687e+08 |\n| Total Liabilities | TCB          |   2022 |         0 | Total liabilities | 5.85608e+08 |\n| Total Liabilities | VPB          |   2024 |         2 | Total liabilities | 7.26325e+08 |\n| Total Liabilities | TCB          |   2024 |         2 | Total liabilities | 7.69755e+08 |\n| Total Liabilities | TCB          |   2023 |         0 | Total liabilities | 7.17866e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Subquery to identify the stock codes of interest and their subsidiaries/investments\ncompanies_of_interest AS (\n  SELECT 'VCB' AS stock_code UNION\n  SELECT 'TCB' UNION\n  SELECT 'VPB' UNION\n  -- Adding subsidiaries/investments (assuming we know them, otherwise, we'd query sub_and_shareholder)\n  SELECT 'Subsidiary/Investment of VCB' UNION\n  SELECT 'Subsidiary/Investment of TCB' UNION\n  SELECT 'Subsidiary/Investment of VPB'\n),\n\n-- Subquery for Total Assets\ntotal_assets AS (\n  SELECT \n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    mccb.en_caption,\n    bfr.data\n  FROM \n    bank_financial_report bfr\n  JOIN \n    map_category_code_bank mccb ON bfr.category_code = mccb.category_code\n  WHERE \n    bfr.stock_code IN (SELECT stock_code FROM companies_of_interest)\n    AND bfr.category_code = 'BS_300'  -- Total Assets\n    AND bfr.year BETWEEN 2020 AND 2024\n    AND (bfr.quarter = 0 OR (bfr.year = 2024 AND bfr.quarter = 2))\n),\n\n-- Subquery for Total Liabilities\ntotal_liabilities AS (\n  SELECT \n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    mccb.en_caption,\n    bfr.data\n  FROM \n    bank_financial_report bfr\n  JOIN \n    map_category_code_bank mccb ON bfr.category_code = mccb.category_code\n  WHERE \n    bfr.stock_code IN (SELECT stock_code FROM companies_of_interest)\n    AND bfr.category_code = 'BS_400'  -- Total Liabilities\n    AND bfr.year BETWEEN 2020 AND 2024\n    AND (bfr.quarter = 0 OR (bfr.year = 2024 AND bfr.quarter = 2))\n)\n\n-- Main Query to combine results\nSELECT \n  'Total Assets' AS Metric,\n  ta.stock_code,\n  ta.year,\n  ta.quarter,\n  ta.en_caption,\n  ta.data\nFROM \n  total_assets ta\n\nUNION ALL\n\nSELECT \n  'Total Liabilities' AS Metric,\n  tl.stock_code,\n  tl.year,\n  tl.quarter,\n  tl.en_caption,\n  tl.data\nFROM \n  total_liabilities tl\n\n-- Limiting the results (adjust as necessary)\nLIMIT 100;\n"
            }
        ],
        "time": 47.48883318901062,
        "evaluate": 1,
        "input_token": 4448,
        "output_token": 2282
    },
    {
        "id": "15ce94fa-2646-4432-b91e-8ef1497dda44",
        "question": "For the period 2020-Q2 2024, provide the year-over-year change in the return on equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group,  separately showing the impact of their subsidiaries and investments on their overall ROE.",
        "answer": "Table 1\n| main_company   |   year |   quarter |   main_company_roe | subsidiary_code   |   subsidiary_roe |\n|:---------------|-------:|----------:|-------------------:|:------------------|-----------------:|\n| HPG            |   2020 |         2 |         0.0524064  |                   |      nan         |\n| HPG            |   2020 |         3 |         0.0688363  |                   |      nan         |\n| HPG            |   2020 |         4 |         0.0787021  |                   |      nan         |\n| HPG            |   2021 |         0 |         0.380268   |                   |      nan         |\n| HPG            |   2021 |         1 |         0.10579    |                   |      nan         |\n| HPG            |   2021 |         2 |         0.131719   |                   |      nan         |\n| HPG            |   2021 |         3 |         0.122748   |                   |      nan         |\n| HPG            |   2021 |         4 |         0.0817293  |                   |      nan         |\n| HPG            |   2022 |         0 |         0.0878594  |                   |      nan         |\n| HPG            |   2022 |         1 |         0.0829275  |                   |      nan         |\n| HPG            |   2022 |         2 |         0.0402598  |                   |      nan         |\n| HPG            |   2022 |         3 |        -0.0182075  |                   |      nan         |\n| HPG            |   2022 |         4 |        -0.020796   |                   |      nan         |\n| HPG            |   2023 |         0 |         0.0661282  |                   |      nan         |\n| HPG            |   2023 |         1 |         0.00397384 |                   |      nan         |\n| HPG            |   2023 |         2 |         0.0147948  |                   |      nan         |\n| HPG            |   2023 |         3 |         0.0200306  |                   |      nan         |\n| HPG            |   2023 |         4 |         0.0288708  |                   |      nan         |\n| HPG            |   2024 |         1 |         0.027164   |                   |      nan         |\n| HPG            |   2024 |         2 |         0.0305454  |                   |      nan         |\n| MSN            |   2020 |         2 |         0.00174282 | TCB               |        0.0428449 |\n| MSN            |   2020 |         3 |         0.0340108  | TCB               |        0.0450409 |\n| MSN            |   2020 |         4 |         0.0233474  | TCB               |        0.0537099 |\n| MSN            |   2021 |         0 |         0.238597   | TCB               |        0.197927  |\n| MSN            |   2021 |         1 |         0.0134906  | TCB               |        0.0565945 |\n| MSN            |   2021 |         2 |         0.0335106  | TCB               |        0.0572896 |\n| MSN            |   2021 |         3 |         0.0490112  | TCB               |        0.0501452 |\n| MSN            |   2021 |         4 |         0.168149   | TCB               |        0.0503334 |\n| MSN            |   2022 |         0 |         0.129771   | TCB               |        0.180176  |\n| MSN            |   2022 |         1 |         0.0515801  | TCB               |        0.0569507 |\n| MSN            |   2022 |         2 |         0.0313142  | TCB               |        0.0562806 |\n| MSN            |   2022 |         3 |         0.0236221  | TCB               |        0.0488406 |\n| MSN            |   2022 |         4 |         0.021933   | TCB               |        0.031493  |\n| MSN            |   2023 |         0 |         0.0489033  | TCB               |        0.139608  |\n| MSN            |   2023 |         1 |         0.0118431  | TCB               |        0.0384612 |\n| MSN            |   2023 |         2 |         0.0114376  | TCB               |        0.0367734 |\n| MSN            |   2023 |         3 |         0.0127258  | TCB               |        0.0367239 |\n| MSN            |   2023 |         4 |         0.013515   | TCB               |        0.0381519 |\n| MSN            |   2024 |         1 |         0.0123309  | TCB               |        0.0459854 |\n| VNM            |   2020 |         2 |         0.095333   |                   |      nan         |\n| VNM            |   2020 |         3 |         0.0990225  |                   |      nan         |\n| VNM            |   2020 |         4 |         0.0664599  |                   |      nan         |\n| VNM            |   2021 |         0 |         0.296583   |                   |      nan         |\n| VNM            |   2021 |         1 |         0.0764615  |                   |      nan         |\n| VNM            |   2021 |         2 |         0.0832651  |                   |      nan         |\n| VNM            |   2021 |         3 |         0.0874017  |                   |      nan         |\n| VNM            |   2021 |         4 |         0.0617182  |                   |      nan         |\n| VNM            |   2022 |         0 |         0.26138    |                   |      nan         |\n| VNM            |   2022 |         1 |         0.06528    |                   |      nan         |\n| VNM            |   2022 |         2 |         0.057095   |                   |      nan         |\n| VNM            |   2022 |         3 |         0.0686339  |                   |      nan         |\n| VNM            |   2022 |         4 |         0.0569567  |                   |      nan         |\n| VNM            |   2023 |         0 |         0.257506   |                   |      nan         |\n| VNM            |   2023 |         1 |         0.0552366  |                   |      nan         |\n| VNM            |   2023 |         2 |         0.112804   |                   |      nan         |\n| VNM            |   2023 |         3 |         0.0745011  |                   |      nan         |\n| VNM            |   2023 |         4 |         0.0671136  |                   |      nan         |\n| VNM            |   2024 |         1 |         0.0615314  |                   |      nan         |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH main_company_roe AS (\n    SELECT \n        fr.stock_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS roe\n    FROM \n        financial_ratio fr\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Return On Equity'\n        AND fr.stock_code IN ('VNM', 'MSN', 'HPG')\n        AND ((fr.year = 2020 AND fr.quarter >= 2) OR (fr.year > 2020 AND fr.year < 2024) OR (fr.year = 2024 AND fr.quarter <= 2))\n),\nsubsidiary_roe AS (\n    SELECT \n        s.stock_code,\n        s.invest_on AS subsidiary_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS roe\n    FROM \n        sub_and_shareholder s\n    JOIN \n        financial_ratio fr ON s.invest_on = fr.stock_code\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Return On Equity'\n        AND s.stock_code IN ('VNM', 'MSN', 'HPG')\n        AND ((fr.year = 2020 AND fr.quarter >= 2) OR (fr.year > 2020 AND fr.year < 2024) OR (fr.year = 2024 AND fr.quarter <= 2))\n)\nSELECT \n    mc.stock_code AS main_company,\n    mc.year,\n    mc.quarter,\n    mc.roe AS main_company_roe,\n    sr.subsidiary_code,\n    sr.roe AS subsidiary_roe\nFROM \n    main_company_roe mc\nLEFT JOIN \n    subsidiary_roe sr ON mc.stock_code = sr.stock_code AND mc.year = sr.year AND mc.quarter = sr.quarter\nORDER BY \n    mc.stock_code, mc.year, mc.quarter, sr.subsidiary_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| type       | company   |   year |   roe_data |   yoy_change |\n|:-----------|:----------|-------:|-----------:|-------------:|\n| Parent     | HPG       |   2021 |  0.380268  |   0.152199   |\n| Parent     | HPG       |   2022 |  0.0878594 |  -0.292408   |\n| Parent     | HPG       |   2023 |  0.0661282 |  -0.0217312  |\n| Parent     | MSN       |   2021 |  0.238597  |   0.182864   |\n| Parent     | MSN       |   2022 |  0.129771  |  -0.108826   |\n| Parent     | MSN       |   2023 |  0.0489033 |  -0.0808676  |\n| Parent     | VNM       |   2021 |  0.296583  |  -0.0373455  |\n| Parent     | VNM       |   2022 |  0.26138   |  -0.0352032  |\n| Parent     | VNM       |   2023 |  0.257506  |  -0.00387337 |\n| Subsidiary | MSN       |   2021 |  0.197927  |   0.0292942  |\n| Subsidiary | MSN       |   2022 |  0.180176  |  -0.0177509  |\n| Subsidiary | MSN       |   2023 |  0.139608  |  -0.0405673  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Subquery to identify ROE for parent companies\nParent_ROE AS (\n  SELECT \n    stock_code, \n    year, \n    data AS ROE_Data\n  FROM \n    financial_ratio\n  WHERE \n    ratio_code = 'ROE' \n    AND quarter = 0  -- Annual reports\n    AND year BETWEEN 2020 AND 2024\n    AND stock_code IN ('VNM', 'MSN', 'HPG')  -- Focus on specified companies\n),\n\n-- Subquery to identify subsidiaries/investments' ROE\nSubsidiary_ROE AS (\n  SELECT \n    s.stock_code AS Parent, \n    s.invest_on AS Subsidiary, \n    fr.year, \n    fr.data AS Subsidiary_ROE_Data\n  FROM \n    sub_and_shareholder s\n  JOIN \n    financial_ratio fr ON s.invest_on = fr.stock_code\n  WHERE \n    fr.ratio_code = 'ROE' \n    AND fr.quarter = 0\n    AND fr.year BETWEEN 2020 AND 2024\n    AND s.stock_code IN ('VNM', 'MSN', 'HPG')\n),\n\n-- Calculate YoY change for parent companies\nParent_YoY AS (\n  SELECT \n    stock_code, \n    year, \n    ROE_Data, \n    (ROE_Data - LAG(ROE_Data) OVER(PARTITION BY stock_code ORDER BY year)) AS YoY_Change\n  FROM \n    Parent_ROE\n),\n\n-- Calculate YoY change for subsidiaries/investments (if any)\nSubsidiary_YoY AS (\n  SELECT \n    Parent, \n    Subsidiary, \n    year, \n    Subsidiary_ROE_Data, \n    (Subsidiary_ROE_Data - LAG(Subsidiary_ROE_Data) OVER(PARTITION BY Parent, Subsidiary ORDER BY year)) AS Subsidiary_YoY_Change\n  FROM \n    Subsidiary_ROE\n)\n\n-- Combine results for a comprehensive view\nSELECT \n  'Parent' AS Type, \n  stock_code AS Company, \n  year, \n  ROE_Data, \n  YoY_Change\nFROM \n  Parent_YoY\nWHERE \n  YoY_Change IS NOT NULL  -- Exclude the first year without YoY change\nUNION ALL\nSELECT \n  'Subsidiary' AS Type, \n  Parent AS Company, \n  year, \n  Subsidiary_ROE_Data, \n  Subsidiary_YoY_Change\nFROM \n  Subsidiary_YoY\nWHERE \n  Subsidiary_YoY_Change IS NOT NULL  -- Exclude the first year without YoY change\nLIMIT 100;  -- To adhere to the 'must add limit' instruction\n"
            }
        ],
        "time": 45.98950266838074,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "2bd167d2-27c8-45cc-bf1a-c5bf42eb5ec9",
        "question": "What is the Return on Equity (ROE) for Vinamilk and Masan Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   | industry           | ratio_name       |   year |   quarter |   roe_value |\n|:-------------|:-------------------|:-----------------|-------:|----------:|------------:|\n| VNM          | Food and Beverages | Return On Equity |   2023 |         0 |   0.257506  |\n| MSN          | Food and Beverages | Return On Equity |   2023 |         0 |   0.0489033 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code, \n  ci.industry, \n  mcr.ratio_name, \n  fr.year, \n  fr.quarter, \n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('VNM', 'MSN')  -- Vinamilk and Masan Group\n  AND fr.year = 2023  -- Fiscal Year\n  AND fr.quarter = 0  -- Annual Report (as per the default condition if not specified)\n  AND mcr.ratio_name = 'Return On Equity'  -- To ensure we're getting ROE\nLIMIT 100;  -- Adding a limit as per the database access note\n"
            }
        ],
        "time": 31.62030339241028,
        "evaluate": 0.5,
        "input_token": 2134,
        "output_token": 674
    },
    {
        "id": "0a7260e6-0f4a-4061-bd8f-11bea613819f",
        "question": "What was the Return on Equity (ROE) for Vietcombank, Techcombank, and VPBank in Q2 2024, and how does this compare to their respective ROE in Q2 2020, considering their investments in subsidiaries?",
        "answer": "Table 1\n| stock_code   | company_name                                       |   year |   quarter |       roe |\n|:-------------|:---------------------------------------------------|-------:|----------:|----------:|\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2020 |         2 | 0.0428449 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2020 |         2 | 0.0428449 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2024 |         2 | 0.0457096 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2024 |         2 | 0.0457096 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2020 |         2 | 0.0621598 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2020 |         2 | 0.0621598 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2024 |         2 | 0.026311  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2024 |         2 | 0.026311  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    ci.company_name, \n    fr.year, \n    fr.quarter, \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nLEFT JOIN \n    sub_and_shareholder ss ON fr.stock_code = ss.stock_code\nWHERE \n    mccr.ratio_name = 'Return On Equity'\n    AND fr.quarter = 2\n    AND fr.year IN (2020, 2024)\n    AND fr.stock_code IN ('VCB', 'TCB', 'VPB')\nORDER BY \n    fr.stock_code, fr.year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   roe_q2_2024 |   roe_q2_2020 |   roe_difference |\n|:-------------|--------------:|--------------:|-----------------:|\n| VPB          |     0.026311  |     0.0621598 |       -0.0358488 |\n| TCB          |     0.0457096 |     0.0428449 |        0.0028647 |\n| VCB          |   nan         |     0.0515214 |      nan         |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Quarterly ROE for Q2 2024\nROE_2024_Q2 AS (\n  SELECT \n    stock_code, \n    data AS ROE_Q2_2024\n  FROM \n    financial_ratio\n  WHERE \n    ratio_code = 'ROE' \n    AND quarter = 2 \n    AND year = 2024\n    AND stock_code IN ('VCB', 'TCB', 'VPB')\n),\n-- Quarterly ROE for Q2 2020\nROE_2020_Q2 AS (\n  SELECT \n    stock_code, \n    data AS ROE_Q2_2020\n  FROM \n    financial_ratio\n  WHERE \n    ratio_code = 'ROE' \n    AND quarter = 2 \n    AND year = 2020\n    AND stock_code IN ('VCB', 'TCB', 'VPB')\n)\n-- Joining both for comparison\nSELECT \n  COALESCE(R1.stock_code, R2.stock_code) AS Stock_Code,\n  R1.ROE_Q2_2024,\n  R2.ROE_Q2_2020,\n  (R1.ROE_Q2_2024 - R2.ROE_Q2_2020) AS ROE_Difference\nFROM \n  ROE_2024_Q2 R1\n  FULL OUTER JOIN ROE_2020_Q2 R2 ON R1.stock_code = R2.stock_code\nLIMIT 100;\n"
            }
        ],
        "time": 33.86267805099487,
        "evaluate": 1,
        "input_token": 2188,
        "output_token": 767
    },
    {
        "id": "517268fa-0be0-45f0-ab11-c3ff9ba775a3",
        "question": "Calculate the Debt-to-Equity ratio for VinGroup, Masan Group, and Hoa Phat Group in Q2 2024.  Analyze the impact of their subsidiary investments on their overall leverage.",
        "answer": "Table 1\n| stock_code   |   debt_to_equity_ratio |   investment_in_subsidiaries |\n|:-------------|-----------------------:|-----------------------------:|\n| HPG          |               0.901137 |                            0 |\n| VIC          |               3.44847  |                            0 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the stock codes for the companies\nWITH company_codes AS (\n    SELECT 'VIC' AS stock_code\n    UNION ALL\n    SELECT 'MSN'\n    UNION ALL\n    SELECT 'HPG'\n)\n\n-- Step 2: Retrieve Debt-to-Equity ratio for Q2 2024\nSELECT \n    fr.stock_code,\n    fr.data AS debt_to_equity_ratio,\n    nbf.data AS investment_in_subsidiaries\nFROM \n    financial_ratio fr\nJOIN \n    company_codes cc ON fr.stock_code = cc.stock_code\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nLEFT JOIN \n    non_bank_financial_report nbf ON fr.stock_code = nbf.stock_code \n    AND nbf.year = 2024 \n    AND nbf.quarter = 2 \n    AND nbf.category_code = 'BS_251' -- Investment in subsidiaries\nWHERE \n    fr.year = 2024 \n    AND fr.quarter = 2 \n    AND mccr.ratio_name = 'Debt To Equity Ratio';\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry        |   year |   quarter |   debttoequityratio |\n|:-------------|:----------------|-------:|----------:|--------------------:|\n| HPG          | Basic Resources |   2024 |         2 |            0.901137 |\n| VIC          | Real Estate     |   2024 |         2 |            3.44847  |\n\nTable 2\n| subsidiary   |\n|:-------------|\n| TCB          |\n| VRE          |\n| MSR          |\n| MCH          |\n| VCF          |\n| QHW          |\n| VSN          |\n| MML          |\n| CMF          |\n| VEF          |\n| VNB          |\n| VHM          |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.industry,\n  fr.year,\n  fr.quarter,\n  fr.data AS DebtToEquityRatio\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.ratio_code = 'DTER'\n  AND fr.stock_code IN ('VIC', 'MSN', 'HPG')\n  AND fr.year = 2024\n  AND fr.quarter = 2  -- Q2\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "-- Identify Subsidiaries for the Companies\nSELECT \n  sah.invest_on AS Subsidiary\nFROM \n  sub_and_shareholder sah\nWHERE \n  sah.stock_code IN ('VIC', 'MSN', 'HPG');\n\n-- **Manual Step:** Based on the subsidiaries identified, determine their types (bank, non-bank, securities) and retrieve relevant financial data. This step cannot be automated without assuming the type of each subsidiary.\n\n-- **Hypothetical Next Step (Assuming All Subsidiaries Are Non-Bank for Simplification):**\nSELECT \n  nfr.stock_code,\n  nfr.year,\n  nfr.quarter,\n  nfr.category_code,\n  nfr.data\nFROM \n  non_bank_financial_report nfr\nWHERE \n  nfr.stock_code IN ([List of Subsidiaries from Previous Query])\n  AND nfr.year = 2024\n  AND nfr.quarter = 2;\n"
            }
        ],
        "time": 38.337648153305054,
        "evaluate": 0.5,
        "input_token": 1783,
        "output_token": 850
    },
    {
        "id": "6eb862c7-4017-4799-a708-7e1fa7a4b1fd",
        "question": "Compare the Return on Equity (ROE) and Debt-to-Equity ratios for Vinamilk, Masan Group, and Sabeco in Q4 2023.  Also provide the total equity and total liabilities for each company in that quarter.",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | DTER         |     2.85445   |\n| SAB          | DTER         |     0.336332  |\n| VNM          | DTER         |     0.503847  |\n| MSN          | ROE          |     0.013515  |\n| SAB          | ROE          |     0.0379247 |\n| VNM          | ROE          |     0.0671136 |\n\nTable 2\n| stock_code   | category_code   |       value |\n|:-------------|:----------------|------------:|\n| VNM          | BS_300          | 1.76476e+07 |\n| VNM          | BS_400          | 3.50257e+07 |\n| MSN          | BS_300          | 1.09146e+08 |\n| SAB          | BS_300          | 8.57147e+06 |\n| MSN          | BS_400          | 3.82372e+07 |\n| SAB          | BS_400          | 2.54852e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve ROE and Debt-to-Equity Ratios for the specified companies\nSELECT \n    fr.stock_code,\n    fr.ratio_code,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB') \n    AND fr.year = 2023 \n    AND fr.quarter = 4\n    AND fr.ratio_code IN ('ROE', 'DTER');\n\n-- Step 2: Retrieve Total Equity and Total Liabilities for the specified companies\nSELECT \n    nfr.stock_code,\n    nfr.category_code,\n    nfr.data AS value\nFROM \n    non_bank_financial_report nfr\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN', 'SAB') \n    AND nfr.year = 2023 \n    AND nfr.quarter = 4\n    AND nfr.category_code IN ('BS_400', 'BS_300'); -- BS_400 for Total Equity, BS_300 for Total Liabilities\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Assuming the following category codes for demonstration\nEQUITY_CATEGORY_CODE AS 'BS_200',\nLIABILITIES_CATEGORY_CODE AS 'BS_300',\n\n-- Filtered Companies\nCompanies AS (\n  SELECT 'VNM' AS stock_code UNION\n  SELECT 'MSN' UNION\n  SELECT 'SAB'\n),\n\n-- Financial Data for Q4 2023\nFinancialData AS (\n  SELECT \n    C.stock_code,\n    'ROE' AS ratio_name,\n    FR.data AS ratio_data\n  FROM \n    Companies C\n  JOIN \n    financial_ratio FR ON C.stock_code = FR.stock_code\n  JOIN \n    map_category_code_ratio MCR ON FR.ratio_code = MCR.ratio_code\n  WHERE \n    FR.year = 2023 AND FR.quarter = 4 AND MCR.ratio_name = 'Return On Equity'\n\n  UNION ALL\n\n  SELECT \n    C.stock_code,\n    'Debt-to-Equity Ratio' AS ratio_name,\n    FR.data AS ratio_data\n  FROM \n    Companies C\n  JOIN \n    financial_ratio FR ON C.stock_code = FR.stock_code\n  JOIN \n    map_category_code_ratio MCR ON FR.ratio_code = MCR.ratio_code\n  WHERE \n    FR.year = 2023 AND FR.quarter = 4 AND MCR.ratio_name = 'Debt To Equity Ratio'\n\n  UNION ALL\n\n  SELECT \n    NFR.stock_code,\n    'Total Equity' AS ratio_name,\n    NFR.data AS ratio_data\n  FROM \n    Companies C\n  JOIN \n    non_bank_financial_report NFR ON C.stock_code = NFR.stock_code\n  WHERE \n    NFR.year = 2023 AND NFR.quarter = 4 AND NFR.category_code = EQUITY_CATEGORY_CODE\n\n  UNION ALL\n\n  SELECT \n    NFR.stock_code,\n    'Total Liabilities' AS ratio_name,\n    NFR.data AS ratio_data\n  FROM \n    Companies C\n  JOIN \n    non_bank_financial_report NFR ON C.stock_code = NFR.stock_code\n  WHERE \n    NFR.year = 2023 AND NFR.quarter = 4 AND NFR.category_code = LIABILITIES_CATEGORY_CODE\n)\n\n-- Final Query\nSELECT \n  stock_code,\n  ratio_name,\n  ratio_data\nFROM \n  FinancialData\nORDER BY \n  stock_code, ratio_name\nLIMIT 100;  -- Always add a limit as per the instructions\n"
            }
        ],
        "time": 44.619662046432495,
        "evaluate": 0,
        "input_token": 1926,
        "output_token": 1019
    }
]