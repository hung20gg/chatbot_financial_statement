[
    {
        "id": "9421f908-f430-45de-b536-6b9e1ebdfb1c",
        "question": "What were the total assets and total liabilities of Vietcombank, Techcombank, and ACB at the end of 2022?",
        "answer": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VCB          | BS_300          | 1.81382e+09 |\n| VCB          | BS_400          | 1.67817e+09 |\n| ACB          | BS_300          | 6.07875e+08 |\n| ACB          | BS_400          | 5.49437e+08 |\n| TCB          | BS_300          | 6.99033e+08 |\n| TCB          | BS_400          | 5.85608e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    category_code,\n    data\nFROM \n    bank_financial_report\nWHERE \n    year = 2022\n    AND quarter = 0\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND category_code IN ('BS_300', 'BS_400');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |   total_assets |   total_liabilities |\n|:-------------|---------------:|--------------------:|\n| ACB          |    6.07875e+08 |         5.49437e+08 |\n| TCB          |    6.99033e+08 |         5.85608e+08 |\n| VCB          |    1.81382e+09 |         1.67817e+09 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.stock_code,\n  SUM(CASE WHEN bfr.category_code = 'BS_300' THEN bfr.data ELSE 0 END) AS total_assets,\n  SUM(CASE WHEN bfr.category_code = 'BS_400' THEN bfr.data ELSE 0 END) AS total_liabilities\nFROM company_info AS ci\nJOIN bank_financial_report AS bfr\n  ON ci.stock_code = bfr.stock_code\nWHERE\n  ci.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND bfr.year = 2022\n  AND bfr.quarter = 0\nGROUP BY\n  ci.stock_code\nLIMIT 3;\n"
            }
        ],
        "time": 4.064009189605713,
        "evaluate": 1,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "6ee96cd0-65dc-4dca-b7d0-0320dc63353c",
        "question": "What is the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| HPG          | 0.0661282 |\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN', 'HPG')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|      data |\n|----------:|\n| 0.0661282 |\n| 0.0489033 |\n| 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND ci.stock_code IN ('VNM', 'MSN', 'HPG')\nLIMIT 3;\n"
            }
        ],
        "time": 3.5997657775878906,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "05531948-0c7c-4c04-b5b6-ed8dc6ba4d19",
        "question": "What were the Debt-to-Equity ratios of Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   |     dter |\n|:-------------|---------:|\n| TCB          |  5.16295 |\n| VCB          | 12.3717  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS dter\nFROM financial_ratio\nWHERE ratio_code = 'DTER'\nAND stock_code IN ('VCB', 'TCB')\nAND year = 2022\nAND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|     data |\n|---------:|\n|  5.16295 |\n| 12.3717  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Debt To Equity Ratio'\n  AND fr.year = 2022\n  AND fr.quarter = 0\n  AND ci.stock_code IN ('VCB', 'TCB')\nLIMIT 2;\n"
            }
        ],
        "time": 3.669118881225586,
        "evaluate": 0,
        "input_token": 10701,
        "output_token": 1221
    },
    {
        "id": "52880a2b-08dd-4e7e-b453-7bfa90617938",
        "question": "Compare the Return on Assets (ROA) and Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.  Additionally, provide the total assets and total equity for both companies for the same period.",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | ROA          |     0.0126875 |\n| MSN          | ROE          |     0.0489033 |\n| VNM          | ROA          |     0.171232  |\n| VNM          | ROE          |     0.257506  |\n\nTable 2\n| stock_code   | en_caption     |       value |\n|:-------------|:---------------|------------:|\n| VNM          | TOTAL ASSETS   | 5.26734e+07 |\n| VNM          | Owner's equity | 3.50257e+07 |\n| MSN          | TOTAL ASSETS   | 1.47383e+08 |\n| MSN          | Owner's equity | 3.82372e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve ROA and ROE for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    fr.stock_code,\n    fr.ratio_code,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nWHERE \n    fr.stock_code IN ('VNM', 'MSN') AND\n    fr.year = 2023 AND\n    fr.quarter = 0 AND\n    fr.ratio_code IN ('ROA', 'ROE');\n\n-- Step 2: Retrieve total assets and total equity for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data AS value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN') AND\n    nfr.year = 2023 AND\n    nfr.quarter = 0 AND\n    mcc.category_code IN ('BS_270', 'BS_410'); -- BS_270: TOTAL ASSETS, BS_410: Owner's equity\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| company_name   | roa   | roe   | total_assets   | total_equity   |\n|----------------|-------|-------|----------------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.company_name,\n  fr.data AS roa,\n  fr2.data AS roe,\n  fr3.data AS total_assets,\n  fr4.data AS total_equity\nFROM company_info AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN financial_ratio AS fr2\n  ON ci.stock_code = fr2.stock_code\nJOIN financial_ratio AS fr3\n  ON ci.stock_code = fr3.stock_code\nJOIN financial_ratio AS fr4\n  ON ci.stock_code = fr4.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN map_category_code_ratio AS mcr2\n  ON fr2.ratio_code = mcr2.ratio_code\nJOIN map_category_code_ratio AS mcr3\n  ON fr3.ratio_code = mcr3.ratio_code\nJOIN map_category_code_ratio AS mcr4\n  ON fr4.ratio_code = mcr4.ratio_code\nWHERE\n  ci.stock_code IN ('VNM', 'MSN')\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND mcr.ratio_name = 'Return On Assets'\n  AND fr2.year = 2023\n  AND fr2.quarter = 0\n  AND mcr2.ratio_name = 'Return On Equity'\n  AND fr3.year = 2023\n  AND fr3.quarter = 0\n  AND mcr3.ratio_name = 'Total Assets' -- Placeholder, needs actual ratio code\n  AND fr4.year = 2023\n  AND fr4.quarter = 0\n  AND mcr4.ratio_name = 'Total Equity'; -- Placeholder, needs actual ratio code\n\n"
            }
        ],
        "time": 8.337777853012085,
        "evaluate": 0,
        "input_token": 4728,
        "output_token": 1456
    },
    {
        "id": "481ebd36-c43a-4af2-901b-99a8e6964217",
        "question": "Compare the Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| company_name                   |       roe |\n|:-------------------------------|----------:|\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan | 0.0489033 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam   | 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.company_name,\n  fr.data AS roe\nFROM company_info AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND ci.stock_code IN ('VNM', 'MSN')\n  AND fr.year = 2023\n  AND fr.quarter = 0\nLIMIT 2;\n"
            }
        ],
        "time": 3.8237624168395996,
        "evaluate": 1,
        "input_token": 5317,
        "output_token": 552
    },
    {
        "id": "61803c95-30e1-4a6f-8f02-ebde74c1120c",
        "question": "What were the operating cash flows and capital expenditures for Vietcombank, Techcombank, and VPBank in Q2 2024?  Calculate the free cash flow for each bank.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |   free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|-----------------:|\n| TCB          |   2024 |         2 |                     0 |                -280254 |           280254 |\n| VPB          |   2024 |         2 |                     0 |                  -1490 |             1490 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) AS operating_cash_flow,\n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS capital_expenditures,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) - \n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS free_cash_flow\nFROM \n    bank_financial_report bfr\nWHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'VPB') AND\n    bfr.year = 2024 AND\n    bfr.quarter = 2 AND\n    bfr.category_code IN ('CF_009', 'CF_025')\nGROUP BY \n    bfr.stock_code, bfr.year, bfr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | operating_cash_flow   | capital_expenditures   | free_cash_flow   |\n|--------------|-----------------------|------------------------|------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH OperatingCashFlow AS (\n  SELECT\n    b.stock_code,\n    b.data AS operating_cash_flow\n  FROM bank_financial_report AS b\n  JOIN map_category_code_bank AS m\n    ON b.category_code = m.category_code\n  WHERE\n    m.en_caption = 'Net cash flow from operating activities before changes in assets and working capital'\n    AND b.year = 2024\n    AND b.quarter = 2\n    AND b.stock_code IN ('VCB', 'TCB', 'VPB')\n), CapitalExpenditures AS (\n  SELECT\n    b.stock_code,\n    b.data * -1 AS capital_expenditures\n  FROM bank_financial_report AS b\n  JOIN map_category_code_bank AS m\n    ON b.category_code = m.category_code\n  WHERE\n    m.en_caption LIKE '%purchase, construction of fixed assets%'\n    AND b.year = 2024\n    AND b.quarter = 2\n    AND b.stock_code IN ('VCB', 'TCB', 'VPB')\n)\nSELECT\n  ocf.stock_code,\n  ocf.operating_cash_flow,\n  ce.capital_expenditures,\n  ocf.operating_cash_flow + ce.capital_expenditures AS free_cash_flow\nFROM OperatingCashFlow AS ocf\nJOIN CapitalExpenditures AS ce\n  ON ocf.stock_code = ce.stock_code;\n"
            }
        ],
        "time": 5.135547399520874,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "5972ee68-a39a-4051-b3d5-59aa6a533359",
        "question": "For the year 2023, what was the total revenue, net income, and total assets of  Masan Group, Vinamilk, and  PetroVietnam Gas?  Additionally, provide the percentage of total assets attributable to subsidiaries or investments for each company.",
        "answer": "Table 1\n| stock_code   |   total_revenue |   net_income |   total_assets |   percentage_investment_assets |\n|:-------------|----------------:|-------------:|---------------:|-------------------------------:|\n| GAS          |     8.99539e+07 |  1.46395e+07 |    8.77545e+07 |                        2.05086 |\n| MSN          |     7.82516e+07 |  2.56297e+06 |    1.47383e+08 |                        0       |\n| VNM          |     6.03689e+07 |  1.09679e+07 |    5.26734e+07 |                        0       |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH financial_data AS (\n    SELECT\n        nfr.stock_code,\n        SUM(CASE WHEN mcc.category_code = 'IS_010' THEN nfr.data ELSE 0 END) AS total_revenue,\n        SUM(CASE WHEN mcc.category_code = 'IS_050' THEN nfr.data ELSE 0 END) AS net_income,\n        SUM(CASE WHEN mcc.category_code = 'BS_270' THEN nfr.data ELSE 0 END) AS total_assets\n    FROM\n        non_bank_financial_report nfr\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND nfr.stock_code IN ('MSN', 'VNM', 'GAS')\n    GROUP BY\n        nfr.stock_code\n),\ninvestment_data AS (\n    SELECT\n        s.stock_code,\n        SUM(nfr.data) AS investment_assets\n    FROM\n        sub_and_shareholder s\n    JOIN\n        non_bank_financial_report nfr ON s.invest_on = nfr.stock_code\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND mcc.category_code = 'BS_270'\n    GROUP BY\n        s.stock_code\n)\nSELECT\n    fd.stock_code,\n    fd.total_revenue,\n    fd.net_income,\n    fd.total_assets,\n    COALESCE(id.investment_assets / NULLIF(fd.total_assets, 0) * 100, 0) AS percentage_investment_assets\nFROM\n    financial_data fd\nLEFT JOIN\n    investment_data id ON fd.stock_code = id.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| company_name                                |   total_revenue |   net_income |   total_assets |   subsidiary_assets_percentage |\n|:--------------------------------------------|----------------:|-------------:|---------------:|-------------------------------:|\n| T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n |               0 |            0 |    6.22178e+07 |                              0 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan              |               0 |            0 |    4.37635e+07 |                              0 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                |               0 |            0 |    3.59359e+07 |                              0 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH company_data AS (\n  SELECT\n    ci.stock_code,\n    ci.company_name,\n    SUM(CASE WHEN nbfr.category_code = 'IS_100' THEN nbfr.data ELSE 0 END) AS total_revenue,\n    SUM(CASE WHEN nbfr.category_code = 'IS_140' THEN nbfr.data ELSE 0 END) AS net_income,\n    SUM(CASE WHEN nbfr.category_code = 'BS_100' THEN nbfr.data ELSE 0 END) AS total_assets\n  FROM company_info AS ci\n  JOIN non_bank_financial_report AS nbfr\n    ON ci.stock_code = nbfr.stock_code\n  WHERE\n    ci.stock_code IN ('MSN', 'VNM', 'GAS')\n    AND nbfr.year = 2023\n    AND nbfr.quarter = 0\n  GROUP BY\n    ci.stock_code,\n    ci.company_name\n), subsidiary_data AS (\n  SELECT\n    sas.stock_code,\n    SUM(ci_sub.total_assets) AS subsidiary_assets\n  FROM sub_and_shareholder AS sas\n  JOIN company_data AS ci_sub\n    ON sas.invest_on = ci_sub.stock_code\n  GROUP BY\n    sas.stock_code\n)\nSELECT\n  cd.company_name,\n  cd.total_revenue,\n  cd.net_income,\n  cd.total_assets,\n  COALESCE((sd.subsidiary_assets / cd.total_assets) * 100, 0) AS subsidiary_assets_percentage\nFROM company_data AS cd\nLEFT JOIN subsidiary_data AS sd\n  ON cd.stock_code = sd.stock_code\nLIMIT 3;\n"
            }
        ],
        "time": 6.346100091934204,
        "evaluate": 0,
        "input_token": 3309,
        "output_token": 627
    },
    {
        "id": "74f9babe-9421-4bb7-a88f-a5c664b5a6da",
        "question": "What is the trend of the Current Ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |   current_ratio |\n|-------:|----------:|:-------------|----------------:|\n|   2020 |         0 | ACB          |         3.69815 |\n|   2021 |         0 | ACB          |         3.97544 |\n|   2022 |         0 | ACB          |         3.81624 |\n|   2023 |         0 | ACB          |         3.04283 |\n|   2024 |         1 | ACB          |         3.29123 |\n|   2020 |         0 | TCB          |         2.83619 |\n|   2021 |         0 | TCB          |         4.35343 |\n|   2022 |         0 | TCB          |         3.29776 |\n|   2023 |         0 | TCB          |         2.66367 |\n|   2024 |         1 | TCB          |         2.40445 |\n|   2024 |         2 | TCB          |         2.88946 |\n|   2020 |         0 | VCB          |         7.25011 |\n|   2021 |         0 | VCB          |         6.29498 |\n|   2022 |         0 | VCB          |         3.56816 |\n|   2023 |         0 | VCB          |         4.7828  |\n|   2024 |         1 | VCB          |         3.48899 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    fr.stock_code, \n    fr.data AS current_ratio\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    mccr.ratio_name = 'Current Ratio'\n    AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR \n         (fr.year = 2024 AND fr.quarter BETWEEN 1 AND 2))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n|   year |   quarter |   current_ratio |\n|-------:|----------:|----------------:|\n|   2020 |         0 |         2.83619 |\n|   2020 |         0 |         3.69815 |\n|   2020 |         0 |         7.25011 |\n|   2020 |         1 |         5.43727 |\n|   2020 |         1 |         2.89911 |\n|   2020 |         1 |         3.54284 |\n|   2020 |         2 |         3.46132 |\n|   2020 |         2 |         5.19794 |\n|   2020 |         2 |         3.84263 |\n|   2020 |         3 |         4.72611 |\n|   2020 |         3 |         3.1178  |\n|   2020 |         3 |         2.47947 |\n|   2020 |         4 |         3.69815 |\n|   2020 |         4 |         7.86737 |\n|   2020 |         4 |         2.83619 |\n|   2021 |         0 |         3.97544 |\n|   2021 |         0 |         4.35343 |\n|   2021 |         0 |         6.29498 |\n|   2021 |         1 |         5.86813 |\n|   2021 |         1 |         2.28142 |\n|   2021 |         1 |         3.16037 |\n|   2021 |         2 |         3.90106 |\n|   2021 |         2 |         2.61232 |\n|   2021 |         2 |         5.28517 |\n|   2021 |         3 |         5.41155 |\n|   2021 |         3 |         6.82119 |\n|   2021 |         3 |         3.03271 |\n|   2021 |         4 |         4.40216 |\n|   2021 |         4 |         3.97544 |\n|   2021 |         4 |         6.58505 |\n|   2022 |         0 |         3.29776 |\n|   2022 |         0 |         3.81624 |\n|   2022 |         0 |         3.56816 |\n|   2022 |         1 |         4.20104 |\n|   2022 |         1 |         3.25965 |\n|   2022 |         1 |         6.06806 |\n|   2022 |         2 |         6.27508 |\n|   2022 |         2 |         3.34928 |\n|   2022 |         2 |         3.53703 |\n|   2022 |         3 |         2.91339 |\n|   2022 |         3 |         3.1711  |\n|   2022 |         3 |         6.95249 |\n|   2022 |         4 |         3.29776 |\n|   2022 |         4 |         3.62631 |\n|   2022 |         4 |         3.81624 |\n|   2023 |         0 |         3.04283 |\n|   2023 |         0 |         2.66367 |\n|   2023 |         0 |         4.7828  |\n|   2023 |         1 |         3.53987 |\n|   2023 |         1 |         5.431   |\n|   2023 |         1 |         3.10937 |\n|   2023 |         2 |       nan       |\n|   2023 |         2 |         2.99619 |\n|   2023 |         2 |         5.5238  |\n|   2023 |         3 |         5.44838 |\n|   2023 |         3 |         4.18999 |\n|   2023 |         3 |         3.69457 |\n|   2023 |         4 |         3.32547 |\n|   2023 |         4 |         5.24741 |\n|   2024 |         1 |         3.48899 |\n|   2024 |         1 |         2.40445 |\n|   2024 |         1 |         3.29123 |\n|   2024 |         2 |         2.88946 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.year,\n  fr.quarter,\n  fr.data AS current_ratio\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Current Ratio'\n  AND ci.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.244677305221558,
        "evaluate": 0,
        "input_token": 6606,
        "output_token": 812
    },
    {
        "id": "b8a00999-b6af-4a1f-9e41-60a2aa7e4d01",
        "question": "Compare the Return on Equity (ROE) of Vinamilk, Masan Group, and Sabeco for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |   return_on_equity |\n|:-------------|-------------------:|\n| MSN          |          0.0489033 |\n| SAB          |          0.166962  |\n| VNM          |          0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    data AS return_on_equity\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    year = 2023 AND\n    quarter = 0 AND\n    stock_code IN ('VNM', 'MSN', 'SAB');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|      data |\n|----------:|\n| 0.0489033 |\n| 0.166962  |\n| 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\nLIMIT 3;\n"
            }
        ],
        "time": 3.6982040405273438,
        "evaluate": 0,
        "input_token": 600,
        "output_token": 243
    },
    {
        "id": "3bdd12bf-a669-4f11-bd82-b368cc2c608f",
        "question": "What is the trend of the current ratio and quick ratio for BIDV, Eximbank, and OCB Bank from 2020 to Q2 2024,  considering their respective subsidiaries and investments?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name    |     data |\n|:-------------|-------:|----------:|:--------------|---------:|\n| BID          |   2020 |         0 | Current Ratio | 2.57276  |\n| BID          |   2021 |         0 | Current Ratio | 3.94763  |\n| BID          |   2022 |         0 | Current Ratio | 5.04924  |\n| BID          |   2023 |         0 | Current Ratio | 2.5701   |\n| BID          |   2024 |         1 | Current Ratio | 2.94967  |\n| BID          |   2024 |         2 | Current Ratio | 3.65939  |\n| EIB          |   2020 |         0 | Current Ratio | 6.67582  |\n| EIB          |   2021 |         0 | Current Ratio | 5.72966  |\n| EIB          |   2022 |         0 | Current Ratio | 5.16642  |\n| EIB          |   2023 |         0 | Current Ratio | 6.12482  |\n| EIB          |   2024 |         1 | Current Ratio | 6.11042  |\n| HDB          |   2020 |         0 | Current Ratio | 4.83941  |\n| HDB          |   2021 |         0 | Current Ratio | 5.9133   |\n| HDB          |   2022 |         0 | Current Ratio | 4.00626  |\n| HDB          |   2023 |         0 | Current Ratio | 3.6528   |\n| HDB          |   2024 |         1 | Current Ratio | 3.1524   |\n| OCB          |   2020 |         0 | Current Ratio | 1.11545  |\n| OCB          |   2021 |         0 | Current Ratio | 4.2912   |\n| OCB          |   2022 |         0 | Current Ratio | 2.74653  |\n| OCB          |   2023 |         0 | Current Ratio | 1.68853  |\n| OCB          |   2024 |         1 | Current Ratio | 2.58278  |\n| STB          |   2020 |         0 | Current Ratio | 1.56301  |\n| STB          |   2021 |         0 | Current Ratio | 1.02262  |\n| STB          |   2022 |         0 | Current Ratio | 1.09035  |\n| STB          |   2023 |         0 | Current Ratio | 0.700152 |\n| STB          |   2024 |         1 | Current Ratio | 1.0368   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH relevant_companies AS (\n    SELECT stock_code\n    FROM company_info\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n    UNION\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n),\nratios AS (\n    SELECT ratio_code\n    FROM map_category_code_ratio\n    WHERE ratio_name IN ('Current Ratio', 'Quick Ratio')\n)\nSELECT fr.stock_code, fr.year, fr.quarter, mcr.ratio_name, fr.data\nFROM financial_ratio fr\nJOIN ratios r ON fr.ratio_code = r.ratio_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE fr.stock_code IN (SELECT stock_code FROM relevant_companies)\nAND ((fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY fr.stock_code, fr.year, fr.quarter, mcr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantCompanies AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('BID', 'EIB', 'OCB') -- Based on provided company names\n  UNION\n  SELECT invest_on\n  FROM sub_and_shareholder\n  WHERE stock_code IN ('BID', 'EIB', 'OCB')\n),\nRatioData AS (\n  SELECT\n    rc.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data\n  FROM RelevantCompanies rc\n  JOIN financial_ratio fr\n    ON rc.stock_code = fr.stock_code\n  JOIN map_category_code_ratio mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name IN ('Current Ratio', 'Quick Ratio')\n    AND fr.year >= 2020\n    AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\n)\nSELECT\n  stock_code,\n  year,\n  quarter,\n  MAX(CASE WHEN ratio_name = 'Current Ratio' THEN data END) AS current_ratio,\n  MAX(CASE WHEN ratio_name = 'Quick Ratio' THEN data END) AS quick_ratio\nFROM (\n  SELECT\n    stock_code,\n    year,\n    quarter,\n    'Current Ratio' AS ratio_name,\n    data\n  FROM RatioData\n  WHERE ratio_name = 'Current Ratio'\n  UNION ALL\n  SELECT\n    stock_code,\n    year,\n    quarter,\n    'Quick Ratio' AS ratio_name,\n    data\n  FROM RatioData\n  WHERE ratio_name = 'Quick Ratio'\n) AS AllRatios\nGROUP BY\n  stock_code,\n  year,\n  quarter\nORDER BY\n  stock_code,\n  year,\n  quarter\nLIMIT 100;\n"
            }
        ],
        "time": 6.157114744186401,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "e4a9ec26-1d13-431d-854f-90f02a2024dd",
        "question": "What was the total equity of  Vietcombank's subsidiaries and associated companies as a percentage of Vietcombank's total equity at the end of Q2 2024?",
        "answer": "Table 1\n| equity_percentage   |\n|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify Vietcombank's subsidiaries and associated companies\nWITH vcb_subsidiaries AS (\n    SELECT invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VCB'\n),\n\n-- Step 2: Retrieve the total equity of these subsidiaries and associated companies\nsubsidiaries_equity AS (\n    SELECT SUM(data) AS total_subsidiaries_equity\n    FROM (\n        SELECT data\n        FROM bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n        UNION ALL\n        SELECT data\n        FROM non_bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for non-banks\n        UNION ALL\n        SELECT data\n        FROM securities_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for securities\n    ) AS equity_data\n),\n\n-- Step 3: Retrieve Vietcombank's total equity\nvcb_equity AS (\n    SELECT data AS total_vcb_equity\n    FROM bank_financial_report\n    WHERE stock_code = 'VCB'\n      AND year = 2024\n      AND quarter = 2\n      AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n)\n\n-- Step 4: Calculate the percentage\nSELECT (subsidiaries_equity.total_subsidiaries_equity / vcb_equity.total_vcb_equity) * 100 AS equity_percentage\nFROM subsidiaries_equity, vcb_equity;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| percentage   |\n|--------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH VietcombankSubsidiaries AS (\n  SELECT\n    invest_on\n  FROM sub_and_shareholder\n  WHERE\n    stock_code = 'VCB'\n), SubsidiaryEquity AS (\n  SELECT\n    COALESCE(SUM(CASE WHEN T1.is_bank THEN T2.data ELSE 0 END), 0) + COALESCE(SUM(CASE WHEN NOT T1.is_bank THEN T3.data ELSE 0 END), 0) AS total_equity\n  FROM company_info AS T1\n  INNER JOIN VietcombankSubsidiaries AS T4\n    ON T1.stock_code = T4.invest_on\n  LEFT JOIN bank_financial_report AS T2\n    ON T1.stock_code = T2.stock_code\n    AND T2.year = 2024\n    AND T2.quarter = 2\n    AND T2.category_code = 'BS_500'\n  LEFT JOIN non_bank_financial_report AS T3\n    ON T1.stock_code = T3.stock_code\n    AND T3.year = 2024\n    AND T3.quarter = 2\n    AND T3.category_code = 'BS_410'\n), VietcombankEquity AS (\n  SELECT\n    data AS vcb_equity\n  FROM bank_financial_report\n  WHERE\n    stock_code = 'VCB'\n    AND year = 2024\n    AND quarter = 2\n    AND category_code = 'BS_500'\n)\nSELECT\n  (\n    COALESCE(total_equity, 0) * 100.0 / COALESCE(vcb_equity, 1)\n  ) AS percentage\nFROM SubsidiaryEquity,\n  VietcombankEquity;\n"
            }
        ],
        "time": 6.074663400650024,
        "evaluate": 0,
        "input_token": 6235,
        "output_token": 1163
    },
    {
        "id": "e0c17ae2-f308-486c-b62b-97f32e813cff",
        "question": "How has the Debt-to-Equity ratio of Vinamilk, Masan Group, and SABECO changed from 2020 to Q2 2024?  Compare their respective Quick Ratios over the same period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_code   |     data |\n|:-------------|-------:|----------:|:-------------|---------:|\n| MSN          |   2020 |         0 | DTER         | 3.62386  |\n| MSN          |   2020 |         0 | QR           | 0.451862 |\n| MSN          |   2020 |         2 | DTER         | 2.36354  |\n| MSN          |   2020 |         2 | QR           | 0.356423 |\n| MSN          |   2021 |         0 | DTER         | 1.97835  |\n| MSN          |   2021 |         0 | QR           | 0.899436 |\n| MSN          |   2021 |         2 | DTER         | 2.83936  |\n| MSN          |   2021 |         2 | QR           | 0.572475 |\n| MSN          |   2022 |         0 | DTER         | 2.85795  |\n| MSN          |   2022 |         0 | QR           | 0.514436 |\n| MSN          |   2022 |         2 | DTER         | 2.22866  |\n| MSN          |   2022 |         2 | QR           | 0.44704  |\n| MSN          |   2023 |         0 | DTER         | 2.85445  |\n| MSN          |   2023 |         0 | QR           | 0.61315  |\n| MSN          |   2023 |         2 | DTER         | 2.75379  |\n| MSN          |   2023 |         2 | QR           | 0.563175 |\n| SAB          |   2020 |         0 | DTER         | 0.290342 |\n| SAB          |   2020 |         0 | QR           | 3.52024  |\n| SAB          |   2020 |         2 | DTER         | 0.32508  |\n| SAB          |   2020 |         2 | QR           | 3.0425   |\n| SAB          |   2021 |         0 | DTER         | 0.349295 |\n| SAB          |   2021 |         0 | QR           | 2.93441  |\n| SAB          |   2021 |         2 | DTER         | 0.288778 |\n| SAB          |   2021 |         2 | QR           | 3.55591  |\n| SAB          |   2022 |         0 | DTER         | 0.401541 |\n| SAB          |   2022 |         0 | QR           | 2.69688  |\n| SAB          |   2022 |         2 | DTER         | 0.280909 |\n| SAB          |   2022 |         2 | QR           | 3.53308  |\n| SAB          |   2023 |         0 | DTER         | 0.336332 |\n| SAB          |   2023 |         0 | QR           | 2.9677   |\n| SAB          |   2023 |         2 | DTER         | 0.318275 |\n| SAB          |   2023 |         2 | QR           | 3.13189  |\n| SAB          |   2024 |         2 | DTER         | 0.359095 |\n| SAB          |   2024 |         2 | QR           | 2.9152   |\n| VNM          |   2020 |         0 | DTER         | 0.439424 |\n| VNM          |   2020 |         0 | QR           | 1.7462   |\n| VNM          |   2020 |         2 | DTER         | 0.532862 |\n| VNM          |   2020 |         2 | QR           | 1.46628  |\n| VNM          |   2021 |         0 | DTER         | 0.487649 |\n| VNM          |   2021 |         0 | QR           | 1.72213  |\n| VNM          |   2021 |         2 | DTER         | 0.543159 |\n| VNM          |   2021 |         2 | QR           | 1.56154  |\n| VNM          |   2022 |         0 | DTER         | 0.477386 |\n| VNM          |   2022 |         0 | QR           | 1.70628  |\n| VNM          |   2022 |         2 | DTER         | 0.462287 |\n| VNM          |   2022 |         2 | QR           | 1.79426  |\n| VNM          |   2023 |         0 | DTER         | 0.503847 |\n| VNM          |   2023 |         0 | QR           | 1.74405  |\n| VNM          |   2023 |         2 | DTER         | 0.390309 |\n| VNM          |   2023 |         2 | QR           | 1.97817  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.ratio_code,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR fr.quarter = 2) -- Include annual reports and Q2 reports\n    AND mccr.ratio_code IN ('DTER', 'QR') -- Debt-to-Equity Ratio and Quick Ratio\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, fr.ratio_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | ratio_name           |   year |   quarter |     data |\n|:-------------|:---------------------|-------:|----------:|---------:|\n| MSN          | Debt To Equity Ratio |   2020 |         0 | 3.62386  |\n| MSN          | Quick Ratio          |   2020 |         0 | 0.451862 |\n| SAB          | Debt To Equity Ratio |   2020 |         0 | 0.290342 |\n| SAB          | Debt To Equity Ratio |   2024 |         2 | 0.359095 |\n| SAB          | Quick Ratio          |   2020 |         0 | 3.52024  |\n| SAB          | Quick Ratio          |   2024 |         2 | 2.9152   |\n| VNM          | Debt To Equity Ratio |   2020 |         0 | 0.439424 |\n| VNM          | Quick Ratio          |   2020 |         0 | 1.7462   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n')\n), RatioData AS (\n  SELECT\n    cc.stock_code,\n    mcr.ratio_name,\n    fr.year,\n    fr.quarter,\n    fr.data\n  FROM CompanyCodes AS cc\n  JOIN financial_ratio AS fr\n    ON cc.stock_code = fr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name IN ('Debt To Equity Ratio', 'Quick Ratio')\n    AND (\n      (\n        fr.year = 2020\n        AND fr.quarter = 0\n      )\n      OR (\n        fr.year = 2024\n        AND fr.quarter = 2\n      )\n    )\n)\nSELECT\n  stock_code,\n  ratio_name,\n  year,\n  quarter,\n  data\nFROM RatioData\nORDER BY\n  stock_code,\n  ratio_name,\n  year,\n  quarter\nLIMIT 100;\n"
            }
        ],
        "time": 5.335015535354614,
        "evaluate": 0,
        "input_token": 2434,
        "output_token": 319
    },
    {
        "id": "23ea7012-1827-4ab6-b0cd-b24116d380df",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and Sacombank from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| STB          |   2020 |         0 | 0.0926219 |\n| STB          |   2021 |         0 | 0.0995728 |\n| STB          |   2022 |         0 | 0.130497  |\n| STB          |   2023 |         0 | 0.168772  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS ROE\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'STB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual data from 2020 to 2023\n        OR (year = 2024 AND quarter = 2) -- Q2 data for 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs.\nWITH relevant_companies AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE en_company_name IN ('Joint Stock Commercial Bank For Foreign Trade Of Vietnam', 'SaiGon Thuong Tin Commercial Joint Stock Bank', 'Vietnam Technological And Commercial Joint Stock Bank')\n)\n\n-- Step 2: Extract ROE trends.\nSELECT\n  rc.en_company_name,\n  fr.year,\n  fr.quarter,\n  fr.data AS roe\nFROM financial_ratio fr\nJOIN relevant_companies rc ON fr.stock_code = rc.stock_code\nJOIN company_info ci ON rc.stock_code = ci.stock_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY\n  rc.en_company_name,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.877216577529907,
        "evaluate": 0,
        "input_token": 2385,
        "output_token": 275
    },
    {
        "id": "650a1eb0-378d-4d82-b07a-acedf00aa716",
        "question": "For the year 2023, what was the combined net income of  VinGroup's subsidiaries and the net income of VinGroup itself, and what percentage of VinGroup's total net income came from its subsidiaries?",
        "answer": "Table 1\n|   total_net_income |   subsidiaries_net_income |   percentage_from_subsidiaries |\n|-------------------:|--------------------------:|-------------------------------:|\n|        4.45219e+07 |               4.94273e+07 |                        111.018 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH vin_subsidiaries AS (\n    SELECT invest_on AS subsidiary_code\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VIC'\n),\nvin_and_subsidiaries_net_income AS (\n    SELECT stock_code, SUM(data) AS net_income\n    FROM non_bank_financial_report\n    WHERE (stock_code = 'VIC' OR stock_code IN (SELECT subsidiary_code FROM vin_subsidiaries))\n      AND year = 2023\n      AND quarter = 0\n      AND category_code = 'IS_030'\n    GROUP BY stock_code\n),\ntotal_net_income AS (\n    SELECT SUM(net_income) AS total_net_income\n    FROM vin_and_subsidiaries_net_income\n),\nsubsidiaries_net_income AS (\n    SELECT SUM(net_income) AS subsidiaries_net_income\n    FROM vin_and_subsidiaries_net_income\n    WHERE stock_code IN (SELECT subsidiary_code FROM vin_subsidiaries)\n)\nSELECT \n    tni.total_net_income,\n    sni.subsidiaries_net_income,\n    (sni.subsidiaries_net_income / tni.total_net_income) * 100 AS percentage_from_subsidiaries\nFROM total_net_income tni, subsidiaries_net_income sni;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH VinGroupSubsidiaries AS (\n  SELECT\n    invest_on\n  FROM sub_and_shareholder\n  WHERE\n    stock_code = 'VIC'\n), VinGroupSubsidiaryIncome AS (\n  SELECT\n    COALESCE(SUM(CASE WHEN T1.quarter = 0 THEN T1.data ELSE NULL END), 0) AS subsidiary_income\n  FROM non_bank_financial_report AS T1\n  INNER JOIN VinGroupSubsidiaries AS T2\n    ON T1.stock_code = T2.invest_on\n  INNER JOIN company_info AS T3\n    ON T1.stock_code = T3.stock_code\n  WHERE\n    T1.year = 2023\n    AND T3.is_bank = FALSE\n    AND T3.is_securities = FALSE\n), VinGroupIncome AS (\n  SELECT\n    COALESCE(SUM(CASE WHEN T1.quarter = 0 THEN T1.data ELSE NULL END), 0) AS vingroup_income\n  FROM non_bank_financial_report AS T1\n  WHERE\n    T1.stock_code = 'VIC'\n    AND T1.year = 2023\n    AND T1.category_code = 'IS_004'\n)\nSELECT\n  vgsi.subsidiary_income,\n  vgi.vingroup_income,\n  (\n    vgsi.subsidiary_income * 100.0 / vgi.vingroup_income\n  ) AS percentage_from_subsidiaries\nFROM VinGroupSubsidiaryIncome AS vgsi\nCROSS JOIN VinGroupIncome AS vgi\nLIMIT 1;\n"
            }
        ],
        "time": 6.401228189468384,
        "evaluate": 0,
        "input_token": 2256,
        "output_token": 381
    },
    {
        "id": "48a8fa57-c0d7-4ba7-879f-5dbe2a9228cc",
        "question": "Compare the Net Profit Margin and the Debt-to-Equity ratio of Vinamilk and Masan Group from 2020 to Q2 2024.  Analyze the changes in their total assets and total liabilities during this period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_code   |   ratio_value |\n|:-------------|-------:|----------:|:-------------|--------------:|\n| MSN          |   2020 |         0 | DTER         |      3.62386  |\n| MSN          |   2021 |         0 | DTER         |      1.97835  |\n| MSN          |   2022 |         0 | DTER         |      2.85795  |\n| MSN          |   2023 |         0 | DTER         |      2.85445  |\n| VNM          |   2020 |         0 | DTER         |      0.439424 |\n| VNM          |   2021 |         0 | DTER         |      0.487649 |\n| VNM          |   2022 |         0 | DTER         |      0.477386 |\n| VNM          |   2023 |         0 | DTER         |      0.503847 |\n\nTable 2\n| stock_code   |   year |   quarter | category_code   |       value |\n|:-------------|-------:|----------:|:----------------|------------:|\n| MSN          |   2020 |         0 | BS_270          | 1.15737e+08 |\n| MSN          |   2020 |         0 | BS_300          | 9.07063e+07 |\n| MSN          |   2021 |         0 | BS_270          | 1.26093e+08 |\n| MSN          |   2021 |         0 | BS_300          | 8.37568e+07 |\n| MSN          |   2022 |         0 | BS_270          | 1.41343e+08 |\n| MSN          |   2022 |         0 | BS_300          | 1.04706e+08 |\n| MSN          |   2023 |         0 | BS_270          | 1.47383e+08 |\n| MSN          |   2023 |         0 | BS_300          | 1.09146e+08 |\n| VNM          |   2020 |         0 | BS_270          | 4.84325e+07 |\n| VNM          |   2020 |         0 | BS_300          | 1.47854e+07 |\n| VNM          |   2021 |         0 | BS_270          | 5.33324e+07 |\n| VNM          |   2021 |         0 | BS_300          | 1.74823e+07 |\n| VNM          |   2022 |         0 | BS_270          | 4.84827e+07 |\n| VNM          |   2022 |         0 | BS_300          | 1.56661e+07 |\n| VNM          |   2023 |         0 | BS_270          | 5.26734e+07 |\n| VNM          |   2023 |         0 | BS_300          | 1.76476e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    ratio_code,\n    data AS ratio_value\nFROM \n    financial_ratio\nWHERE \n    stock_code IN ('VNM', 'MSN')\n    AND ratio_code IN ('NPM', 'DTER')\n    AND ((year = 2020 AND quarter = 0) OR (year = 2021 AND quarter = 0) OR (year = 2022 AND quarter = 0) OR (year = 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter, ratio_code;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    category_code,\n    data AS value\nFROM \n    non_bank_financial_report\nWHERE \n    stock_code IN ('VNM', 'MSN')\n    AND category_code IN ('BS_270', 'BS_300') -- BS_270 for Total Assets, BS_300 for Total Liabilities\n    AND ((year = 2020 AND quarter = 0) OR (year = 2021 AND quarter = 0) OR (year = 2022 AND quarter = 0) OR (year = 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter, category_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter | net_profit_margin   |   debt_to_equity_ratio |   total_assets |   total_liabilities |\n|:-------------|-------:|----------:|:--------------------|-----------------------:|---------------:|--------------------:|\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |                3.62386 |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                   ",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan')\n), RatioData AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    CASE\n      WHEN mcr.ratio_name = 'Net profit margin'\n      THEN fr.data\n      ELSE NULL\n    END AS net_profit_margin,\n    CASE\n      WHEN mcr.ratio_name = 'Debt To Equity Ratio'\n      THEN fr.data\n      ELSE NULL\n    END AS debt_to_equity_ratio\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  JOIN CompanyCodes AS cc\n    ON fr.stock_code = cc.stock_code\n  WHERE\n    fr.year >= 2020 AND fr.year <= 2024 AND fr.quarter IN (0, 1, 2)\n), BalanceSheetData AS (\n  SELECT\n    nfr.stock_code,\n    nfr.year,\n    nfr.quarter,\n    SUM(\n      CASE\n        WHEN mcn.en_caption = 'Total assets'\n        THEN nfr.data\n        ELSE 0\n      END\n    ) AS total_assets,\n    SUM(\n      CASE\n        WHEN mcn.en_caption = 'Total liabilities'\n        THEN nfr.data\n        ELSE 0\n      END\n    ) AS total_liabilities\n  FROM non_bank_financial_report AS nfr\n  JOIN map_category_code_non_bank AS mcn\n    ON nfr.category_code = mcn.category_code\n  JOIN CompanyCodes AS cc\n    ON nfr.stock_code = cc.stock_code\n  WHERE\n    nfr.year >= 2020 AND nfr.year <= 2024 AND nfr.quarter IN (0, 1, 2)\n  GROUP BY\n    nfr.stock_code,\n    nfr.year,\n    nfr.quarter\n)\nSELECT\n  rd.stock_code,\n  rd.year,\n  rd.quarter,\n  rd.net_profit_margin,\n  rd.debt_to_equity_ratio,\n  bs.total_assets,\n  bs.total_liabilities\nFROM RatioData AS rd\nJOIN BalanceSheetData AS bs\n  ON rd.stock_code = bs.stock_code AND rd.year = bs.year AND rd.quarter = bs.quarter\nORDER BY\n  rd.stock_code,\n  rd.year,\n  rd.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 7.77132773399353,
        "evaluate": 0,
        "input_token": 3288,
        "output_token": 801
    },
    {
        "id": "1ef436da-be56-41ad-a474-7be82fff814b",
        "question": "Rank the top 5 companies with the highest Debt-to-Equity ratio as of December 31, 2023.",
        "answer": "Table 1\n| stock_code   | industry   |   debt_to_equity_ratio |\n|:-------------|:-----------|-----------------------:|\n| BID          | Banking    |                17.7184 |\n| CTG          | Banking    |                15.1483 |\n| STB          | Banking    |                13.746  |\n| HDB          | Banking    |                12.5012 |\n| SHB          | Banking    |                11.5853 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name   | en_company_name   | debt_to_equity_ratio   | rank   |\n|--------------|----------------|-------------------|------------------------|--------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedCompanies AS (\n  SELECT\n    fr.stock_code,\n    fr.data AS debt_to_equity_ratio,\n    ROW_NUMBER() OVER (ORDER BY\n      fr.data DESC) AS rank\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Debt-to-Equity ratio' AND fr.year = 2023 AND fr.quarter = 0\n)\nSELECT\n  ci.stock_code,\n  ci.company_name,\n  ci.en_company_name,\n  rc.debt_to_equity_ratio,\n  rc.rank\nFROM RankedCompanies AS rc\nJOIN company_info AS ci\n  ON rc.stock_code = ci.stock_code\nWHERE\n  rc.rank <= 5\nLIMIT 5;\n"
            }
        ],
        "time": 3.8150827884674072,
        "evaluate": 0,
        "input_token": 6058,
        "output_token": 1201
    },
    {
        "id": "ba73d2eb-be40-43aa-aae0-07913d6003b2",
        "question": "What are the top 10 companies with the lowest Return on Equity (ROE) for the fiscal year 2022?",
        "answer": "Table 1\n| stock_code   | industry                             |    roe_value |\n|:-------------|:-------------------------------------|-------------:|\n| VJC          | Travel and Leisure                   | -0.151828    |\n| NKG          | Basic Resources                      | -0.0234384   |\n| NVB          | Banking                              |  1.38787e-06 |\n| DBC          | Food and Beverages                   |  0.0011191   |\n| NHA          | Construction and Materials           |  0.00438288  |\n| HLD          | Real Estate                          |  0.0115416   |\n| VIC          | Real Estate                          |  0.0150701   |\n| YEG          | Media                                |  0.0274488   |\n| PVG          | Utilities (Electricity, Water & Gas) |  0.032697    |\n| PVC          | Oil and Gas                          |  0.0327001   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe_value\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2022\n    AND fr.quarter = 0\nORDER BY \n    fr.data ASC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | roe   |\n|--------------|-------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.stock_code,\n  fr.data AS roe\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'ROE' AND fr.year = 2022 AND fr.quarter = 0\nORDER BY\n  roe ASC\nLIMIT 10;\n"
            }
        ],
        "time": 3.1843621730804443,
        "evaluate": 0,
        "input_token": 3730,
        "output_token": 548
    },
    {
        "id": "94513aff-57b5-4d36-8a98-bdf527d9190f",
        "question": "What is the trend of the Net Profit Margin ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_profit_margin\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'NPM'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (1, 2))\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| en_company_name   | year   | quarter   | net_profit_margin   |\n|-------------------|--------|-----------|---------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.en_company_name,\n  fr.year,\n  fr.quarter,\n  fr.data AS net_profit_margin\nFROM company_info AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  ci.en_company_name IN ('Joint Stock Commercial Bank For Foreign Trade Of Vietnam', 'Asia Commercial Joint Stock Bank', 'Vietnam Technological And Commercial Joint Stock Bank')\n  AND mcr.ratio_name = 'Net profit margin'\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  ci.en_company_name,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.339111089706421,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "4705a2ab-1bb2-400f-895d-b1eea6557de9",
        "question": "What was the average Return on Equity (ROE) for  Vietcombank,  Techcombank, and  Sacombank in 2022, and how did this compare to their respective subsidiaries' average ROE for the same year?",
        "answer": "Table 1\n| bank_code   |   bank_avg_roe |   subsidiary_avg_roe |\n|:------------|---------------:|---------------------:|\n| STB         |       0.130497 |           nan        |\n| TCB         |       0.180176 |           nan        |\n| VCB         |       0.220567 |             0.170252 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_roe AS (\n    SELECT stock_code, AVG(data) AS avg_roe\n    FROM financial_ratio\n    WHERE ratio_code = 'ROE'\n      AND stock_code IN ('VCB', 'TCB', 'STB')\n      AND year = 2022\n      AND quarter = 0\n    GROUP BY stock_code\n),\nsubsidiary_roe AS (\n    SELECT s.stock_code, AVG(fr.data) AS avg_roe\n    FROM sub_and_shareholder s\n    JOIN financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE s.stock_code IN ('VCB', 'TCB', 'STB')\n      AND fr.ratio_code = 'ROE'\n      AND fr.year = 2022\n      AND fr.quarter = 0\n    GROUP BY s.stock_code\n)\nSELECT b.stock_code AS bank_code, b.avg_roe AS bank_avg_roe, s.avg_roe AS subsidiary_avg_roe\nFROM bank_roe b\nLEFT JOIN subsidiary_roe s ON b.stock_code = s.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   parent_roe |   subsidiary_roe |\n|:-------------|-------------:|-----------------:|\n| STB          |     0.130497 |                0 |\n| TCB          |     0.180176 |                0 |\n| VCB          |     0.220567 |                0 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH ParentROE AS (\n  SELECT\n    fr.stock_code,\n    fr.data AS roe\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year = 2022\n    AND fr.quarter = 0\n    AND fr.stock_code IN ('VCB', 'TCB', 'STB')\n), SubsidiaryROE AS (\n  SELECT\n    s.invest_on AS stock_code,\n    AVG(fr.data) AS roe\n  FROM sub_and_shareholder AS s\n  JOIN financial_ratio AS fr\n    ON s.invest_on = fr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year = 2022\n    AND fr.quarter = 0\n    AND s.stock_code IN ('VCB', 'TCB', 'STB')\n  GROUP BY\n    s.invest_on\n)\nSELECT\n  p.stock_code,\n  p.roe AS parent_roe,\n  COALESCE(s.roe, 0) AS subsidiary_roe\nFROM ParentROE AS p\nLEFT JOIN SubsidiaryROE AS s\n  ON p.stock_code = s.stock_code\nLIMIT 100;\n"
            }
        ],
        "time": 5.807816028594971,
        "evaluate": 0,
        "input_token": 6177,
        "output_token": 973
    },
    {
        "id": "090710f9-3867-4922-9703-fd2af16e09e9",
        "question": "Calculate the Debt-to-Equity ratio for  Vinamilk,  Masan Group, and their significant subsidiaries in 2023 Q2.  Analyze the differences in leverage between the parent companies and their subsidiaries.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|-------:|----------:|-----------------------:|\n| MSN          |   2023 |         2 |               2.75379  |\n| VNM          |   2023 |         2 |               0.390309 |\n| TCB          |   2023 |         2 |               4.98106  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH parent_companies AS (\n    SELECT 'VNM' AS stock_code\n    UNION\n    SELECT 'MSN'\n),\nsubsidiaries AS (\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN (SELECT stock_code FROM parent_companies)\n),\nall_relevant_companies AS (\n    SELECT stock_code FROM parent_companies\n    UNION\n    SELECT stock_code FROM subsidiaries\n)\nSELECT fr.stock_code, fr.year, fr.quarter, fr.data AS debt_to_equity_ratio\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Debt To Equity Ratio'\nAND fr.stock_code IN (SELECT stock_code FROM all_relevant_companies)\nAND fr.year = 2023\nAND fr.quarter = 2;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | en_company_name                                       |   debt_to_equity_ratio |\n|:-------------|:------------------------------------------------------|-----------------------:|\n| MSN          | Masan Group Corporation                               |               2.75379  |\n| VNM          | Vietnam Dairy Products Joint Stock Company            |               0.390309 |\n| TCB          | Vietnam Technological And Commercial Joint Stock Bank |               4.98106  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify relevant company IDs\n\nWITH RelevantCompanies AS (\n    SELECT stock_code\n    FROM company_info\n    WHERE stock_code IN ('VNM', 'MSN') -- Vinamilk and Masan Group\n    UNION\n    SELECT invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('VNM', 'MSN') -- Subsidiaries of Vinamilk and Masan Group\n)\n\n-- Step 2: Retrieve Debt-to-Equity ratio for 2023 Q2\n\nSELECT \n    rc.stock_code,\n    ci.en_company_name,\n    fr.data AS debt_to_equity_ratio\nFROM RelevantCompanies rc\nJOIN company_info ci ON rc.stock_code = ci.stock_code\nJOIN financial_ratio fr ON rc.stock_code = fr.stock_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE fr.year = 2023\n  AND fr.quarter = 2\n  AND mcr.ratio_name = 'Debt To Equity Ratio'\nLIMIT 100;\n\n"
            }
        ],
        "time": 5.361052989959717,
        "evaluate": 0.5,
        "input_token": 3420,
        "output_token": 543
    },
    {
        "id": "bb6f60b5-01dc-41a5-a518-ba2edf9f457b",
        "question": "Compare the evolution of the Debt-to-Equity ratio and the Current Ratio for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Analyze the implications of these ratios on the financial risk profile of each company.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name           |   ratio_value |\n|:-------------|-------:|----------:|:---------------------|--------------:|\n| HPG          |   2020 |         0 | Current Ratio        |      1.09453  |\n| HPG          |   2020 |         0 | Debt To Equity Ratio |      1.22073  |\n| HPG          |   2021 |         0 | Current Ratio        |      1.28577  |\n| HPG          |   2021 |         0 | Debt To Equity Ratio |      0.963375 |\n| HPG          |   2022 |         0 | Current Ratio        |      1.29573  |\n| HPG          |   2022 |         0 | Debt To Equity Ratio |      0.772243 |\n| HPG          |   2023 |         0 | Current Ratio        |      1.16128  |\n| HPG          |   2023 |         0 | Debt To Equity Ratio |      0.826032 |\n| HPG          |   2024 |         2 | Current Ratio        |      1.15441  |\n| HPG          |   2024 |         2 | Debt To Equity Ratio |      0.901137 |\n| MSN          |   2020 |         0 | Current Ratio        |      0.773354 |\n| MSN          |   2020 |         0 | Debt To Equity Ratio |      3.62386  |\n| MSN          |   2021 |         0 | Current Ratio        |      1.27032  |\n| MSN          |   2021 |         0 | Debt To Equity Ratio |      1.97835  |\n| MSN          |   2022 |         0 | Current Ratio        |      0.73558  |\n| MSN          |   2022 |         0 | Debt To Equity Ratio |      2.85795  |\n| MSN          |   2023 |         0 | Current Ratio        |      0.874439 |\n| MSN          |   2023 |         0 | Debt To Equity Ratio |      2.85445  |\n| VNM          |   2020 |         0 | Current Ratio        |      2.09132  |\n| VNM          |   2020 |         0 | Debt To Equity Ratio |      0.439424 |\n| VNM          |   2021 |         0 | Current Ratio        |      2.11895  |\n| VNM          |   2021 |         0 | Debt To Equity Ratio |      0.487649 |\n| VNM          |   2022 |         0 | Current Ratio        |      2.06801  |\n| VNM          |   2022 |         0 | Debt To Equity Ratio |      0.477386 |\n| VNM          |   2023 |         0 | Current Ratio        |      2.1016   |\n| VNM          |   2023 |         0 | Debt To Equity Ratio |      0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'HPG')\n    AND mccr.ratio_name IN ('Debt To Equity Ratio', 'Current Ratio')\n    AND (\n        (fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR\n        (fr.year = 2024 AND fr.quarter = 2)\n    )\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, mccr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | en_company_name                            |   year |   quarter |   Debt-to-Equity Ratio |   Current Ratio |\n|:-------------|:-------------------------------------------|-------:|----------:|-----------------------:|----------------:|\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         0 |               1.22073  |        1.09453  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         1 |               1.13947  |        1.15672  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         2 |               1.14232  |        1.1661   |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         3 |               1.13635  |        1.20774  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         4 |               1.22073  |        1.09658  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         0 |               0.963375 |        1.28577  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         1 |               1.09875  |        1.24475  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         2 |               1.16004  |        1.24071  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         3 |               1.07106  |        1.33701  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         4 |               0.96338  |        1.28576  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         0 |               0.772243 |        1.29573  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         1 |               0.878041 |        1.39032  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         2 |               1.07672  |        1.28758  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         3 |               0.874119 |        1.34087  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         4 |               0.772243 |        1.29573  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         0 |               0.826032 |        1.16128  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         1 |               0.818875 |        1.26262  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         2 |               0.801487 |        1.24127  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         3 |               0.737412 |        1.23076  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         4 |               0.826032 |        1.16128  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2024 |         1 |               0.911868 |        1.19092  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2024 |         2 |               0.901137 |        1.15441  |\n| MSN          | Masan Group Corporation                    |   2020 |         0 |               3.62386  |        0.773354 |\n| MSN          | Masan Group Corporation                    |   2020 |         1 |               1.03768  |        0.943772 |\n| MSN          | Masan Group Corporation                    |   2020 |         2 |               2.36354  |        0.671478 |\n| MSN          | Masan Group Corporation                    |   2020 |         3 |               2.82101  |        0.69027  |\n| MSN          | Masan Group Corporation                    |   2020 |         4 |               3.62386  |        0.773354 |\n| MSN          | Masan Group Corporation                    |   2021 |         0 |               1.97835  |        1.27032  |\n| MSN          | Masan Group Corporation                    |   2021 |         1 |               3.5765   |        0.838925 |\n| MSN          | Masan Group Corporation                    |   2021 |         2 |               2.83936  |        0.913651 |\n| MSN          | Masan Group Corporation                    |   2021 |         3 |               2.81245  |        0.935449 |\n| MSN          | Masan Group Corporation                    |   2021 |         4 |               1.97835  |        1.27032  |\n| MSN          | Masan Group Corporation                    |   2022 |         0 |               2.85795  |        0.73558  |\n| MSN          | Masan Group Corporation                    |   2022 |         1 |               2.38294  |        1.00047  |\n| MSN          | Masan Group Corporation                    |   2022 |         2 |               2.22866  |        0.709978 |\n| MSN          | Masan Group Corporation                    |   2022 |         3 |               2.60746  |        0.585935 |\n| MSN          | Masan Group Corporation                    |   2022 |         4 |               2.85795  |        0.73558  |\n| MSN          | Masan Group Corporation                    |   2023 |         0 |               2.85445  |        0.874439 |\n| MSN          | Masan Group Corporation                    |   2023 |         1 |               2.92883  |        0.851707 |\n| MSN          | Masan Group Corporation                    |   2023 |         2 |               2.75379  |        0.804937 |\n| MSN          | Masan Group Corporation                    |   2023 |         3 |               2.81036  |        0.893996 |\n| MSN          | Masan Group Corporation                    |   2023 |         4 |               2.85445  |        0.874439 |\n| MSN          | Masan Group Corporation                    |   2024 |         1 |               2.77309  |        0.87025  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         0 |               0.439424 |        2.09132  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         1 |               0.428786 |        2.00177  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         2 |               0.532862 |        1.80774  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         3 |               0.590219 |        1.73972  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         4 |               0.439424 |        2.09132  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         0 |               0.487649 |        2.11895  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         1 |               0.5031   |        1.99828  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         2 |               0.543159 |        1.93904  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         3 |               0.537059 |        1.9431   |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         4 |               0.487649 |        2.11895  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         0 |               0.477386 |        2.06801  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         1 |               0.515144 |        2.01857  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         2 |               0.462287 |        2.22061  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         3 |               0.512803 |        2.03288  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         4 |               0.477386 |        2.06801  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2023 |         0 |               0.503847 |        2.1016   |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2023 |         1 |               0.427542 |        2.25658  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2023 |         2 |               0.390309 |        2.43804  |\n| VNM          | Vietnam Dairy Products Joint Stock Co",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    stock_code IN ('VNM', 'MSN', 'HPG')\n)\nSELECT\n  ci.stock_code,\n  ci.en_company_name,\n  fr.year,\n  fr.quarter,\n  MAX(CASE WHEN fr.ratio_code = 'DTER' THEN fr.data ELSE NULL END) AS \"Debt-to-Equity Ratio\",\n  MAX(CASE WHEN fr.ratio_code = 'CurrentR' THEN fr.data ELSE NULL END) AS \"Current Ratio\"\nFROM CompanyCodes AS cc\nJOIN company_info AS ci\n  ON cc.stock_code = ci.stock_code\nLEFT JOIN financial_ratio AS fr\n  ON cc.stock_code = fr.stock_code\nWHERE\n  fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nGROUP BY\n  ci.stock_code,\n  ci.en_company_name,\n  fr.year,\n  fr.quarter\nORDER BY\n  ci.stock_code,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 7.371253728866577,
        "evaluate": 0.5,
        "input_token": 5537,
        "output_token": 1287
    },
    {
        "id": "113431fd-d8a9-4fcc-b8e4-44bb3cc73663",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) in 2023, based on their financial statements.",
        "answer": "Table 1\n| stock_code   | industry           |      roe |\n|:-------------|:-------------------|---------:|\n| TMB          | Basic Resources    | 0.476625 |\n| SLS          | Food and Beverages | 0.443074 |\n| CAP          | Basic Resources    | 0.43171  |\n| SAF          | Food and Beverages | 0.2894   |\n| DGC          | Chemicals          | 0.269533 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |      roe |   roe_rank |\n|:-------------|---------:|-----------:|\n| TMB          | 0.476625 |          1 |\n| SLS          | 0.443074 |          2 |\n| CAP          | 0.43171  |          3 |\n| SAF          | 0.2894   |          4 |\n| DGC          | 0.269533 |          5 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedROE AS (\n  SELECT\n    stock_code,\n    data AS roe,\n    RANK() OVER (\n      ORDER BY\n        data DESC\n    ) AS roe_rank\n  FROM financial_ratio\n  WHERE\n    ratio_code = 'ROE' AND year = 2023 AND quarter = 0\n)\nSELECT\n  stock_code,\n  roe,\n  roe_rank\nFROM RankedROE\nWHERE\n  roe_rank <= 5\nLIMIT 5;\n"
            }
        ],
        "time": 3.256225109100342,
        "evaluate": 1,
        "input_token": 6382,
        "output_token": 1131
    },
    {
        "id": "1f330071-6ed3-48d3-912a-2bad5446636b",
        "question": "For Q4 2023, what was the Debt-to-Equity ratio for Mobile World Investment and Vinamilk, and how do these ratios change when considering the debt and equity of their subsidiaries and associated companies?",
        "answer": "Table 1\n| entity_type   | stock_code   | invest_on   |     dter |\n|:--------------|:-------------|:------------|---------:|\n| Parent        | MWG          |             | 1.57316  |\n| Parent        | VNM          |             | 0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify subsidiaries and associated companies for MWG and VNM\nWITH subsidiaries AS (\n    SELECT stock_code, invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('MWG', 'VNM')\n),\n\n-- Step 2: Retrieve Debt-to-Equity Ratio for MWG and VNM for Q4 2023\nparent_dter AS (\n    SELECT stock_code, data AS dter\n    FROM financial_ratio\n    WHERE ratio_code = 'DTER'\n      AND stock_code IN ('MWG', 'VNM')\n      AND year = 2023\n      AND quarter = 4\n),\n\n-- Step 3: Retrieve Debt-to-Equity Ratio for subsidiaries and associated companies for Q4 2023\nsubsidiary_dter AS (\n    SELECT s.stock_code, s.invest_on, fr.data AS dter\n    FROM subsidiaries s\n    JOIN financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE fr.ratio_code = 'DTER'\n      AND fr.year = 2023\n      AND fr.quarter = 4\n)\n\n-- Step 4: Combine the results\nSELECT 'Parent' AS entity_type, stock_code, NULL AS invest_on, dter\nFROM parent_dter\nUNION ALL\nSELECT 'Subsidiary', stock_code, invest_on, dter\nFROM subsidiary_dter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | en_company_name                            |   debt_to_equity_ratio |\n|:-------------|:-------------------------------------------|-----------------------:|\n| MWG          | Mobile World Investment Corporation        |               1.57316  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |               0.503847 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve Debt-to-Equity ratio for MWG and VNM in Q4 2023.  The database schema does not \n-- provide a way to distinguish between consolidated and parent-company-only financial statements.\n-- The query below retrieves the Debt-to-Equity ratio for the specified companies and quarter.  \n--  Further analysis in Step 2 will address the limitations of not having consolidated/parent-only data distinction.\n\nSELECT \n    fr.stock_code,\n    ci.en_company_name,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nJOIN\n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    mcr.ratio_name = 'Debt To Equity Ratio'\n    AND fr.year = 2023\n    AND fr.quarter = 4\n    AND fr.stock_code IN ('MWG', 'VNM')\nLIMIT 2;\n\n\n-- Step 2: Analysis (This is not SQL, but an outline of the analysis that would follow the query above)\n\n-- The SQL query above retrieves the Debt-to-Equity ratio for MWG and VNM for Q4 2023.  \n-- To perform a complete analysis as requested,  we would need additional information:\n\n-- 1. Consolidated vs. Parent Company Data: The database lacks a mechanism to differentiate between \n--    consolidated and parent-company-only financial statements.  Therefore, the query's results \n--    represent a single Debt-to-Equity ratio for each company, without a breakdown based on \n--    consolidation scope.\n\n-- 2. Subsidiary Data: To incorporate subsidiary data, we would need to join the `financial_ratio` table \n--    with the `sub_and_shareholder` table. However, this requires the assumption that the `financial_ratio` \n--    table contains entries for both parent companies and their subsidiaries, which is not guaranteed by the \n--    provided schema.  The `financial_ratio` table might only contain data for the parent companies.\n\n-- 3. Interpretation: Once we obtain the Debt-to-Equity ratios (with or without subsidiary data, depending \n--    on data availability), we would compare the ratios for MWG and VNM.  A higher ratio indicates higher \n--    financial leverage (more debt relative to equity).  The inclusion of subsidiary data would likely \n--    affect the ratio, potentially increasing or decreasing it depending on the subsidiaries' financial \n--    health.  A significant difference between the ratios (if subsidiary data were available) would warrant \n--    further investigation into the financial positions of the subsidiaries.\n\n-- In summary, the SQL query provides a starting point.  A complete analysis requires enhancements to the \n-- database schema to explicitly track consolidated vs. parent-company data and potentially additional data \n-- within the `financial_ratio` table to represent subsidiary financial information.\n"
            }
        ],
        "time": 7.4503173828125,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "12a7a240-a91a-45cd-b870-50f2826a2e66",
        "question": "What are the top 10 companies with the lowest Debt-to-Equity ratio from 2020 to Q2 2024, calculated as Total Debt divided by Total Equity, and how did this ratio change for each company over this period?",
        "answer": "Table 1\n| stock_code   | company_name                                                  |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|:--------------------------------------------------------------|-------:|----------:|-----------------------:|\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2023 |         0 |               0.102494 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2020 |         0 |               0.125015 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2023 |         0 |               0.136624 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2020 |         0 |               0.17039  |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2023 |         0 |               0.176222 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2024 |         2 |               0.179365 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2021 |         0 |               0.188442 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2022 |         0 |               0.200008 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2024 |         2 |               0.206202 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2024 |         2 |               0.209858 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2022 |         0 |               0.216221 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2021 |         0 |               0.235643 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2022 |         0 |               0.237365 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2023 |         0 |               0.259786 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2020 |         0 |               0.276946 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2022 |         0 |               0.277531 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2021 |         0 |               0.277955 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2021 |         0 |               0.287564 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2020 |         0 |               0.290342 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2023 |         0 |               0.291759 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2023 |         0 |               0.297329 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2024 |         2 |               0.310486 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2022 |         0 |               0.33581  |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2023 |         0 |               0.336332 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2023 |         0 |               0.343894 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2023 |         0 |               0.344899 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2021 |         0 |               0.345608 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2021 |         0 |               0.349295 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2022 |         0 |               0.351281 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2022 |         0 |               0.353514 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2020 |         0 |               0.357263 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2024 |         2 |               0.359095 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2022 |         0 |               0.368554 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2024 |         2 |               0.369029 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2020 |         0 |               0.377942 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2023 |         0 |               0.394739 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2022 |         0 |               0.401541 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2022 |         0 |               0.402429 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2021 |         0 |               0.406165 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2020 |         0 |               0.408761 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2021 |         0 |               0.414164 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2023 |         0 |               0.419899 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2020 |         0 |               0.423653 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2024 |         2 |               0.435372 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2022 |         0 |               0.43865  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2020 |         0 |               0.439424 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2020 |         0 |               0.444683 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2023 |         0 |               0.457793 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2020 |         0 |               0.463731 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2022 |         0 |               0.46592  |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2023 |         0 |               0.471272 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2020 |         0 |               0.474374 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2022 |         0 |               0.477386 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2021 |         0 |               0.480607 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2024 |         2 |               0.483638 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2021 |         0 |               0.487649 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2023 |         0 |               0.503847 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2020 |         0 |               0.504436 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2023 |         0 |               0.508928 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2021 |         0 |               0.509177 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2021 |         0 |               0.521258 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2023 |         0 |               0.529397 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2021 |         0 |               0.543834 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2020 |         0 |               0.545038 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2023 |         0 |               0.554623 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2020 |         0 |               0.560901 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2022 |         0 |               0.561239 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2021 |         0 |               0.563492 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2020 |         0 |               0.569625 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2021 |         0 |               0.571747 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2024 |         2 |               0.576112 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2022 |         0 |               0.579462 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2023 |         0 |               0.581221 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2023 |         0 |               0.593005 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2023 |         0 |               0.603542 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2020 |         0 |               0.618346 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2022 |         0 |               0.632072 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2021 |         0 |               0.642793 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2023 |         0 |               0.660318 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2022 |         0 |               0.682692 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2024 |         2 |               0.687472 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2022 |         0 |               0.694971 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2021 |         0 |               0.702049 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2024 |         2 |               0.705204 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2023 |         0 |               0.705913 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2022 |         0 |               0.707956 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2020 |         0 |               0.708054 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2023 |         0 |               0.719185 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2021 |         0 |               0.722437 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2023 |         0 |               0.722593 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2022 |         0 |               0.725978 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2022 |         0 |               0.728122 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2020 |         0 |               0.728687 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2023 |         0 |               0.750505 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2021 |         0 |               0.751401 |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2021 |         0 |               0.754212 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2021 |         0 |               0.755797 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2021 |         0 |               0.766117 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2020 |         0 |               0.766169 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2022 |         0 |               0.772243 |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2023 |         0 |               0.772254 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2022 |         0 |               0.778332 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2021 |         0 |               0.779472 |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2024 |         2 |               0.78104  |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2022 |         0 |               0.788825 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2021 |         0 |               0.794179 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2021 |         0 |               0.808803 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2022 |         0 |               0.815038 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2021 |         0 |               0.816257 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2023 |         0 |               0.826032 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2022 |         0 |               0.826206 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2022 |         0 |               0.839544 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2021 |         0 |               0.845713 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2024 |         2 |               0.874097 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2022 |         0 |               0.898412 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2024 |         2 |               0.901137 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2024 |         2 |               0.93525  |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2023 |         0 |               0.936787 |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2021 |         0 |               0.941665 |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2024 |         2 |               0.949132 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2023 |         0 |               0.950352 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2021 |         0 |               0.963375 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2020 |         0 |               0.974251 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2020 |         0 |               0.975521 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2021 |         0 |               0.982156 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2021 |         0 |               0.991947 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2022 |         0 |               0.994639 |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2023 |         0 |               1.01392  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2023 |         0 |               1.02916  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2020 |         0 |               1.03173  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2022 |         0 |               1.037    |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2020 |         0 |               1.03966  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2023 |         0 |               1.04948  |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2023 |         0 |               1.06223  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2022 |         0 |               1.09689  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2022 |         0 |               1.10132  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2021 |         0 |               1.11143  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2024 |         2 |               1.12275  |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2022 |         0 |               1.13455  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2020 |         0 |               1.14525  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2022 |         0 |               1.1527   |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2020 |         0 |               1.22073  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2023 |         0 |               1.22591  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2020 |         0 |               1.2431   |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2023 |         0 |               1.25617  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2021 |         0 |               1.25925  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2024 |         2 |               1.26119  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2021 |         0 |               1.29267  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2021 |         0 |               1.31812  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2021 |         0 |               1.32573  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2022 |         0 |               1.33297  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2021 |         0 |               1.34428  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2024 |         2 |               1.35003  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2023 |         0 |               1.35495  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2023 |         0 |               1.36439  |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2024 |         2 |               1.36986  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2022 |         0 |               1.37252  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2024 |         2 |               1.39121  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2020 |         0 |               1.40109  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2020 |         0 |               1.41587  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2023 |         0 |               1.43451  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2022 |         0 |               1.43609  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2020 |         0 |               1.44044  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2023 |         0 |               1.46271  |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2021 |         0 |               1.47419  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2024 |         2 |               1.48784  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2021 |         0 |               1.50714  |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2023 |         0 |               1.51354  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2022 |         0 |               1.53038  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2020 |         0 |               1.53275  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2021 |         0 |               1.54511  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2020 |         0 |               1.5662   |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2023 |         0 |               1.5733   |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2024 |         2 |               1.60012  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2022 |         0 |               1.68066  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2021 |         0 |               1.68459  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2021 |         0 |               1.69044  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2022 |         0 |               1.69096  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2022 |         0 |               1.69426  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2024 |         2 |               1.72785  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2023 |         0 |               1.7435   |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2024 |         2 |               1.77546  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2023 |         0 |               1.78848  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2022 |         0 |               1.7954   |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2023 |         0 |               1.81978  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2021 |         0 |               1.84053  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2021 |         0 |               1.85522  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2021 |         0 |               1.89752  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2024 |         2 |               1.90154  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2020 |         0 |               1.91758  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2022 |         0 |               1.92198  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2022 |         0 |               1.95208  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2020 |         0 |               1.97325  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2021 |         0 |               1.97835  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2021 |         0 |               1.98675  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2022 |         0 |               2.00309  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2023 |         0 |               2.00446  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2020 |         0 |               2.01747  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2021 |         0 |               2.06474  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2021 |         0 |               2.09013  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2020 |         0 |               2.09671  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2020 |         0 |               2.11001  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2023 |         0 |               2.15907  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2022 |         0 |               2.20557  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2024 |         2 |               2.21151  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2020 |         0 |               2.22173  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2023 |         0 |               2.22761  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2024 |         2 |               2.26609  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2020 |         0 |               2.28019  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2021 |         0 |               2.51506  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2021 |         0 |               2.53892  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2021 |         0 |               2.71025  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2023 |         0 |               2.72341  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2020 |         0 |               2.74222  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2022 |         0 |               2.76126  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2023 |         0 |               2.85445  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2022 |         0 |               2.85795  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2020 |         0 |               2.88006  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2023 |         0 |               3.0692   |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2022 |         0 |               3.07163  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2021 |         0 |               3.09964  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2022 |         0 |               3.12368  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2022 |         0 |               3.25643  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2021 |         0 |               3.27534  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2020 |         0 |               3.39756  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2024 |         2 |               3.41035  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2024 |         2 |               3.44847  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2023 |         0 |               3.50444  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2020 |         0 |               3.52636  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2022 |         0 |               3.56676  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2020 |         0 |               3.62386  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2021 |         0 |               3.90207  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2022 |         0 |               4.03591  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2022 |         0 |               4.13522  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2020 |         0 |               4.17725  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2023 |         0 |               4.33049  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2021 |         0 |               4.3342   |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2023 |         0 |               4.66769  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2023 |         0 |               4.69525  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2023 |         0 |               4.69885  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2022 |         0 |               4.73317  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2022 |         0 |               4.75073  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2023 |         0 |               4.84831  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2020 |         0 |               4.89163  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2021 |         0 |               5.01874  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2022 |         0 |               5.09663  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2021 |         0 |               5.11264  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2022 |         0 |               5.16295  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2024 |         2 |               5.26066  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2021 |         0 |               5.34471  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2021 |         0 |               5.42305  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2023 |         0 |               5.50936  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2024 |         2 |               5.6117   |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2024 |         2 |               5.64646  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2020 |         0 |               5.67617  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2022 |         0 |               5.71337  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2020 |         0 |               5.90465  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2023 |         0 |               6.61905  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2022 |         0 |               6.67618  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2020 |         0 |               6.93709  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2024 |         2 |               7.08423  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2023 |         0 |               7.41452  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2021 |         0 |               7.46095  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2020 |         0 |               7.74824  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2023 |         0 |               7.9738   |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2022 |         0 |               8.03598  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2022 |         0 |               8.1509   |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2023 |         0 |               8.16639  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2021 |         0 |               8.32431  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2020 |         0 |               8.53865  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2021 |         0 |               8.71642  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2023 |         0 |               8.77089  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2020 |         0 |               8.87998  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2020 |         0 |               8.96134  |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2022 |         0 |               8.97033  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2023 |         0 |               9.13015  |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2022 |         0 |               9.19368  |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2021 |         0 |               9.31087  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2022 |         0 |               9.40194  |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2022 |         0 |               9.49887  |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2022 |         0 |               9.67507  |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2023 |         0 |               9.80353  |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2023 |         0 |               9.89194  |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2023 |         0 |              10.1483   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2023 |         0 |              10.2219   |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2021 |         0 |              10.2682   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2024 |         2 |              10.3055   |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2021 |         0 |              10.7541   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2024 |         2 |              10.8215   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2023 |         0 |              11.0259   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2021 |         0 |              11.1666   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2020 |         0 |              11.2966   |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2020 |         0 |              11.3214   |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2020 |         0 |              11.5403   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2023 |         0 |              11.5853   |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2021 |         0 |              11.7422   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2022 |         0 |              11.8402   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2020 |         0 |              11.918    |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2021 |         0 |              11.9647   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2020 |         0 |              12.0583   |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2022 |         0 |              12.3717   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2023 |         0 |              12.5012   |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2020 |         0 |              12.6129   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2022 |         0 |              12.6248   |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2020 |         0 |              13.0946   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2021 |         0 |              13.2578   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2023 |         0 |              13.746    |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2021 |         0 |              14.2101   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2022 |         0 |              14.3237   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2022 |         0 |              14.587    |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2020 |         0 |              14.7056   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2023 |         0 |              15.1483   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2021 |         0 |              15.3545   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2022 |         0 |              15.7188   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2020 |         0 |              16.009    |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2020 |         0 |              16.0284   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2021 |         0 |              16.212    |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2021 |         0 |              16.3027   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2024 |         2 |              17.7161   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2023 |         0 |              17.7184   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2020 |         0 |              18.0427   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2024 |         2 |              19.2545   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2022 |         0 |              19.3533   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2021 |         0 |              19.4068   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2020 |         0 |              20.0192   |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2022 |         0 |             nan        |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH RankedCompanies AS (\n    SELECT \n        fr.stock_code,\n        ci.company_name,\n        fr.year,\n        fr.quarter,\n        fr.data AS debt_to_equity_ratio,\n        ROW_NUMBER() OVER (PARTITION BY fr.stock_code ORDER BY fr.data ASC) AS rn\n    FROM \n        financial_ratio fr\n    JOIN \n        company_info ci ON fr.stock_code = ci.stock_code\n    WHERE \n        fr.ratio_code = 'DTER'\n        AND ((fr.year = 2020 AND fr.quarter = 0) OR\n             (fr.year = 2021 AND fr.quarter = 0) OR\n             (fr.year = 2022 AND fr.quarter = 0) OR\n             (fr.year = 2023 AND fr.quarter = 0) OR\n             (fr.year = 2024 AND fr.quarter = 2))\n)\nSELECT \n    rc.stock_code,\n    rc.company_name,\n    rc.year,\n    rc.quarter,\n    rc.debt_to_equity_ratio\nFROM \n    RankedCompanies rc\nWHERE \n    rc.rn <= 10\nORDER BY \n    rc.debt_to_equity_ratio ASC, rc.stock_code, rc.year, rc.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry   | year   | quarter   | debt_to_equity_ratio   |\n|--------------|------------|--------|-----------|------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedRatios AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS debt_to_equity_ratio,\n    ROW_NUMBER() OVER (PARTITION BY fr.stock_code ORDER BY fr.year, fr.quarter) AS rn\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Debt-to-Equity ratio'\n    AND fr.year >= 2020\n    AND (\n      fr.year < 2024\n      OR (\n        fr.year = 2024\n        AND fr.quarter <= 2\n      )\n    )\n  ORDER BY\n    fr.data ASC\n), Top10Companies AS (\n  SELECT\n    stock_code\n  FROM RankedRatios\n  GROUP BY\n    stock_code\n  ORDER BY\n    AVG(debt_to_equity_ratio) ASC\n  LIMIT 10\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  rr.year,\n  rr.quarter,\n  rr.debt_to_equity_ratio\nFROM RankedRatios AS rr\nJOIN Top10Companies AS tc\n  ON rr.stock_code = tc.stock_code\nJOIN company_info AS ci\n  ON rr.stock_code = ci.stock_code\nORDER BY\n  rr.stock_code,\n  rr.year,\n  rr.quarter;\n"
            }
        ],
        "time": 5.181565284729004,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "6ef05b65-adaa-4959-805b-0f7a613617fd",
        "question": "What is the trend of Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (1, 2))\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs.\nWITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('VCB', 'TCB', 'ACB')\n)\n\n-- Step 2: Extract ROE trends.\nSELECT\n  ci.stock_code,\n  ci.en_company_name,\n  fr.year,\n  fr.quarter,\n  fr.data AS roe\nFROM CompanyIDs AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY\n  ci.stock_code,\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.443062782287598,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "a43c12a4-c2cc-4354-b458-0878a4f70bd0",
        "question": "Rank the top 5 companies with the highest Current Ratio as of December 31, 2023, among companies with total assets exceeding 100 billion VND.",
        "answer": "Table 1\n| stock_code   | industry           |   current_ratio |\n|:-------------|:-------------------|----------------:|\n| HLD          | Real Estate        |         7.25278 |\n| EIB          | Banking            |         6.12482 |\n| TCH          | Real Estate        |         6.00022 |\n| ABB          | Banking            |         5.488   |\n| SLS          | Food and Beverages |         4.98219 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TotalAssets AS (\n    SELECT stock_code\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n    UNION\n    SELECT stock_code\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n    UNION\n    SELECT stock_code\n    FROM securities_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n),\nCurrentRatios AS (\n    SELECT fr.stock_code, fr.data AS current_ratio\n    FROM financial_ratio fr\n    JOIN TotalAssets ta ON fr.stock_code = ta.stock_code\n    WHERE fr.ratio_code = 'CurrentR' AND fr.year = 2023 AND fr.quarter = 0\n)\nSELECT ci.stock_code, ci.industry, cr.current_ratio\nFROM CurrentRatios cr\nJOIN company_info ci ON cr.stock_code = ci.stock_code\nORDER BY cr.current_ratio DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | current_ratio   |\n|--------------|-----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- There's no information on total assets or a specific \"Current Ratio\" code in the provided schema.\n-- The following query assumes the existence of a 'Current Ratio' ratio_code in 'map_category_code_ratio' and that total assets are represented by a category code in the financial reports.  \n--  Replace 'BS_XXX' with the actual category code for total assets and 'CR' with the actual ratio code for Current Ratio.  This query also needs adjustment based on which financial report table (bank, non-bank, securities) holds the relevant asset data.\n\nWITH RelevantCompanies AS (\n    -- Assuming total assets are in one of the financial report tables.  Adjust table name as needed.\n    SELECT DISTINCT stock_code\n    FROM bank_financial_report  -- Or non_bank_financial_report or securities_financial_report\n    WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_XXX' AND data > 100000 -- 100 billion VND\n),\nCurrentRatios AS (\n    SELECT \n        rc.stock_code,\n        fr.data as current_ratio\n    FROM RelevantCompanies rc\n    JOIN financial_ratio fr ON rc.stock_code = fr.stock_code\n    WHERE fr.ratio_code = 'CR' AND fr.year = 2023 AND fr.quarter = 0\n)\nSELECT \n    stock_code, \n    current_ratio\nFROM CurrentRatios\nORDER BY current_ratio DESC\nLIMIT 5;\n\n"
            }
        ],
        "time": 4.716273784637451,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "eefe39ae-6424-47d5-ac08-482fc8f15531",
        "question": "For the top 10 companies with Net Income greater than 1,000,000,000,000 VND in 2023, what are their respective Net Profit Margins and Current Ratios?",
        "answer": "Table 1\n| stock_code   | net_profit_margin   | current_ratio   |\n|--------------|---------------------|-----------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TopCompanies AS (\n    SELECT\n        stock_code,\n        SUM(data) AS net_income\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'IS_021' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'IS_030' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'IS_400' AND year = 2023 AND quarter = 0\n    ) AS combined_reports\n    GROUP BY stock_code\n    HAVING SUM(data) > 1000000\n    ORDER BY net_income DESC\n    LIMIT 10\n)\n\nSELECT\n    tc.stock_code,\n    fr1.data AS net_profit_margin,\n    fr2.data AS current_ratio\nFROM\n    TopCompanies tc\nJOIN financial_ratio fr1 ON tc.stock_code = fr1.stock_code\n    AND fr1.ratio_code = 'NPM' AND fr1.year = 2023 AND fr1.quarter = 0\nJOIN financial_ratio fr2 ON tc.stock_code = fr2.stock_code\n    AND fr2.ratio_code = 'CurrentR' AND fr2.year = 2023 AND fr2.quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | netprofitmargin   | currentratio   |\n|--------------|-------------------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH Top10Companies AS (\n  SELECT\n    stock_code\n  FROM (\n    SELECT\n      stock_code,\n      SUM(CASE WHEN category_code = 'IS_003' THEN data ELSE 0 END) AS NetIncome\n    FROM (\n      SELECT\n        stock_code,\n        category_code,\n        data\n      FROM bank_financial_report\n      WHERE\n        year = 2023 AND quarter = 0\n      UNION ALL\n      SELECT\n        stock_code,\n        category_code,\n        data\n      FROM non_bank_financial_report\n      WHERE\n        year = 2023 AND quarter = 0\n      UNION ALL\n      SELECT\n        stock_code,\n        category_code,\n        data\n      FROM securities_financial_report\n      WHERE\n        year = 2023 AND quarter = 0\n    ) AS AllFinancialReports\n    GROUP BY\n      stock_code\n    HAVING\n      SUM(CASE WHEN category_code = 'IS_003' THEN data ELSE 0 END) > 1000000000000\n    ORDER BY\n      NetIncome DESC\n    LIMIT 10\n  ) AS TopCompanies\n)\nSELECT\n  tc.stock_code,\n  MAX(CASE WHEN fr.ratio_code = 'ratio_net_profit_margin' THEN fr.data ELSE NULL END) AS NetProfitMargin,\n  MAX(CASE WHEN fr.ratio_code = 'ratio_current_ratio' THEN fr.data ELSE NULL END) AS CurrentRatio\nFROM Top10Companies AS tc\nJOIN financial_ratio AS fr\n  ON tc.stock_code = fr.stock_code\nWHERE\n  fr.year = 2023 AND fr.quarter = 0\nGROUP BY\n  tc.stock_code;\n"
            }
        ],
        "time": 5.6220996379852295,
        "evaluate": 0,
        "input_token": 12929,
        "output_token": 2409
    },
    {
        "id": "5c4964d0-adc2-4847-9751-de6fad125d24",
        "question": "Calculate the Gross Profit Margin for Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.  Further, compute the year-on-year growth rate of the Gross Profit Margin for each company during this period.",
        "answer": "Table 1\n| stock_code   |   year |   avg_gpm |   yoy_growth_rate |\n|:-------------|-------:|----------:|------------------:|\n| MSN          |   2020 |  0.231665 |         nan       |\n| MSN          |   2021 |  0.249747 |           7.80519 |\n| MSN          |   2022 |  0.276089 |          10.5474  |\n| MSN          |   2023 |  0.282692 |           2.39156 |\n| SAB          |   2020 |  0.30403  |         nan       |\n| SAB          |   2021 |  0.28849  |          -5.11146 |\n| SAB          |   2022 |  0.307918 |           6.73451 |\n| SAB          |   2023 |  0.298455 |          -3.07321 |\n| VNM          |   2020 |  0.463956 |         nan       |\n| VNM          |   2021 |  0.431363 |          -7.02496 |\n| VNM          |   2022 |  0.398578 |          -7.60046 |\n| VNM          |   2023 |  0.406579 |           2.00742 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH GPM_data AS (\n    SELECT \n        fr.stock_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS gpm\n    FROM \n        financial_ratio fr\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Gross Profit Margin' AND\n        fr.stock_code IN ('VNM', 'MSN', 'SAB') AND\n        ((fr.year BETWEEN 2020 AND 2024) AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter <= 2)))\n),\nYearly_GPM AS (\n    SELECT \n        stock_code,\n        year,\n        AVG(gpm) AS avg_gpm\n    FROM \n        GPM_data\n    WHERE \n        quarter = 0\n    GROUP BY \n        stock_code, year\n),\nGrowth_Rate AS (\n    SELECT \n        a.stock_code,\n        a.year,\n        a.avg_gpm,\n        ((a.avg_gpm - b.avg_gpm) / NULLIF(b.avg_gpm, 0)) * 100 AS yoy_growth_rate\n    FROM \n        Yearly_GPM a\n    LEFT JOIN \n        Yearly_GPM b ON a.stock_code = b.stock_code AND a.year = b.year + 1\n)\nSELECT \n    stock_code,\n    year,\n    avg_gpm,\n    yoy_growth_rate\nFROM \n    Growth_Rate\nORDER BY \n    stock_code, year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n')\n),\nGrossProfitMargin AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS gross_profit_margin\n  FROM financial_ratio fr\n  JOIN CompanyCodes cc ON fr.stock_code = cc.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE mcr.ratio_name = 'Gross Profit Margin'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\n),\nYearlyGrossProfitMargin AS (\n  SELECT\n    stock_code,\n    year,\n    MAX(gross_profit_margin) AS yearly_gross_profit_margin\n  FROM GrossProfitMargin\n  WHERE quarter = 0\n  GROUP BY stock_code, year\n),\nGrowthRates AS (\n  SELECT\n    y1.stock_code,\n    y1.year,\n    (y1.yearly_gross_profit_margin - COALESCE(y2.yearly_gross_profit_margin, 0))::numeric / COALESCE(y2.yearly_gross_profit_margin, 1) * 100 AS growth_rate\n  FROM YearlyGrossProfitMargin y1\n  LEFT JOIN YearlyGrossProfitMargin y2 ON y1.stock_code = y2.stock_code AND y1.year = y2.year + 1\n)\nSELECT\n  cc.company_name,\n  ygm.year,\n  ygm.yearly_gross_profit_margin,\n  COALESCE(gr.growth_rate, 0) AS year_on_year_growth_rate\nFROM YearlyGrossProfitMargin ygm\nJOIN CompanyCodes cc ON ygm.stock_code = cc.stock_code\nLEFT JOIN GrowthRates gr ON ygm.stock_code = gr.stock_code AND ygm.year = gr.year\nORDER BY cc.company_name, ygm.year\nLIMIT 100;\n"
            }
        ],
        "time": 6.700191259384155,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "5f48b85d-d6f3-4010-a6f8-22f11cfaa754",
        "question": "What is the breakdown of equity investments (including both subsidiaries and other investments) for Mobile World Investment and its return on equity (ROE) for the fiscal year 2023?",
        "answer": "Table 1\n| category_code   | en_caption                                  |   data |\n|:----------------|:--------------------------------------------|-------:|\n| BS_213          | Business capital at subsidiaries            |      0 |\n| BS_251          | Investment in subsidiaries                  |      0 |\n| BS_252          | Investment in associates and joint ventures | 286632 |\n| BS_253          | Investment in other entities                |      0 |\n\nTable 2\n|       roe |\n|----------:|\n| 0.0071846 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to get the breakdown of equity investments for MWG in 2023\nSELECT \n    nbfr.category_code,\n    mccnb.en_caption,\n    nbfr.data\nFROM \n    non_bank_financial_report nbfr\nJOIN \n    map_category_code_non_bank mccnb ON nbfr.category_code = mccnb.category_code\nWHERE \n    nbfr.stock_code = 'MWG'\n    AND nbfr.year = 2023\n    AND nbfr.quarter = 0\n    AND nbfr.category_code IN ('BS_213', 'BS_251', 'BS_252', 'BS_253');\n\n-- Query to get the ROE for MWG in 2023\nSELECT \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code = 'MWG'\n    AND fr.year = 2023\n    AND fr.quarter = 0\n    AND mccr.ratio_name = 'Return On Equity';\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| invest_on   | roe   |\n|-------------|-------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH mwi_investments AS (\n  SELECT\n    invest_on\n  FROM sub_and_shareholder\n  WHERE\n    stock_code = 'MWG'\n), mwi_roe AS (\n  SELECT\n    data AS roe\n  FROM financial_ratio\n  WHERE\n    stock_code = 'MWG'\n    AND year = 2023\n    AND quarter = 0\n    AND ratio_code = 'ROE' -- Assuming ROE ratio code is 'ROE'.  Replace if different.\n)\nSELECT\n  i.invest_on,\n  r.roe\nFROM mwi_investments AS i\nCROSS JOIN mwi_roe AS r\nLIMIT 100;\n"
            }
        ],
        "time": 3.9217934608459473,
        "evaluate": 0,
        "input_token": 8385,
        "output_token": 1262
    },
    {
        "id": "6ebec9aa-2d66-4d22-a45a-a7e6114dad2b",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) \n        OR (year = 2024 AND quarter BETWEEN 1 AND 2)\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n|   year |   quarter | en_company_name                                          |         roe |\n|-------:|----------:|:---------------------------------------------------------|------------:|\n|   2020 |         0 | Asia Commercial Joint Stock Bank                         |   0.216734  |\n|   2020 |         1 | Asia Commercial Joint Stock Bank                         |   0.0522587 |\n|   2020 |         2 | Asia Commercial Joint Stock Bank                         |   0.0493524 |\n|   2020 |         3 | Asia Commercial Joint Stock Bank                         |   0.0630206 |\n|   2020 |         4 | Asia Commercial Joint Stock Bank                         |   0.0719231 |\n|   2021 |         0 | Asia Commercial Joint Stock Bank                         |   0.213865  |\n|   2021 |         1 | Asia Commercial Joint Stock Bank                         |   0.0654744 |\n|   2021 |         2 | Asia Commercial Joint Stock Bank                         |   0.0640966 |\n|   2021 |         3 | Asia Commercial Joint Stock Bank                         |   0.0494926 |\n|   2021 |         4 | Asia Commercial Joint Stock Bank                         |   0.0540857 |\n|   2022 |         0 | Asia Commercial Joint Stock Bank                         |   0.234232  |\n|   2022 |         1 | Asia Commercial Joint Stock Bank                         |   0.0682014 |\n|   2022 |         2 | Asia Commercial Joint Stock Bank                         |   0.0757336 |\n|   2022 |         3 | Asia Commercial Joint Stock Bank                         |   0.0643583 |\n|   2022 |         4 | Asia Commercial Joint Stock Bank                         |   0.0491202 |\n|   2023 |         0 | Asia Commercial Joint Stock Bank                         |   0.226122  |\n|   2023 |         1 | Asia Commercial Joint Stock Bank                         |   0.0661285 |\n|   2023 |         2 | Asia Commercial Joint Stock Bank                         | nan         |\n|   2023 |         3 | Asia Commercial Joint Stock Bank                         |   0.0604199 |\n|   2024 |         1 | Asia Commercial Joint Stock Bank                         |   0.052218  |\n|   2020 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.196318  |\n|   2020 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0491661 |\n|   2020 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0515214 |\n|   2020 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0427012 |\n|   2020 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0573927 |\n|   2021 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.201059  |\n|   2021 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0683861 |\n|   2021 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0377385 |\n|   2021 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.1084    |\n|   2021 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0580801 |\n|   2022 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.220567  |\n|   2022 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0680525 |\n|   2022 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0483124 |\n|   2022 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0472737 |\n|   2022 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0719881 |\n|   2023 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.200315  |\n|   2023 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0621596 |\n|   2023 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.139806  |\n|   2023 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.045712  |\n|   2023 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0555349 |\n|   2024 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0494831 |\n|   2020 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.168632  |\n|   2020 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0387928 |\n|   2020 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0428449 |\n|   2020 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0450409 |\n|   2020 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0537099 |\n|   2021 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.197927  |\n|   2021 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0565945 |\n|   2021 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0572896 |\n|   2021 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0501452 |\n|   2021 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0503334 |\n|   2022 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.180176  |\n|   2022 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0569507 |\n|   2022 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0562806 |\n|   2022 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0488406 |\n|   2022 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.031493  |\n|   2023 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.139608  |\n|   2023 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0384612 |\n|   2023 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0367734 |\n|   2023 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0367239 |\n|   2023 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0381519 |\n|   2024 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0459854 |\n|   2024 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0457096 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.year,\n  fr.quarter,\n  ci.en_company_name,\n  fr.data AS roe\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND ci.en_company_name IN ('Joint Stock Commercial Bank For Foreign Trade Of Vietnam', 'Asia Commercial Joint Stock Bank', 'Vietnam Technological And Commercial Joint Stock Bank')\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  ci.en_company_name,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.435594797134399,
        "evaluate": 0.5,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "0529969a-2008-4b24-bc19-022d11d2ecc6",
        "question": "What were the values of Total Assets, Total Liabilities, and Net Income for Vinamilk, Masan Group, and PetroVietnam Gas for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   | en_caption                           |        data |\n|:-------------|:-------------------------------------|------------:|\n| VNM          | Net profit from operating activities | 1.09036e+07 |\n| MSN          | Net profit from operating activities | 2.35043e+06 |\n| GAS          | Net profit from operating activities | 1.46191e+07 |\n| GAS          | TOTAL ASSETS                         | 8.77545e+07 |\n| GAS          | C. LIABILITIES                       | 2.24558e+07 |\n| VNM          | TOTAL ASSETS                         | 5.26734e+07 |\n| VNM          | C. LIABILITIES                       | 1.76476e+07 |\n| MSN          | TOTAL ASSETS                         | 1.47383e+08 |\n| MSN          | C. LIABILITIES                       | 1.09146e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN', 'GAS') \n    AND nfr.year = 2023 \n    AND nfr.quarter = 0 \n    AND nfr.category_code IN ('BS_270', 'BS_300', 'IS_030');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs.\nWITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n')\n)\n\n-- Step 2: Retrieve financial data.  This assumes that Total Assets, Total Liabilities, and Net Income exist in map_category_code_non_bank.  You'll need to replace the category codes below with the actual codes from your map_category_code_non_bank table.  The example codes are placeholders.\nSELECT\n  ci.company_name,\n  COALESCE(SUM(CASE WHEN nbfr.category_code = 'BS_100' THEN nbfr.data ELSE 0 END),0) AS Total_Assets,  -- Replace 'BS_100' with actual code for Total Assets\n  COALESCE(SUM(CASE WHEN nbfr.category_code = 'BS_200' THEN nbfr.data ELSE 0 END),0) AS Total_Liabilities, -- Replace 'BS_200' with actual code for Total Liabilities\n  COALESCE(SUM(CASE WHEN nbfr.category_code = 'IS_001' THEN nbfr.data ELSE 0 END),0) AS Net_Income       -- Replace 'IS_001' with actual code for Net Income\nFROM CompanyIDs AS ci\nJOIN company_info AS info ON ci.stock_code = info.stock_code\nLEFT JOIN non_bank_financial_report AS nbfr ON ci.stock_code = nbfr.stock_code AND nbfr.year = 2023 AND nbfr.quarter = 0\nGROUP BY ci.company_name\nLIMIT 3;\n\n"
            }
        ],
        "time": 5.864533185958862,
        "evaluate": 0,
        "input_token": 4452,
        "output_token": 825
    },
    {
        "id": "514613cf-7002-4698-a3b7-93db835122c6",
        "question": "Rank the top 5 companies with total assets greater than 100,000 billion VND as of December 31, 2023, based on their Return on Equity (ROE).",
        "answer": "Table 1\n| stock_code   | industry   |      roe |\n|:-------------|:-----------|---------:|\n| HDB          | Banking    | 0.232433 |\n| ACB          | Banking    | 0.226122 |\n| VIB          | Banking    | 0.225702 |\n| MBB          | Banking    | 0.217698 |\n| VCB          | Banking    | 0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT \n        stock_code,\n        SUM(data) AS total_assets\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n    ) AS combined_assets\n    GROUP BY stock_code\n    HAVING SUM(data) > 100000000\n)\n\nSELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    total_assets ta ON fr.stock_code = ta.stock_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE' AND fr.year = 2023 AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| VHM          | 0.183605  |\n| VIC          | 0.0138715 |\n| NVL          | 0.0107248 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- There's no direct information on total assets in the provided schema.\n-- The query below assumes a `BS_100` category code represents total assets, \n-- and a `ratio_code` of 'ROE' exists in `map_category_code_ratio` for Return on Equity.\n--  Adjust `BS_100` and 'ROE' if different category codes are used in your actual database.\n\nWITH TopCompanies AS (\n    SELECT \n        ci.stock_code\n    FROM \n        company_info ci\n    JOIN \n        (SELECT stock_code, data AS total_assets FROM bank_financial_report WHERE category_code = 'BS_100' AND year = 2023 AND quarter = 0\n        UNION ALL\n        SELECT stock_code, data AS total_assets FROM non_bank_financial_report WHERE category_code = 'BS_100' AND year = 2023 AND quarter = 0\n        UNION ALL\n        SELECT stock_code, data AS total_assets FROM securities_financial_report WHERE category_code = 'BS_100' AND year = 2023 AND quarter = 0) as assets\n        ON ci.stock_code = assets.stock_code\n    WHERE \n        total_assets > 100000000 \n)\n\nSELECT \n    tc.stock_code,\n    fr.data AS roe\nFROM \n    TopCompanies tc\nJOIN \n    financial_ratio fr ON tc.stock_code = fr.stock_code\nWHERE \n    fr.ratio_code = 'ROE' AND fr.year = 2023 AND fr.quarter = 0\nORDER BY \n    roe DESC\nLIMIT 5;\n\n"
            }
        ],
        "time": 4.924239635467529,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "c831d896-2da0-445e-8184-0699fc43e0db",
        "question": "What is the trend of Net Profit Margin for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_profit_margin\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'NPM' \n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual reports from 2020 to 2023\n        OR \n        (year = 2024 AND quarter IN (1, 2)) -- Quarterly reports for Q1 and Q2 of 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| year   | quarter   | net_profit_margin   |\n|--------|-----------|---------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.year,\n  fr.quarter,\n  fr.data AS net_profit_margin\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Net profit margin'\n  AND ci.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.221615791320801,
        "evaluate": 0,
        "input_token": 5871,
        "output_token": 1058
    },
    {
        "id": "a6c11447-d4dd-4ae8-99b8-57138309a422",
        "question": "Show the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Calculate the average ROE for each company over this period.",
        "answer": "Table 1\n| stock_code   |   average_roe |\n|:-------------|--------------:|\n| HPG          |     0.136672  |\n| MSN          |     0.0970669 |\n| VNM          |     0.242186  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    AVG(data) AS average_roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    stock_code IN ('VNM', 'MSN', 'HPG') AND\n    ((year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n    (year = 2024 AND quarter IN (1, 2)))\nGROUP BY \n    stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| company_name                      |   year |   quarter |         roe |   avg_roe |\n|:----------------------------------|-------:|----------:|------------:|----------:|\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         0 |  0.333928   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         1 |  0.0861112  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         2 |  0.095333   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         3 |  0.0990225  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         4 |  0.0664599  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         0 |  0.296583   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         1 |  0.0764615  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         2 |  0.0832651  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         3 |  0.0874017  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         4 |  0.0617182  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         0 |  0.26138    | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         1 |  0.06528    | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         2 |  0.057095   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         3 |  0.0686339  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         4 |  0.0569567  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         0 |  0.257506   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         1 |  0.0552366  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         2 |  0.112804   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         3 |  0.0745011  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         4 |  0.0671136  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2024 |         1 |  0.0615314  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         0 |  0.228068   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         1 |  0.0460368  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         2 |  0.0524064  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         3 |  0.0688363  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         4 |  0.0787021  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         0 |  0.380268   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         1 |  0.10579    | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         2 |  0.131719   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         3 |  0.122748   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         4 |  0.0817293  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         0 |  0.0878594  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         1 |  0.0829275  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         2 |  0.0402598  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         3 | -0.0182075  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         4 | -0.020796   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         0 |  0.0661282  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         1 |  0.00397384 | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         2 |  0.0147948  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         3 |  0.0200306  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         4 |  0.0288708  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2024 |         1 |  0.027164   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2024 |         2 |  0.0305454  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         0 |  0.055733   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         1 | -0.00419562 | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         2 |  0.00174282 | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         3 |  0.0340108  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         4 |  0.0233474  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         0 |  0.238597   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         1 |  0.0134906  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         2 |  0.0335106  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         3 |  0.0490112  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         4 |  0.168149   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         0 |  0.129771   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         1 |  0.0515801  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         2 |  0.0313142  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         3 |  0.0236221  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         4 |  0.021933   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         0 |  0.0489033  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         1 |  0.0118431  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         2 |  0.0114376  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         3 |  0.0127258  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         4 |  0.013515   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2024 |         1 |  0.0123309  | 0.0467796 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t')\n),\nROEData AS (\n  SELECT\n    ci.company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS roe\n  FROM financial_ratio fr\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN CompanyCodes cc ON fr.stock_code = cc.stock_code\n  WHERE mcr.ratio_name = 'Return On Equity'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\n)\nSELECT\n  company_name,\n  year,\n  quarter,\n  roe,\n  AVG(roe) OVER (PARTITION BY company_name) AS avg_roe\nFROM ROEData\nORDER BY company_name, year, quarter\nLIMIT 100;\n"
            }
        ],
        "time": 5.303208351135254,
        "evaluate": 0,
        "input_token": 2762,
        "output_token": 364
    },
    {
        "id": "14f189a3-a158-450b-9b00-6970b80da60a",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) among Vietcombank, Techcombank, ACB, BIDV, and VPBank for the period from 2020 to Q2 2024.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |      roe |\n|:-------------|-------:|----------:|---------:|\n| ACB          |   2022 |         0 | 0.234232 |\n| ACB          |   2023 |         0 | 0.226122 |\n| VCB          |   2022 |         0 | 0.220567 |\n| ACB          |   2020 |         0 | 0.216734 |\n| ACB          |   2021 |         0 | 0.213865 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, year, quarter, data AS roe\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'VPB')\n  AND (\n    (year = 2024 AND quarter <= 2) OR\n    (year BETWEEN 2020 AND 2023 AND quarter = 0)\n  )\nORDER BY roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name                                                       |       roe |   year |   quarter |\n|:-------------|:----------------------------------------------------------------------|----------:|-------:|----------:|\n| BID          | Joint Stock Commercial Bank for Investment and Development of Vietnam | 0.0485079 |   2024 |         2 |\n| TCB          | Vietnam Technological And Commercial Joint Stock Bank                 | 0.0457096 |   2024 |         2 |\n| VPB          | Vietnam Prosperity Joint Stock Commercial Bank                        | 0.026311  |   2024 |         2 |\n| ACB          | Asia Commercial Joint Stock Bank                                      | 0.052218  |   2024 |         1 |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam              | 0.0494831 |   2024 |         1 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedROE AS (\n  SELECT\n    ci.stock_code,\n    ci.en_company_name,\n    fr.data AS roe,\n    fr.year,\n    fr.quarter,\n    RANK() OVER (PARTITION BY fr.year, fr.quarter ORDER BY fr.data DESC) AS rank_within_year_quarter\n  FROM company_info AS ci\n  JOIN financial_ratio AS fr\n    ON ci.stock_code = fr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND ci.stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'VPB')\n    AND fr.year >= 2020\n    AND (\n      fr.quarter = 0\n      OR fr.quarter IN (1, 2)\n    )\n)\nSELECT\n  stock_code,\n  en_company_name,\n  roe,\n  year,\n  quarter\nFROM RankedROE\nWHERE\n  rank_within_year_quarter <= 5\nORDER BY\n  year DESC,\n  quarter DESC,\n  rank_within_year_quarter ASC\nLIMIT 5;\n"
            }
        ],
        "time": 5.39182186126709,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "0139ac4a-8687-4aac-a031-3b29b413d83a",
        "question": "For the period 2020-Q2 2024, which 10 companies have the highest total assets,  with the condition that total assets must be greater than 100 billion VND?",
        "answer": "Table 1\n| stock_code   |   total_assets |\n|:-------------|---------------:|\n| BID          |    3.1738e+10  |\n| CTG          |    2.57372e+10 |\n| VCB          |    2.56522e+10 |\n| TCB          |    1.1165e+10  |\n| VPB          |    9.8242e+09  |\n| VIC          |    9.36372e+09 |\n| MBB          |    9.02315e+09 |\n| STB          |    8.76012e+09 |\n| SHB          |    8.57265e+09 |\n| ACB          |    7.8037e+09  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN bank_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_300'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n\n    UNION ALL\n\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN non_bank_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_270'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n\n    UNION ALL\n\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN securities_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_270'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n)\n\nSELECT\n    t.stock_code,\n    t.total_assets\nFROM\n    total_assets t\nWHERE\n    t.total_assets > 100000\nORDER BY\n    t.total_assets DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry                             |\n|:-------------|:-------------------------------------|\n| VIC          | Real Estate                          |\n| VHM          | Real Estate                          |\n| NVL          | Real Estate                          |\n| HPG          | Basic Resources                      |\n| GAS          | Utilities (Electricity, Water & Gas) |\n| MWG          | Retail                               |\n| SSI          | Financial Services                   |\n| PLX          | Oil and Gas                          |\n| MSN          | Food and Beverages                   |\n| VGI          | Telecommunications                   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH ConsolidatedAssets AS (\n  SELECT\n    stock_code,\n    SUM(data) AS total_assets\n  FROM (\n    SELECT\n      stock_code,\n      data\n    FROM bank_financial_report\n    WHERE\n      year >= 2020\n      AND (\n        quarter = 0\n        OR quarter BETWEEN 1 AND 2\n      )\n      AND category_code = 'BS_100' -- Assuming BS_100 represents Total Assets.  Adjust if needed.\n    UNION ALL\n    SELECT\n      stock_code,\n      data\n    FROM non_bank_financial_report\n    WHERE\n      year >= 2020\n      AND (\n        quarter = 0\n        OR quarter BETWEEN 1 AND 2\n      )\n      AND category_code = 'BS_100' -- Assuming BS_100 represents Total Assets. Adjust if needed.\n    UNION ALL\n    SELECT\n      stock_code,\n      data\n    FROM securities_financial_report\n    WHERE\n      year >= 2020\n      AND (\n        quarter = 0\n        OR quarter BETWEEN 1 AND 2\n      )\n      AND category_code = 'BS_100' -- Assuming BS_100 represents Total Assets. Adjust if needed.\n  ) AS AllReports\n  GROUP BY\n    stock_code\n  HAVING\n    SUM(data) > 100000\n)\nSELECT\n  ci.stock_code,\n  ci.industry\nFROM ConsolidatedAssets\nJOIN company_info AS ci\n  ON ConsolidatedAssets.stock_code = ci.stock_code\nORDER BY\n  total_assets DESC\nLIMIT 10;\n"
            }
        ],
        "time": 5.348229169845581,
        "evaluate": 0,
        "input_token": 4636,
        "output_token": 686
    },
    {
        "id": "62907a1f-3544-4f00-acbc-9099a5fa6f67",
        "question": "What were the Return on Equity (ROE) and Debt-to-Equity ratios for Vietcombank and Techcombank in 2023?",
        "answer": "Table 1\n| stock_code   | ratio_code   |      data |\n|:-------------|:-------------|----------:|\n| TCB          | DTER         |  5.50936  |\n| VCB          | DTER         | 10.1483   |\n| TCB          | ROE          |  0.139608 |\n| VCB          | ROE          |  0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    ratio_code, \n    data \nFROM \n    financial_ratio \nWHERE \n    (stock_code = 'VCB' OR stock_code = 'TCB') \n    AND year = 2023 \n    AND quarter = 0 \n    AND (ratio_code = 'ROE' OR ratio_code = 'DTER');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| ratio_code   |      data |\n|:-------------|----------:|\n| DTER         |  5.50936  |\n| DTER         | 10.1483   |\n| ROE          |  0.139608 |\n| ROE          |  0.200315 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  f.ratio_code,\n  f.data\nFROM financial_ratio AS f\nJOIN company_info AS c\n  ON f.stock_code = c.stock_code\nWHERE\n  (\n    c.en_company_name = 'Joint Stock Commercial Bank For Foreign Trade Of Vietnam' OR c.en_company_name = 'Vietnam Technological And Commercial Joint Stock Bank'\n  )\n  AND f.year = 2023\n  AND f.quarter = 0\n  AND f.ratio_code IN ('ROE', 'DTER')\nLIMIT 10;\n"
            }
        ],
        "time": 3.769213914871216,
        "evaluate": 0,
        "input_token": 6285,
        "output_token": 1174
    },
    {
        "id": "c7ee3213-142c-4b94-ac63-6f90c9317169",
        "question": "What is the trend of Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024, considering their respective subsidiaries' financial performance?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |       roe |\n|-------:|----------:|:-------------|----------:|\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2020 |         0 | EIB          | 0.0636274 |\n|   2020 |         0 | EIB          | 0.0636274 |\n|   2020 |         0 | EIB          | 0.0636274 |\n|   2021 |         0 | EIB          | 0.0542841 |\n|   2021 |         0 | EIB          | 0.0542841 |\n|   2021 |         0 | EIB          | 0.0542841 |\n|   2022 |         0 | EIB          | 0.143836  |\n|   2022 |         0 | EIB          | 0.143836  |\n|   2022 |         0 | EIB          | 0.143836  |\n|   2023 |         0 | EIB          | 0.0964624 |\n|   2023 |         0 | EIB          | 0.0964624 |\n|   2023 |         0 | EIB          | 0.0964624 |\n|   2024 |         1 | EIB          | 0.0229559 |\n|   2024 |         1 | EIB          | 0.0229559 |\n|   2024 |         1 | EIB          | 0.0229559 |\n|   2020 |         0 | MBB          | 0.171779  |\n|   2020 |         0 | MBB          | 0.171779  |\n|   2021 |         0 | MBB          | 0.21159   |\n|   2021 |         0 | MBB          | 0.21159   |\n|   2022 |         0 | MBB          | 0.228042  |\n|   2022 |         0 | MBB          | 0.228042  |\n|   2023 |         0 | MBB          | 0.217698  |\n|   2023 |         0 | MBB          | 0.217698  |\n|   2020 |         0 | MSN          | 0.055733  |\n|   2021 |         0 | MSN          | 0.238597  |\n|   2022 |         0 | MSN          | 0.129771  |\n|   2023 |         0 | MSN          | 0.0489033 |\n|   2024 |         1 | MSN          | 0.0123309 |\n|   2020 |         0 | OCB          | 0.202736  |\n|   2020 |         0 | OCB          | 0.202736  |\n|   2021 |         0 | OCB          | 0.202016  |\n|   2021 |         0 | OCB          | 0.202016  |\n|   2022 |         0 | OCB          | 0.138876  |\n|   2022 |         0 | OCB          | 0.138876  |\n|   2023 |         0 | OCB          | 0.11576   |\n|   2023 |         0 | OCB          | 0.11576   |\n|   2024 |         1 | OCB          | 0.03233   |\n|   2024 |         1 | OCB          | 0.03233   |\n|   2020 |         0 | PVT          | 0.132256  |\n|   2021 |         0 | PVT          | 0.119846  |\n|   2022 |         0 | PVT          | 0.144227  |\n|   2023 |         0 | PVT          | 0.135265  |\n|   2024 |         1 | PVT          | 0.0327416 |\n|   2024 |         2 | PVT          | 0.0394265 |\n|   2020 |         0 | TCB          | 0.168632  |\n|   2020 |         0 | TCB          | 0.168632  |\n|   2020 |         0 | TCB          | 0.168632  |\n|   2021 |         0 | TCB          | 0.197927  |\n|   2021 |         0 | TCB          | 0.197927  |\n|   2021 |         0 | TCB          | 0.197927  |\n|   2022 |         0 | TCB          | 0.180176  |\n|   2022 |         0 | TCB          | 0.180176  |\n|   2022 |         0 | TCB          | 0.180176  |\n|   2023 |         0 | TCB          | 0.139608  |\n|   2023 |         0 | TCB          | 0.139608  |\n|   2023 |         0 | TCB          | 0.139608  |\n|   2024 |         1 | TCB          | 0.0459854 |\n|   2024 |         1 | TCB          | 0.0459854 |\n|   2024 |         1 | TCB          | 0.0459854 |\n|   2024 |         2 | TCB          | 0.0457096 |\n|   2024 |         2 | TCB          | 0.0457096 |\n|   2024 |         2 | TCB          | 0.0457096 |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    fr.stock_code, \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    sub_and_shareholder ssh ON fr.stock_code = ssh.stock_code OR fr.stock_code = ssh.invest_on\nWHERE \n    mccr.ratio_name = 'Return On Equity'\n    AND (ssh.stock_code IN ('VCB', 'TCB', 'ACB') OR ssh.invest_on IN ('VCB', 'TCB', 'ACB'))\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY \n    fr.stock_code, \n    fr.year, \n    fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |   year |   quarter |          roe |\n|:-------------|-------:|----------:|-------------:|\n| ACB          |   2020 |         0 |   0.216734   |\n| ACB          |   2020 |         1 |   0.0522587  |\n| ACB          |   2020 |         2 |   0.0493524  |\n| ACB          |   2020 |         3 |   0.0630206  |\n| ACB          |   2020 |         4 |   0.0719231  |\n| ACB          |   2021 |         0 |   0.213865   |\n| ACB          |   2021 |         1 |   0.0654744  |\n| ACB          |   2021 |         2 |   0.0640966  |\n| ACB          |   2021 |         3 |   0.0494926  |\n| ACB          |   2021 |         4 |   0.0540857  |\n| ACB          |   2022 |         0 |   0.234232   |\n| ACB          |   2022 |         1 |   0.0682014  |\n| ACB          |   2022 |         2 |   0.0757336  |\n| ACB          |   2022 |         3 |   0.0643583  |\n| ACB          |   2022 |         4 |   0.0491202  |\n| ACB          |   2023 |         0 |   0.226122   |\n| ACB          |   2023 |         1 |   0.0661285  |\n| ACB          |   2023 |         2 | nan          |\n| ACB          |   2023 |         3 |   0.0604199  |\n| ACB          |   2024 |         1 |   0.052218   |\n| EIB          |   2020 |         0 |   0.0636274  |\n| EIB          |   2020 |         1 |   0.0226563  |\n| EIB          |   2020 |         2 |   0.00463626 |\n| EIB          |   2020 |         3 |   0.0259155  |\n| EIB          |   2020 |         4 |   0.0118351  |\n| EIB          |   2021 |         0 |   0.0542841  |\n| EIB          |   2021 |         1 |   0.0101296  |\n| EIB          |   2021 |         2 |   0.015775   |\n| EIB          |   2021 |         3 |   0.0186707  |\n| EIB          |   2021 |         4 |   0.0107492  |\n| EIB          |   2022 |         0 |   0.143836   |\n| EIB          |   2022 |         1 |   0.0350819  |\n| EIB          |   2022 |         2 |   0.0456879  |\n| EIB          |   2022 |         3 |   0.050865   |\n| EIB          |   2022 |         4 |   0.0197067  |\n| EIB          |   2023 |         0 |   0.0964624  |\n| EIB          |   2023 |         1 |   0.0329119  |\n| EIB          |   2023 |         2 |   0.0197283  |\n| EIB          |   2023 |         3 |   0.0111711  |\n| EIB          |   2024 |         1 |   0.0229559  |\n| MBB          |   2020 |         0 |   0.171779   |\n| MBB          |   2020 |         1 |   0.0405342  |\n| MBB          |   2020 |         2 |   0.0521778  |\n| MBB          |   2020 |         3 |   0.0502199  |\n| MBB          |   2020 |         4 |   0.0401243  |\n| MBB          |   2021 |         0 |   0.21159    |\n| MBB          |   2021 |         1 |   0.0682441  |\n| MBB          |   2021 |         2 |   0.0488157  |\n| MBB          |   2021 |         3 |   0.0530561  |\n| MBB          |   2021 |         4 |   0.0592516  |\n| MBB          |   2022 |         0 |   0.228042   |\n| MBB          |   2022 |         1 |   0.0704771  |\n| MBB          |   2022 |         2 |   0.0676073  |\n| MBB          |   2022 |         3 |   0.0663274  |\n| MBB          |   2022 |         4 |   0.0452189  |\n| MBB          |   2023 |         0 |   0.217698   |\n| MBB          |   2023 |         1 |   0.0614098  |\n| MBB          |   2023 |         2 |   0.0578888  |\n| MBB          |   2023 |         3 |   0.063432   |\n| OCB          |   2020 |         0 |   0.202736   |\n| OCB          |   2020 |         1 |   0.0713619  |\n| OCB          |   2020 |         2 |   0.039273   |\n| OCB          |   2020 |         3 |   0.0325253  |\n| OCB          |   2020 |         4 |   0.087555   |\n| OCB          |   2021 |         0 |   0.202016   |\n| OCB          |   2021 |         1 |   0.0547977  |\n| OCB          |   2021 |         2 |   0.056709   |\n| OCB          |   2021 |         3 |   0.0433367  |\n| OCB          |   2021 |         4 |   0.0642113  |\n| OCB          |   2022 |         0 |   0.138876   |\n| OCB          |   2022 |         1 |   0.0297372  |\n| OCB          |   2022 |         2 |   0.0312123  |\n| OCB          |   2022 |         3 |   0.0304543  |\n| OCB          |   2022 |         4 |   0.055069   |\n| OCB          |   2023 |         0 |   0.11576    |\n| OCB          |   2023 |         1 |   0.030181   |\n| OCB          |   2023 |         2 |   0.046235   |\n| OCB          |   2023 |         3 |   0.0382103  |\n| OCB          |   2024 |         1 |   0.03233    |\n| PVT          |   2020 |         0 |   0.132256   |\n| PVT          |   2020 |         1 |   0.0153572  |\n| PVT          |   2020 |         2 |   0.0400373  |\n| PVT          |   2020 |         3 |   0.0282293  |\n| PVT          |   2020 |         4 |   0.0498216  |\n| PVT          |   2021 |         0 |   0.119846   |\n| PVT          |   2021 |         1 |   0.0269294  |\n| PVT          |   2021 |         2 |   0.0408744  |\n| PVT          |   2021 |         3 |   0.0230505  |\n| PVT          |   2021 |         4 |   0.0337111  |\n| PVT          |   2022 |         0 |   0.144227   |\n| PVT          |   2022 |         1 |   0.0271063  |\n| PVT          |   2022 |         2 |   0.0360822  |\n| PVT          |   2022 |         3 |   0.0505561  |\n| PVT          |   2022 |         4 |   0.0344706  |\n| PVT          |   2023 |         0 |   0.135265   |\n| PVT          |   2023 |         1 |   0.0291099  |\n| PVT          |   2023 |         2 |   0.045119   |\n| PVT          |   2023 |         3 |   0.0370064  |\n| PVT          |   2023 |         4 |   0.0296613  |\n| PVT          |   2024 |         1 |   0.0327416  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify relevant company IDs.\nWITH ParentCompanies AS (\n    SELECT stock_code\n    FROM company_info\n    WHERE stock_code IN ('VCB', 'TCB', 'ACB')\n),\nSubsidiaries AS (\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN (SELECT stock_code FROM ParentCompanies)\n),\nAllCompanies AS (\n    SELECT stock_code FROM ParentCompanies\n    UNION\n    SELECT stock_code FROM Subsidiaries\n)\n\n-- Step 2: Extract ROE data.\nSELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS roe\nFROM financial_ratio fr\nJOIN AllCompanies ac ON fr.stock_code = ac.stock_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Return On Equity'\nAND fr.year >= 2020\nAND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <=2))\nORDER BY fr.stock_code, fr.year, fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 5.321015357971191,
        "evaluate": 0,
        "input_token": 4873,
        "output_token": 595
    },
    {
        "id": "360e3adc-d07d-4357-9c84-5526619e7f5f",
        "question": "How has the Net Profit Margin of Vinamilk, Masan Group, and other companies with significant investments in subsidiaries evolved from 2020 to Q2 2024?  Analyze this considering the profitability contributions from their subsidiaries.",
        "answer": "Table 1\n| stock_code   | en_company_name   | year   | quarter   | net_profit_margin   |\n|--------------|-------------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.en_company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS net_profit_margin\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nLEFT JOIN \n    sub_and_shareholder ss ON ci.stock_code = ss.stock_code\nWHERE \n    mccr.ratio_name = 'Net profit margin'\n    AND (ci.stock_code = 'VNM' OR ci.stock_code = 'MSN' OR ss.stock_code IS NOT NULL)\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantCompanies AS (\n  SELECT\n    ci.stock_code\n  FROM company_info AS ci\n  JOIN sub_and_shareholder AS sas\n    ON ci.stock_code = sas.stock_code\n  WHERE\n    ci.stock_code IN ('VNM', 'MSN')\n    OR ci.industry = 'Food and Beverages'\n), NetProfitMarginData AS (\n  SELECT\n    f.stock_code,\n    f.year,\n    f.quarter,\n    f.data AS net_profit_margin\n  FROM financial_ratio AS f\n  JOIN RelevantCompanies AS rc\n    ON f.stock_code = rc.stock_code\n  WHERE\n    f.ratio_code = 'NPM'\n    AND f.year >= 2020\n    AND (\n      f.year < 2024\n      OR (\n        f.year = 2024\n        AND f.quarter <= 2\n      )\n    )\n)\nSELECT\n  npmd.stock_code,\n  npmd.year,\n  npmd.quarter,\n  npmd.net_profit_margin\nFROM NetProfitMarginData AS npmd\nORDER BY\n  npmd.stock_code,\n  npmd.year,\n  npmd.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 6.3646156787872314,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "e2b68420-a9fe-4c34-b33a-0b2f2f44c423",
        "question": "Compare the operating cash flow and capital expenditures of Vinamilk and Masan Group for the period from 2020 to Q2 2024.  Calculate the free cash flow for each company during this period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |   free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|-----------------:|\n| MSN          |   2020 |         0 |           1.3513e+06  |           -3.67816e+06 |      5.02946e+06 |\n| MSN          |   2021 |         0 |           1.14391e+06 |           -2.80543e+06 |      3.94934e+06 |\n| MSN          |   2022 |         0 |          -3.78885e+06 |           -4.16532e+06 | 376469           |\n| MSN          |   2023 |         0 |      500461           |           -2.2288e+06  |      2.72926e+06 |\n| MSN          |   2024 |         1 |      -35373           |      -396763           | 361390           |\n| VNM          |   2020 |         0 |           1.01802e+07 |           -1.26482e+06 |      1.1445e+07  |\n| VNM          |   2021 |         0 |           9.43197e+06 |           -1.53102e+06 |      1.0963e+07  |\n| VNM          |   2022 |         0 |           8.82727e+06 |           -1.45691e+06 |      1.02842e+07 |\n| VNM          |   2023 |         0 |           7.88742e+06 |           -1.57964e+06 |      9.46706e+06 |\n| VNM          |   2024 |         1 |      907549           |      -378452           |      1.286e+06   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nbfr.stock_code,\n    nbfr.year,\n    nbfr.quarter,\n    SUM(CASE WHEN nbfr.category_code = 'CF_020' THEN nbfr.data ELSE 0 END) AS operating_cash_flow,\n    SUM(CASE WHEN nbfr.category_code = 'CF_021' THEN nbfr.data ELSE 0 END) AS capital_expenditures,\n    SUM(CASE WHEN nbfr.category_code = 'CF_020' THEN nbfr.data ELSE 0 END) - \n    SUM(CASE WHEN nbfr.category_code = 'CF_021' THEN nbfr.data ELSE 0 END) AS free_cash_flow\nFROM \n    non_bank_financial_report nbfr\nWHERE \n    nbfr.stock_code IN ('VNM', 'MSN') AND\n    ((nbfr.year = 2020 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2021 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2022 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2023 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2024 AND nbfr.quarter <= 2))\n    AND nbfr.category_code IN ('CF_020', 'CF_021')\nGROUP BY \n    nbfr.stock_code, nbfr.year, nbfr.quarter\nORDER BY \n    nbfr.stock_code, nbfr.year, nbfr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |    free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|------------------:|\n| MSN          |   2020 |         0 |           2.32484e+06 |           -1.34166e+06 |       3.6665e+06  |\n| MSN          |   2020 |         1 |      -60255           |            1.06252e+06 |      -1.12277e+06 |\n| MSN          |   2020 |         2 |      251140           |            2.11097e+06 |      -1.85983e+06 |\n| MSN          |   2021 |         0 |           1.14888e+07 |            0           |       1.14888e+07 |\n| MSN          |   2021 |         1 |      487053           |            1.22248e+06 | -735431           |\n| MSN          |   2021 |         2 |           1.62892e+06 |            2.36325e+06 | -734332           |\n| MSN          |   2022 |         0 |           5.14715e+06 |            4.40652e+06 |  740627           |\n| MSN          |   2022 |         1 |           0           |            0           |       0           |\n| MSN          |   2022 |         2 |           3.33495e+06 |            2.2044e+06  |       1.13056e+06 |\n| MSN          |   2023 |         0 |           2.56297e+06 |            4.00656e+06 |      -1.44358e+06 |\n| MSN          |   2023 |         1 |      581345           |            1.08496e+06 | -503616           |\n| MSN          |   2023 |         2 |           1.03224e+06 |            2.03165e+06 | -999411           |\n| MSN          |   2024 |         1 |      633663           |            1.04377e+06 | -410105           |\n| VNM          |   2020 |         0 |           1.35185e+07 |            2.81702e+06 |       1.07015e+07 |\n| VNM          |   2020 |         1 |           3.35826e+06 |        67364           |       3.2909e+06  |\n| VNM          |   2020 |         2 |           7.06964e+06 |       134910           |       6.93473e+06 |\n| VNM          |   2021 |         0 |           1.29222e+07 |            2.36688e+06 |       1.05554e+07 |\n| VNM          |   2021 |         1 |           3.15391e+06 |        61385           |       3.09252e+06 |\n| VNM          |   2021 |         2 |           6.6476e+06  |       122770           |       6.52482e+06 |\n| VNM          |   2022 |         0 |           1.04955e+07 |            2.34099e+06 |       8.15454e+06 |\n| VNM          |   2022 |         1 |           2.76435e+06 |       537371           |       2.22698e+06 |\n| VNM          |   2022 |         2 |           5.34041e+06 |            1.17982e+06 |       4.16059e+06 |\n| VNM          |   2023 |         0 |           1.09679e+07 |            2.30013e+06 |       8.66777e+06 |\n| VNM          |   2023 |         1 |           2.31205e+06 |       529307           |       1.78274e+06 |\n| VNM          |   2023 |         2 |           5.04004e+06 |            1.16788e+06 |       3.87216e+06 |\n| VNM          |   2024 |         1 |           2.70584e+06 |       566009           |       2.13983e+06 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve operating cash flow and capital expenditures data.  Since the provided schema \n-- does not contain readily available \"Operating Cash Flow\" and \"Capital Expenditures\" fields, \n-- we need to make assumptions based on common accounting practices and the available `map_category_code_non_bank` table.\n--  This requires knowing the `category_code` values that represent these items in the `non_bank_financial_report` table.\n--  Replace 'CF_XXX' with the actual category codes for operating cash flow and capital expenditures from your `map_category_code_non_bank` table.\n\n-- Assuming 'CF_001' represents operating cash flow and 'CF_002' represents capital expenditures.  Adjust these codes as needed.\n\nWITH OperatingCashFlow AS (\n    SELECT\n        stock_code,\n        year,\n        quarter,\n        data AS operating_cash_flow\n    FROM\n        non_bank_financial_report\n    WHERE\n        category_code = 'CF_001' -- Replace with actual category code for operating cash flow\n        AND year >= 2020\n        AND (quarter = 0 OR quarter BETWEEN 1 AND 2) -- Include annual and Q1-Q2 data\n        AND stock_code IN ('VNM', 'MSN')\n),\nCapitalExpenditures AS (\n    SELECT\n        stock_code,\n        year,\n        quarter,\n        data AS capital_expenditures\n    FROM\n        non_bank_financial_report\n    WHERE\n        category_code = 'CF_002' -- Replace with actual category code for capital expenditures\n        AND year >= 2020\n        AND (quarter = 0 OR quarter BETWEEN 1 AND 2) -- Include annual and Q1-Q2 data\n        AND stock_code IN ('VNM', 'MSN')\n)\n\n-- Step 2: Calculate free cash flow.\nSELECT\n    ocf.stock_code,\n    ocf.year,\n    ocf.quarter,\n    ocf.operating_cash_flow,\n    ce.capital_expenditures,\n    ocf.operating_cash_flow - ce.capital_expenditures AS free_cash_flow\nFROM\n    OperatingCashFlow ocf\nJOIN\n    CapitalExpenditures ce ON ocf.stock_code = ce.stock_code AND ocf.year = ce.year AND ocf.quarter = ce.quarter\nORDER BY\n    ocf.stock_code,\n    ocf.year,\n    ocf.quarter\nLIMIT 100; -- Add a LIMIT clause to restrict the output. Adjust as needed.\n\n"
            }
        ],
        "time": 7.715670824050903,
        "evaluate": 0,
        "input_token": 2848,
        "output_token": 881
    },
    {
        "id": "0759f255-d239-4e78-be61-78f7c00f8b42",
        "question": "What is the total amount of  property, plant, and equipment (PP&E) for Vinamilk, Masan Group, and Hoa Phat Group at the end of 2023?",
        "answer": "Table 1\n| stock_code   |   total_ppe |\n|:-------------|------------:|\n| HPG          | 7.19984e+07 |\n| MSN          | 4.28858e+07 |\n| VNM          | 1.26897e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    SUM(data) AS total_ppe\nFROM \n    non_bank_financial_report\nWHERE \n    year = 2023 \n    AND quarter = 0 \n    AND stock_code IN ('VNM', 'MSN', 'HPG')\n    AND category_code IN ('BS_221', 'BS_224', 'BS_227')\nGROUP BY \n    stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |\n|:-------------|\n| VNM          |\n| HPG          |\n| MSN          |\n\nTable 2\n| company_name                      |   total_ppe |\n|:----------------------------------|------------:|\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      | 3.59359e+07 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t | 8.27164e+07 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    | 4.37635e+07 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs for Vinamilk, Masan Group, and Hoa Phat Group.\n-- We need to find the stock_code for VNM, MSN, and HPG.  Assuming company_name is available in company_info table.  Adjust if needed based on your actual table schema.\n\nSELECT stock_code\nFROM company_info\nWHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t')\n;\n\n\n-- Step 2: Retrieve the Property, Plant, and Equipment (PP&E) values for the identified companies at the end of 2023.\n-- This requires knowing the `category_code` for PP&E in the `map_category_code_non_bank` table.  \n--  Let's assume there's a category code like 'BS_100' representing PP&E (replace with the actual code if different).\n\n--  The following query assumes that the PP&E information is available in the non_bank_financial_report table.  Adjust if it's in a different table.\n\nWITH CompanyCodes AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t')\n)\nSELECT \n  ci.company_name,\n  SUM(nbfr.data) as total_PPE\nFROM CompanyCodes cc\nJOIN company_info ci ON cc.stock_code = ci.stock_code\nLEFT JOIN non_bank_financial_report nbfr ON cc.stock_code = nbfr.stock_code\nAND nbfr.year = 2023\nAND nbfr.quarter = 0 -- Annual report\nAND nbfr.category_code = 'BS_100' -- Replace 'BS_100' with the actual category code for PP&E\nGROUP BY ci.company_name;\n\n-- Note: Replace 'BS_100' with the correct category code for PP&E from your `map_category_code_non_bank` table.\n--  The query also assumes that the company names are stored in the `company_info` table.  Adjust accordingly if your schema differs.\n-- Add error handling for cases where the category code or company names are not found.\n\n"
            }
        ],
        "time": 6.876229286193848,
        "evaluate": 0,
        "input_token": 5800,
        "output_token": 1471
    },
    {
        "id": "2021f2a2-50f4-49c3-8242-38373e361aa0",
        "question": "What is the trend of total assets and total liabilities for Vietcombank, Techcombank, and VPBank from 2020 to Q2 2024, broken down by the assets and liabilities of their subsidiaries and other investments?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | category          |   bank_data |   subsidiary_data |\n|:-------------|-------:|----------:|:------------------|------------:|------------------:|\n| TCB          |   2020 |         0 | Total assets      | 4.39603e+08 |                 0 |\n| TCB          |   2020 |         0 | Total liabilities | 3.64988e+08 |                 0 |\n| TCB          |   2021 |         0 | Total assets      | 5.68729e+08 |                 0 |\n| TCB          |   2021 |         0 | Total liabilities | 4.75687e+08 |                 0 |\n| TCB          |   2022 |         0 | Total assets      | 6.99033e+08 |                 0 |\n| TCB          |   2022 |         0 | Total liabilities | 5.85608e+08 |                 0 |\n| TCB          |   2023 |         0 | Total assets      | 8.49482e+08 |                 0 |\n| TCB          |   2023 |         0 | Total liabilities | 7.17866e+08 |                 0 |\n| TCB          |   2024 |         2 | Total assets      | 9.08307e+08 |                 0 |\n| TCB          |   2024 |         2 | Total liabilities | 7.69755e+08 |                 0 |\n| VCB          |   2020 |         0 | Total assets      | 1.32623e+09 |                 0 |\n| VCB          |   2020 |         0 | Total liabilities | 1.23214e+09 |                 0 |\n| VCB          |   2021 |         0 | Total assets      | 1.41467e+09 |                 0 |\n| VCB          |   2021 |         0 | Total liabilities | 1.30556e+09 |                 0 |\n| VCB          |   2022 |         0 | Total assets      | 1.81382e+09 |                 0 |\n| VCB          |   2022 |         0 | Total liabilities | 1.67817e+09 |                 0 |\n| VCB          |   2023 |         0 | Total assets      | 1.83961e+09 |                 0 |\n| VCB          |   2023 |         0 | Total liabilities | 1.6746e+09  |                 0 |\n| VPB          |   2020 |         0 | Total assets      | 4.19027e+08 |                 0 |\n| VPB          |   2020 |         0 | Total liabilities | 3.66233e+08 |                 0 |\n| VPB          |   2021 |         0 | Total assets      | 5.47409e+08 |                 0 |\n| VPB          |   2021 |         0 | Total liabilities | 4.61131e+08 |                 0 |\n| VPB          |   2022 |         0 | Total assets      | 6.31013e+08 |                 0 |\n| VPB          |   2022 |         0 | Total liabilities | 5.27511e+08 |                 0 |\n| VPB          |   2023 |         0 | Total assets      | 8.17567e+08 |                 0 |\n| VPB          |   2023 |         0 | Total liabilities | 6.77771e+08 |                 0 |\n| VPB          |   2024 |         2 | Total assets      | 8.64392e+08 |                 0 |\n| VPB          |   2024 |         2 | Total liabilities | 7.26325e+08 |                 0 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_assets_liabilities AS (\n    SELECT\n        stock_code,\n        year,\n        quarter,\n        category_code,\n        data\n    FROM\n        bank_financial_report\n    WHERE\n        stock_code IN ('VCB', 'TCB', 'VPB')\n        AND category_code IN ('BS_300', 'BS_400') -- Total assets and total liabilities\n        AND ((year BETWEEN 2020 AND 2024) AND (quarter = 0 OR (year = 2024 AND quarter = 2)))\n),\nsubsidiary_investments AS (\n    SELECT\n        ss.stock_code,\n        ss.invest_on,\n        bf.year,\n        bf.quarter,\n        bf.category_code,\n        bf.data\n    FROM\n        sub_and_shareholder ss\n    JOIN\n        bank_financial_report bf ON ss.invest_on = bf.stock_code\n    WHERE\n        ss.stock_code IN ('VCB', 'TCB', 'VPB')\n        AND bf.category_code IN ('BS_211', 'BS_213', 'BS_214') -- Investments in subsidiaries and other entities\n        AND ((bf.year BETWEEN 2020 AND 2024) AND (bf.quarter = 0 OR (bf.year = 2024 AND bf.quarter = 2)))\n)\nSELECT\n    ba.stock_code,\n    ba.year,\n    ba.quarter,\n    mc.en_caption AS category,\n    ba.data AS bank_data,\n    COALESCE(SUM(si.data), 0) AS subsidiary_data\nFROM\n    bank_assets_liabilities ba\nJOIN\n    map_category_code_bank mc ON ba.category_code = mc.category_code\nLEFT JOIN\n    subsidiary_investments si ON ba.stock_code = si.stock_code AND ba.year = si.year AND ba.quarter = si.quarter AND ba.category_code = si.category_code\nGROUP BY\n    ba.stock_code, ba.year, ba.quarter, mc.en_caption, ba.data\nORDER BY\n    ba.stock_code, ba.year, ba.quarter, mc.en_caption;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |   year |   quarter |   total_assets |   total_liabilities |\n|:-------------|-------:|----------:|---------------:|--------------------:|\n| EIB          |   2020 |         0 |    1.60435e+08 |         1.43616e+08 |\n| EIB          |   2020 |         1 |    1.57171e+08 |         1.41013e+08 |\n| EIB          |   2020 |         2 |    1.47315e+08 |         1.31154e+08 |\n| EIB          |   2021 |         0 |    1.65832e+08 |         1.48047e+08 |\n| EIB          |   2021 |         1 |    1.60953e+08 |         1.43961e+08 |\n| EIB          |   2021 |         2 |    1.6556e+08  |         1.48274e+08 |\n| EIB          |   2022 |         0 |    1.85056e+08 |         1.64576e+08 |\n| EIB          |   2022 |         1 |    1.72343e+08 |         1.53894e+08 |\n| EIB          |   2022 |         2 |    1.74582e+08 |         1.5551e+08  |\n| EIB          |   2023 |         0 |    2.01417e+08 |         1.78972e+08 |\n| EIB          |   2023 |         1 |    1.83684e+08 |         1.62533e+08 |\n| EIB          |   2023 |         2 |    1.90301e+08 |         1.68879e+08 |\n| EIB          |   2024 |         1 |    2.03585e+08 |         1.80617e+08 |\n| MBB          |   2020 |         0 |    4.94982e+08 |         4.44883e+08 |\n| MBB          |   2020 |         1 |    4.06803e+08 |         3.62819e+08 |\n| MBB          |   2020 |         2 |    4.21636e+08 |         3.75837e+08 |\n| MBB          |   2021 |         0 |    6.0714e+08  |         5.44654e+08 |\n| MBB          |   2021 |         1 |    5.10957e+08 |         4.57234e+08 |\n| MBB          |   2021 |         2 |    5.23334e+08 |         4.674e+08   |\n| MBB          |   2022 |         0 |    7.28532e+08 |         6.48919e+08 |\n| MBB          |   2022 |         1 |    6.4904e+08  |         5.81976e+08 |\n| MBB          |   2022 |         2 |    6.58274e+08 |         5.87368e+08 |\n| MBB          |   2023 |         0 |    9.44954e+08 |         8.48242e+08 |\n| MBB          |   2023 |         1 |    7.60761e+08 |         6.75994e+08 |\n| MBB          |   2023 |         2 |    8.06238e+08 |         7.20168e+08 |\n| OCB          |   2020 |         0 |    1.52529e+08 |         1.35093e+08 |\n| OCB          |   2020 |         1 |    1.18958e+08 |         1.0655e+08  |\n| OCB          |   2020 |         2 |    1.24398e+08 |         1.08975e+08 |\n| OCB          |   2021 |         0 |    1.84491e+08 |         1.62686e+08 |\n| OCB          |   2021 |         1 |    1.60297e+08 |         1.41834e+08 |\n| OCB          |   2021 |         2 |    1.67142e+08 |         1.47605e+08 |\n| OCB          |   2022 |         0 |    1.93994e+08 |         1.68722e+08 |\n| OCB          |   2022 |         1 |    1.87748e+08 |         1.65276e+08 |\n| OCB          |   2022 |         2 |    1.88857e+08 |         1.6571e+08  |\n| OCB          |   2023 |         0 |    2.40114e+08 |         2.11579e+08 |\n| OCB          |   2023 |         1 |    1.99141e+08 |         1.73085e+08 |\n| OCB          |   2023 |         2 |    2.11292e+08 |         1.84019e+08 |\n| OCB          |   2024 |         1 |    2.3698e+08  |         2.07484e+08 |\n| TCB          |   2020 |         0 |    4.39603e+08 |         3.64988e+08 |\n| TCB          |   2020 |         1 |    3.91808e+08 |         3.27217e+08 |\n| TCB          |   2020 |         2 |    3.95861e+08 |         3.28432e+08 |\n| TCB          |   2021 |         0 |    5.68729e+08 |         4.75687e+08 |\n| TCB          |   2021 |         1 |    4.62823e+08 |         3.8373e+08  |\n| TCB          |   2021 |         2 |    5.04304e+08 |         4.20403e+08 |\n| TCB          |   2022 |         0 |    6.99033e+08 |         5.85608e+08 |\n| TCB          |   2022 |         1 |    6.1527e+08  |         5.16684e+08 |\n| TCB          |   2022 |         2 |    6.23745e+08 |         5.19272e+08 |\n| TCB          |   2023 |         0 |    8.49482e+08 |         7.17866e+08 |\n| TCB          |   2023 |         1 |    7.23518e+08 |         6.05552e+08 |\n| TCB          |   2023 |         2 |    7.3247e+08  |         6.10005e+08 |\n| TCB          |   2024 |         1 |    8.85653e+08 |         7.47781e+08 |\n| TCB          |   2024 |         2 |    9.08307e+08 |         7.69755e+08 |\n| VCB          |   2020 |         0 |    1.32623e+09 |         1.23214e+09 |\n| VCB          |   2020 |         1 |    1.14427e+09 |         1.0592e+09  |\n| VCB          |   2020 |         2 |    1.18526e+09 |         1.09568e+09 |\n| VCB          |   2021 |         0 |    1.41467e+09 |         1.30556e+09 |\n| VCB          |   2021 |         1 |    1.27897e+09 |         1.17796e+09 |\n| VCB          |   2021 |         2 |    1.30363e+09 |         1.1987e+09  |\n| VCB          |   2022 |         0 |    1.81382e+09 |         1.67817e+09 |\n| VCB          |   2022 |         1 |    1.46275e+09 |         1.34567e+09 |\n| VCB          |   2022 |         2 |    1.60239e+09 |         1.4794e+09  |\n| VCB          |   2023 |         0 |    1.83961e+09 |         1.6746e+09  |\n| VCB          |   2023 |         1 |    1.84643e+09 |         1.70177e+09 |\n| VCB          |   2023 |         2 |    1.70427e+09 |         1.55227e+09 |\n| VCB          |   2024 |         1 |    1.77371e+09 |         1.6001e+09  |\n| VPB          |   2020 |         0 |    4.19027e+08 |         3.66233e+08 |\n| VPB          |   2020 |         1 |    3.93209e+08 |         3.48685e+08 |\n| VPB          |   2020 |         2 |    3.99473e+08 |         3.51998e+08 |\n| VPB          |   2021 |         0 |    5.47409e+08 |         4.61131e+08 |\n| VPB          |   2021 |         1 |    4.36241e+08 |         3.80246e+08 |\n| VPB          |   2021 |         2 |    4.51767e+08 |         3.91755e+08 |\n| VPB          |   2022 |         0 |    6.31013e+08 |         5.27511e+08 |\n| VPB          |   2022 |         1 |    5.63924e+08 |         4.68722e+08 |\n| VPB          |   2022 |         2 |    6.08275e+08 |         5.09751e+08 |\n| VPB          |   2023 |         0 |    8.17567e+08 |         6.77771e+08 |\n| VPB          |   2023 |         1 |    6.77624e+08 |         5.72526e+08 |\n| VPB          |   2023 |         2 |    7.39762e+08 |         6.32198e+08 |\n| VPB          |   2024 |         1 |    8.22367e+08 |         6.7943e+08  |\n| VPB          |   2024 |         2 |    8.64392e+08 |         7.26325e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH ParentCompanies AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('VCB', 'TCB', 'VPB')\n),\nSubsidiaries AS (\n  SELECT invest_on\n  FROM sub_and_shareholder\n  WHERE stock_code IN (SELECT stock_code FROM ParentCompanies)\n),\nAllCompanies AS (\n  SELECT stock_code\n  FROM ParentCompanies\n  UNION\n  SELECT invest_on\n  FROM Subsidiaries\n),\nFinancialData AS (\n  SELECT\n    ac.stock_code,\n    b.year,\n    b.quarter,\n    SUM(CASE WHEN b.category_code = 'BS_300' THEN b.data ELSE 0 END) as total_assets,\n    SUM(CASE WHEN b.category_code = 'BS_400' THEN b.data ELSE 0 END) as total_liabilities\n  FROM AllCompanies ac\n  JOIN bank_financial_report b ON ac.stock_code = b.stock_code\n  WHERE b.year >= 2020 AND b.year <= 2024 AND b.quarter <=2\n  GROUP BY ac.stock_code, b.year, b.quarter\n)\nSELECT\n  fd.stock_code,\n  fd.year,\n  fd.quarter,\n  fd.total_assets,\n  fd.total_liabilities\nFROM FinancialData fd\nORDER BY fd.stock_code, fd.year, fd.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 6.138803958892822,
        "evaluate": 0,
        "input_token": 4826,
        "output_token": 1094
    },
    {
        "id": "b7305bbf-5414-4848-8c0d-223f54960820",
        "question": "Rank the top 5 companies with total assets greater than 100,000 billion VND as of December 31, 2023, based on their Return on Equity (ROE).",
        "answer": "Table 1\n| stock_code   | industry   |      roe |\n|:-------------|:-----------|---------:|\n| HDB          | Banking    | 0.232433 |\n| ACB          | Banking    | 0.226122 |\n| VIB          | Banking    | 0.225702 |\n| MBB          | Banking    | 0.217698 |\n| VCB          | Banking    | 0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT stock_code, data AS total_assets\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM securities_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n),\nfiltered_companies AS (\n    SELECT stock_code\n    FROM total_assets\n    WHERE total_assets > 100000000\n),\nroe_data AS (\n    SELECT stock_code, data AS roe\n    FROM financial_ratio\n    WHERE ratio_code = 'ROE' AND year = 2023 AND quarter = 0\n)\nSELECT ci.stock_code, ci.industry, roe_data.roe\nFROM filtered_companies fc\nJOIN roe_data ON fc.stock_code = roe_data.stock_code\nJOIN company_info ci ON fc.stock_code = ci.stock_code\nORDER BY roe_data.roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| VHM          | 0.183605  |\n| VIC          | 0.0138715 |\n| NVL          | 0.0107248 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Assuming 'BS_100' represents total assets in the financial reports and 'ROE' is the ratio code for Return on Equity.\n-- Also assuming necessary tables and columns exist to represent company names and total assets.\n\nWITH TopCompanies AS (\n    SELECT \n        cfr.stock_code\n    FROM (\n        SELECT stock_code, data as total_assets FROM bank_financial_report WHERE category_code = 'BS_100' AND year = 2023 AND quarter = 0\n        UNION ALL\n        SELECT stock_code, data as total_assets FROM non_bank_financial_report WHERE category_code = 'BS_100' AND year = 2023 AND quarter = 0\n        UNION ALL\n        SELECT stock_code, data as total_assets FROM securities_financial_report WHERE category_code = 'BS_100' AND year = 2023 AND quarter = 0\n    ) cfr\n    WHERE total_assets > 100000000 \n)\n\nSELECT \n    ci.stock_code,  -- Replace with actual company name column if available\n    fr.data AS roe  \nFROM TopCompanies tc\nJOIN company_info ci ON tc.stock_code = ci.stock_code\nJOIN financial_ratio fr ON tc.stock_code = fr.stock_code AND fr.ratio_code = 'ROE' AND fr.year = 2023 AND fr.quarter = 0\nORDER BY roe DESC\nLIMIT 5;\n\n"
            }
        ],
        "time": 7.942352056503296,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "15ce94fa-2646-4432-b91e-8ef1497dda44",
        "question": "For the period 2020-Q2 2024, provide the year-over-year change in the return on equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group,  separately showing the impact of their subsidiaries and investments on their overall ROE.",
        "answer": "Table 1\n| main_company   |   year |   quarter |   main_company_roe | subsidiary_code   |   subsidiary_roe |\n|:---------------|-------:|----------:|-------------------:|:------------------|-----------------:|\n| HPG            |   2020 |         2 |         0.0524064  |                   |      nan         |\n| HPG            |   2020 |         3 |         0.0688363  |                   |      nan         |\n| HPG            |   2020 |         4 |         0.0787021  |                   |      nan         |\n| HPG            |   2021 |         0 |         0.380268   |                   |      nan         |\n| HPG            |   2021 |         1 |         0.10579    |                   |      nan         |\n| HPG            |   2021 |         2 |         0.131719   |                   |      nan         |\n| HPG            |   2021 |         3 |         0.122748   |                   |      nan         |\n| HPG            |   2021 |         4 |         0.0817293  |                   |      nan         |\n| HPG            |   2022 |         0 |         0.0878594  |                   |      nan         |\n| HPG            |   2022 |         1 |         0.0829275  |                   |      nan         |\n| HPG            |   2022 |         2 |         0.0402598  |                   |      nan         |\n| HPG            |   2022 |         3 |        -0.0182075  |                   |      nan         |\n| HPG            |   2022 |         4 |        -0.020796   |                   |      nan         |\n| HPG            |   2023 |         0 |         0.0661282  |                   |      nan         |\n| HPG            |   2023 |         1 |         0.00397384 |                   |      nan         |\n| HPG            |   2023 |         2 |         0.0147948  |                   |      nan         |\n| HPG            |   2023 |         3 |         0.0200306  |                   |      nan         |\n| HPG            |   2023 |         4 |         0.0288708  |                   |      nan         |\n| HPG            |   2024 |         1 |         0.027164   |                   |      nan         |\n| HPG            |   2024 |         2 |         0.0305454  |                   |      nan         |\n| MSN            |   2020 |         2 |         0.00174282 | TCB               |        0.0428449 |\n| MSN            |   2020 |         3 |         0.0340108  | TCB               |        0.0450409 |\n| MSN            |   2020 |         4 |         0.0233474  | TCB               |        0.0537099 |\n| MSN            |   2021 |         0 |         0.238597   | TCB               |        0.197927  |\n| MSN            |   2021 |         1 |         0.0134906  | TCB               |        0.0565945 |\n| MSN            |   2021 |         2 |         0.0335106  | TCB               |        0.0572896 |\n| MSN            |   2021 |         3 |         0.0490112  | TCB               |        0.0501452 |\n| MSN            |   2021 |         4 |         0.168149   | TCB               |        0.0503334 |\n| MSN            |   2022 |         0 |         0.129771   | TCB               |        0.180176  |\n| MSN            |   2022 |         1 |         0.0515801  | TCB               |        0.0569507 |\n| MSN            |   2022 |         2 |         0.0313142  | TCB               |        0.0562806 |\n| MSN            |   2022 |         3 |         0.0236221  | TCB               |        0.0488406 |\n| MSN            |   2022 |         4 |         0.021933   | TCB               |        0.031493  |\n| MSN            |   2023 |         0 |         0.0489033  | TCB               |        0.139608  |\n| MSN            |   2023 |         1 |         0.0118431  | TCB               |        0.0384612 |\n| MSN            |   2023 |         2 |         0.0114376  | TCB               |        0.0367734 |\n| MSN            |   2023 |         3 |         0.0127258  | TCB               |        0.0367239 |\n| MSN            |   2023 |         4 |         0.013515   | TCB               |        0.0381519 |\n| MSN            |   2024 |         1 |         0.0123309  | TCB               |        0.0459854 |\n| VNM            |   2020 |         2 |         0.095333   |                   |      nan         |\n| VNM            |   2020 |         3 |         0.0990225  |                   |      nan         |\n| VNM            |   2020 |         4 |         0.0664599  |                   |      nan         |\n| VNM            |   2021 |         0 |         0.296583   |                   |      nan         |\n| VNM            |   2021 |         1 |         0.0764615  |                   |      nan         |\n| VNM            |   2021 |         2 |         0.0832651  |                   |      nan         |\n| VNM            |   2021 |         3 |         0.0874017  |                   |      nan         |\n| VNM            |   2021 |         4 |         0.0617182  |                   |      nan         |\n| VNM            |   2022 |         0 |         0.26138    |                   |      nan         |\n| VNM            |   2022 |         1 |         0.06528    |                   |      nan         |\n| VNM            |   2022 |         2 |         0.057095   |                   |      nan         |\n| VNM            |   2022 |         3 |         0.0686339  |                   |      nan         |\n| VNM            |   2022 |         4 |         0.0569567  |                   |      nan         |\n| VNM            |   2023 |         0 |         0.257506   |                   |      nan         |\n| VNM            |   2023 |         1 |         0.0552366  |                   |      nan         |\n| VNM            |   2023 |         2 |         0.112804   |                   |      nan         |\n| VNM            |   2023 |         3 |         0.0745011  |                   |      nan         |\n| VNM            |   2023 |         4 |         0.0671136  |                   |      nan         |\n| VNM            |   2024 |         1 |         0.0615314  |                   |      nan         |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH main_company_roe AS (\n    SELECT \n        fr.stock_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS roe\n    FROM \n        financial_ratio fr\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Return On Equity'\n        AND fr.stock_code IN ('VNM', 'MSN', 'HPG')\n        AND ((fr.year = 2020 AND fr.quarter >= 2) OR (fr.year > 2020 AND fr.year < 2024) OR (fr.year = 2024 AND fr.quarter <= 2))\n),\nsubsidiary_roe AS (\n    SELECT \n        s.stock_code,\n        s.invest_on AS subsidiary_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS roe\n    FROM \n        sub_and_shareholder s\n    JOIN \n        financial_ratio fr ON s.invest_on = fr.stock_code\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Return On Equity'\n        AND s.stock_code IN ('VNM', 'MSN', 'HPG')\n        AND ((fr.year = 2020 AND fr.quarter >= 2) OR (fr.year > 2020 AND fr.year < 2024) OR (fr.year = 2024 AND fr.quarter <= 2))\n)\nSELECT \n    mc.stock_code AS main_company,\n    mc.year,\n    mc.quarter,\n    mc.roe AS main_company_roe,\n    sr.subsidiary_code,\n    sr.roe AS subsidiary_roe\nFROM \n    main_company_roe mc\nLEFT JOIN \n    subsidiary_roe sr ON mc.stock_code = sr.stock_code AND mc.year = sr.year AND mc.quarter = sr.quarter\nORDER BY \n    mc.stock_code, mc.year, mc.quarter, sr.subsidiary_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| en_company_name                            |   year |   quarter |   overall_roe |   subsidiary_roe |   direct_roe |   previous_year_roe |   yoy_change_overall_roe |   previous_year_subsidiary_roe |   yoy_change_subsidiary_roe |\n|:-------------------------------------------|-------:|----------:|--------------:|-----------------:|-------------:|--------------------:|-------------------------:|-------------------------------:|----------------------------:|\n| Hoa Phat Group Joint Stock Company         |   2020 |         0 |    0.228068   |        0         |    0.228068  |          0          |                0.228068  |                      0         |                   0         |\n| Hoa Phat Group Joint Stock Company         |   2020 |         2 |    0.0524064  |        0         |    0.0524064 |          0.228068   |               -0.175662  |                      0         |                   0         |\n| Hoa Phat Group Joint Stock Company         |   2021 |         0 |    0.380268   |        0         |    0.380268  |          0.0524064  |                0.327861  |                      0         |                   0         |\n| Hoa Phat Group Joint Stock Company         |   2021 |         2 |    0.131719   |        0         |    0.131719  |          0.380268   |               -0.248549  |                      0         |                   0         |\n| Hoa Phat Group Joint Stock Company         |   2022 |         0 |    0.0878594  |        0         |    0.0878594 |          0.131719   |               -0.0438595 |                      0         |                   0         |\n| Hoa Phat Group Joint Stock Company         |   2022 |         2 |    0.0402598  |        0         |    0.0402598 |          0.0878594  |               -0.0475997 |                      0         |                   0         |\n| Hoa Phat Group Joint Stock Company         |   2023 |         0 |    0.0661282  |        0         |    0.0661282 |          0.0402598  |                0.0258684 |                      0         |                   0         |\n| Hoa Phat Group Joint Stock Company         |   2023 |         2 |    0.0147948  |        0         |    0.0147948 |          0.0661282  |               -0.0513334 |                      0         |                   0         |\n| Hoa Phat Group Joint Stock Company         |   2024 |         2 |    0.0305454  |        0         |    0.0305454 |          0.0147948  |                0.0157506 |                      0         |                   0         |\n| Masan Group Corporation                    |   2020 |         0 |    0.055733   |        0.168632  |   -0.112899  |          0          |                0.055733  |                      0         |                   0.168632  |\n| Masan Group Corporation                    |   2020 |         2 |    0.00174282 |        0.0428449 |   -0.041102  |          0.055733   |               -0.0539902 |                      0.168632  |                  -0.125787  |\n| Masan Group Corporation                    |   2021 |         0 |    0.238597   |        0.197927  |    0.04067   |          0.00174282 |                0.236854  |                      0.0428449 |                   0.155082  |\n| Masan Group Corporation                    |   2021 |         2 |    0.0335106  |        0.0572896 |   -0.0237791 |          0.238597   |               -0.205086  |                      0.197927  |                  -0.140637  |\n| Masan Group Corporation                    |   2022 |         0 |    0.129771   |        0.180176  |   -0.0504048 |          0.0335106  |                0.0962604 |                      0.0572896 |                   0.122886  |\n| Masan Group Corporation                    |   2022 |         2 |    0.0313142  |        0.0562806 |   -0.0249664 |          0.129771   |               -0.0984567 |                      0.180176  |                  -0.123895  |\n| Masan Group Corporation                    |   2023 |         0 |    0.0489033  |        0.139608  |   -0.0907051 |          0.0313142  |                0.0175891 |                      0.0562806 |                   0.0833278 |\n| Masan Group Corporation                    |   2023 |         2 |    0.0114376  |        0.0367734 |   -0.0253358 |          0.0489033  |               -0.0374657 |                      0.139608  |                  -0.102835  |\n| Vietnam Dairy Products Joint Stock Company |   2020 |         0 |    0.333928   |        0         |    0.333928  |          0          |                0.333928  |                      0         |                   0         |\n| Vietnam Dairy Products Joint Stock Company |   2020 |         2 |    0.095333   |        0         |    0.095333  |          0.333928   |               -0.238595  |                      0         |                   0         |\n| Vietnam Dairy Products Joint Stock Company |   2021 |         0 |    0.296583   |        0         |    0.296583  |          0.095333   |                0.20125   |                      0         |                   0         |\n| Vietnam Dairy Products Joint Stock Company |   2021 |         2 |    0.0832651  |        0         |    0.0832651 |          0.296583   |               -0.213318  |                      0         |                   0         |\n| Vietnam Dairy Products Joint Stock Company |   2022 |         0 |    0.26138    |        0         |    0.26138   |          0.0832651  |                0.178115  |                      0         |                   0         |\n| Vietnam Dairy Products Joint Stock Company |   2022 |         2 |    0.057095   |        0         |    0.057095  |          0.26138    |               -0.204285  |                      0         |                   0         |\n| Vietnam Dairy Products Joint Stock Company |   2023 |         0 |    0.257506   |        0         |    0.257506  |          0.057095   |                0.200411  |                      0         |                   0         |\n| Vietnam Dairy Products Joint Stock Company |   2023 |         2 |    0.112804   |        0         |    0.112804  |          0.257506   |               -0.144703  |                      0         |                   0         |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyROE AS (\n  SELECT\n    c.en_company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS roe\n  FROM company_info AS c\n  JOIN financial_ratio AS fr\n    ON c.stock_code = fr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND c.stock_code IN ('VNM', 'MSN', 'HPG')\n    AND fr.year >= 2020\n    AND fr.year <= 2024\n    AND fr.quarter IN (0, 2)\n), SubsidiaryROE AS (\n  SELECT\n    c.en_company_name,\n    fr.year,\n    fr.quarter,\n    SUM(fr.data) AS subsidiary_roe\n  FROM company_info AS c\n  JOIN sub_and_shareholder AS ss\n    ON c.stock_code = ss.stock_code\n  JOIN financial_ratio AS fr\n    ON ss.invest_on = fr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND c.stock_code IN ('VNM', 'MSN', 'HPG')\n    AND fr.year >= 2020\n    AND fr.year <= 2024\n    AND fr.quarter IN (0, 2)\n  GROUP BY\n    c.en_company_name,\n    fr.year,\n    fr.quarter\n)\nSELECT\n  cr.en_company_name,\n  cr.year,\n  cr.quarter,\n  cr.roe AS overall_roe,\n  COALESCE(sr.subsidiary_roe, 0) AS subsidiary_roe,\n  cr.roe - COALESCE(sr.subsidiary_roe, 0) AS direct_roe,\n  LAG(cr.roe, 1, 0) OVER (PARTITION BY cr.en_company_name ORDER BY cr.year, cr.quarter) AS previous_year_roe,\n  cr.roe - LAG(cr.roe, 1, 0) OVER (PARTITION BY cr.en_company_name ORDER BY cr.year, cr.quarter) AS yoy_change_overall_roe,\n  COALESCE(LAG(sr.subsidiary_roe, 1, 0) OVER (PARTITION BY cr.en_company_name ORDER BY cr.year, cr.quarter),0) AS previous_year_subsidiary_roe,\n  COALESCE(sr.subsidiary_roe,0) - COALESCE(LAG(sr.subsidiary_roe, 1, 0) OVER (PARTITION BY cr.en_company_name ORDER BY cr.year, cr.quarter),0) AS yoy_change_subsidiary_roe\nFROM CompanyROE AS cr\nLEFT JOIN SubsidiaryROE AS sr\n  ON cr.en_company_name = sr.en_company_name\n  AND cr.year = sr.year\n  AND cr.quarter = sr.quarter\nORDER BY\n  cr.en_company_name,\n  cr.year,\n  cr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 8.390737771987915,
        "evaluate": 0,
        "input_token": 5503,
        "output_token": 1084
    },
    {
        "id": "2bd167d2-27c8-45cc-bf1a-c5bf42eb5ec9",
        "question": "What is the Return on Equity (ROE) for Vinamilk and Masan Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|      data |\n|----------:|\n| 0.0489033 |\n| 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND ci.stock_code IN ('VNM', 'MSN')\nLIMIT 2;\n"
            }
        ],
        "time": 3.6510117053985596,
        "evaluate": 0,
        "input_token": 1219,
        "output_token": 482
    },
    {
        "id": "0a7260e6-0f4a-4061-bd8f-11bea613819f",
        "question": "What was the Return on Equity (ROE) for Vietcombank, Techcombank, and VPBank in Q2 2024, and how does this compare to their respective ROE in Q2 2020, considering their investments in subsidiaries?",
        "answer": "Table 1\n| stock_code   | company_name                                       |   year |   quarter |       roe |\n|:-------------|:---------------------------------------------------|-------:|----------:|----------:|\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2020 |         2 | 0.0428449 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2020 |         2 | 0.0428449 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2024 |         2 | 0.0457096 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2024 |         2 | 0.0457096 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2020 |         2 | 0.0621598 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2020 |         2 | 0.0621598 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2024 |         2 | 0.026311  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2024 |         2 | 0.026311  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    ci.company_name, \n    fr.year, \n    fr.quarter, \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nLEFT JOIN \n    sub_and_shareholder ss ON fr.stock_code = ss.stock_code\nWHERE \n    mccr.ratio_name = 'Return On Equity'\n    AND fr.quarter = 2\n    AND fr.year IN (2020, 2024)\n    AND fr.stock_code IN ('VCB', 'TCB', 'VPB')\nORDER BY \n    fr.stock_code, fr.year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2020 |         2 | 0.0428449 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2020 |         2 | 0.0515214 |\n| VPB          |   2020 |         0 | 0.197255  |\n| VPB          |   2020 |         2 | 0.0621598 |\n| VPB          |   2024 |         2 | 0.026311  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantCompanies AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    stock_code IN ('VCB', 'TCB', 'VPB')\n), ROEData AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS roe\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  JOIN RelevantCompanies AS rc\n    ON fr.stock_code = rc.stock_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.quarter IN (0, 2)\n    AND fr.year IN (2020, 2024)\n)\nSELECT\n  rd.stock_code,\n  rd.year,\n  rd.quarter,\n  rd.roe\nFROM ROEData AS rd\nORDER BY\n  rd.stock_code,\n  rd.year,\n  rd.quarter\nLIMIT 10;\n"
            }
        ],
        "time": 5.9345738887786865,
        "evaluate": 0.5,
        "input_token": 4628,
        "output_token": 627
    },
    {
        "id": "517268fa-0be0-45f0-ab11-c3ff9ba775a3",
        "question": "Calculate the Debt-to-Equity ratio for VinGroup, Masan Group, and Hoa Phat Group in Q2 2024.  Analyze the impact of their subsidiary investments on their overall leverage.",
        "answer": "Table 1\n| stock_code   |   debt_to_equity_ratio |   investment_in_subsidiaries |\n|:-------------|-----------------------:|-----------------------------:|\n| HPG          |               0.901137 |                            0 |\n| VIC          |               3.44847  |                            0 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the stock codes for the companies\nWITH company_codes AS (\n    SELECT 'VIC' AS stock_code\n    UNION ALL\n    SELECT 'MSN'\n    UNION ALL\n    SELECT 'HPG'\n)\n\n-- Step 2: Retrieve Debt-to-Equity ratio for Q2 2024\nSELECT \n    fr.stock_code,\n    fr.data AS debt_to_equity_ratio,\n    nbf.data AS investment_in_subsidiaries\nFROM \n    financial_ratio fr\nJOIN \n    company_codes cc ON fr.stock_code = cc.stock_code\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nLEFT JOIN \n    non_bank_financial_report nbf ON fr.stock_code = nbf.stock_code \n    AND nbf.year = 2024 \n    AND nbf.quarter = 2 \n    AND nbf.category_code = 'BS_251' -- Investment in subsidiaries\nWHERE \n    fr.year = 2024 \n    AND fr.quarter = 2 \n    AND mccr.ratio_name = 'Debt To Equity Ratio';\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| en_company_name                    |   parent_dter |   avg_subsidiary_dter |\n|:-----------------------------------|--------------:|----------------------:|\n| Hoa Phat Group Joint Stock Company |      0.901137 |              0        |\n| VinGroup Joint Stock Company       |      3.44847  |              0.850849 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH ParentCompanies AS (\n  SELECT\n    ci.stock_code,\n    ci.en_company_name\n  FROM company_info AS ci\n  WHERE\n    ci.en_company_name IN ('VinGroup Joint Stock Company', 'Masan Group Corporation', 'Hoa Phat Group Joint Stock Company')\n), ParentCompanyRatios AS (\n  SELECT\n    pcr.stock_code,\n    pcr.data AS parent_dter\n  FROM financial_ratio AS pcr\n  JOIN ParentCompanies AS pc\n    ON pcr.stock_code = pc.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON pcr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Debt To Equity Ratio'\n    AND pcr.quarter = 2\n    AND pcr.year = 2024\n), SubsidiaryRatios AS (\n  SELECT\n    ss.stock_code AS parent_stock_code,\n    sr.stock_code AS subsidiary_stock_code,\n    sr.data AS subsidiary_dter\n  FROM sub_and_shareholder AS ss\n  JOIN ParentCompanies AS pc\n    ON ss.stock_code = pc.stock_code\n  JOIN financial_ratio AS sr\n    ON ss.invest_on = sr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON sr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Debt To Equity Ratio'\n    AND sr.quarter = 2\n    AND sr.year = 2024\n)\nSELECT\n  pc.en_company_name,\n  pcr.parent_dter,\n  COALESCE(AVG(sr.subsidiary_dter), 0) AS avg_subsidiary_dter\nFROM ParentCompanies AS pc\nJOIN ParentCompanyRatios AS pcr\n  ON pc.stock_code = pcr.stock_code\nLEFT JOIN SubsidiaryRatios AS sr\n  ON pc.stock_code = sr.parent_stock_code\nGROUP BY\n  pc.en_company_name,\n  pcr.parent_dter\nORDER BY\n  pc.en_company_name;\n"
            }
        ],
        "time": 6.646727085113525,
        "evaluate": 0.5,
        "input_token": 2305,
        "output_token": 516
    },
    {
        "id": "6eb862c7-4017-4799-a708-7e1fa7a4b1fd",
        "question": "Compare the Return on Equity (ROE) and Debt-to-Equity ratios for Vinamilk, Masan Group, and Sabeco in Q4 2023.  Also provide the total equity and total liabilities for each company in that quarter.",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | DTER         |     2.85445   |\n| SAB          | DTER         |     0.336332  |\n| VNM          | DTER         |     0.503847  |\n| MSN          | ROE          |     0.013515  |\n| SAB          | ROE          |     0.0379247 |\n| VNM          | ROE          |     0.0671136 |\n\nTable 2\n| stock_code   | category_code   |       value |\n|:-------------|:----------------|------------:|\n| VNM          | BS_300          | 1.76476e+07 |\n| VNM          | BS_400          | 3.50257e+07 |\n| MSN          | BS_300          | 1.09146e+08 |\n| SAB          | BS_300          | 8.57147e+06 |\n| MSN          | BS_400          | 3.82372e+07 |\n| SAB          | BS_400          | 2.54852e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve ROE and Debt-to-Equity Ratios for the specified companies\nSELECT \n    fr.stock_code,\n    fr.ratio_code,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB') \n    AND fr.year = 2023 \n    AND fr.quarter = 4\n    AND fr.ratio_code IN ('ROE', 'DTER');\n\n-- Step 2: Retrieve Total Equity and Total Liabilities for the specified companies\nSELECT \n    nfr.stock_code,\n    nfr.category_code,\n    nfr.data AS value\nFROM \n    non_bank_financial_report nfr\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN', 'SAB') \n    AND nfr.year = 2023 \n    AND nfr.quarter = 4\n    AND nfr.category_code IN ('BS_400', 'BS_300'); -- BS_400 for Total Equity, BS_300 for Total Liabilities\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| ratio_code        |      data | company_name                                             |\n|:------------------|----------:|:---------------------------------------------------------|\n| DTER              | 0.336332  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| Total Liabilities | 0         | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| Total Equity      | 0         | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| Total Equity      | 0         | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| ROE               | 0.0379247 | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| DTER              | 2.85445   | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| Total Liabilities | 0         | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| Total Liabilities | 0         | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| ROE               | 0.0671136 | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| ROE               | 0.013515  | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| DTER              | 0.503847  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| Total Equity      | 0         | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.ratio_code,\n  fr.data,\n  ci.company_name\nFROM financial_ratio AS fr\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  ci.company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n')\n  AND fr.quarter = 4\n  AND fr.year = 2023\n  AND mcr.ratio_name IN ('Return On Equity', 'Debt To Equity Ratio')\nUNION\nSELECT\n  'Total Equity' AS ratio_code,\n  SUM(CASE WHEN mcr.en_caption = 'Total Equity' THEN nfr.data ELSE 0 END) AS data,\n  ci.company_name\nFROM non_bank_financial_report AS nfr\nJOIN company_info AS ci\n  ON nfr.stock_code = ci.stock_code\nJOIN map_category_code_non_bank AS mcr\n  ON nfr.category_code = mcr.category_code\nWHERE\n  ci.company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n')\n  AND nfr.quarter = 4\n  AND nfr.year = 2023\nGROUP BY\n  ci.company_name\nUNION\nSELECT\n  'Total Liabilities' AS ratio_code,\n  SUM(CASE WHEN mcr.en_caption = 'Total Liabilities' THEN nfr.data ELSE 0 END) AS data,\n  ci.company_name\nFROM non_bank_financial_report AS nfr\nJOIN company_info AS ci\n  ON nfr.stock_code = ci.stock_code\nJOIN map_category_code_non_bank AS mcr\n  ON nfr.category_code = mcr.category_code\nWHERE\n  ci.company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n')\n  AND nfr.quarter = 4\n  AND nfr.year = 2023\nGROUP BY\n  ci.company_name\nLIMIT 100;\n"
            }
        ],
        "time": 9.539840936660767,
        "evaluate": 1,
        "input_token": 2429,
        "output_token": 981
    },
    {
        "id": "5acf9fe2-b166-443f-8511-111e3acea0ce",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) from 2020 to Q2 2024, calculated as Net Income divided by Average Shareholder Equity.",
        "answer": "Table 1\n| stock_code   | company_name                                   | en_company_name                                                         | industry                             |   year |   quarter |        roe |\n|:-------------|:-----------------------------------------------|:------------------------------------------------------------------------|:-------------------------------------|-------:|----------:|-----------:|\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng           | Nam MeKong Group Joint Stock Company                                    | Real Estate                          |   2022 |         0 | nan        |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n    | PetroVietnam Gas Joint Stock Corporation                                | Utilities (Electricity, Water & Gas) |   2024 |         1 | nan        |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang    | Ducgiang Chemicals Group Joint Stock Company                            | Chemicals                            |   2022 |         0 |   0.557243 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i | Yen Bai Joint Stock Forest Agricultural Products And Foodstuffs Company | Basic Resources                      |   2022 |         0 |   0.546075 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                      | Licogi 14 Joint Stock Company                                           | Construction and Materials           |   2021 |         0 |   0.493854 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.company_name,\n    ci.en_company_name,\n    ci.industry,\n    fr.year,\n    fr.quarter,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND ((fr.year = 2020 AND fr.quarter = 0) OR\n         (fr.year = 2021 AND fr.quarter = 0) OR\n         (fr.year = 2022 AND fr.quarter = 0) OR\n         (fr.year = 2023 AND fr.quarter = 0) OR\n         (fr.year = 2024 AND fr.quarter IN (1, 2)))\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | roe   | roe_rank   |\n|--------------|-------|------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedROE AS (\n  SELECT\n    fr.stock_code,\n    fr.data AS roe,\n    RANK() OVER (ORDER BY\n      fr.data DESC) AS roe_rank\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return on Equity'\n    AND fr.year >= 2020\n    AND fr.year <= 2024\n    AND (\n      fr.quarter = 0\n      OR fr.quarter BETWEEN 1 AND 2\n    )\n)\nSELECT\n  r.stock_code,\n  r.roe,\n  r.roe_rank\nFROM RankedROE AS r\nWHERE\n  r.roe_rank <= 5\nLIMIT 5;\n"
            }
        ],
        "time": 3.8131210803985596,
        "evaluate": 0,
        "input_token": 10541,
        "output_token": 1534
    },
    {
        "id": "87f74847-ecb4-42ee-8cfc-46eb78d61d84",
        "question": "For the period 2020 to Q2 2024, rank the top 10 companies based on their Debt-to-Equity ratio, calculated as Total Debt divided by Total Equity.  This ratio will show the financial leverage of each company.",
        "answer": "Table 1\n| stock_code   | industry    |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|:------------|-------:|----------:|-----------------------:|\n| VC3          | Real Estate |   2022 |         0 |               nan      |\n| NVB          | Banking     |   2020 |         0 |                20.0192 |\n| BID          | Banking     |   2021 |         0 |                19.4068 |\n| BID          | Banking     |   2022 |         0 |                19.3533 |\n| NVB          | Banking     |   2024 |         2 |                19.2545 |\n| BID          | Banking     |   2020 |         0 |                18.0427 |\n| BID          | Banking     |   2023 |         0 |                17.7184 |\n| BID          | Banking     |   2024 |         2 |                17.7161 |\n| NVB          | Banking     |   2021 |         0 |                16.3027 |\n| LPB          | Banking     |   2021 |         0 |                16.212  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.year,\n    fr.quarter,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND ((fr.year = 2020 AND fr.quarter = 0) OR\n         (fr.year = 2021 AND fr.quarter = 0) OR\n         (fr.year = 2022 AND fr.quarter = 0) OR\n         (fr.year = 2023 AND fr.quarter = 0) OR\n         (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n    fr.data DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name   | year   | quarter   | debt_to_equity_ratio   |\n|--------------|----------------|--------|-----------|------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH DebtToEquityRatio AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS debt_to_equity_ratio\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Debt-to-Equity ratio'\n    AND fr.year >= 2020\n    AND (\n      fr.year < 2024\n      OR (\n        fr.year = 2024\n        AND fr.quarter <= 2\n      )\n    )\n)\nSELECT\n  ci.stock_code,\n  ci.company_name,\n  der.year,\n  der.quarter,\n  der.debt_to_equity_ratio\nFROM DebtToEquityRatio AS der\nJOIN company_info AS ci\n  ON der.stock_code = ci.stock_code\nORDER BY\n  der.debt_to_equity_ratio DESC\nLIMIT 10;\n"
            }
        ],
        "time": 4.511003494262695,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "756db2fc-d60a-4119-93a9-f965164708dd",
        "question": "What is the trend of the Net Profit Margin ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    fr.year, \n    fr.quarter, \n    fr.data AS net_profit_margin\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    mccr.ratio_name = 'Net profit margin' AND\n    fr.stock_code IN ('VCB', 'TCB', 'ACB') AND\n    ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR\n     (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n    fr.stock_code, \n    fr.year, \n    fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| year   | quarter   | en_company_name   | net_profit_margin   |\n|--------|-----------|-------------------|---------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.year,\n  fr.quarter,\n  ci.en_company_name,\n  fr.data AS net_profit_margin\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Net profit margin'\n  AND ci.en_company_name IN ('Joint Stock Commercial Bank For Foreign Trade Of Vietnam', 'Asia Commercial Joint Stock Bank', 'Vietnam Technological And Commercial Joint Stock Bank')\n  AND fr.year >= 2020\n  AND (\n    fr.quarter = 0\n    OR fr.quarter IN (1, 2)\n  )\nORDER BY\n  ci.en_company_name,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.708774566650391,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "a9d94d50-4a5e-4023-8fa7-0ef92a370a01",
        "question": "For Q1 2023, what was the net income attributable to the parent company for  Vinamilk, and what proportion of this net income was generated by its subsidiaries and associates?  Provide a breakdown of the net income contribution from each significant subsidiary if available.",
        "answer": "Table 1\n|   net_income_parent | subsidiary_code   | category   | contribution   |\n|--------------------:|:------------------|:-----------|:---------------|\n|         1.85673e+06 |                   |            |                |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH parent_net_income AS (\n    SELECT \n        stock_code,\n        data AS net_income_parent\n    FROM \n        non_bank_financial_report\n    WHERE \n        stock_code = 'VNM' \n        AND year = 2023 \n        AND quarter = 1 \n        AND category_code = 'IS_061'\n),\nsubsidiary_contributions AS (\n    SELECT \n        s.invest_on AS subsidiary_code,\n        m.en_caption AS category,\n        f.data AS contribution\n    FROM \n        sub_and_shareholder s\n    JOIN \n        non_bank_financial_report f ON s.invest_on = f.stock_code\n    JOIN \n        map_category_code_non_bank m ON f.category_code = m.category_code\n    WHERE \n        s.stock_code = 'VNM'\n        AND f.year = 2023\n        AND f.quarter = 1\n        AND m.en_caption = 'Share of profit/(loss) from joint ventures and associates'\n)\nSELECT \n    p.net_income_parent,\n    s.subsidiary_code,\n    s.category,\n    s.contribution\nFROM \n    parent_net_income p\nLEFT JOIN \n    subsidiary_contributions s ON p.stock_code = 'VNM';\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| net_income   | total_subsidiary_income   | subsidiary_income_proportion   | invest_on   | subsidiary_net_income   |\n|--------------|---------------------------|--------------------------------|-------------|-------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify Vinamilk's stock code and Q1 2023 net income.\n-- We need to find the appropriate category_code for \"net income attributable to the parent company\" in the map_category_code_non_bank table.  \n--  This information is not provided in the schema or sample data.  I will assume a placeholder category code.  \n--  Replace 'IS_XXX' with the actual category code representing net income attributable to the parent company.\n\nWITH VinamilkNetIncome AS (\n    SELECT \n        ci.stock_code,\n        nfr.data as net_income\n    FROM company_info ci\n    JOIN non_bank_financial_report nfr ON ci.stock_code = nfr.stock_code\n    WHERE ci.en_company_name = 'Vietnam Dairy Products Joint Stock Company'\n    AND nfr.year = 2023\n    AND nfr.quarter = 1\n    AND nfr.category_code = 'IS_XXX' -- Replace 'IS_XXX' with the correct category code\n),\n\n-- Step 2: Identify Vinamilk's subsidiaries and their Q1 2023 net income.\nSubsidiaryIncome AS (\n    SELECT \n        sas.invest_on,\n        SUM(nfr.data) as subsidiary_net_income\n    FROM sub_and_shareholder sas\n    JOIN company_info ci ON sas.stock_code = ci.stock_code\n    JOIN non_bank_financial_report nfr ON sas.invest_on = nfr.stock_code\n    WHERE sas.stock_code = (SELECT stock_code FROM VinamilkNetIncome)\n    AND nfr.year = 2023\n    AND nfr.quarter = 1\n    AND nfr.category_code = 'IS_XXX' -- Replace 'IS_XXX' with the correct category code\n    GROUP BY sas.invest_on\n)\n\n-- Combine and calculate the proportion\nSELECT \n    vni.net_income,\n    COALESCE(SUM(si.subsidiary_net_income),0) as total_subsidiary_income,\n    COALESCE(SUM(si.subsidiary_net_income),0) * 100.0 / vni.net_income as subsidiary_income_proportion,\n    si.invest_on,\n    si.subsidiary_net_income\nFROM VinamilkNetIncome vni\nLEFT JOIN SubsidiaryIncome si ON 1=1\nGROUP BY vni.net_income, si.invest_on, si.subsidiary_net_income\nLIMIT 10;\n\n"
            }
        ],
        "time": 8.24715805053711,
        "evaluate": 0,
        "input_token": 4068,
        "output_token": 1154
    },
    {
        "id": "6e85dfc8-0e0f-484a-ac9c-b472109731ef",
        "question": "What was the current ratio for Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   |    data |\n|:-------------|--------:|\n| TCB          | 3.29776 |\n| VCB          | 3.56816 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data\nFROM financial_ratio\nWHERE ratio_code = 'CurrentR'\n  AND stock_code IN ('VCB', 'TCB')\n  AND year = 2022\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|    data |\n|--------:|\n| 3.29776 |\n| 3.56816 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.data\nFROM financial_ratio AS fr\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  ci.stock_code IN ('VCB', 'TCB')\n  AND fr.year = 2022\n  AND mcr.ratio_name = 'Current Ratio'\n  AND fr.quarter = 0\nLIMIT 100;\n"
            }
        ],
        "time": 3.5611066818237305,
        "evaluate": 0,
        "input_token": 3223,
        "output_token": 321
    },
    {
        "id": "22005fc2-07f4-41f8-9b53-2ebb12689756",
        "question": "Compare the Return on Equity (ROE) and the Debt-to-Equity ratio of Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name           |      data |\n|:-------------|-------:|----------:|:---------------------|----------:|\n| MSN          |   2020 |         0 | Debt To Equity Ratio | 3.62386   |\n| MSN          |   2020 |         0 | Return On Equity     | 0.055733  |\n| MSN          |   2021 |         0 | Debt To Equity Ratio | 1.97835   |\n| MSN          |   2021 |         0 | Return On Equity     | 0.238597  |\n| MSN          |   2022 |         0 | Debt To Equity Ratio | 2.85795   |\n| MSN          |   2022 |         0 | Return On Equity     | 0.129771  |\n| MSN          |   2023 |         0 | Debt To Equity Ratio | 2.85445   |\n| MSN          |   2023 |         0 | Return On Equity     | 0.0489033 |\n| MSN          |   2024 |         1 | Debt To Equity Ratio | 2.77309   |\n| MSN          |   2024 |         1 | Return On Equity     | 0.0123309 |\n| SAB          |   2020 |         0 | Debt To Equity Ratio | 0.290342  |\n| SAB          |   2020 |         0 | Return On Equity     | 0.232702  |\n| SAB          |   2021 |         0 | Debt To Equity Ratio | 0.349295  |\n| SAB          |   2021 |         0 | Return On Equity     | 0.173903  |\n| SAB          |   2022 |         0 | Debt To Equity Ratio | 0.401541  |\n| SAB          |   2022 |         0 | Return On Equity     | 0.223652  |\n| SAB          |   2023 |         0 | Debt To Equity Ratio | 0.336332  |\n| SAB          |   2023 |         0 | Return On Equity     | 0.166962  |\n| SAB          |   2024 |         1 | Debt To Equity Ratio | 0.215054  |\n| SAB          |   2024 |         1 | Return On Equity     | 0.038694  |\n| SAB          |   2024 |         2 | Debt To Equity Ratio | 0.359095  |\n| SAB          |   2024 |         2 | Return On Equity     | 0.0524845 |\n| VNM          |   2020 |         0 | Debt To Equity Ratio | 0.439424  |\n| VNM          |   2020 |         0 | Return On Equity     | 0.333928  |\n| VNM          |   2021 |         0 | Debt To Equity Ratio | 0.487649  |\n| VNM          |   2021 |         0 | Return On Equity     | 0.296583  |\n| VNM          |   2022 |         0 | Debt To Equity Ratio | 0.477386  |\n| VNM          |   2022 |         0 | Return On Equity     | 0.26138   |\n| VNM          |   2023 |         0 | Debt To Equity Ratio | 0.503847  |\n| VNM          |   2023 |         0 | Return On Equity     | 0.257506  |\n| VNM          |   2024 |         1 | Debt To Equity Ratio | 0.440127  |\n| VNM          |   2024 |         1 | Return On Equity     | 0.0615314 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND mccr.ratio_code IN ('ROE', 'DTER')\n    AND (\n        (fr.year = 2020 AND fr.quarter = 0) OR\n        (fr.year = 2021 AND fr.quarter = 0) OR\n        (fr.year = 2022 AND fr.quarter = 0) OR\n        (fr.year = 2023 AND fr.quarter = 0) OR\n        (fr.year = 2024 AND fr.quarter IN (1, 2))\n    )\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, mccr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs\n\nWITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n')\n)\n\n-- Step 2: Retrieve ROE and Debt-to-Equity ratio\n\nSELECT \n    ci.company_name,\n    fr.year,\n    fr.quarter,\n    fr.data as roe,\n    dter.data as dter\nFROM CompanyIDs ci\nJOIN financial_ratio fr ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nLEFT JOIN financial_ratio dter ON ci.stock_code = dter.stock_code AND dter.ratio_code = 'DTER' AND fr.year = dter.year AND fr.quarter = dter.quarter\nWHERE mcr.ratio_name = 'Return On Equity'\nAND fr.year >= 2020\nAND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <=2))\nLIMIT 100;\n"
            }
        ],
        "time": 5.392423868179321,
        "evaluate": 0,
        "input_token": 5348,
        "output_token": 759
    },
    {
        "id": "18574cdb-3c4f-4bed-ba96-57d62355afc8",
        "question": "What is the Return on Equity (ROE) and Return on Assets (ROA) for Vinamilk and Masan Group from 2020 to Q2 2024?  Provide data for each quarter separately.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name       |         data |\n|:-------------|-------:|----------:|:-----------------|-------------:|\n| MSN          |   2020 |         1 | Return On Assets | -0.00205902  |\n| MSN          |   2020 |         1 | Return On Equity | -0.00419562  |\n| MSN          |   2020 |         2 | Return On Assets |  0.000518152 |\n| MSN          |   2020 |         2 | Return On Equity |  0.00174282  |\n| MSN          |   2020 |         3 | Return On Assets |  0.00890101  |\n| MSN          |   2020 |         3 | Return On Equity |  0.0340108   |\n| MSN          |   2020 |         4 | Return On Assets |  0.00504934  |\n| MSN          |   2020 |         4 | Return On Equity |  0.0233474   |\n| MSN          |   2021 |         1 | Return On Assets |  0.0029478   |\n| MSN          |   2021 |         1 | Return On Equity |  0.0134906   |\n| MSN          |   2021 |         2 | Return On Assets |  0.00872816  |\n| MSN          |   2021 |         2 | Return On Equity |  0.0335106   |\n| MSN          |   2021 |         3 | Return On Assets |  0.0128556   |\n| MSN          |   2021 |         3 | Return On Equity |  0.0490112   |\n| MSN          |   2021 |         4 | Return On Assets |  0.056457    |\n| MSN          |   2021 |         4 | Return On Equity |  0.168149    |\n| MSN          |   2022 |         1 | Return On Assets |  0.0152471   |\n| MSN          |   2022 |         1 | Return On Equity |  0.0515801   |\n| MSN          |   2022 |         2 | Return On Assets |  0.00969881  |\n| MSN          |   2022 |         2 | Return On Equity |  0.0313142   |\n| MSN          |   2022 |         3 | Return On Assets |  0.00654813  |\n| MSN          |   2022 |         3 | Return On Equity |  0.0236221   |\n| MSN          |   2022 |         4 | Return On Assets |  0.00568514  |\n| MSN          |   2022 |         4 | Return On Equity |  0.021933    |\n| MSN          |   2023 |         1 | Return On Assets |  0.00301441  |\n| MSN          |   2023 |         1 | Return On Equity |  0.0118431   |\n| MSN          |   2023 |         2 | Return On Assets |  0.00304694  |\n| MSN          |   2023 |         2 | Return On Equity |  0.0114376   |\n| MSN          |   2023 |         3 | Return On Assets |  0.0033398   |\n| MSN          |   2023 |         3 | Return On Equity |  0.0127258   |\n| MSN          |   2023 |         4 | Return On Assets |  0.00350634  |\n| MSN          |   2023 |         4 | Return On Equity |  0.013515    |\n| MSN          |   2024 |         1 | Return On Assets |  0.00326811  |\n| MSN          |   2024 |         1 | Return On Equity |  0.0123309   |\n| VNM          |   2020 |         1 | Return On Assets |  0.0602688   |\n| VNM          |   2020 |         1 | Return On Equity |  0.0861112   |\n| VNM          |   2020 |         2 | Return On Assets |  0.0621928   |\n| VNM          |   2020 |         2 | Return On Equity |  0.095333    |\n| VNM          |   2020 |         3 | Return On Assets |  0.0622698   |\n| VNM          |   2020 |         3 | Return On Equity |  0.0990225   |\n| VNM          |   2020 |         4 | Return On Assets |  0.0461712   |\n| VNM          |   2020 |         4 | Return On Equity |  0.0664599   |\n| VNM          |   2021 |         1 | Return On Assets |  0.0508692   |\n| VNM          |   2021 |         1 | Return On Equity |  0.0764615   |\n| VNM          |   2021 |         2 | Return On Assets |  0.0539576   |\n| VNM          |   2021 |         2 | Return On Equity |  0.0832651   |\n| VNM          |   2021 |         3 | Return On Assets |  0.0568629   |\n| VNM          |   2021 |         3 | Return On Equity |  0.0874017   |\n| VNM          |   2021 |         4 | Return On Assets |  0.0414871   |\n| VNM          |   2021 |         4 | Return On Equity |  0.0617182   |\n| VNM          |   2022 |         1 | Return On Assets |  0.043085    |\n| VNM          |   2022 |         1 | Return On Equity |  0.06528     |\n| VNM          |   2022 |         2 | Return On Assets |  0.039045    |\n| VNM          |   2022 |         2 | Return On Equity |  0.057095    |\n| VNM          |   2022 |         3 | Return On Assets |  0.0453687   |\n| VNM          |   2022 |         3 | Return On Equity |  0.0686339   |\n| VNM          |   2022 |         4 | Return On Assets |  0.0385524   |\n| VNM          |   2022 |         4 | Return On Equity |  0.0569567   |\n| VNM          |   2023 |         1 | Return On Assets |  0.0386935   |\n| VNM          |   2023 |         1 | Return On Equity |  0.0552366   |\n| VNM          |   2023 |         2 | Return On Assets |  0.0811356   |\n| VNM          |   2023 |         2 | Return On Equity |  0.112804    |\n| VNM          |   2023 |         3 | Return On Assets |  0.0460866   |\n| VNM          |   2023 |         3 | Return On Equity |  0.0745011   |\n| VNM          |   2023 |         4 | Return On Assets |  0.044628    |\n| VNM          |   2023 |         4 | Return On Equity |  0.0671136   |\n| VNM          |   2024 |         1 | Return On Assets |  0.0427264   |\n| VNM          |   2024 |         1 | Return On Equity |  0.0615314   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mcr.ratio_name,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN')\n    AND mcr.ratio_name IN ('Return On Equity', 'Return On Assets')\n    AND ((fr.year = 2020 AND fr.quarter != 0) OR\n         (fr.year = 2021 AND fr.quarter != 0) OR\n         (fr.year = 2022 AND fr.quarter != 0) OR\n         (fr.year = 2023 AND fr.quarter != 0) OR\n         (fr.year = 2024 AND fr.quarter IN (1, 2)))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, mcr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs for Vinamilk and Masan Group.\nWITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan')\n)\n\n-- Step 2: Retrieve the quarterly ROE and ROA values.\nSELECT\n  ci.company_name,\n  fr.year,\n  fr.quarter,\n  mccr.ratio_name,\n  fr.data\nFROM CompanyIDs AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio AS mccr\n  ON fr.ratio_code = mccr.ratio_code\nWHERE\n  mccr.ratio_name IN ('Return On Equity', 'Return On Assets')\n  AND fr.year >= 2020\n  AND fr.year <= 2024\n  AND (fr.quarter BETWEEN 1 AND 2 OR fr.quarter = 0) -- Include all quarters up to Q2 2024 and annual reports.\nORDER BY\n  ci.company_name,\n  fr.year,\n  fr.quarter,\n  mccr.ratio_name\nLIMIT 100;\n\n"
            }
        ],
        "time": 4.882048606872559,
        "evaluate": 0,
        "input_token": 347,
        "output_token": 65
    },
    {
        "id": "55ac4539-ffb5-4f26-ac74-c282a46db6b7",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual data from 2020 to 2023\n        OR (year = 2024 AND quarter BETWEEN 1 AND 2) -- Quarterly data for Q1 and Q2 of 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs.\nWITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('VCB', 'TCB', 'ACB') -- Vietcombank, Techcombank, ACB\n)\n\n-- Step 2: Extract ROE data.\nSELECT\n  ci.stock_code,\n  ci.en_company_name,\n  fr.year,\n  fr.quarter,\n  fr.data AS roe\nFROM CompanyIDs AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY\n  ci.stock_code,\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.669087886810303,
        "evaluate": 0,
        "input_token": 3946,
        "output_token": 623
    },
    {
        "id": "8f89fda6-e0a1-4b9e-851f-61c5b9d2a533",
        "question": "Compare the Net Profit Margin and the Current Ratio of Vinamilk and Masan Group from 2020 to Q2 2024.  Analyze the changes in these ratios over time for both companies, focusing on any significant variations and potential contributing factors.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name    |     data |\n|:-------------|-------:|----------:|:--------------|---------:|\n| MSN          |   2020 |         0 | Current Ratio | 0.773354 |\n| MSN          |   2021 |         0 | Current Ratio | 1.27032  |\n| MSN          |   2022 |         0 | Current Ratio | 0.73558  |\n| MSN          |   2023 |         0 | Current Ratio | 0.874439 |\n| VNM          |   2020 |         0 | Current Ratio | 2.09132  |\n| VNM          |   2021 |         0 | Current Ratio | 2.11895  |\n| VNM          |   2022 |         0 | Current Ratio | 2.06801  |\n| VNM          |   2023 |         0 | Current Ratio | 2.1016   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN')\n    AND mccr.ratio_code IN ('NPM', 'CurrentR')\n    AND (\n        (fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR\n        (fr.year = 2024 AND fr.quarter = 2)\n    )\nORDER BY \n    fr.stock_code, \n    fr.year, \n    fr.quarter, \n    mccr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| ratio_code   | stock_code   |   year |   quarter |     data |\n|:-------------|:-------------|-------:|----------:|---------:|\n| CurrentR     | MSN          |   2020 |         0 | 0.773354 |\n| CurrentR     | MSN          |   2020 |         1 | 0.943772 |\n| CurrentR     | MSN          |   2020 |         2 | 0.671478 |\n| CurrentR     | MSN          |   2020 |         3 | 0.69027  |\n| CurrentR     | MSN          |   2020 |         4 | 0.773354 |\n| CurrentR     | MSN          |   2021 |         0 | 1.27032  |\n| CurrentR     | MSN          |   2021 |         1 | 0.838925 |\n| CurrentR     | MSN          |   2021 |         2 | 0.913651 |\n| CurrentR     | MSN          |   2021 |         3 | 0.935449 |\n| CurrentR     | MSN          |   2021 |         4 | 1.27032  |\n| CurrentR     | MSN          |   2022 |         0 | 0.73558  |\n| CurrentR     | MSN          |   2022 |         1 | 1.00047  |\n| CurrentR     | MSN          |   2022 |         2 | 0.709978 |\n| CurrentR     | MSN          |   2022 |         3 | 0.585935 |\n| CurrentR     | MSN          |   2022 |         4 | 0.73558  |\n| CurrentR     | MSN          |   2023 |         0 | 0.874439 |\n| CurrentR     | MSN          |   2023 |         1 | 0.851707 |\n| CurrentR     | MSN          |   2023 |         2 | 0.804937 |\n| CurrentR     | MSN          |   2023 |         3 | 0.893996 |\n| CurrentR     | MSN          |   2023 |         4 | 0.874439 |\n| CurrentR     | MSN          |   2024 |         1 | 0.87025  |\n| CurrentR     | VNM          |   2020 |         0 | 2.09132  |\n| CurrentR     | VNM          |   2020 |         1 | 2.00177  |\n| CurrentR     | VNM          |   2020 |         2 | 1.80774  |\n| CurrentR     | VNM          |   2020 |         3 | 1.73972  |\n| CurrentR     | VNM          |   2020 |         4 | 2.09132  |\n| CurrentR     | VNM          |   2021 |         0 | 2.11895  |\n| CurrentR     | VNM          |   2021 |         1 | 1.99828  |\n| CurrentR     | VNM          |   2021 |         2 | 1.93904  |\n| CurrentR     | VNM          |   2021 |         3 | 1.9431   |\n| CurrentR     | VNM          |   2021 |         4 | 2.11895  |\n| CurrentR     | VNM          |   2022 |         0 | 2.06801  |\n| CurrentR     | VNM          |   2022 |         1 | 2.01857  |\n| CurrentR     | VNM          |   2022 |         2 | 2.22061  |\n| CurrentR     | VNM          |   2022 |         3 | 2.03288  |\n| CurrentR     | VNM          |   2022 |         4 | 2.06801  |\n| CurrentR     | VNM          |   2023 |         0 | 2.1016   |\n| CurrentR     | VNM          |   2023 |         1 | 2.25658  |\n| CurrentR     | VNM          |   2023 |         2 | 2.43804  |\n| CurrentR     | VNM          |   2023 |         3 | 1.85089  |\n| CurrentR     | VNM          |   2023 |         4 | 2.1016   |\n| CurrentR     | VNM          |   2024 |         1 | 2.30115  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.ratio_code,\n  fr.stock_code,\n  fr.year,\n  fr.quarter,\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  (\n    ci.stock_code = 'VNM' OR ci.stock_code = 'MSN'\n  )\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024 OR (\n      fr.year = 2024 AND fr.quarter <= 2\n    )\n  )\n  AND mcr.ratio_name IN ('Net profit margin', 'Current Ratio')\nORDER BY\n  fr.stock_code,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.827759265899658,
        "evaluate": 0,
        "input_token": 5971,
        "output_token": 737
    },
    {
        "id": "6bd17126-d46e-4133-bedf-a54fcef397a2",
        "question": "What were the Return on Equity (ROE) and Return on Assets (ROA) for Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| VCB          | ROE          |     0.220567  |\n| TCB          | ROA          |     0.0292353 |\n| TCB          | ROE          |     0.180176  |\n| VCB          | ROA          |     0.0164951 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    ratio_code, \n    data AS ratio_value\nFROM \n    financial_ratio\nWHERE \n    (stock_code = 'VCB' OR stock_code = 'TCB') \n    AND (ratio_code = 'ROE' OR ratio_code = 'ROA') \n    AND year = 2022 \n    AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| ratio_code   |      data |\n|:-------------|----------:|\n| ROA          | 0.0292353 |\n| ROE          | 0.180176  |\n| ROA          | 0.0164951 |\n| ROE          | 0.220567  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.ratio_code,\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  (\n    ci.stock_code = 'VCB' OR ci.stock_code = 'TCB'\n  )\n  AND fr.year = 2022\n  AND fr.quarter = 0\n  AND mcr.ratio_name IN ('Return On Equity', 'Return On Assets')\nLIMIT 10;\n"
            }
        ],
        "time": 4.193659067153931,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "bae902e9-0a14-42b8-a499-26336872e762",
        "question": "Compare the Net Income, Total Assets, and Total Liabilities of Vinamilk and Masan Group for the fiscal year 2023.  Calculate the Debt-to-Equity ratio for both companies.",
        "answer": "Table 1\n| stock_code   |   net_income |   total_assets |   total_liabilities |   debt_to_equity_ratio |\n|:-------------|-------------:|---------------:|--------------------:|-----------------------:|\n| MSN          |  2.35043e+06 |    1.47383e+08 |         1.09146e+08 |               2.85445  |\n| VNM          |  1.09036e+07 |    5.26734e+07 |         1.76476e+07 |               0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH financial_data AS (\n    SELECT \n        stock_code,\n        SUM(CASE WHEN category_code = 'IS_030' THEN data ELSE 0 END) AS net_income,\n        SUM(CASE WHEN category_code = 'BS_270' THEN data ELSE 0 END) AS total_assets,\n        SUM(CASE WHEN category_code = 'BS_300' THEN data ELSE 0 END) AS total_liabilities\n    FROM \n        non_bank_financial_report\n    WHERE \n        stock_code IN ('VNM', 'MSN') AND\n        year = 2023 AND\n        quarter = 0\n    GROUP BY \n        stock_code\n)\nSELECT \n    fd.stock_code,\n    fd.net_income,\n    fd.total_assets,\n    fd.total_liabilities,\n    (fd.total_liabilities / (fd.total_assets - fd.total_liabilities)) AS debt_to_equity_ratio\nFROM \n    financial_data fd;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| company_name   | net_income   | total_assets   | total_liabilities   | debt_to_equity_ratio   |\n|----------------|--------------|----------------|---------------------|------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH company_data AS (\n  SELECT\n    ci.stock_code,\n    ci.company_name,\n    nfr.data AS net_income,\n    (\n      SELECT\n        data\n      FROM non_bank_financial_report\n      WHERE\n        stock_code = ci.stock_code\n        AND year = 2023\n        AND quarter = 0\n        AND category_code = 'BS_100'\n    ) AS total_assets,\n    (\n      SELECT\n        data\n      FROM non_bank_financial_report\n      WHERE\n        stock_code = ci.stock_code\n        AND year = 2023\n        AND quarter = 0\n        AND category_code = 'BS_200'\n    ) AS total_liabilities\n  FROM company_info AS ci\n  JOIN non_bank_financial_report AS nfr\n    ON ci.stock_code = nfr.stock_code\n  WHERE\n    ci.stock_code IN ('VNM', 'MSN')\n    AND nfr.year = 2023\n    AND nfr.quarter = 0\n    AND nfr.category_code = 'IS_004'\n), ratio_data AS (\n  SELECT\n    fr.stock_code,\n    fr.data AS debt_to_equity_ratio\n  FROM financial_ratio AS fr\n  WHERE\n    fr.ratio_code = 'DTER'\n    AND fr.year = 2023\n    AND fr.quarter = 0\n)\nSELECT\n  cd.company_name,\n  cd.net_income,\n  cd.total_assets,\n  cd.total_liabilities,\n  COALESCE(rd.debt_to_equity_ratio, (\n    cd.total_liabilities / (\n      cd.total_assets - cd.total_liabilities\n    )\n  )) AS debt_to_equity_ratio\nFROM company_data AS cd\nLEFT JOIN ratio_data AS rd\n  ON cd.stock_code = rd.stock_code\nORDER BY\n  cd.company_name\nLIMIT 2;\n"
            }
        ],
        "time": 6.974188327789307,
        "evaluate": 0,
        "input_token": 3395,
        "output_token": 753
    },
    {
        "id": "ccdf4a0a-dd91-4147-a7b5-61cd342fc390",
        "question": "For the year 2021, what were the values of  accounts receivable, and inventory for Mobile World Investment, Vinamilk, and Masan Group?  Additionally, provide a breakdown of the investments in subsidiaries or associated companies for each of these companies, specifying the investment value and the nature of the investment (e.g., equity stake, loan).",
        "answer": "Table 1\n| stock_code   | category                                    |            value |\n|:-------------|:--------------------------------------------|-----------------:|\n| VNM          | Trade receivables                           |      4.36777e+06 |\n| VNM          | Inventories                                 |      6.82049e+06 |\n| MSN          | Trade receivables                           |      2.48022e+06 |\n| MSN          | Inventories                                 |      1.29479e+07 |\n| MWG          | Trade receivables                           | 384236           |\n| MWG          | Inventories                                 |      2.98501e+07 |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to get accounts receivable and inventory values for the specified companies\nSELECT \n    nbfr.stock_code,\n    mccnb.en_caption AS category,\n    nbfr.data AS value\nFROM \n    non_bank_financial_report nbfr\nJOIN \n    map_category_code_non_bank mccnb ON nbfr.category_code = mccnb.category_code\nWHERE \n    nbfr.stock_code IN ('MWG', 'VNM', 'MSN')\n    AND nbfr.year = 2021\n    AND nbfr.quarter = 0\n    AND nbfr.category_code IN ('BS_131', 'BS_141')\n\nUNION ALL\n\n-- Query to get investment details for the specified companies\nSELECT \n    s.stock_code,\n    CASE \n        WHEN nbfr.category_code = 'BS_251' THEN 'Investment in subsidiaries'\n        WHEN nbfr.category_code = 'BS_252' THEN 'Investment in associates and joint ventures'\n    END AS category,\n    nbfr.data AS value\nFROM \n    non_bank_financial_report nbfr\nJOIN \n    sub_and_shareholder s ON nbfr.stock_code = s.stock_code\nWHERE \n    nbfr.stock_code IN ('MWG', 'VNM', 'MSN')\n    AND nbfr.year = 2021\n    AND nbfr.quarter = 0\n    AND nbfr.category_code IN ('BS_251', 'BS_252');\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| company_name   | accounts_receivable   |\n|----------------|-----------------------|\n\nTable 2\n| company_name   | invested_company   |\n|----------------|--------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve accounts receivable and inventory values for specified companies.\n--  Unfortunately, the provided schema and data do not contain information on what category codes represent \"accounts receivable\" and \"inventory\" in the non_bank_financial_report table.  The query below will need to be modified once this information is available.  Replace 'YOUR_ACCOUNTS_RECEIVABLE_CODE' and 'YOUR_INVENTORY_CODE' with the actual category codes.\n\nSELECT\n    ci.company_name,\n    nbfr.data AS accounts_receivable\nFROM\n    company_info ci\nJOIN\n    non_bank_financial_report nbfr ON ci.stock_code = nbfr.stock_code\nWHERE\n    ci.company_name IN ('Mobile World Investment Corporation', 'Vietnam Dairy Products Joint Stock Company', 'Masan Group Corporation')\n    AND nbfr.year = 2021\n    AND nbfr.quarter = 0\n    AND nbfr.category_code = 'YOUR_ACCOUNTS_RECEIVABLE_CODE' -- Replace with actual category code\n\nUNION ALL\n\nSELECT\n    ci.company_name,\n    nbfr.data AS inventory\nFROM\n    company_info ci\nJOIN\n    non_bank_financial_report nbfr ON ci.stock_code = nbfr.stock_code\nWHERE\n    ci.company_name IN ('Mobile World Investment Corporation', 'Vietnam Dairy Products Joint Stock Company', 'Masan Group Corporation')\n    AND nbfr.year = 2021\n    AND nbfr.quarter = 0\n    AND nbfr.category_code = 'YOUR_INVENTORY_CODE'; -- Replace with actual category code\n\n\n\n-- Step 2: Retrieve investment details.\n--  The provided schema does not include information about the nature or value of investments.  The query below only retrieves the list of investments.  Additional information is needed in the database to provide the requested investment value and type.\n\nSELECT\n    ci.company_name,\n    ci2.company_name AS invested_company\nFROM\n    company_info ci\nJOIN\n    sub_and_shareholder sas ON ci.stock_code = sas.stock_code\nJOIN\n    company_info ci2 ON sas.invest_on = ci2.stock_code\nWHERE\n    ci.company_name IN ('Mobile World Investment Corporation', 'Vietnam Dairy Products Joint Stock Company', 'Masan Group Corporation')\nLIMIT 100;\n\n"
            }
        ],
        "time": 8.127803802490234,
        "evaluate": 0,
        "input_token": 2305,
        "output_token": 746
    },
    {
        "id": "a49609f8-52db-4822-bc87-a6f207297116",
        "question": "What were the Return on Equity (ROE) and Return on Assets (ROA) for Vietcombank, Techcombank, and ACB in 2022?",
        "answer": "Table 1\n| stock_code   | ratio_code   |      data |\n|:-------------|:-------------|----------:|\n| TCB          | ROA          | 0.0292353 |\n| TCB          | ROE          | 0.180176  |\n| VCB          | ROA          | 0.0164951 |\n| ACB          | ROA          | 0.0225181 |\n| ACB          | ROE          | 0.234232  |\n| VCB          | ROE          | 0.220567  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    ratio_code, \n    data \nFROM \n    financial_ratio \nWHERE \n    (stock_code = 'VCB' OR stock_code = 'TCB' OR stock_code = 'ACB') \n    AND (ratio_code = 'ROE' OR ratio_code = 'ROA') \n    AND year = 2022 \n    AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| ratio_code   |      data |\n|:-------------|----------:|\n| ROA          | 0.0225181 |\n| ROE          | 0.234232  |\n| ROA          | 0.0292353 |\n| ROE          | 0.180176  |\n| ROA          | 0.0164951 |\n| ROE          | 0.220567  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.ratio_code,\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  ci.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND fr.year = 2022\n  AND fr.quarter = 0\n  AND mcr.ratio_name IN ('Return On Equity', 'Return On Assets')\nLIMIT 6;\n"
            }
        ],
        "time": 3.8693037033081055,
        "evaluate": 0,
        "input_token": 10549,
        "output_token": 1495
    },
    {
        "id": "8dbfe18f-c50c-4fc6-b067-98938f4e5f02",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) exceeding 20% as of Q2 2024, based on their financial statements.",
        "answer": "Table 1\n| stock_code   | industry   | roe   |\n|--------------|------------|-------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE' \n    AND fr.year = 2024 \n    AND fr.quarter = 2 \n    AND fr.data > 20\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | roe   |\n|--------------|-------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  stock_code,\n  data AS roe\nFROM financial_ratio\nWHERE\n  ratio_code = 'ROE' AND year = 2024 AND quarter = 2 AND data > 0.2\nORDER BY\n  roe DESC\nLIMIT 5;\n"
            }
        ],
        "time": 3.0631165504455566,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "d839218c-d2ce-460b-855c-57b2db066d6b",
        "question": "What were the values of Total Assets, Total Liabilities, and Net Income for Vinamilk, Masan Group, and Mobile World Investment in 2023?",
        "answer": "Table 1\n| stock_code   |   year | category                             |        data |\n|:-------------|-------:|:-------------------------------------|------------:|\n| VNM          |   2023 | Net profit from operating activities | 1.09036e+07 |\n| MSN          |   2023 | Net profit from operating activities | 2.35043e+06 |\n| MSN          |   2023 | TOTAL ASSETS                         | 1.47383e+08 |\n| MSN          |   2023 | C. LIABILITIES                       | 1.09146e+08 |\n| MWG          |   2023 | Net profit from operating activities | 1.04707e+06 |\n| VNM          |   2023 | TOTAL ASSETS                         | 5.26734e+07 |\n| VNM          |   2023 | C. LIABILITIES                       | 1.76476e+07 |\n| MWG          |   2023 | TOTAL ASSETS                         | 6.01112e+07 |\n| MWG          |   2023 | C. LIABILITIES                       | 3.67517e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    nfr.year,\n    mcc.en_caption AS category,\n    nfr.data\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.year = 2023\n    AND nfr.quarter = 0\n    AND nfr.stock_code IN ('VNM', 'MSN', 'MWG')\n    AND nfr.category_code IN ('BS_270', 'BS_300', 'IS_030');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs.  This assumes the company names provided are accurate and match the database.\nSELECT stock_code\nINTO temp_company_ids\nFROM company_info\nWHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng');\n\n\n-- Step 2: Retrieve financial data.  This query assumes that 'Total Assets', 'Total Liabilities', and 'Net Income' have corresponding category codes in the non_bank_financial_report table.  You'll need to replace 'BS_XXX', 'BS_YYY', and 'IS_ZZZ' with the actual category codes from map_category_code_non_bank.  The query also assumes that the data is available in the non_bank_financial_report table.  If not, adjust accordingly.\n\nSELECT \n    t1.stock_code,\n    MAX(CASE WHEN t2.en_caption = 'Total Assets' THEN t1.data ELSE NULL END) as Total_Assets,\n    MAX(CASE WHEN t2.en_caption = 'Total Liabilities' THEN t1.data ELSE NULL END) as Total_Liabilities,\n    MAX(CASE WHEN t2.en_caption = 'Net Income' THEN t1.data ELSE NULL END) as Net_Income\nFROM non_bank_financial_report t1\nJOIN map_category_code_non_bank t2 ON t1.category_code = t2.category_code\nJOIN temp_company_ids t3 ON t1.stock_code = t3.stock_code\nWHERE t1.year = 2023 AND t1.quarter = 0\nGROUP BY t1.stock_code;\n\nDROP TABLE temp_company_ids;\n"
            }
        ],
        "time": 5.708893060684204,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "9bd1bf8b-a936-4ee0-b7ef-3f081505fae5",
        "question": "What were the total current assets and current liabilities for Vietcombank, Techcombank, and VPBank in 2022, and what were their respective current ratios for that year?  Further, provide the details of their significant subsidiaries' contribution to these figures.",
        "answer": "Table 1\n| stock_code   |   total_current_assets |   total_current_liabilities |   current_ratio | subsidiary_stock_code   |   subsidiary_current_assets |   subsidiary_current_liabilities |\n|:-------------|-----------------------:|----------------------------:|----------------:|:------------------------|----------------------------:|---------------------------------:|\n| TCB          |                      0 |              7826           |         3.29776 |                         |                             |                                  |\n| VCB          |                      0 |                 6.73148e+07 |         3.56816 | EIB                     |                           0 |                  48522           |\n| VCB          |                      0 |                 6.73148e+07 |         3.56816 | MBB                     |                           0 |                  63576           |\n| VCB          |                      0 |                 6.73148e+07 |         3.56816 | OCB                     |                           0 |                      5.18926e+06 |\n| VPB          |                      0 |                 1.92923e+06 |         2.24166 |                         |                             |                                  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve total current assets and current liabilities for the specified banks\nWITH bank_assets_liabilities AS (\n    SELECT \n        stock_code,\n        SUM(CASE WHEN category_code = 'BS_100' THEN data ELSE 0 END) AS total_current_assets,\n        SUM(CASE WHEN category_code = 'BS_310' THEN data ELSE 0 END) AS total_current_liabilities\n    FROM \n        bank_financial_report\n    WHERE \n        stock_code IN ('VCB', 'TCB', 'VPB')\n        AND year = 2022\n        AND quarter = 0\n    GROUP BY \n        stock_code\n),\n\n-- Step 2: Retrieve current ratio for the specified banks\nbank_current_ratios AS (\n    SELECT \n        stock_code,\n        data AS current_ratio\n    FROM \n        financial_ratio\n    WHERE \n        ratio_code = 'CurrentR'\n        AND stock_code IN ('VCB', 'TCB', 'VPB')\n        AND year = 2022\n        AND quarter = 0\n),\n\n-- Step 3: Retrieve subsidiaries' contributions\nsubsidiaries_contributions AS (\n    SELECT \n        s.stock_code,\n        s.invest_on,\n        SUM(CASE WHEN f.category_code = 'BS_100' THEN f.data ELSE 0 END) AS subsidiary_current_assets,\n        SUM(CASE WHEN f.category_code = 'BS_310' THEN f.data ELSE 0 END) AS subsidiary_current_liabilities\n    FROM \n        sub_and_shareholder s\n    JOIN \n        bank_financial_report f ON s.invest_on = f.stock_code\n    WHERE \n        s.stock_code IN ('VCB', 'TCB', 'VPB')\n        AND f.year = 2022\n        AND f.quarter = 0\n    GROUP BY \n        s.stock_code, s.invest_on\n)\n\n-- Final output combining all the information\nSELECT \n    a.stock_code,\n    a.total_current_assets,\n    a.total_current_liabilities,\n    r.current_ratio,\n    sc.invest_on AS subsidiary_stock_code,\n    sc.subsidiary_current_assets,\n    sc.subsidiary_current_liabilities\nFROM \n    bank_assets_liabilities a\nJOIN \n    bank_current_ratios r ON a.stock_code = r.stock_code\nLEFT JOIN \n    subsidiaries_contributions sc ON a.stock_code = sc.stock_code\nORDER BY \n    a.stock_code, sc.invest_on;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| en_company_name   | current_assets   | current_liabilities   | current_ratio   |\n|-------------------|------------------|-----------------------|-----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH BankInfo AS (\n  SELECT\n    ci.stock_code,\n    ci.en_company_name\n  FROM company_info AS ci\n  WHERE\n    ci.stock_code IN ('VCB', 'TCB', 'VPB')\n), Subsidiaries AS (\n  SELECT\n    sas.invest_on AS subsidiary_code\n  FROM sub_and_shareholder AS sas\n  WHERE\n    sas.stock_code IN ('VCB', 'TCB', 'VPB')\n), ConsolidatedFinancials AS (\n  SELECT\n    COALESCE(bi.stock_code, s.subsidiary_code) AS stock_code,\n    SUM(CASE WHEN mcb.en_caption = 'Total assets' THEN nbfr.data ELSE 0 END) AS total_assets,\n    SUM(CASE WHEN mcb.en_caption = 'Total liabilities' THEN nbfr.data ELSE 0 END) AS total_liabilities,\n    SUM(CASE WHEN mcb.en_caption = 'Current liabilities' THEN nbfr.data ELSE 0 END) AS current_liabilities,\n    SUM(CASE WHEN mcb.en_caption = 'Current assets' THEN nbfr.data ELSE 0 END) AS current_assets\n  FROM BankInfo AS bi\n  FULL OUTER JOIN Subsidiaries AS s\n    ON bi.stock_code = s.subsidiary_code\n  LEFT JOIN non_bank_financial_report AS nbfr\n    ON COALESCE(bi.stock_code, s.subsidiary_code) = nbfr.stock_code\n  LEFT JOIN map_category_code_non_bank AS mcb\n    ON nbfr.category_code = mcb.category_code\n  WHERE\n    nbfr.year = 2022 AND nbfr.quarter = 0\n  GROUP BY\n    COALESCE(bi.stock_code, s.subsidiary_code)\n), Ratios AS (\n  SELECT\n    cf.stock_code,\n    cf.current_assets,\n    cf.current_liabilities,\n    (\n      cf.current_assets / NULLIF(cf.current_liabilities, 0)\n    ) AS current_ratio\n  FROM ConsolidatedFinancials AS cf\n)\nSELECT\n  bi.en_company_name,\n  r.current_assets,\n  r.current_liabilities,\n  r.current_ratio\nFROM BankInfo AS bi\nJOIN Ratios AS r\n  ON bi.stock_code = r.stock_code\nLIMIT 100;\n"
            }
        ],
        "time": 7.332148313522339,
        "evaluate": 0,
        "input_token": 2646,
        "output_token": 579
    },
    {
        "id": "1fc45cfe-d70c-4722-89fc-0e61fb8c08ac",
        "question": "Compare the Debt-to-Equity ratio and the Current Ratio of Vinamilk and Masan Group for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   | ratio_code   |     data |\n|:-------------|:-------------|---------:|\n| MSN          | DTER         | 2.85445  |\n| VNM          | DTER         | 0.503847 |\n| MSN          | CurrentR     | 0.874439 |\n| VNM          | CurrentR     | 2.1016   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    ratio_code, \n    data \nFROM \n    financial_ratio \nWHERE \n    (stock_code = 'VNM' OR stock_code = 'MSN') \n    AND year = 2023 \n    AND quarter = 0 \n    AND (ratio_code = 'DTER' OR ratio_code = 'CurrentR');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| en_company_name                            | ratio_code   |     data |\n|:-------------------------------------------|:-------------|---------:|\n| Masan Group Corporation                    | DTER         | 2.85445  |\n| Vietnam Dairy Products Joint Stock Company | DTER         | 0.503847 |\n| Masan Group Corporation                    | CurrentR     | 0.874439 |\n| Vietnam Dairy Products Joint Stock Company | CurrentR     | 2.1016   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.en_company_name,\n  fr.ratio_code,\n  fr.data\nFROM company_info AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  ci.stock_code IN ('VNM', 'MSN')\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND mcr.ratio_code IN ('DTER', 'CurrentR')\nLIMIT 4;\n"
            }
        ],
        "time": 3.93471097946167,
        "evaluate": 1,
        "input_token": 8700,
        "output_token": 1585
    },
    {
        "id": "e7873bd4-6132-4705-a91f-5c55cd3b9b66",
        "question": "What was the average Return on Equity (ROE) for  Vietcombank, Techcombank, and  VPBank  in 2022, and how did this compare to their respective subsidiaries' average ROE for the same year?",
        "answer": "Table 1\n| bank   |   bank_avg_roe |   subsidiary_avg_roe |\n|:-------|---------------:|---------------------:|\n| TCB    |       0.180176 |           nan        |\n| VCB    |       0.220567 |             0.170252 |\n| VPB    |       0.163367 |           nan        |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_roe AS (\n    SELECT \n        stock_code, \n        AVG(data) AS avg_roe\n    FROM \n        financial_ratio\n    WHERE \n        ratio_code = 'ROE' \n        AND year = 2022 \n        AND quarter = 0\n        AND stock_code IN ('VCB', 'TCB', 'VPB')\n    GROUP BY \n        stock_code\n),\nsubsidiary_roe AS (\n    SELECT \n        s.stock_code, \n        AVG(fr.data) AS avg_roe\n    FROM \n        sub_and_shareholder s\n    JOIN \n        financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE \n        fr.ratio_code = 'ROE' \n        AND fr.year = 2022 \n        AND fr.quarter = 0\n        AND s.stock_code IN ('VCB', 'TCB', 'VPB')\n    GROUP BY \n        s.stock_code\n)\nSELECT \n    b.stock_code AS bank,\n    b.avg_roe AS bank_avg_roe,\n    s.avg_roe AS subsidiary_avg_roe\nFROM \n    bank_roe b\nLEFT JOIN \n    subsidiary_roe s ON b.stock_code = s.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   avg_roe |   avg_sub_roe |\n|:-------------|----------:|--------------:|\n| TCB          |  0.180176 |             0 |\n| VCB          |  0.220567 |             0 |\n| VPB          |  0.163367 |             0 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH ParentROE AS (\n  SELECT\n    fr.stock_code,\n    AVG(fr.data) AS avg_roe\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year = 2022\n    AND fr.stock_code IN ('VCB', 'TCB', 'VPB')\n    AND fr.quarter = 0\n  GROUP BY\n    fr.stock_code\n), SubsidiaryROE AS (\n  SELECT\n    ss.invest_on,\n    AVG(fr.data) AS avg_sub_roe\n  FROM sub_and_shareholder AS ss\n  JOIN financial_ratio AS fr\n    ON ss.invest_on = fr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year = 2022\n    AND ss.stock_code IN ('VCB', 'TCB', 'VPB')\n    AND fr.quarter = 0\n  GROUP BY\n    ss.invest_on\n)\nSELECT\n  p.stock_code,\n  p.avg_roe,\n  COALESCE(s.avg_sub_roe, 0) AS avg_sub_roe\nFROM ParentROE AS p\nLEFT JOIN SubsidiaryROE AS s\n  ON p.stock_code = s.invest_on\nLIMIT 100;\n"
            }
        ],
        "time": 6.141165494918823,
        "evaluate": 0,
        "input_token": 2485,
        "output_token": 257
    },
    {
        "id": "92b00988-89ff-42e7-ae1e-2abd01ab7947",
        "question": "What is the trend of the Net Cash Flow from Operating Activities for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_cash_flow_operating_activities   |\n|--------------|--------|-----------|--------------------------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_cash_flow_operating_activities\nFROM \n    bank_financial_report\nWHERE \n    stock_code IN ('VCB', 'TCB', 'ACB') \n    AND category_code = 'CF_009'\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual reports from 2020 to 2023\n        OR (year = 2024 AND quarter BETWEEN 1 AND 2) -- Quarterly reports for Q1 and Q2 of 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| year   | quarter   | stock_code   | net_cash_flow   |\n|--------|-----------|--------------|-----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantCashFlows AS (\n  SELECT\n    b.year,\n    b.quarter,\n    b.data AS net_cash_flow,\n    ci.stock_code\n  FROM bank_financial_report AS b\n  JOIN company_info AS ci\n    ON b.stock_code = ci.stock_code\n  JOIN map_category_code_bank AS mcb\n    ON b.category_code = mcb.category_code\n  WHERE\n    mcb.en_caption = 'Net cash flow from operating activities before changes in assets and working capital'\n    AND ci.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND b.year >= 2020\n    AND b.year <= 2024\n    AND (\n      b.quarter = 0\n      OR b.quarter BETWEEN 1 AND 2\n    )\n)\nSELECT\n  year,\n  quarter,\n  stock_code,\n  net_cash_flow\nFROM RelevantCashFlows\nORDER BY\n  stock_code,\n  year,\n  quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.790545225143433,
        "evaluate": 0,
        "input_token": 2463,
        "output_token": 542
    },
    {
        "id": "7d5b40dc-a4a2-4e05-96fb-4716676e6d36",
        "question": "Calculate the Debt-to-Equity ratio for  Vinamilk,  Masan Group, and  PetroVietnam Gas in 2023 Q2.  Analyze the relationship between these ratios and the financial health of their respective subsidiaries or investments.",
        "answer": "Table 1\n| stock_code   | en_company_name                            |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|:-------------------------------------------|-------:|----------:|-----------------------:|\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2023 |         2 |               0.390309 |\n| MSN          | Masan Group Corporation                    |   2023 |         2 |               2.75379  |\n| GAS          | PetroVietnam Gas Joint Stock Corporation   |   2023 |         2 |               0.308313 |\n\nTable 2\n| stock_code   | invest_on   | parent_company                           | subsidiary_company                                    |\n|:-------------|:------------|:-----------------------------------------|:------------------------------------------------------|\n| MSN          | TCB         | Masan Group Corporation                  | Vietnam Technological And Commercial Joint Stock Bank |\n| GAS          | PVG         | PetroVietnam Gas Joint Stock Corporation | Petro Vietnam LPG Joint Stock Company                 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve the Debt-to-Equity ratio for the specified companies in 2023 Q2\nSELECT \n    fr.stock_code,\n    ci.en_company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND fr.year = 2023\n    AND fr.quarter = 2\n    AND fr.stock_code IN ('VNM', 'MSN', 'GAS');\n\n-- Step 2: Retrieve the subsidiaries or investments for each company\nSELECT \n    ss.stock_code,\n    ss.invest_on,\n    ci.en_company_name AS parent_company,\n    ci2.en_company_name AS subsidiary_company\nFROM \n    sub_and_shareholder ss\nJOIN \n    company_info ci ON ss.stock_code = ci.stock_code\nJOIN \n    company_info ci2 ON ss.invest_on = ci2.stock_code\nWHERE \n    ss.stock_code IN ('VNM', 'MSN', 'GAS');\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| company_name                                |   debt_to_equity_ratio |\n|:--------------------------------------------|-----------------------:|\n| T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n |               0.308313 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan              |               2.75379  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                |               0.390309 |\n\nTable 2\n| invest_on   |\n|:------------|\n| TCB         |\n| VLC         |\n| MCM         |\n| SBT         |\n| SRF         |\n| TDW         |\n| MSR         |\n| MCH         |\n| VCF         |\n| QHW         |\n| VSN         |\n| MML         |\n| CMF         |\n| CNG         |\n| PVB         |\n| PGD         |\n| PGS         |\n| SSB         |\n| PCG         |\n| PVG         |\n\nTable 3\n| debt_to_equity_ratio   |\n|------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve Debt-to-Equity ratios for specified companies in 2023 Q2.\n\nSELECT \n    ci.company_name,\n    fr.data AS debt_to_equity_ratio\nFROM \n    company_info ci\nJOIN \n    financial_ratio fr ON ci.stock_code = fr.stock_code\nJOIN\n\tmap_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    ci.stock_code IN ('VNM', 'MSN', 'GAS')\n    AND fr.year = 2023\n    AND fr.quarter = 2\n    AND mcr.ratio_name = 'Debt To Equity Ratio'\nLIMIT 3;\n\n\n-- Step 2: Analyze the ratios and their relationship with subsidiary financial health.  This step requires further analysis beyond SQL.\n\n-- The SQL query above provides the Debt-to-Equity ratios.  To analyze the relationship with subsidiary financial health, \n-- we would need to:\n\n-- 1. Identify subsidiaries of VNM, MSN, and GAS using the `sub_and_shareholder` table.\n-- 2. Retrieve Debt-to-Equity ratios for those subsidiaries using similar SQL queries as above.\n-- 3. Compare the ratios of parent companies and their subsidiaries to assess the financial health.  This comparison would be done outside of SQL, likely in a spreadsheet or other analytical tool.  Industry benchmarks and financial health guidelines would also be considered in this external analysis.\n\n-- Example of identifying subsidiaries (Step 1 of the manual analysis):\n\nSELECT invest_on FROM sub_and_shareholder WHERE stock_code IN ('VNM', 'MSN', 'GAS');\n\n-- Example of retrieving Debt-to-Equity ratios for a subsidiary (Step 2 of the manual analysis, assuming a subsidiary's stock code is 'SUB1'):\n\nSELECT fr.data AS debt_to_equity_ratio\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE fr.stock_code = 'SUB1'\n  AND fr.year = 2023\n  AND fr.quarter = 2\n  AND mcr.ratio_name = 'Debt To Equity Ratio'\nLIMIT 1;\n\n-- Note:  The complete analysis (Step 2) is a qualitative assessment that requires interpretation and comparison of the numerical data obtained from the SQL queries.\n"
            }
        ],
        "time": 7.077789783477783,
        "evaluate": 0.5,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "13adfa83-6eb5-4eaf-8f6e-0e57464afbf4",
        "question": "Compare the changes in  Property, Plant, and Equipment (PP&E)  for Vinamilk, Hoa Phat Group, and VinGroup from 2020 to Q2 2024.  Show the net increase/decrease each year.",
        "answer": "Table 1\n| stock_code   |   year |   net_change |\n|:-------------|-------:|-------------:|\n| HPG          |   2020 |  1.31123e+08 |\n| HPG          |   2021 |  7.43837e+06 |\n| HPG          |   2022 |  3.10415e+06 |\n| HPG          |   2023 |  2.33091e+06 |\n| HPG          |   2024 | -3.84744e+06 |\n| VIC          |   2020 |  2.5128e+08  |\n| VIC          |   2021 |  1.01122e+07 |\n| VIC          |   2022 | -2.1907e+07  |\n| VIC          |   2023 |  8.13337e+07 |\n| VIC          |   2024 |  6.03128e+07 |\n| VNM          |   2020 |  2.77076e+07 |\n| VNM          |   2021 | -2.29442e+06 |\n| VNM          |   2022 | -1.60678e+06 |\n| VNM          |   2023 |  1.57289e+06 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH ppe_data AS (\n    SELECT \n        stock_code,\n        year,\n        SUM(data) AS total_ppe\n    FROM \n        non_bank_financial_report\n    WHERE \n        category_code IN ('BS_220', 'BS_221', 'BS_224', 'BS_227', 'BS_263')\n        AND stock_code IN ('VNM', 'HPG', 'VIC')\n        AND ((year BETWEEN 2020 AND 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\n    GROUP BY \n        stock_code, year\n),\nppe_change AS (\n    SELECT \n        a.stock_code,\n        a.year,\n        a.total_ppe - COALESCE(b.total_ppe, 0) AS net_change\n    FROM \n        ppe_data a\n    LEFT JOIN \n        ppe_data b ON a.stock_code = b.stock_code AND a.year = b.year + 1\n)\nSELECT \n    stock_code,\n    year,\n    net_change\nFROM \n    ppe_change\nORDER BY \n    stock_code, year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH PPES AS (\n  SELECT\n    ci.en_company_name,\n    nfr.year,\n    nfr.quarter,\n    nfr.data AS ppe_value\n  FROM non_bank_financial_report AS nfr\n  JOIN company_info AS ci\n    ON nfr.stock_code = ci.stock_code\n  JOIN map_category_code_non_bank AS mcc\n    ON nfr.category_code = mcc.category_code\n  WHERE\n    ci.en_company_name IN ('Vietnam Dairy Products Joint Stock Company', 'Hoa Phat Group Joint Stock Company', 'VinGroup Joint Stock Company')\n    AND mcc.en_caption LIKE '%Property, Plant, and Equipment%'\n    AND nfr.year BETWEEN 2020 AND 2024\n    AND nfr.quarter IN (0, 2)\n), PPES_YEARLY AS (\n  SELECT\n    en_company_name,\n    year,\n    ppe_value,\n    LAG(ppe_value, 1, 0) OVER (PARTITION BY en_company_name ORDER BY year, quarter) AS prev_year_ppe\n  FROM PPES\n)\nSELECT\n  en_company_name,\n  year,\n  ppe_value - prev_year_ppe AS ppe_change\nFROM PPES_YEARLY\nORDER BY\n  en_company_name,\n  year,\n  quarter\nLIMIT 100;\n"
            }
        ],
        "time": 5.475273609161377,
        "evaluate": 0,
        "input_token": 6268,
        "output_token": 1334
    },
    {
        "id": "6332ded8-a846-4f63-9d25-d8dfa9aed104",
        "question": "What is the trend of the Current Ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   current_ratio |\n|:-------------|-------:|----------:|----------------:|\n| ACB          |   2020 |         0 |         3.69815 |\n| ACB          |   2021 |         0 |         3.97544 |\n| ACB          |   2022 |         0 |         3.81624 |\n| ACB          |   2023 |         0 |         3.04283 |\n| ACB          |   2024 |         1 |         3.29123 |\n| TCB          |   2020 |         0 |         2.83619 |\n| TCB          |   2021 |         0 |         4.35343 |\n| TCB          |   2022 |         0 |         3.29776 |\n| TCB          |   2023 |         0 |         2.66367 |\n| TCB          |   2024 |         1 |         2.40445 |\n| TCB          |   2024 |         2 |         2.88946 |\n| VCB          |   2020 |         0 |         7.25011 |\n| VCB          |   2021 |         0 |         6.29498 |\n| VCB          |   2022 |         0 |         3.56816 |\n| VCB          |   2023 |         0 |         4.7828  |\n| VCB          |   2024 |         1 |         3.48899 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS current_ratio\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'CurrentR' \n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual data for 2020 to 2023\n        OR \n        (year = 2024 AND quarter <= 2) -- Quarterly data for 2024 up to Q2\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n|   year |   quarter |   current_ratio |\n|-------:|----------:|----------------:|\n|   2020 |         0 |         2.83619 |\n|   2020 |         0 |         7.25011 |\n|   2020 |         0 |         3.69815 |\n|   2020 |         1 |         5.43727 |\n|   2020 |         1 |         3.54284 |\n|   2020 |         1 |         2.89911 |\n|   2020 |         2 |         3.46132 |\n|   2020 |         2 |         5.19794 |\n|   2020 |         2 |         3.84263 |\n|   2020 |         3 |         3.1178  |\n|   2020 |         3 |         2.47947 |\n|   2020 |         3 |         4.72611 |\n|   2020 |         4 |         7.86737 |\n|   2020 |         4 |         2.83619 |\n|   2020 |         4 |         3.69815 |\n|   2021 |         0 |         6.29498 |\n|   2021 |         0 |         4.35343 |\n|   2021 |         0 |         3.97544 |\n|   2021 |         1 |         5.86813 |\n|   2021 |         1 |         2.28142 |\n|   2021 |         1 |         3.16037 |\n|   2021 |         2 |         3.90106 |\n|   2021 |         2 |         2.61232 |\n|   2021 |         2 |         5.28517 |\n|   2021 |         3 |         3.03271 |\n|   2021 |         3 |         6.82119 |\n|   2021 |         3 |         5.41155 |\n|   2021 |         4 |         4.40216 |\n|   2021 |         4 |         3.97544 |\n|   2021 |         4 |         6.58505 |\n|   2022 |         0 |         3.56816 |\n|   2022 |         0 |         3.29776 |\n|   2022 |         0 |         3.81624 |\n|   2022 |         1 |         4.20104 |\n|   2022 |         1 |         6.06806 |\n|   2022 |         1 |         3.25965 |\n|   2022 |         2 |         3.53703 |\n|   2022 |         2 |         3.34928 |\n|   2022 |         2 |         6.27508 |\n|   2022 |         3 |         2.91339 |\n|   2022 |         3 |         3.1711  |\n|   2022 |         3 |         6.95249 |\n|   2022 |         4 |         3.62631 |\n|   2022 |         4 |         3.81624 |\n|   2022 |         4 |         3.29776 |\n|   2023 |         0 |         3.04283 |\n|   2023 |         0 |         2.66367 |\n|   2023 |         0 |         4.7828  |\n|   2023 |         1 |         5.431   |\n|   2023 |         1 |         3.53987 |\n|   2023 |         1 |         3.10937 |\n|   2023 |         2 |         5.5238  |\n|   2023 |         2 |       nan       |\n|   2023 |         2 |         2.99619 |\n|   2023 |         3 |         3.69457 |\n|   2023 |         3 |         4.18999 |\n|   2023 |         3 |         5.44838 |\n|   2023 |         4 |         3.32547 |\n|   2023 |         4 |         5.24741 |\n|   2024 |         1 |         3.29123 |\n|   2024 |         1 |         3.48899 |\n|   2024 |         1 |         2.40445 |\n|   2024 |         2 |         2.88946 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.year,\n  fr.quarter,\n  fr.data AS current_ratio\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Current Ratio'\n  AND ci.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.230006217956543,
        "evaluate": 0,
        "input_token": 7218,
        "output_token": 1173
    },
    {
        "id": "7e2eeae9-63ca-4551-8421-3e02bfd5c000",
        "question": "What is the trend of  operating cash flow for Vietcombank, Techcombank, and Sacombank from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | operating_cash_flow   |\n|--------------|--------|-----------|-----------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    data AS operating_cash_flow\nFROM \n    bank_financial_report\nWHERE \n    stock_code IN ('VCB', 'TCB', 'STB')\n    AND category_code = 'CF_009'\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual reports from 2020 to 2023\n        OR (year = 2024 AND quarter <= 2) -- Quarterly reports for 2024 up to Q2\n    )\nORDER BY \n    stock_code, year, quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | year   | quarter   | operating_cash_flow   |\n|--------------|--------|-----------|-----------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantCompanies AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    stock_code IN ('VCB', 'TCB', 'STB')\n), OperatingCashFlowData AS (\n  SELECT\n    rc.stock_code,\n    bfr.year,\n    bfr.quarter,\n    bfr.data AS operating_cash_flow\n  FROM RelevantCompanies AS rc\n  JOIN bank_financial_report AS bfr\n    ON rc.stock_code = bfr.stock_code\n  JOIN map_category_code_bank AS mccb\n    ON bfr.category_code = mccb.category_code\n  WHERE\n    mccb.en_caption LIKE '%Net cash flow from operating activities%'\n    AND bfr.year >= 2020\n    AND (\n      bfr.quarter BETWEEN 0 AND 2\n    )\n  UNION ALL\n  SELECT\n    rc.stock_code,\n    nbfr.year,\n    nbfr.quarter,\n    nbfr.data AS operating_cash_flow\n  FROM RelevantCompanies AS rc\n  JOIN non_bank_financial_report AS nbfr\n    ON rc.stock_code = nbfr.stock_code\n  JOIN map_category_code_non_bank AS mccnb\n    ON nbfr.category_code = mccnb.category_code\n  WHERE\n    mccnb.en_caption LIKE '%Net cash flow from operating activities%'\n    AND nbfr.year >= 2020\n    AND (\n      nbfr.quarter BETWEEN 0 AND 2\n    )\n  UNION ALL\n  SELECT\n    rc.stock_code,\n    sfr.year,\n    sfr.quarter,\n    sfr.data AS operating_cash_flow\n  FROM RelevantCompanies AS rc\n  JOIN securities_financial_report AS sfr\n    ON rc.stock_code = sfr.stock_code\n  JOIN map_category_code_securities AS mccs\n    ON sfr.category_code = mccs.category_code\n  WHERE\n    mccs.en_caption LIKE '%Net cash flow from operating activities%'\n    AND sfr.year >= 2020\n    AND (\n      sfr.quarter BETWEEN 0 AND 2\n    )\n)\nSELECT\n  stock_code,\n  year,\n  quarter,\n  operating_cash_flow\nFROM OperatingCashFlowData\nORDER BY\n  stock_code,\n  year,\n  quarter\nLIMIT 100;\n"
            }
        ],
        "time": 6.8618247509002686,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "5b310386-fc27-4cf8-b9c0-421b0979ffb2",
        "question": "Show the change in  total assets and total liabilities for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Calculate the debt-to-asset ratio for each company for each year.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   total_assets |   total_liabilities |   debt_to_asset_ratio |\n|:-------------|-------:|----------:|---------------:|--------------------:|----------------------:|\n| HPG          |   2020 |         0 |    1.31511e+08 |         1.31511e+08 |              0.549699 |\n| HPG          |   2021 |         0 |    1.78236e+08 |         1.78236e+08 |              0.490673 |\n| HPG          |   2022 |         0 |    1.70336e+08 |         1.70336e+08 |              0.435743 |\n| HPG          |   2023 |         0 |    1.87783e+08 |         1.87783e+08 |              0.452364 |\n| HPG          |   2024 |         2 |    2.06609e+08 |         2.06609e+08 |              0.473999 |\n| MSN          |   2020 |         0 |    1.15737e+08 |         1.15737e+08 |              0.783731 |\n| MSN          |   2021 |         0 |    1.26093e+08 |         1.26093e+08 |              0.664244 |\n| MSN          |   2022 |         0 |    1.41343e+08 |         1.41343e+08 |              0.740795 |\n| MSN          |   2023 |         0 |    1.47383e+08 |         1.47383e+08 |              0.74056  |\n| VNM          |   2020 |         0 |    4.84325e+07 |         4.84325e+07 |              0.305278 |\n| VNM          |   2021 |         0 |    5.33324e+07 |         5.33324e+07 |              0.327799 |\n| VNM          |   2022 |         0 |    4.84827e+07 |         4.84827e+07 |              0.323129 |\n| VNM          |   2023 |         0 |    5.26734e+07 |         5.26734e+07 |              0.335039 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH AssetLiabilityData AS (\n    SELECT\n        nfr.stock_code,\n        nfr.year,\n        nfr.quarter,\n        CASE\n            WHEN mccnb.en_caption = 'TOTAL ASSETS' THEN nfr.data\n            ELSE 0\n        END AS total_assets,\n        CASE\n            WHEN mccnb.en_caption = 'TOTAL LIABILITIES AND EQUITY' THEN nfr.data\n            ELSE 0\n        END AS total_liabilities\n    FROM\n        non_bank_financial_report nfr\n    JOIN\n        map_category_code_non_bank mccnb ON nfr.category_code = mccnb.category_code\n    WHERE\n        nfr.stock_code IN ('VNM', 'MSN', 'HPG')\n        AND mccnb.en_caption IN ('TOTAL ASSETS', 'TOTAL LIABILITIES AND EQUITY')\n        AND ((nfr.year BETWEEN 2020 AND 2024 AND nfr.quarter = 0) OR (nfr.year = 2024 AND nfr.quarter = 2))\n),\nAggregatedData AS (\n    SELECT\n        stock_code,\n        year,\n        quarter,\n        SUM(total_assets) AS total_assets,\n        SUM(total_liabilities) AS total_liabilities\n    FROM\n        AssetLiabilityData\n    GROUP BY\n        stock_code, year, quarter\n)\nSELECT\n    ad.stock_code,\n    ad.year,\n    ad.quarter,\n    ad.total_assets,\n    ad.total_liabilities,\n    fr.data AS debt_to_asset_ratio\nFROM\n    AggregatedData ad\nLEFT JOIN\n    financial_ratio fr ON ad.stock_code = fr.stock_code AND ad.year = fr.year AND ad.quarter = fr.quarter\nWHERE\n    fr.ratio_code = 'DTAR'\nORDER BY\n    ad.stock_code, ad.year, ad.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t')\n),\nFinancialData AS (\n  SELECT\n    ci.company_name,\n    nfr.year,\n    nfr.quarter,\n    SUM(CASE WHEN nfr.category_code = 'BS_100' THEN nfr.data ELSE 0 END) AS total_assets,\n    SUM(CASE WHEN nfr.category_code = 'BS_200' THEN nfr.data ELSE 0 END) AS total_liabilities,\n    fr.data AS debt_to_asset_ratio\n  FROM CompanyIDs AS ci\n  JOIN company_info AS info ON ci.stock_code = info.stock_code\n  LEFT JOIN non_bank_financial_report AS nfr ON ci.stock_code = nfr.stock_code\n  LEFT JOIN financial_ratio AS fr ON ci.stock_code = fr.stock_code AND nfr.year = fr.year AND nfr.quarter = fr.quarter AND fr.ratio_code = 'DTAR'\n  WHERE nfr.year IN (2020, 2024) AND nfr.quarter IN (0, 1, 2)\n  GROUP BY ci.company_name, nfr.year, nfr.quarter, fr.data\n)\nSELECT\n  company_name,\n  year,\n  quarter,\n  total_assets,\n  total_liabilities,\n  debt_to_asset_ratio\nFROM FinancialData\nORDER BY company_name, year, quarter\nLIMIT 100;\n"
            }
        ],
        "time": 5.967040538787842,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "77119fb1-1ebd-44db-9398-0e378dc3824d",
        "question": "Rank the top 10 companies by their Return on Equity (ROE) for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   | industry                      |      roe |\n|:-------------|:------------------------------|---------:|\n| TMB          | Basic Resources               | 0.476625 |\n| SLS          | Food and Beverages            | 0.443074 |\n| CAP          | Basic Resources               | 0.43171  |\n| SAF          | Food and Beverages            | 0.2894   |\n| DGC          | Chemicals                     | 0.269533 |\n| DTD          | Real Estate                   | 0.262679 |\n| FPT          | Information Technology        | 0.260183 |\n| VNM          | Food and Beverages            | 0.257506 |\n| VTP          | Industrial Goods and Services | 0.240244 |\n| HDB          | Banking                       | 0.232433 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry   | roe   | roe_rank   |\n|--------------|------------|-------|------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedROE AS (\n  SELECT\n    fr.stock_code,\n    fr.data AS roe,\n    RANK() OVER (ORDER BY\n      fr.data DESC) AS roe_rank\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'ROE' AND fr.year = 2023 AND fr.quarter = 0\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  r.roe,\n  r.roe_rank\nFROM RankedROE AS r\nJOIN company_info AS ci\n  ON r.stock_code = ci.stock_code\nWHERE\n  r.roe_rank <= 10\nLIMIT 10;\n"
            }
        ],
        "time": 3.5978453159332275,
        "evaluate": 0,
        "input_token": 5899,
        "output_token": 1102
    },
    {
        "id": "4bfbed15-327d-43f7-98d4-2ed6b6ac6cca",
        "question": "What were the total assets and total liabilities of Vinamilk and Masan Group at the end of 2023?",
        "answer": "Table 1\n| stock_code   | en_caption   |        data |\n|:-------------|:-------------|------------:|\n| VNM          | TOTAL ASSETS | 5.26734e+07 |\n| MSN          | TOTAL ASSETS | 1.47383e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN') \n    AND nfr.year = 2023 \n    AND nfr.quarter = 0\n    AND mcc.en_caption IN ('TOTAL ASSETS', 'TOTAL LIABILITIES');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs for Vinamilk and Masan Group.\nWITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan')\n)\n\n-- Step 2: Retrieve the total assets and total liabilities for each company at the end of 2023.\nSELECT\n  ci.company_name,\n  SUM(CASE WHEN mccnb.en_caption LIKE '%Total assets%' THEN nbfr.data ELSE 0 END) as total_assets,\n  SUM(CASE WHEN mccnb.en_caption LIKE '%Total liabilities%' THEN nbfr.data ELSE 0 END) as total_liabilities\nFROM CompanyIDs AS ci\nJOIN non_bank_financial_report AS nbfr\n  ON ci.stock_code = nbfr.stock_code\nJOIN map_category_code_non_bank AS mccnb\n  ON nbfr.category_code = mccnb.category_code\nWHERE\n  nbfr.year = 2023 AND nbfr.quarter = 0\nGROUP BY ci.company_name\nLIMIT 2;\n"
            }
        ],
        "time": 4.744709491729736,
        "evaluate": 0,
        "input_token": 4503,
        "output_token": 584
    },
    {
        "id": "557a8a67-6696-4b97-b5fb-a41f9d3101cd",
        "question": "What are the top 5 companies with the highest Total Assets as of Q2 2024?",
        "answer": "Table 1\n| stock_code   | industry    | is_bank   | is_securities   |   total_assets |\n|:-------------|:------------|:----------|:----------------|---------------:|\n| BID          | Banking     | True      | False           |    2.52105e+09 |\n| TCB          | Banking     | True      | False           |    9.08307e+08 |\n| VPB          | Banking     | True      | False           |    8.64392e+08 |\n| VIC          | Real Estate | False     | False           |    7.22259e+08 |\n| SHB          | Banking     | True      | False           |    6.59767e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to find the top 5 companies with the highest Total Assets as of Q2 2024\n\nSELECT ci.stock_code, ci.industry, ci.is_bank, ci.is_securities, fr.data AS total_assets\nFROM (\n    SELECT stock_code, data\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2024 AND quarter = 2\n    \n    UNION ALL\n    \n    SELECT stock_code, data\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_270' AND year = 2024 AND quarter = 2\n    \n    UNION ALL\n    \n    SELECT stock_code, data\n    FROM securities_financial_report\n    WHERE category_code = 'BS_270' AND year = 2024 AND quarter = 2\n) AS fr\nJOIN company_info ci ON fr.stock_code = ci.stock_code\nORDER BY fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry    |   total_assets |\n|:-------------|:------------|---------------:|\n| VIC          | Real Estate |    7.22259e+08 |\n| VPB          | Banking     |    8.64392e+08 |\n| TCB          | Banking     |    9.08307e+08 |\n| SHB          | Banking     |    6.59767e+08 |\n| BID          | Banking     |    2.52105e+09 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CombinedTotalAssets AS (\n  SELECT\n    stock_code,\n    data AS total_assets\n  FROM bank_financial_report\n  WHERE\n    category_code IN ('BS_300') AND quarter = 2 AND year = 2024\n  UNION ALL\n  SELECT\n    stock_code,\n    data AS total_assets\n  FROM non_bank_financial_report\n  WHERE\n    category_code IN ('BS_270') AND quarter = 2 AND year = 2024\n  UNION ALL\n  SELECT\n    stock_code,\n    data AS total_assets\n  FROM securities_financial_report\n  WHERE\n    category_code IN ('BS_270') AND quarter = 2 AND year = 2024\n), RankedTotalAssets AS (\n  SELECT\n    stock_code,\n    total_assets,\n    RANK() OVER (ORDER BY total_assets DESC) AS rank\n  FROM CombinedTotalAssets\n  WHERE\n    total_assets IS NOT NULL\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  rta.total_assets\nFROM RankedTotalAssets AS rta\nJOIN company_info AS ci\n  ON rta.stock_code = ci.stock_code\nWHERE\n  rta.rank <= 5\nLIMIT 5;\n"
            }
        ],
        "time": 4.778468608856201,
        "evaluate": 1,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "9f7f3747-ac23-4eb1-8d0c-49469b2186e6",
        "question": "Analyze the changes in  Free Cash Flow to Firm (FCFF) for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Calculate the FCFF using the indirect method.",
        "answer": "Table 1\n|   year |   quarter | stock_code   | en_company_name                            |        fcff |\n|-------:|----------:|:-------------|:-------------------------------------------|------------:|\n|   2020 |         0 | HPG          | Hoa Phat Group Joint Stock Company         | 3.68935e+07 |\n|   2021 |         0 | HPG          | Hoa Phat Group Joint Stock Company         | 8.1097e+07  |\n|   2022 |         0 | HPG          | Hoa Phat Group Joint Stock Company         | 8.79324e+07 |\n|   2023 |         0 | HPG          | Hoa Phat Group Joint Stock Company         | 6.58285e+07 |\n|   2024 |         2 | HPG          | Hoa Phat Group Joint Stock Company         | 3.70183e+07 |\n|   2020 |         0 | MSN          | Masan Group Corporation                    | 1.98463e+07 |\n|   2021 |         0 | MSN          | Masan Group Corporation                    | 1.66562e+07 |\n|   2022 |         0 | MSN          | Masan Group Corporation                    | 1.2966e+07  |\n|   2023 |         0 | MSN          | Masan Group Corporation                    | 3.16468e+07 |\n|   2020 |         0 | VNM          | Vietnam Dairy Products Joint Stock Company | 2.4254e+07  |\n|   2021 |         0 | VNM          | Vietnam Dairy Products Joint Stock Company | 2.20982e+07 |\n|   2022 |         0 | VNM          | Vietnam Dairy Products Joint Stock Company | 2.19656e+07 |\n|   2023 |         0 | VNM          | Vietnam Dairy Products Joint Stock Company | 2.0475e+07  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    ci.stock_code, \n    ci.en_company_name, \n    fr.data AS fcff\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    ci.stock_code IN ('VNM', 'MSN', 'HPG') \n    AND mccr.ratio_name = 'Free Cash Flow'\n    AND ((fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n    ci.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantData AS (\n    SELECT \n        ci.company_name,\n        nfr.year,\n        nfr.quarter,\n        SUM(CASE WHEN mcd.line_item_name = 'Net Income' THEN nfr.data ELSE 0 END) as NetIncome,\n        SUM(CASE WHEN mcd.line_item_name = 'Depreciation' THEN nfr.data ELSE 0 END) as Depreciation,\n        SUM(CASE WHEN mcd.line_item_name = 'Capital Expenditures' THEN nfr.data ELSE 0 END) * -1 as CapEx, -- Negative because it's a cash outflow\n        SUM(CASE WHEN mcd.line_item_name = 'Interest Expense' THEN nfr.data ELSE 0 END) as InterestExpense,\n        -- Add more CASE statements for other Working Capital components as needed...\n        SUM(CASE WHEN mcd.line_item_name = 'Changes in Working Capital' THEN nfr.data ELSE 0 END) as ChangeInWorkingCapital\n\n    FROM non_bank_financial_report nfr\n    JOIN company_info ci ON nfr.stock_code = ci.stock_code\n    JOIN map_category_code_description mcd ON nfr.category_code = mcd.category_code\n    WHERE ci.stock_code IN ('VNM', 'MSN', 'HPG')\n    AND nfr.year >= 2020\n    AND (nfr.quarter BETWEEN 0 AND 2) --0 for annual, 1,2 for Q1, Q2\n    GROUP BY ci.company_name, nfr.year, nfr.quarter\n),\nTaxRates AS (\n  SELECT stock_code, year, tax_rate FROM company_tax_rates\n),\nFCFFCalculation AS (\n    SELECT \n        rd.company_name,\n        rd.year,\n        rd.quarter,\n        NetIncome + Depreciation + (InterestExpense * (1 - ctr.tax_rate)) - CapEx - ChangeInWorkingCapital AS FCFF\n    FROM RelevantData rd\n    JOIN TaxRates ctr ON rd.company_name = ctr.stock_code AND rd.year = ctr.year\n)\nSELECT * FROM FCFFCalculation\nLIMIT 100;\n\n"
            }
        ],
        "time": 9.795542240142822,
        "evaluate": 0,
        "input_token": 4888,
        "output_token": 1670
    },
    {
        "id": "3092ddf1-2f29-4297-9476-c590de259f84",
        "question": "What is the trend of the Cash Flow from Operating Activities to Total Assets ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | cash_flow_to_total_assets_ratio   |\n|--------------|--------|-----------|-----------------------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    fr.year, \n    fr.quarter, \n    fr.data AS cash_flow_to_total_assets_ratio\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND mccr.ratio_name = 'Cash Flow from Operating Activities to Total Assets'\n    AND ((fr.year BETWEEN 2020 AND 2024) AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter <= 2)))\nORDER BY \n    fr.stock_code, \n    fr.year, \n    fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | year   | quarter   | ratio_data   |\n|--------------|--------|-----------|--------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH relevant_companies AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    stock_code IN ('VCB', 'TCB', 'ACB')\n), relevant_ratios AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS ratio_data\n  FROM financial_ratio AS fr\n  JOIN relevant_companies AS rc\n    ON fr.stock_code = rc.stock_code\n  WHERE\n    fr.ratio_code = 'CFTOTA' -- Assuming 'CFTOTA' represents 'Cash Flow from Operating Activities to Total Assets' ratio.  Adjust if needed based on your actual ratio_code.\n    AND fr.year >= 2020\n    AND fr.year <= 2024\n    AND fr.quarter >= 0\n    AND fr.quarter <= 2\n)\nSELECT\n  rc.stock_code,\n  rc.year,\n  rc.quarter,\n  rc.ratio_data\nFROM relevant_ratios AS rc\nORDER BY\n  rc.stock_code,\n  rc.year,\n  rc.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 5.243824243545532,
        "evaluate": 0,
        "input_token": 5508,
        "output_token": 579
    },
    {
        "id": "d4bb52e6-2407-4f6d-9f90-60c654e8c0b2",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS ROE\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    stock_code IN ('VCB', 'TCB', 'ACB') AND\n    ((year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n     (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n|   year |   quarter | en_company_name                                          |         roe |\n|-------:|----------:|:---------------------------------------------------------|------------:|\n|   2020 |         0 | Asia Commercial Joint Stock Bank                         |   0.216734  |\n|   2020 |         1 | Asia Commercial Joint Stock Bank                         |   0.0522587 |\n|   2020 |         2 | Asia Commercial Joint Stock Bank                         |   0.0493524 |\n|   2020 |         3 | Asia Commercial Joint Stock Bank                         |   0.0630206 |\n|   2020 |         4 | Asia Commercial Joint Stock Bank                         |   0.0719231 |\n|   2021 |         0 | Asia Commercial Joint Stock Bank                         |   0.213865  |\n|   2021 |         1 | Asia Commercial Joint Stock Bank                         |   0.0654744 |\n|   2021 |         2 | Asia Commercial Joint Stock Bank                         |   0.0640966 |\n|   2021 |         3 | Asia Commercial Joint Stock Bank                         |   0.0494926 |\n|   2021 |         4 | Asia Commercial Joint Stock Bank                         |   0.0540857 |\n|   2022 |         0 | Asia Commercial Joint Stock Bank                         |   0.234232  |\n|   2022 |         1 | Asia Commercial Joint Stock Bank                         |   0.0682014 |\n|   2022 |         2 | Asia Commercial Joint Stock Bank                         |   0.0757336 |\n|   2022 |         3 | Asia Commercial Joint Stock Bank                         |   0.0643583 |\n|   2022 |         4 | Asia Commercial Joint Stock Bank                         |   0.0491202 |\n|   2023 |         0 | Asia Commercial Joint Stock Bank                         |   0.226122  |\n|   2023 |         1 | Asia Commercial Joint Stock Bank                         |   0.0661285 |\n|   2023 |         2 | Asia Commercial Joint Stock Bank                         | nan         |\n|   2023 |         3 | Asia Commercial Joint Stock Bank                         |   0.0604199 |\n|   2024 |         1 | Asia Commercial Joint Stock Bank                         |   0.052218  |\n|   2020 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.196318  |\n|   2020 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0491661 |\n|   2020 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0515214 |\n|   2020 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0427012 |\n|   2020 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0573927 |\n|   2021 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.201059  |\n|   2021 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0683861 |\n|   2021 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0377385 |\n|   2021 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.1084    |\n|   2021 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0580801 |\n|   2022 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.220567  |\n|   2022 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0680525 |\n|   2022 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0483124 |\n|   2022 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0472737 |\n|   2022 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0719881 |\n|   2023 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.200315  |\n|   2023 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0621596 |\n|   2023 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.139806  |\n|   2023 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.045712  |\n|   2023 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0555349 |\n|   2024 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0494831 |\n|   2020 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.168632  |\n|   2020 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0387928 |\n|   2020 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0428449 |\n|   2020 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0450409 |\n|   2020 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0537099 |\n|   2021 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.197927  |\n|   2021 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0565945 |\n|   2021 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0572896 |\n|   2021 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0501452 |\n|   2021 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0503334 |\n|   2022 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.180176  |\n|   2022 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0569507 |\n|   2022 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0562806 |\n|   2022 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0488406 |\n|   2022 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.031493  |\n|   2023 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.139608  |\n|   2023 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0384612 |\n|   2023 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0367734 |\n|   2023 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0367239 |\n|   2023 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0381519 |\n|   2024 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0459854 |\n|   2024 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0457096 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.year,\n  fr.quarter,\n  ci.en_company_name,\n  fr.data AS roe\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND ci.en_company_name IN ('Joint Stock Commercial Bank For Foreign Trade Of Vietnam', 'Asia Commercial Joint Stock Bank', 'Vietnam Technological And Commercial Joint Stock Bank')\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  ci.en_company_name,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.6158599853515625,
        "evaluate": 0.5,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "916ca955-e277-4c29-8413-c4f9f46fdead",
        "question": "Compare the change in the Free Cash Flow (FCF) to Revenue ratio for Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.  Calculate FCF as Operating Cash Flow - Capital Expenditures.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   free_cash_flow |          revenue |   fcf_to_revenue_ratio |\n|:-------------|-------:|----------:|-----------------:|-----------------:|-----------------------:|\n| MSN          |   2020 |         0 |      5.02946e+06 |      1.19577e+06 |              4.20603   |\n| MSN          |   2020 |         2 |      1.39238e+06 | 324589           |              4.28967   |\n| MSN          |   2021 |         0 |      3.94934e+06 |      1.12732e+07 |              0.350331  |\n| MSN          |   2021 |         2 |      2.85035e+06 |      1.14379e+06 |              2.49202   |\n| MSN          |   2022 |         0 | 376469           |      5.22274e+06 |              0.0720826 |\n| MSN          |   2022 |         2 |      1.58818e+06 |      1.26951e+06 |              1.25102   |\n| MSN          |   2023 |         0 |      2.72926e+06 |      2.35043e+06 |              1.16117   |\n| MSN          |   2023 |         2 |      1.95534e+06 | 466572           |              4.19085   |\n| SAB          |   2020 |         0 |      4.49605e+06 |      6.07641e+06 |              0.739919  |\n| SAB          |   2020 |         2 |      1.73514e+06 |      1.4662e+06  |              1.18343   |\n| SAB          |   2021 |         0 |      3.84739e+06 |      4.78023e+06 |              0.804855  |\n| SAB          |   2021 |         2 |      1.70659e+06 |      1.3032e+06  |              1.30954   |\n| SAB          |   2022 |         0 |      4.91168e+06 |      6.82966e+06 |              0.719169  |\n| SAB          |   2022 |         2 |      2.38322e+06 |      2.20974e+06 |              1.0785    |\n| SAB          |   2023 |         0 |      2.2238e+06  |      5.40263e+06 |              0.411614  |\n| SAB          |   2023 |         2 |      1.11413e+06 |      1.53609e+06 |              0.725305  |\n| SAB          |   2024 |         2 |      2.30155e+06 |      1.64767e+06 |              1.39685   |\n| VNM          |   2020 |         0 |      1.1445e+07  |      1.35394e+07 |              0.845311  |\n| VNM          |   2020 |         2 |      5.48195e+06 |      3.72152e+06 |              1.47304   |\n| VNM          |   2021 |         0 |      1.0963e+07  |      1.27276e+07 |              0.861355  |\n| VNM          |   2021 |         2 |      4.48222e+06 |      3.51026e+06 |              1.27689   |\n| VNM          |   2022 |         0 |      1.02842e+07 |      1.04911e+07 |              0.980281  |\n| VNM          |   2022 |         2 |      3.59228e+06 |      2.60094e+06 |              1.38115   |\n| VNM          |   2023 |         0 |      9.46706e+06 |      1.09036e+07 |              0.868248  |\n| VNM          |   2023 |         2 |      4.32854e+06 |      5.09154e+06 |              0.850145  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH fcf_calculation AS (\n    SELECT \n        stock_code,\n        year,\n        quarter,\n        SUM(CASE WHEN category_code = 'CF_020' THEN data ELSE 0 END) AS operating_cash_flow,\n        SUM(CASE WHEN category_code = 'CF_021' THEN data ELSE 0 END) AS capital_expenditures,\n        SUM(CASE WHEN category_code = 'IS_030' THEN data ELSE 0 END) AS revenue\n    FROM \n        non_bank_financial_report\n    WHERE \n        stock_code IN ('VNM', 'MSN', 'SAB') AND\n        ((year BETWEEN 2020 AND 2024) AND (quarter = 0 OR quarter = 2))\n    GROUP BY \n        stock_code, year, quarter\n)\nSELECT \n    stock_code,\n    year,\n    quarter,\n    (operating_cash_flow - capital_expenditures) AS free_cash_flow,\n    revenue,\n    CASE \n        WHEN revenue != 0 THEN (operating_cash_flow - capital_expenditures) / revenue\n        ELSE NULL\n    END AS fcf_to_revenue_ratio\nFROM \n    fcf_calculation\nORDER BY \n    stock_code, year, quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter |               fcf |     revenue |   fcf_to_revenue_ratio |\n|:-------------|-------:|----------:|------------------:|------------:|-----------------------:|\n| MSN          |   2020 |         0 |       3.6665e+06  | 7.88683e+07 |             0.0464889  |\n| MSN          |   2021 |         0 |       1.14888e+07 | 8.97916e+07 |             0.127949   |\n| MSN          |   2022 |         0 |  740627           | 7.63808e+07 |             0.00969651 |\n| MSN          |   2023 |         0 |      -1.44358e+06 | 7.8517e+07  |            -0.0183856  |\n| MSN          |   2024 |         1 | -410105           | 1.89424e+07 |            -0.0216502  |\n| SAB          |   2020 |         0 |       5.51837e+06 | 2.81356e+07 |             0.196135   |\n| SAB          |   2021 |         0 |       4.29942e+06 | 2.6578e+07  |             0.161766   |\n| SAB          |   2022 |         0 |       6.25231e+06 | 3.52359e+07 |             0.177442   |\n| SAB          |   2023 |         0 |       4.80038e+06 | 3.07068e+07 |             0.15633    |\n| SAB          |   2024 |         1 |       1.16526e+06 | 7.24313e+06 |             0.160878   |\n| SAB          |   2024 |         2 |       2.66268e+06 | 8.1351e+06  |             0.327308   |\n| VNM          |   2020 |         0 |       1.07015e+07 | 5.97229e+07 |             0.179186   |\n| VNM          |   2021 |         0 |       1.05554e+07 | 6.10121e+07 |             0.173004   |\n| VNM          |   2022 |         0 |       8.15454e+06 | 6.00747e+07 |             0.13574    |\n| VNM          |   2023 |         0 |       8.66777e+06 | 6.04789e+07 |             0.143319   |\n| VNM          |   2024 |         1 |       2.13983e+06 | 1.41249e+07 |             0.151494   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH OperatingCashFlow AS (\n  SELECT\n    stock_code,\n    year,\n    quarter,\n    data AS operating_cash_flow\n  FROM non_bank_financial_report\n  WHERE\n    category_code = 'CF_001'\n    AND stock_code IN ('VNM', 'MSN', 'SAB')\n    AND year >= 2020\n), CapitalExpenditures AS (\n  SELECT\n    stock_code,\n    year,\n    quarter,\n    data AS capital_expenditures\n  FROM non_bank_financial_report\n  WHERE\n    category_code = 'CF_002'\n    AND stock_code IN ('VNM', 'MSN', 'SAB')\n    AND year >= 2020\n), Revenue AS (\n  SELECT\n    stock_code,\n    year,\n    quarter,\n    data AS revenue\n  FROM non_bank_financial_report\n  WHERE\n    category_code = 'IS_001'\n    AND stock_code IN ('VNM', 'MSN', 'SAB')\n    AND year >= 2020\n), FCF AS (\n  SELECT\n    ocf.stock_code,\n    ocf.year,\n    ocf.quarter,\n    ocf.operating_cash_flow - ce.capital_expenditures AS fcf\n  FROM OperatingCashFlow AS ocf\n  JOIN CapitalExpenditures AS ce\n    ON ocf.stock_code = ce.stock_code\n    AND ocf.year = ce.year\n    AND ocf.quarter = ce.quarter\n)\nSELECT\n  fcf.stock_code,\n  fcf.year,\n  fcf.quarter,\n  fcf.fcf,\n  rev.revenue,\n  fcf.fcf / rev.revenue AS fcf_to_revenue_ratio\nFROM FCF AS fcf\nJOIN Revenue AS rev\n  ON fcf.stock_code = rev.stock_code\n  AND fcf.year = rev.year\n  AND fcf.quarter = rev.quarter\nWHERE\n  (\n    fcf.year >= 2020\n    AND fcf.quarter = 0\n  )\n  OR (\n    fcf.year = 2024\n    AND fcf.quarter IN (1, 2)\n  )\nORDER BY\n  fcf.stock_code,\n  fcf.year,\n  fcf.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 7.279137134552002,
        "evaluate": 0,
        "input_token": 3386,
        "output_token": 770
    },
    {
        "id": "4ac358e0-c6f7-4645-8e8e-fb12eba2bcab",
        "question": "Calculate the return on equity (ROE) for Vinamilk and Masan Group for the fiscal year 2022, and also provide their total equity for the same year.",
        "answer": "Table 1\n| stock_code   |      roe |   total_equity |\n|:-------------|---------:|---------------:|\n| VNM          | 0.26138  |    3.28165e+07 |\n| MSN          | 0.129771 |    3.66367e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to get ROE for Vinamilk and Masan Group for the fiscal year 2022\nSELECT \n    fr.stock_code,\n    fr.data AS roe,\n    nbfr.data AS total_equity\nFROM \n    financial_ratio fr\nJOIN \n    non_bank_financial_report nbfr ON fr.stock_code = nbfr.stock_code AND fr.year = nbfr.year\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2022\n    AND fr.quarter = 0\n    AND nbfr.category_code = 'BS_410'\n    AND nbfr.quarter = 0\n    AND fr.stock_code IN ('VNM', 'MSN');\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| company_name                   |      roe |   total_equity |\n|:-------------------------------|---------:|---------------:|\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam   | 0.26138  |    3.15604e+07 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan | 0.129771 |    4.76746e+07 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs for Vinamilk and Masan Group.\nWITH CompanyIDs AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan')\n)\n\n-- Step 2: Retrieve the ROE and total equity for the identified companies.\nSELECT\n  ci.company_name,\n  fr.data AS roe,\n  (\n    SELECT\n      data\n    FROM non_bank_financial_report\n    WHERE\n      stock_code = ci.stock_code\n      AND year = 2022\n      AND quarter = 0\n      AND category_code = 'BS_100' -- Assuming BS_100 represents Total Equity.  Adjust if needed.\n  ) AS total_equity\nFROM CompanyIDs AS cid\nJOIN company_info AS ci\n  ON cid.stock_code = ci.stock_code\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nWHERE\n  fr.ratio_code = 'ROE'\n  AND fr.year = 2022\n  AND fr.quarter = 0\nLIMIT 2; -- Limit to 2 companies as requested.\n\n"
            }
        ],
        "time": 4.8493812084198,
        "evaluate": 0,
        "input_token": 4200,
        "output_token": 797
    },
    {
        "id": "01c004d0-974e-44a8-b591-7d38da1708a0",
        "question": "Compare the current ratio and quick ratio of Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.  Analyze the changes in their cash and short-term investments during this period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name    |   ratio_value |\n|:-------------|-------:|----------:|:--------------|--------------:|\n| MSN          |   2020 |         0 | Current Ratio |      0.773354 |\n| MSN          |   2020 |         0 | Quick Ratio   |      0.451862 |\n| MSN          |   2022 |         0 | Current Ratio |      0.73558  |\n| MSN          |   2022 |         0 | Quick Ratio   |      0.514436 |\n| SAB          |   2020 |         0 | Current Ratio |      3.79993  |\n| SAB          |   2020 |         0 | Quick Ratio   |      3.52024  |\n| SAB          |   2021 |         0 | Current Ratio |      3.16422  |\n| SAB          |   2021 |         0 | Quick Ratio   |      2.93441  |\n| SAB          |   2023 |         0 | Current Ratio |      3.24947  |\n| SAB          |   2023 |         0 | Quick Ratio   |      2.9677   |\n| VNM          |   2020 |         0 | Current Ratio |      2.09132  |\n| VNM          |   2020 |         0 | Quick Ratio   |      1.7462   |\n| VNM          |   2022 |         0 | Current Ratio |      2.06801  |\n| VNM          |   2022 |         0 | Quick Ratio   |      1.70628  |\n| VNM          |   2024 |         1 | Current Ratio |      2.30115  |\n| VNM          |   2024 |         1 | Quick Ratio   |      1.85779  |\n| MSN          |   2021 |         0 | Current Ratio |      1.27032  |\n| MSN          |   2021 |         0 | Quick Ratio   |      0.899436 |\n| MSN          |   2023 |         0 | Current Ratio |      0.874439 |\n| MSN          |   2023 |         0 | Quick Ratio   |      0.61315  |\n| MSN          |   2024 |         1 | Current Ratio |      0.87025  |\n| MSN          |   2024 |         1 | Quick Ratio   |      0.611971 |\n| SAB          |   2022 |         0 | Current Ratio |      2.93495  |\n| SAB          |   2022 |         0 | Quick Ratio   |      2.69688  |\n| SAB          |   2024 |         1 | Current Ratio |      4.68054  |\n| SAB          |   2024 |         1 | Quick Ratio   |      4.27023  |\n| SAB          |   2024 |         2 | Current Ratio |      3.18639  |\n| SAB          |   2024 |         2 | Quick Ratio   |      2.9152   |\n| VNM          |   2021 |         0 | Current Ratio |      2.11895  |\n| VNM          |   2021 |         0 | Quick Ratio   |      1.72213  |\n| VNM          |   2023 |         0 | Current Ratio |      2.1016   |\n| VNM          |   2023 |         0 | Quick Ratio   |      1.74405  |\n\nTable 2\n| stock_code   |   year |   quarter | en_caption                           |   financial_data |\n|:-------------|-------:|----------:|:-------------------------------------|-----------------:|\n| MSN          |   2020 |         0 | I. Cash and cash equivalents         |      7.72144e+06 |\n| MSN          |   2021 |         0 | I. Cash and cash equivalents         |      2.23048e+07 |\n| MSN          |   2022 |         0 | I. Cash and cash equivalents         |      1.38531e+07 |\n| MSN          |   2023 |         0 | I. Cash and cash equivalents         |      1.01245e+07 |\n| MSN          |   2020 |         0 | II. Short-term financial investments | 447250           |\n| MSN          |   2021 |         0 | II. Short-term financial investments | 332753           |\n| MSN          |   2022 |         0 | II. Short-term financial investments |      3.65918e+06 |\n| MSN          |   2023 |         0 | II. Short-term financial investments |      6.79479e+06 |\n| VNM          |   2024 |         1 | I. Cash and cash equivalents         |      1.78825e+06 |\n| MSN          |   2024 |         1 | I. Cash and cash equivalents         |      8.49273e+06 |\n| MSN          |   2024 |         1 | II. Short-term financial investments |      5.32918e+06 |\n| VNM          |   2020 |         0 | I. Cash and cash equivalents         |      2.11124e+06 |\n| VNM          |   2021 |         0 | I. Cash and cash equivalents         |      2.34855e+06 |\n| VNM          |   2022 |         0 | I. Cash and cash equivalents         |      2.29994e+06 |\n| VNM          |   2023 |         0 | I. Cash and cash equivalents         |      2.91203e+06 |\n| VNM          |   2020 |         0 | II. Short-term financial investments |      1.73137e+07 |\n| VNM          |   2021 |         0 | II. Short-term financial investments |      2.10257e+07 |\n| VNM          |   2022 |         0 | II. Short-term financial investments |      1.74141e+07 |\n| VNM          |   2023 |         0 | II. Short-term financial investments |      2.01372e+07 |\n| SAB          |   2020 |         0 | I. Cash and cash equivalents         |      2.72614e+06 |\n| SAB          |   2021 |         0 | I. Cash and cash equivalents         |      3.60645e+06 |\n| SAB          |   2022 |         0 | I. Cash and cash equivalents         |      4.06946e+06 |\n| SAB          |   2023 |         0 | I. Cash and cash equivalents         |      5.03991e+06 |\n| SAB          |   2020 |         0 | II. Short-term financial investments |      1.45474e+07 |\n| SAB          |   2021 |         0 | II. Short-term financial investments |      1.69912e+07 |\n| SAB          |   2022 |         0 | II. Short-term financial investments |      1.94115e+07 |\n| SAB          |   2023 |         0 | II. Short-term financial investments |      1.77411e+07 |\n| VNM          |   2024 |         1 | II. Short-term financial investments |      2.02681e+07 |\n| SAB          |   2024 |         1 | I. Cash and cash equivalents         |      3.2131e+06  |\n| SAB          |   2024 |         2 | I. Cash and cash equivalents         |      6.0341e+06  |\n| SAB          |   2024 |         1 | II. Short-term financial investments |      1.82025e+07 |\n| SAB          |   2024 |         2 | II. Short-term financial investments |      1.73244e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve Current Ratio and Quick Ratio\nSELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND mccr.ratio_name IN ('Current Ratio', 'Quick Ratio')\n    AND ((fr.year = 2020 AND fr.quarter = 0) OR \n         (fr.year = 2021 AND fr.quarter = 0) OR \n         (fr.year = 2022 AND fr.quarter = 0) OR \n         (fr.year = 2023 AND fr.quarter = 0) OR \n         (fr.year = 2024 AND fr.quarter IN (1, 2)));\n\n-- Step 2: Analyze changes in cash and short-term investments\nSELECT \n    nbf.stock_code,\n    nbf.year,\n    nbf.quarter,\n    mccnb.en_caption,\n    nbf.data AS financial_data\nFROM \n    non_bank_financial_report nbf\nJOIN \n    map_category_code_non_bank mccnb ON nbf.category_code = mccnb.category_code\nWHERE \n    nbf.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND mccnb.en_caption IN ('I. Cash and cash equivalents', 'II. Short-term financial investments')\n    AND ((nbf.year = 2020 AND nbf.quarter = 0) OR \n         (nbf.year = 2021 AND nbf.quarter = 0) OR \n         (nbf.year = 2022 AND nbf.quarter = 0) OR \n         (nbf.year = 2023 AND nbf.quarter = 0) OR \n         (nbf.year = 2024 AND nbf.quarter IN (1, 2)));\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| ratio_code   |   year |   quarter |     data | company_name                                             |\n|:-------------|-------:|----------:|---------:|:---------------------------------------------------------|\n| QR           |   2020 |         0 | 1.7462   | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2020 |         0 | 2.09132  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2020 |         1 | 2.00177  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2020 |         1 | 1.57114  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2020 |         2 | 1.80774  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2020 |         2 | 1.46628  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2021 |         0 | 2.11895  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2021 |         0 | 1.72213  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2021 |         1 | 1.60719  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2021 |         1 | 1.99828  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2021 |         2 | 1.93904  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2021 |         2 | 1.56154  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2022 |         0 | 1.70628  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2022 |         0 | 2.06801  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2022 |         1 | 2.01857  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2022 |         1 | 1.5832   | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2022 |         2 | 1.79426  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2022 |         2 | 2.22061  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2023 |         0 | 1.74405  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2023 |         0 | 2.1016   | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2023 |         1 | 1.79124  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2023 |         1 | 2.25658  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2023 |         2 | 1.97817  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2023 |         2 | 2.43804  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| QR           |   2024 |         1 | 1.85779  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2024 |         1 | 2.30115  | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             |\n| CurrentR     |   2020 |         0 | 0.773354 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2020 |         0 | 0.451862 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2020 |         1 | 0.650382 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2020 |         1 | 0.943772 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2020 |         2 | 0.356423 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2020 |         2 | 0.671478 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2021 |         0 | 0.899436 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2021 |         0 | 1.27032  | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2021 |         1 | 0.838925 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2021 |         1 | 0.504552 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2021 |         2 | 0.913651 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2021 |         2 | 0.572475 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2022 |         0 | 0.73558  | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2022 |         0 | 0.514436 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2022 |         1 | 1.00047  | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2022 |         1 | 0.660956 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2022 |         2 | 0.44704  | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2022 |         2 | 0.709978 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2023 |         0 | 0.874439 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2023 |         0 | 0.61315  | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2023 |         1 | 0.628277 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2023 |         1 | 0.851707 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2023 |         2 | 0.804937 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2023 |         2 | 0.563175 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| CurrentR     |   2024 |         1 | 0.87025  | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2024 |         1 | 0.611971 | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           |\n| QR           |   2020 |         0 | 3.52024  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2020 |         0 | 3.79993  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2020 |         1 | 3.41748  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| QR           |   2020 |         1 | 2.94894  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2020 |         2 | 3.32298  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| QR           |   2020 |         2 | 3.0425   | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2021 |         0 | 3.16422  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| QR           |   2021 |         0 | 2.93441  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2021 |         1 | 3.9982   | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| QR           |   2021 |         1 | 3.57592  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| QR           |   2021 |         2 | 3.55591  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2021 |         2 | 3.85619  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2022 |         0 | 2.93495  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| QR           |   2022 |         0 | 2.69688  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2022 |         1 | 3.527    | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| QR           |   2022 |         1 | 3.21984  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2022 |         2 | 3.83923  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| QR           |   2022 |         2 | 3.53308  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| QR           |   2023 |         0 | 2.9677   | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n| CurrentR     |   2023 |         0 | 3.24947  | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.ratio_code,\n  fr.year,\n  fr.quarter,\n  fr.data,\n  ci.company_name\nFROM financial_ratio AS fr\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  ci.stock_code IN ('VNM', 'MSN', 'SAB')\n  AND fr.year >= 2020\n  AND (\n    fr.quarter BETWEEN 0 AND 2\n  )\n  AND fr.ratio_code IN ('CurrentR', 'QR') -- Add Cash and short-term investment codes if available in map_category_code_ratio\nORDER BY\n  ci.company_name,\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.202466011047363,
        "evaluate": 0,
        "input_token": 5743,
        "output_token": 681
    },
    {
        "id": "210545b9-e52c-408a-9b0a-96e26978bc0d",
        "question": "What are the top 5 companies with the highest operating cash flow in 2022?",
        "answer": "Table 1\n| stock_code   | industry                             |   operating_cash_flow |\n|:-------------|:-------------------------------------|----------------------:|\n| VHM          | Real Estate                          |           3.10035e+07 |\n| VGI          | Telecommunications                   |           1.36636e+07 |\n| GAS          | Utilities (Electricity, Water & Gas) |           1.27921e+07 |\n| HPG          | Basic Resources                      |           1.22776e+07 |\n| VNM          | Food and Beverages                   |           8.82727e+06 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "(\n    SELECT c.stock_code, c.industry, nfr.data AS operating_cash_flow\n    FROM non_bank_financial_report nfr\n    JOIN company_info c ON nfr.stock_code = c.stock_code\n    WHERE nfr.year = 2022 AND nfr.quarter = 0 AND nfr.category_code = 'CF_020'\n)\nUNION ALL\n(\n    SELECT c.stock_code, c.industry, bfr.data AS operating_cash_flow\n    FROM bank_financial_report bfr\n    JOIN company_info c ON bfr.stock_code = c.stock_code\n    WHERE bfr.year = 2022 AND bfr.quarter = 0 AND bfr.category_code = 'CF_009'\n)\nUNION ALL\n(\n    SELECT c.stock_code, c.industry, sfr.data AS operating_cash_flow\n    FROM securities_financial_report sfr\n    JOIN company_info c ON sfr.stock_code = c.stock_code\n    WHERE sfr.year = 2022 AND sfr.quarter = 0 AND sfr.category_code = 'CF_060'\n)\nORDER BY operating_cash_flow DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry                             |   operating_cash_flow |\n|:-------------|:-------------------------------------|----------------------:|\n| VHM          | Real Estate                          |           3.10035e+07 |\n| VGI          | Telecommunications                   |           1.36636e+07 |\n| GAS          | Utilities (Electricity, Water & Gas) |           1.27921e+07 |\n| HPG          | Basic Resources                      |           1.22776e+07 |\n| VNM          | Food and Beverages                   |           8.82727e+06 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedOperatingCashFlow AS (\n  SELECT\n    stock_code,\n    data AS operating_cash_flow\n  FROM (\n    SELECT\n      stock_code,\n      data\n    FROM bank_financial_report\n    WHERE\n      year = 2022\n      AND quarter = 0\n      AND category_code IN ('CF_009') -- Net cash flow from operating activities before changes in assets and working capital\n    UNION ALL\n    SELECT\n      stock_code,\n      data\n    FROM non_bank_financial_report\n    WHERE\n      year = 2022\n      AND quarter = 0\n      AND category_code IN ('CF_020') -- Net cash flow from operating activities\n    UNION ALL\n    SELECT\n      stock_code,\n      data\n    FROM securities_financial_report\n    WHERE\n      year = 2022\n      AND quarter = 0\n      AND category_code IN ('CF_060') -- Net cash flow from operating activities\n  ) AS all_reports\n  ORDER BY\n    operating_cash_flow DESC\n  LIMIT 5\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  roc.operating_cash_flow\nFROM RankedOperatingCashFlow AS roc\nJOIN company_info AS ci\n  ON roc.stock_code = ci.stock_code\nORDER BY\n  roc.operating_cash_flow DESC;\n"
            }
        ],
        "time": 5.3034586906433105,
        "evaluate": 1,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "fea4088b-643e-4e03-9bed-1879ba8538f0",
        "question": "What was the Free Cash Flow to Firm (FCFF) for Vietcombank, Techcombank, and ACB in 2022?",
        "answer": "Table 1\n| stock_code   |   year |        fcff |\n|:-------------|-------:|------------:|\n| ACB          |   2022 | 2.17861e+07 |\n| TCB          |   2022 | 5.66533e+07 |\n| VCB          |   2022 | 1.87481e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, year, data AS FCFF\nFROM financial_ratio\nWHERE ratio_code = 'FCF'\n  AND stock_code IN ('VCB', 'TCB', 'ACB')\n  AND year = 2022\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|        data |\n|------------:|\n| 2.17861e+07 |\n| 5.66533e+07 |\n| 1.87481e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Free Cash Flow' AND fr.year = 2022 AND fr.quarter = 0 AND ci.stock_code IN ('VCB', 'TCB', 'ACB')\nLIMIT 100;\n"
            }
        ],
        "time": 3.594817876815796,
        "evaluate": 0,
        "input_token": 5318,
        "output_token": 1056
    },
    {
        "id": "65582c45-ca21-4b65-b92a-990a565809d4",
        "question": "Rank the top 10 companies by their total cash and cash equivalents at the end of Q2 2024.",
        "answer": "Table 1\n| stock_code   | industry           | is_bank   | is_securities   |   cash_and_cash_equivalents |\n|:-------------|:-------------------|:----------|:----------------|----------------------------:|\n| BID          | Banking            | True      | False           |                 2.78228e+08 |\n| TCB          | Banking            | True      | False           |                 1.24892e+08 |\n| VPB          | Banking            | True      | False           |                 1.02267e+08 |\n| SHB          | Banking            | True      | False           |                 8.93781e+07 |\n| ABB          | Banking            | True      | False           |                 4.01649e+07 |\n| VIC          | Real Estate        | False     | False           |                 2.85439e+07 |\n| VHM          | Real Estate        | False     | False           |                 1.71802e+07 |\n| PLX          | Oil and Gas        | False     | False           |                 1.55622e+07 |\n| HPG          | Basic Resources    | False     | False           |                 1.3032e+07  |\n| VGI          | Telecommunications | False     | False           |                 1.11629e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT ci.stock_code, ci.industry, ci.is_bank, ci.is_securities, fr.data AS cash_and_cash_equivalents\nFROM (\n    SELECT stock_code, data\n    FROM bank_financial_report\n    WHERE year = 2024 AND quarter = 2 AND category_code = 'CF_045'\n    \n    UNION ALL\n    \n    SELECT stock_code, data\n    FROM non_bank_financial_report\n    WHERE year = 2024 AND quarter = 2 AND category_code = 'CF_070'\n    \n    UNION ALL\n    \n    SELECT stock_code, data\n    FROM securities_financial_report\n    WHERE year = 2024 AND quarter = 2 AND category_code = 'CF_103'\n) AS fr\nJOIN company_info ci ON fr.stock_code = ci.stock_code\nORDER BY fr.data DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   total_cash_equivalents |   cash_rank |\n|:-------------|-------------------------:|------------:|\n| SSI          |              4.00146e+07 |           1 |\n| VND          |              2.1114e+07  |           2 |\n| POW          |              9.16624e+06 |           3 |\n| PLX          |              8.37162e+06 |           4 |\n| HPG          |              7.48171e+06 |           5 |\n| VIX          |              5.76071e+06 |           6 |\n| SAB          |              4.21927e+06 |           7 |\n| GVR          |              2.2548e+06  |           8 |\n| ORS          |              2.16644e+06 |           9 |\n| MBS          |              1.59957e+06 |          10 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH ConsolidatedCashData AS (\n  SELECT\n    stock_code,\n    SUM(data) AS total_cash_equivalents\n  FROM (\n    SELECT\n      stock_code,\n      data\n    FROM bank_financial_report\n    WHERE\n      quarter = 2\n      AND year = 2024\n      AND category_code = 'BS_112' -- Assuming BS_112 represents total cash and cash equivalents for banks.  Adjust if needed based on your mapping tables.\n    UNION ALL\n    SELECT\n      stock_code,\n      data\n    FROM non_bank_financial_report\n    WHERE\n      quarter = 2\n      AND year = 2024\n      AND category_code = 'BS_112' -- Assuming BS_112 represents total cash and cash equivalents for non-banks. Adjust if needed based on your mapping tables.\n    UNION ALL\n    SELECT\n      stock_code,\n      data\n    FROM securities_financial_report\n    WHERE\n      quarter = 2\n      AND year = 2024\n      AND category_code = 'BS_112' -- Assuming BS_112 represents total cash and cash equivalents for securities firms. Adjust if needed based on your mapping tables.\n  ) AS AllCashData\n  GROUP BY\n    stock_code\n)\nSELECT\n  stock_code,\n  total_cash_equivalents,\n  RANK() OVER (\n    ORDER BY\n      total_cash_equivalents DESC\n  ) AS cash_rank\nFROM ConsolidatedCashData\nORDER BY\n  cash_rank\nLIMIT 10;\n"
            }
        ],
        "time": 7.271038770675659,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "bd8cbad4-191a-45e2-a174-5bbacabaa07b",
        "question": "What are the top 10 companies with the lowest Debt-to-Equity ratio as of Q4 2023?",
        "answer": "Table 1\n| stock_code   | industry                             | is_bank   | is_securities   |   debt_to_equity_ratio |\n|:-------------|:-------------------------------------|:----------|:----------------|-----------------------:|\n| CAP          | Basic Resources                      | False     | False           |               0.102041 |\n| SLS          | Food and Beverages                   | False     | False           |               0.136624 |\n| TCH          | Real Estate                          | False     | False           |               0.17618  |\n| VRE          | Real Estate                          | False     | False           |               0.259786 |\n| DGC          | Chemicals                            | False     | False           |               0.291074 |\n| VCS          | Construction and Materials           | False     | False           |               0.297329 |\n| SAB          | Food and Beverages                   | False     | False           |               0.336332 |\n| GAS          | Utilities (Electricity, Water & Gas) | False     | False           |               0.343894 |\n| YEG          | Media                                | False     | False           |               0.356841 |\n| GVR          | Chemicals                            | False     | False           |               0.428991 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    ci.stock_code,\n    ci.industry,\n    ci.is_bank,\n    ci.is_securities,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND fr.year = 2023\n    AND fr.quarter = 4\nORDER BY \n    fr.data ASC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry   | debt_to_equity_ratio   | rank   |\n|--------------|------------|------------------------|--------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedCompanies AS (\n  SELECT\n    fr.stock_code,\n    fr.data AS debt_to_equity_ratio,\n    RANK() OVER (ORDER BY fr.data ASC) AS rank\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Debt-to-Equity ratio' AND fr.year = 2023 AND fr.quarter = 4\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  rc.debt_to_equity_ratio,\n  rc.rank\nFROM RankedCompanies AS rc\nJOIN company_info AS ci\n  ON rc.stock_code = ci.stock_code\nWHERE\n  rc.rank <= 10\nLIMIT 10;\n"
            }
        ],
        "time": 4.16243052482605,
        "evaluate": 0,
        "input_token": 12691,
        "output_token": 1554
    },
    {
        "id": "ac3dd378-1331-4ca0-babb-f307a8f5378a",
        "question": "Compare the Cash Conversion Cycle (CCC) of Vinamilk and Masan Group in 2023 Q2.  Calculate CCC using the average inventory, accounts receivable, and accounts payable.",
        "answer": "Table 1\n| stock_code   |   inventory |   receivables |    payables |     dio |      dso |      dpo |     ccc |\n|:-------------|------------:|--------------:|------------:|--------:|---------:|---------:|--------:|\n| VNM          | 6.31989e+06 |   4.5048e+06  | 3.48324e+06 | 17314.8 | 12341.9  |  9543.11 | 20113.6 |\n| VNM          | 6.34626e+06 |   4.5048e+06  | 3.48324e+06 | 17387   | 12341.9  |  9543.11 | 20185.8 |\n| MSN          | 1.39022e+07 |   2.38814e+06 | 6.60183e+06 | 38088.2 |  6542.85 | 18087.2  | 26543.8 |\n| MSN          | 1.42982e+07 |   2.38814e+06 | 6.60183e+06 | 39173.2 |  6542.85 | 18087.2  | 27628.8 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH Inventory AS (\n    SELECT stock_code, data AS inventory\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 2 AND category_code IN ('BS_140', 'BS_141')\n      AND stock_code IN ('VNM', 'MSN')\n),\nReceivables AS (\n    SELECT stock_code, data AS receivables\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 2 AND category_code = 'BS_131'\n      AND stock_code IN ('VNM', 'MSN')\n),\nPayables AS (\n    SELECT stock_code, data AS payables\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 2 AND category_code = 'BS_311'\n      AND stock_code IN ('VNM', 'MSN')\n)\nSELECT \n    i.stock_code,\n    i.inventory,\n    r.receivables,\n    p.payables,\n    -- Assuming some constants for days in period and cost of goods sold for calculation\n    (i.inventory / 365) AS DIO, \n    (r.receivables / 365) AS DSO,\n    (p.payables / 365) AS DPO,\n    ((i.inventory / 365) + (r.receivables / 365) - (p.payables / 365)) AS CCC\nFROM Inventory i\nJOIN Receivables r ON i.stock_code = r.stock_code\nJOIN Payables p ON i.stock_code = p.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "text",
                "code": "The provided database schema does not contain information on inventory, accounts receivable, accounts payable, or cost of goods sold, which are necessary to calculate the Cash Conversion Cycle (CCC).  Therefore, it's impossible to construct a SQL query to answer the question.  The schema needs to be extended to include these crucial financial metrics for accurate CCC calculation.\n\n\n### The result of the given SQL:\n\n"
            }
        ],
        "time": 4.507756233215332,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "aec88c44-7b88-47ca-a04a-e599e1ddaeda",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) from 2020 to Q2 2024, calculated annually.",
        "answer": "Table 1\n| stock_code   | industry                   |   year |        roe |\n|:-------------|:---------------------------|-------:|-----------:|\n| VC3          | Real Estate                |   2022 | nan        |\n| DGC          | Chemicals                  |   2022 |   0.557243 |\n| CAP          | Basic Resources            |   2022 |   0.546075 |\n| L14          | Construction and Materials |   2021 |   0.493854 |\n| CAP          | Basic Resources            |   2021 |   0.479184 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    ci.industry, \n    fr.year, \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    mccr.ratio_name = 'Return On Equity'\n    AND fr.year BETWEEN 2020 AND 2024\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name                                                         |    avg_roe |\n|:-------------|:------------------------------------------------------------------------|-----------:|\n| VC3          | Nam MeKong Group Joint Stock Company                                    | nan        |\n| CAP          | Yen Bai Joint Stock Forest Agricultural Products And Foodstuffs Company |   0.485657 |\n| DGC          | Ducgiang Chemicals Group Joint Stock Company                            |   0.364215 |\n| TMB          | Vinacomin - Northern Coal Trading Joint Stock Company                   |   0.33406  |\n| SAF          | Safoco Foodstuff Joint Stock Company                                    |   0.297699 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH AnnualROE AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.data AS roe\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity' AND fr.quarter = 0 AND fr.year BETWEEN 2020 AND 2024\n), AverageROE AS (\n  SELECT\n    stock_code,\n    AVG(roe) AS avg_roe\n  FROM AnnualROE\n  GROUP BY\n    stock_code\n)\nSELECT\n  ci.stock_code,\n  ci.en_company_name,\n  ar.avg_roe\nFROM AverageROE AS ar\nJOIN company_info AS ci\n  ON ar.stock_code = ci.stock_code\nORDER BY\n  ar.avg_roe DESC\nLIMIT 5;\n"
            }
        ],
        "time": 4.615581035614014,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "b402ce7e-32ae-4413-bf24-57e2a907327e",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) for Q2 2024.",
        "answer": "Table 1\n| stock_code   | industry                      |       roe |\n|:-------------|:------------------------------|----------:|\n| TMB          | Basic Resources               | 0.0752439 |\n| VTP          | Industrial Goods and Services | 0.0581527 |\n| SLS          | Food and Beverages            | 0.0572923 |\n| SAB          | Food and Beverages            | 0.0524845 |\n| VHM          | Real Estate                   | 0.0513036 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT fr.stock_code, ci.industry, fr.data AS roe\nFROM financial_ratio fr\nJOIN map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE mccr.ratio_name = 'Return On Equity'\n  AND fr.year = 2024\n  AND fr.quarter = 2\nORDER BY fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | roe   | roe_rank   |\n|--------------|-------|------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedROE AS (\n  SELECT\n    fr.stock_code,\n    fr.data AS roe,\n    RANK() OVER (ORDER BY\n      fr.data DESC) AS roe_rank\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return on Equity' AND fr.year = 2024 AND fr.quarter = 2\n)\nSELECT\n  stock_code,\n  roe,\n  roe_rank\nFROM RankedROE\nWHERE\n  roe_rank <= 5;\n"
            }
        ],
        "time": 3.596705675125122,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "5ee33432-80c6-40b3-9525-1c8791410fae",
        "question": "Rank the top 10 companies by Return on Equity (ROE) for the fiscal year 2022.",
        "answer": "Table 1\n| stock_code   |   roe_value |\n|:-------------|------------:|\n| VC3          |  nan        |\n| DGC          |    0.557243 |\n| CAP          |    0.546075 |\n| TMB          |    0.432194 |\n| DCM          |    0.40744  |\n| SAF          |    0.293575 |\n| TVD          |    0.265397 |\n| VNM          |    0.26138  |\n| VIB          |    0.259372 |\n| FPT          |    0.256007 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    fr.data AS roe_value\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    mccr.ratio_name = 'Return On Equity' \n    AND fr.year = 2022 \n    AND fr.quarter = 0\nORDER BY \n    roe_value DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name                                                         |        roe |   roe_rank |\n|:-------------|:------------------------------------------------------------------------|-----------:|-----------:|\n| VC3          | Nam MeKong Group Joint Stock Company                                    | nan        |          1 |\n| DGC          | Ducgiang Chemicals Group Joint Stock Company                            |   0.557243 |          2 |\n| CAP          | Yen Bai Joint Stock Forest Agricultural Products And Foodstuffs Company |   0.546075 |          3 |\n| TMB          | Vinacomin - Northern Coal Trading Joint Stock Company                   |   0.432194 |          4 |\n| DCM          | PetroVietnam Ca Mau Fertilizer Joint Stock Company                      |   0.40744  |          5 |\n| SAF          | Safoco Foodstuff Joint Stock Company                                    |   0.293575 |          6 |\n| TVD          | Vang Danh Coal Joint Stock Company                                      |   0.265397 |          7 |\n| VNM          | Vietnam Dairy Products Joint Stock Company                              |   0.26138  |          8 |\n| VIB          | Viet Nam International Commercial Joint Stock Bank                      |   0.259372 |          9 |\n| FPT          | FPT Corporation                                                         |   0.256007 |         10 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.stock_code,\n  ci.en_company_name,\n  fr.data AS roe,\n  RANK() OVER (ORDER BY fr.data DESC) AS roe_rank\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Return On Equity' AND fr.year = 2022 AND fr.quarter = 0\nLIMIT 10;\n"
            }
        ],
        "time": 3.9528632164001465,
        "evaluate": 0.5,
        "input_token": 8419,
        "output_token": 1540
    },
    {
        "id": "5635fb56-7037-4c79-9db7-8435e6f0e120",
        "question": "Rank the top 5 companies with total assets greater than 100,000 billion VND  based on Return on Equity (ROE) for the period 2020-Q2 2024, showing ROE values for each company.",
        "answer": "Table 1\n| stock_code   | industry    |     avg_roe |\n|:-------------|:------------|------------:|\n| ACB          | Banking     | nan         |\n| VIB          | Banking     |   0.0698803 |\n| VHM          | Real Estate |   0.0646859 |\n| VCB          | Banking     |   0.0624534 |\n| MBB          | Banking     |   0.056319  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT stock_code, MAX(data) AS max_total_assets\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'BS_300' AND quarter != 0 AND year BETWEEN 2020 AND 2024\n\n        UNION ALL\n\n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'BS_270' AND quarter != 0 AND year BETWEEN 2020 AND 2024\n\n        UNION ALL\n\n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'BS_270' AND quarter != 0 AND year BETWEEN 2020 AND 2024\n    ) AS combined_assets\n    GROUP BY stock_code\n    HAVING MAX(data) > 100000000\n),\nroe_data AS (\n    SELECT stock_code, AVG(data) AS avg_roe\n    FROM financial_ratio\n    WHERE ratio_code = 'ROE' AND quarter != 0 AND year BETWEEN 2020 AND 2024\n    GROUP BY stock_code\n)\nSELECT ci.stock_code, ci.industry, roe_data.avg_roe\nFROM roe_data\nJOIN total_assets ON roe_data.stock_code = total_assets.stock_code\nJOIN company_info ci ON roe_data.stock_code = ci.stock_code\nORDER BY roe_data.avg_roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | industry    |   avg_roe |\n|:-------------|:------------|----------:|\n| VHM          | Real Estate | 0.109791  |\n| NVL          | Real Estate | 0.0291668 |\n| VIC          | Real Estate | 0.0045544 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyROE AS (\n  SELECT\n    ci.stock_code,\n    AVG(fr.data) AS avg_roe\n  FROM company_info AS ci\n  JOIN financial_ratio AS fr\n    ON ci.stock_code = fr.stock_code\n  WHERE\n    fr.ratio_code = 'ROE'\n    AND fr.year >= 2020\n    AND fr.year <= 2024\n    AND fr.quarter <= 2\n  GROUP BY\n    ci.stock_code\n), TotalAssets AS (\n  SELECT\n    ci.stock_code,\n    MAX(CASE WHEN t1.category_code = 'BS_100' THEN t1.data ELSE 0 END) as total_assets\n  FROM company_info AS ci\n  LEFT JOIN (\n    SELECT * FROM bank_financial_report\n    UNION ALL\n    SELECT * FROM non_bank_financial_report\n    UNION ALL\n    SELECT * FROM securities_financial_report\n  ) AS t1\n    ON ci.stock_code = t1.stock_code\n  WHERE t1.quarter = 0\n  GROUP BY ci.stock_code\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  croe.avg_roe\nFROM CompanyROE AS croe\nJOIN TotalAssets AS ta\n  ON croe.stock_code = ta.stock_code\nJOIN company_info AS ci\n  ON croe.stock_code = ci.stock_code\nWHERE\n  ta.total_assets > 100000000\nORDER BY\n  croe.avg_roe DESC\nLIMIT 5;\n"
            }
        ],
        "time": 5.871661424636841,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "6a06e8b7-04a8-4b93-b5a5-7c40198b6678",
        "question": "For the first half of 2024, what were the total assets and total liabilities of Vinamilk and Mobile World Investment?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | en_caption     |   total_value |\n|:-------------|-------:|----------:|:---------------|--------------:|\n| MWG          |   2024 |         1 | C. LIABILITIES |   3.75094e+07 |\n| MWG          |   2024 |         1 | TOTAL ASSETS   |   6.35435e+07 |\n| MWG          |   2024 |         2 | C. LIABILITIES |   3.93931e+07 |\n| MWG          |   2024 |         2 | TOTAL ASSETS   |   6.58698e+07 |\n| VNM          |   2024 |         1 | C. LIABILITIES |   1.57863e+07 |\n| VNM          |   2024 |         1 | TOTAL ASSETS   |   5.16539e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    nfr.year,\n    nfr.quarter,\n    mcc.en_caption,\n    SUM(nfr.data) AS total_value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MWG')\n    AND nfr.year = 2024\n    AND nfr.quarter IN (1, 2)\n    AND mcc.category_code IN ('BS_270', 'BS_300')\nGROUP BY \n    nfr.stock_code, nfr.year, nfr.quarter, mcc.en_caption\nORDER BY \n    nfr.stock_code, nfr.year, nfr.quarter, mcc.en_caption;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n|   total_assets |   total_liabilities |\n|---------------:|--------------------:|\n|    5.96882e+07 |         6.18162e+06 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  SUM(CASE WHEN t1.category_code = 'BS_100' THEN t1.data ELSE 0 END) AS total_assets,\n  SUM(CASE WHEN t1.category_code = 'BS_200' THEN t1.data ELSE 0 END) AS total_liabilities\nFROM non_bank_financial_report AS t1\nINNER JOIN company_info AS t2\n  ON t1.stock_code = t2.stock_code\nWHERE\n  t2.stock_code IN ('VNM', 'MWG') AND t1.year = 2024 AND t1.quarter = 2;\n"
            }
        ],
        "time": 7.853082180023193,
        "evaluate": 0,
        "input_token": 2222,
        "output_token": 699
    },
    {
        "id": "c0ff8d4c-799a-4af1-97ff-5618152aa69d",
        "question": "For the period 2020-Q2 2024, list the top 10 companies with Net Income exceeding 1,000 billion VND, ranked by their Debt-to-Equity ratio, and provide the Debt-to-Equity ratio for each company.",
        "answer": "Table 1\n| stock_code   | industry   | is_bank   | is_securities   |   debt_to_equity_ratio |\n|:-------------|:-----------|:----------|:----------------|-----------------------:|\n| VCB          | Banking    | True      | False           |                29.2163 |\n| VCB          | Banking    | True      | False           |                30.067  |\n| ACB          | Banking    | True      | False           |               nan      |\n| STB          | Banking    | True      | False           |                16.557  |\n| SHB          | Banking    | True      | False           |                18.2134 |\n| LPB          | Banking    | True      | False           |                16.212  |\n| BID          | Banking    | True      | False           |                16.9862 |\n| BID          | Banking    | True      | False           |                17.6264 |\n| BID          | Banking    | True      | False           |                17.7161 |\n| BID          | Banking    | True      | False           |                17.7451 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH net_income_exceeding AS (\n    SELECT\n        stock_code,\n        SUM(data) AS total_net_income\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'IS_021' AND year BETWEEN 2020 AND 2024 AND quarter != 0\n\n        UNION ALL\n\n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'IS_400' AND year BETWEEN 2020 AND 2024 AND quarter != 0\n\n        UNION ALL\n\n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'IS_400' AND year BETWEEN 2020 AND 2024 AND quarter != 0\n    ) AS combined_reports\n    GROUP BY stock_code\n    HAVING SUM(data) > 1000000\n),\ntop_companies AS (\n    SELECT\n        fr.stock_code,\n        fr.data AS debt_to_equity_ratio\n    FROM financial_ratio fr\n    JOIN net_income_exceeding nie ON fr.stock_code = nie.stock_code\n    WHERE fr.ratio_code = 'DTER' AND fr.year BETWEEN 2020 AND 2024 AND fr.quarter != 0\n    ORDER BY fr.data DESC\n    LIMIT 10\n)\nSELECT\n    ci.stock_code,\n    ci.industry,\n    ci.is_bank,\n    ci.is_securities,\n    tc.debt_to_equity_ratio\nFROM company_info ci\nJOIN top_companies tc ON ci.stock_code = tc.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | industry   | debt_to_equity_ratio   |\n|--------------|------------|------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH TopCompanies AS (\n  SELECT\n    ci.stock_code,\n    ci.industry,\n    fr.data AS debt_to_equity_ratio\n  FROM company_info AS ci\n  JOIN financial_ratio AS fr\n    ON ci.stock_code = fr.stock_code\n  WHERE\n    fr.ratio_code = 'DE_RATIO'\n    AND fr.year >= 2020\n    AND fr.year <= 2024\n    AND fr.quarter IN (0, 1, 2) -- Include annual and quarterly data\n  ORDER BY\n    fr.data DESC\n  LIMIT 10\n), NetIncomeCompanies AS (\n  SELECT\n    ci.stock_code,\n    ci.industry,\n    SUM(CASE WHEN t1.quarter = 0 THEN t1.data ELSE 0 END) as annual_net_income,\n    SUM(CASE WHEN t1.quarter != 0 THEN t1.data ELSE 0 END) as quarterly_net_income\n  FROM company_info AS ci\n  LEFT JOIN (\n    SELECT\n      *\n    FROM bank_financial_report\n    UNION ALL\n    SELECT\n      *\n    FROM non_bank_financial_report\n    UNION ALL\n    SELECT\n      *\n    FROM securities_financial_report\n  ) AS t1\n    ON ci.stock_code = t1.stock_code\n  WHERE\n    t1.category_code LIKE 'IS_003' -- Assuming IS_003 represents Net Income\n    AND t1.year >= 2020\n    AND t1.year <= 2024\n  GROUP BY\n    ci.stock_code,\n    ci.industry\n  HAVING\n    SUM(CASE WHEN t1.quarter = 0 THEN t1.data ELSE 0 END) > 1000000 -- 1000 Billion VND\n    OR SUM(CASE WHEN t1.quarter != 0 THEN t1.data ELSE 0 END) > 1000000 -- 1000 Billion VND\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  tc.debt_to_equity_ratio\nFROM company_info AS ci\nJOIN TopCompanies AS tc\n  ON ci.stock_code = tc.stock_code\nJOIN NetIncomeCompanies AS nic\n  ON ci.stock_code = nic.stock_code\nORDER BY\n  tc.debt_to_equity_ratio DESC;\n"
            }
        ],
        "time": 10.80155348777771,
        "evaluate": 0,
        "input_token": 4189,
        "output_token": 1609
    },
    {
        "id": "823d1e17-605a-4502-be5d-4ddcaa72ab21",
        "question": "What are the top 5 companies with the highest Total Assets as of December 31, 2023?",
        "answer": "Table 1\n| stock_code   | industry   |   issue_share |   total_assets |\n|:-------------|:-----------|--------------:|---------------:|\n| BID          | Banking    |    5.7004e+09 |    2.30081e+09 |\n| CTG          | Banking    |    5.37e+09   |    2.03261e+09 |\n| VCB          | Banking    |    5.5891e+09 |    1.83961e+09 |\n| MBB          | Banking    |    5.2871e+09 |    9.44954e+08 |\n| TCB          | Banking    |    7.045e+09  |    8.49482e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the category codes for \"Total Assets\"\n-- For banks, the category code is BS_300\n-- For non-bank corporations, the category code is BS_270\n-- For securities firms, the category code is BS_270\n\n-- Step 2, 3, 4: Retrieve, combine, and order the data\n\nSELECT ci.stock_code, ci.industry, ci.issue_share, total_assets\nFROM (\n    SELECT stock_code, data AS total_assets\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n    \n    UNION ALL\n    \n    SELECT stock_code, data AS total_assets\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n    \n    UNION ALL\n    \n    SELECT stock_code, data AS total_assets\n    FROM securities_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n) AS combined_reports\nJOIN company_info ci ON combined_reports.stock_code = ci.stock_code\nORDER BY total_assets DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry   |   total_assets |\n|:-------------|:-----------|---------------:|\n| BID          | Banking    |    2.30081e+09 |\n| CTG          | Banking    |    2.03261e+09 |\n| VCB          | Banking    |    1.83961e+09 |\n| MBB          | Banking    |    9.44954e+08 |\n| TCB          | Banking    |    8.49482e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH Top5Companies AS (\n  SELECT\n    ci.stock_code,\n    MAX(CASE WHEN t1.category_code = 'BS_300' THEN t1.data ELSE 0 END) AS total_assets\n  FROM company_info AS ci\n  LEFT JOIN bank_financial_report AS t1\n    ON ci.stock_code = t1.stock_code\n    AND t1.year = 2023\n    AND t1.quarter = 0\n  LEFT JOIN non_bank_financial_report AS t2\n    ON ci.stock_code = t2.stock_code\n    AND t2.year = 2023\n    AND t2.quarter = 0\n    AND t2.category_code = 'BS_270'\n  LEFT JOIN securities_financial_report AS t3\n    ON ci.stock_code = t3.stock_code\n    AND t3.year = 2023\n    AND t3.quarter = 0\n    AND t3.category_code = 'BS_270'\n  GROUP BY\n    ci.stock_code\n  ORDER BY\n    total_assets DESC\n  LIMIT 5\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  Top5Companies.total_assets\nFROM Top5Companies\nJOIN company_info AS ci\n  ON Top5Companies.stock_code = ci.stock_code\nORDER BY\n  Top5Companies.total_assets DESC;\n"
            }
        ],
        "time": 5.2925450801849365,
        "evaluate": 1,
        "input_token": 3411,
        "output_token": 651
    },
    {
        "id": "e3299b8e-bde9-4386-aead-2aaf40d9c8fb",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) among  Vietcombank, Techcombank, ACB, BIDV, and VietinBank for the period from 2020 to Q2 2024,  filtering for companies with total assets exceeding 100 billion VND in each year.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |      roe |\n|:-------------|-------:|----------:|---------:|\n| ACB          |   2022 |         0 | 0.234232 |\n| ACB          |   2023 |         0 | 0.226122 |\n| VCB          |   2022 |         0 | 0.220567 |\n| ACB          |   2020 |         0 | 0.216734 |\n| ACB          |   2021 |         0 | 0.213865 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TotalAssets AS (\n    SELECT \n        stock_code, \n        year, \n        SUM(data) AS total_assets\n    FROM \n        bank_financial_report\n    WHERE \n        category_code = 'BS_300' -- Total assets for banks\n        AND year BETWEEN 2020 AND 2024\n        AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n    GROUP BY \n        stock_code, year\n    HAVING \n        SUM(data) > 100000 -- 100 billion VND\n),\nROEData AS (\n    SELECT \n        fr.stock_code, \n        fr.year, \n        fr.quarter, \n        fr.data AS roe\n    FROM \n        financial_ratio fr\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Return On Equity'\n        AND fr.stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'CTG')\n        AND fr.year BETWEEN 2020 AND 2024\n        AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\n)\nSELECT \n    roe.stock_code, \n    roe.year, \n    roe.quarter, \n    roe.roe\nFROM \n    ROEData roe\nJOIN \n    TotalAssets ta ON roe.stock_code = ta.stock_code AND roe.year = ta.year\nORDER BY \n    roe.roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter |       roe |   total_assets |\n|:-------------|-------:|----------:|----------:|---------------:|\n| ACB          |   2020 |         0 | 0.216734  |    4.4453e+08  |\n| VCB          |   2020 |         0 | 0.196318  |    1.32623e+09 |\n| TCB          |   2020 |         0 | 0.168632  |    4.39603e+08 |\n| CTG          |   2020 |         0 | 0.161071  |    1.34144e+09 |\n| BID          |   2020 |         0 | 0.0906952 |    1.51669e+09 |\n| ACB          |   2020 |         1 | 0.0522587 |    3.87396e+08 |\n| VCB          |   2020 |         1 | 0.0491661 |    1.14427e+09 |\n| TCB          |   2020 |         1 | 0.0387928 |    3.91808e+08 |\n| CTG          |   2020 |         1 | 0.0305124 |    1.22265e+09 |\n| BID          |   2020 |         1 | 0.0182221 |    1.44604e+09 |\n| VCB          |   2020 |         2 | 0.0515214 |    1.18526e+09 |\n| ACB          |   2020 |         2 | 0.0493524 |    3.9676e+08  |\n| CTG          |   2020 |         2 | 0.0445602 |    1.23956e+09 |\n| TCB          |   2020 |         2 | 0.0428449 |    3.95861e+08 |\n| BID          |   2020 |         2 | 0.0267998 |    1.44635e+09 |\n| ACB          |   2020 |         3 | 0.0630206 |    4.18748e+08 |\n| TCB          |   2020 |         3 | 0.0450409 |    4.01462e+08 |\n| VCB          |   2020 |         3 | 0.0427012 |    1.18857e+09 |\n| CTG          |   2020 |         3 | 0.0281035 |    1.2612e+09  |\n| BID          |   2020 |         3 | 0.0266951 |    1.46781e+09 |\n| ACB          |   2020 |         4 | 0.0719231 |    4.4453e+08  |\n| CTG          |   2020 |         4 | 0.0630527 |    1.34139e+09 |\n| VCB          |   2020 |         4 | 0.0573927 |    1.32754e+09 |\n| TCB          |   2020 |         4 | 0.0537099 |    4.39603e+08 |\n| BID          |   2020 |         4 | 0.0212542 |    1.51687e+09 |\n| ACB          |   2021 |         0 | 0.213865  |    5.2777e+08  |\n| VCB          |   2021 |         0 | 0.201059  |    1.41467e+09 |\n| TCB          |   2021 |         0 | 0.197927  |    5.68729e+08 |\n| CTG          |   2021 |         0 | 0.151793  |    1.53159e+09 |\n| BID          |   2021 |         0 | 0.125581  |    1.7617e+09  |\n| CTG          |   2021 |         1 | 0.0704634 |    1.34398e+09 |\n| VCB          |   2021 |         1 | 0.0683861 |    1.27897e+09 |\n| ACB          |   2021 |         1 | 0.0654744 |    4.49515e+08 |\n| TCB          |   2021 |         1 | 0.0565945 |    4.62823e+08 |\n| BID          |   2021 |         1 | 0.0330833 |    1.55889e+09 |\n| ACB          |   2021 |         2 | 0.0640966 |    4.71275e+08 |\n| TCB          |   2021 |         2 | 0.0572896 |    5.04304e+08 |\n| BID          |   2021 |         2 | 0.0447812 |    1.6425e+09  |\n| VCB          |   2021 |         2 | 0.0377385 |    1.30363e+09 |\n| CTG          |   2021 |         2 | 0.0240216 |    1.47302e+09 |\n| VCB          |   2021 |         3 | 0.1084    |    1.38524e+09 |\n| TCB          |   2021 |         3 | 0.0501452 |    5.41635e+08 |\n| ACB          |   2021 |         3 | 0.0494926 |    4.79309e+08 |\n| CTG          |   2021 |         3 | 0.0257908 |    1.44781e+09 |\n| BID          |   2021 |         3 | 0.0246729 |    1.68668e+09 |\n| VCB          |   2021 |         4 | 0.0580801 |    1.41477e+09 |\n| ACB          |   2021 |         4 | 0.0540857 |    5.2777e+08  |\n| TCB          |   2021 |         4 | 0.0503334 |    5.68811e+08 |\n| CTG          |   2021 |         4 | 0.0318805 |    1.53147e+09 |\n| BID          |   2021 |         4 | 0.0265799 |    1.76194e+09 |\n| ACB          |   2022 |         0 | 0.234232  |    6.07875e+08 |\n| VCB          |   2022 |         0 | 0.220567  |    1.81382e+09 |\n| TCB          |   2022 |         0 | 0.180176  |    6.99033e+08 |\n| BID          |   2022 |         0 | 0.176793  |    2.12061e+09 |\n| CTG          |   2022 |         0 | 0.155638  |    1.80843e+09 |\n| ACB          |   2022 |         1 | 0.0682014 |    5.28636e+08 |\n| VCB          |   2022 |         1 | 0.0680525 |    1.46275e+09 |\n| TCB          |   2022 |         1 | 0.0569507 |    6.1527e+08  |\n| CTG          |   2022 |         1 | 0.0477933 |    1.66373e+09 |\n| BID          |   2022 |         1 | 0.0404915 |    1.8477e+09  |\n| ACB          |   2022 |         2 | 0.0757336 |    5.43737e+08 |\n| TCB          |   2022 |         2 | 0.0562806 |    6.23745e+08 |\n| BID          |   2022 |         2 | 0.056009  |    1.97942e+09 |\n| VCB          |   2022 |         2 | 0.0483124 |    1.60239e+09 |\n| CTG          |   2022 |         2 | 0.0455415 |    1.69106e+09 |\n| ACB          |   2022 |         3 | 0.0643583 |    5.61114e+08 |\n| BID          |   2022 |         3 | 0.0530516 |    2.04895e+09 |\n| TCB          |   2022 |         3 | 0.0488406 |    6.71354e+08 |\n| VCB          |   2022 |         3 | 0.0472737 |    1.64966e+09 |\n| CTG          |   2022 |         3 | 0.0312855 |    1.75079e+09 |\n| VCB          |   2022 |         4 | 0.0719881 |    1.81419e+09 |\n| ACB          |   2022 |         4 | 0.0491202 |    6.07875e+08 |\n| CTG          |   2022 |         4 | 0.0408979 |    2.12053e+09 |\n| BID          |   2022 |         4 | 0.0408979 |    2.12053e+09 |\n| TCB          |   2022 |         4 | 0.031493  |    6.99033e+08 |\n| ACB          |   2023 |         0 | 0.226122  |    7.18795e+08 |\n| VCB          |   2023 |         0 | 0.200315  |    1.83961e+09 |\n| BID          |   2023 |         0 | 0.178797  |    2.30081e+09 |\n| CTG          |   2023 |         0 | 0.159246  |    2.03261e+09 |\n| TCB          |   2023 |         0 | 0.139608  |    8.49482e+08 |\n| ACB          |   2023 |         1 | 0.0661285 |    6.11224e+08 |\n| VCB          |   2023 |         1 | 0.0621596 |    1.84643e+09 |\n| BID          |   2023 |         1 | 0.0506065 |    2.10686e+09 |\n| CTG          |   2023 |         1 | 0.0427747 |    1.82396e+09 |\n| TCB          |   2023 |         1 | 0.0384612 |    7.23518e+08 |\n| VCB          |   2023 |         2 | 0.139806  |    1.70427e+09 |\n| BID          |   2023 |         2 | 0.0486747 |    2.1248e+09  |\n| CTG          |   2023 |         2 | 0.0445844 |    1.8601e+09  |\n| TCB          |   2023 |         2 | 0.0367734 |    7.3247e+08  |\n| ACB          |   2023 |         3 | 0.0604199 |    6.4851e+08  |\n| VCB          |   2023 |         3 | 0.045712  |    1.73131e+09 |\n| BID          |   2023 |         3 | 0.0413834 |    2.13285e+09 |\n| TCB          |   2023 |         3 | 0.0367239 |    7.81279e+08 |\n| CTG          |   2023 |         3 | 0.0321482 |    1.88834e+09 |\n| VCB          |   2023 |         4 | 0.0555349 |    1.83922e+09 |\n| TCB          |   2023 |         4 | 0.0381519 |    8.18107e+08 |\n| ACB          |   2024 |         1 | 0.052218  |    7.27298e+08 |\n| VCB          |   2024 |         1 | 0.0494831 |    1.77371e+09 |\n| BID          |   2024 |         1 | 0.0477211 |    2.32873e+09 |\n| TCB          |   2024 |         1 | 0.0459854 |    8.85653e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantCompanies AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'CTG') -- Vietcombank, Techcombank, ACB, BIDV, VietinBank\n),\nROEData AS (\n  SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data as roe\n  FROM financial_ratio fr\n  JOIN RelevantCompanies rc ON fr.stock_code = rc.stock_code\n  WHERE fr.ratio_code = 'ROE'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <=2))\n),\nTotalAssetsData AS (\n  SELECT \n    br.stock_code,\n    br.year,\n    br.quarter,\n    br.data as total_assets\n  FROM bank_financial_report br\n  JOIN RelevantCompanies rc ON br.stock_code = rc.stock_code\n  WHERE br.category_code = 'BS_300' -- Assuming BS_300 represents Total Assets for banks.  Adjust if needed based on schema.\n  AND br.year >= 2020\n  AND (br.year < 2024 OR (br.year = 2024 AND br.quarter <=2))\n\n),\nCombinedData AS (\n  SELECT \n    rd.stock_code,\n    rd.year,\n    rd.quarter,\n    rd.roe,\n    tad.total_assets\n  FROM ROEData rd\n  JOIN TotalAssetsData tad ON rd.stock_code = tad.stock_code AND rd.year = tad.year AND rd.quarter = tad.quarter\n  WHERE tad.total_assets > 100000 \n)\nSELECT \n    stock_code,\n    year,\n    quarter,\n    roe,\n    total_assets\nFROM (\n  SELECT \n    stock_code,\n    year,\n    quarter,\n    roe,\n    total_assets,\n    RANK() OVER (PARTITION BY year, quarter ORDER BY roe DESC) as rank\n  FROM CombinedData\n) ranked_data\nWHERE rank <=5\nORDER BY year, quarter, rank\nLIMIT 100;\n\n"
            }
        ],
        "time": 7.179544925689697,
        "evaluate": 0.5,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "74b672c5-6a11-41a6-add8-8b866f4f1972",
        "question": "What were the total assets and total liabilities of Vinamilk and Masan Group at the end of 2023?",
        "answer": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VNM          | BS_270          | 5.26734e+07 |\n| VNM          | BS_300          | 1.76476e+07 |\n| MSN          | BS_270          | 1.47383e+08 |\n| MSN          | BS_300          | 1.09146e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    category_code,\n    data\nFROM \n    non_bank_financial_report\nWHERE \n    stock_code IN ('VNM', 'MSN') AND\n    year = 2023 AND\n    quarter = 0 AND\n    category_code IN ('BS_270', 'BS_300');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs for Vinamilk and Masan Group.\nWITH CompanyIDs AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan')\n)\n\n-- Step 2: Retrieve the total assets and total liabilities for Vinamilk and Masan Group for the year 2023.\nSELECT\n  ci.company_name,\n  SUM(CASE WHEN mccnb.en_caption LIKE '%Total assets%' THEN nbfr.data ELSE 0 END) AS total_assets,\n  SUM(CASE WHEN mccnb.en_caption LIKE '%Total liabilities%' THEN nbfr.data ELSE 0 END) AS total_liabilities\nFROM CompanyIDs AS ci\nJOIN non_bank_financial_report AS nbfr\n  ON ci.stock_code = nbfr.stock_code\nJOIN map_category_code_non_bank AS mccnb\n  ON nbfr.category_code = mccnb.category_code\nWHERE\n  nbfr.year = 2023 AND nbfr.quarter = 0\nGROUP BY\n  ci.company_name;\n"
            }
        ],
        "time": 4.691569566726685,
        "evaluate": 0,
        "input_token": 8235,
        "output_token": 2119
    },
    {
        "id": "d791c613-7b95-4157-bde2-61de3fb6bec9",
        "question": "Rank the top 5 companies with the highest operating cash flow in Q2 2024, filtering for companies with total assets exceeding 100 billion VND.",
        "answer": "Table 1\n| stock_code   | industry           |   operating_cash_flow |\n|:-------------|:-------------------|----------------------:|\n| MWG          | Retail             |           7.46094e+06 |\n| VGI          | Telecommunications |           6.99246e+06 |\n| VHM          | Real Estate        |           6.47431e+06 |\n| VND          | Financial Services |           3.45256e+06 |\n| SSI          | Financial Services |           3.20662e+06 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TotalAssets AS (\n    SELECT stock_code, data AS total_assets\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2024 AND quarter = 2\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_270' AND year = 2024 AND quarter = 2\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM securities_financial_report\n    WHERE category_code = 'BS_270' AND year = 2024 AND quarter = 2\n),\nOperatingCashFlow AS (\n    SELECT stock_code, data AS operating_cash_flow\n    FROM bank_financial_report\n    WHERE category_code = 'CF_009' AND year = 2024 AND quarter = 2\n    UNION ALL\n    SELECT stock_code, data AS operating_cash_flow\n    FROM non_bank_financial_report\n    WHERE category_code = 'CF_020' AND year = 2024 AND quarter = 2\n    UNION ALL\n    SELECT stock_code, data AS operating_cash_flow\n    FROM securities_financial_report\n    WHERE category_code = 'CF_060' AND year = 2024 AND quarter = 2\n)\nSELECT ci.stock_code, ci.industry, ocf.operating_cash_flow\nFROM OperatingCashFlow ocf\nJOIN TotalAssets ta ON ocf.stock_code = ta.stock_code\nJOIN company_info ci ON ocf.stock_code = ci.stock_code\nWHERE ta.total_assets > 100000\nORDER BY ocf.operating_cash_flow DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry   | operating_cash_flow   |\n|--------------|------------|-----------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedCompanies AS (\n  SELECT\n    ci.stock_code,\n    ci.industry,\n    COALESCE(bnk.data, nbk.data, sec.data) AS operating_cash_flow,\n    RANK() OVER (\n      ORDER BY\n        COALESCE(bnk.data, nbk.data, sec.data) DESC\n    ) AS cash_flow_rank\n  FROM company_info AS ci\n  LEFT JOIN bank_financial_report AS bnk\n    ON ci.stock_code = bnk.stock_code\n    AND bnk.year = 2024\n    AND bnk.quarter = 2\n    AND bnk.category_code IN ('CF_009') -- Assuming 'CF_009' represents operating cash flow for banks.  Adjust if needed based on your data.\n  LEFT JOIN non_bank_financial_report AS nbk\n    ON ci.stock_code = nbk.stock_code\n    AND nbk.year = 2024\n    AND nbk.quarter = 2\n    AND nbk.category_code IN ('CF_020') -- Assuming 'CF_020' represents operating cash flow for non-bank companies. Adjust if needed.\n  LEFT JOIN securities_financial_report AS sec\n    ON ci.stock_code = sec.stock_code\n    AND sec.year = 2024\n    AND sec.quarter = 2\n    AND sec.category_code IN ('CF_060') -- Assuming 'CF_060' represents operating cash flow for securities firms. Adjust if needed.\n  WHERE\n    ci.stock_code IN (\n      SELECT\n        stock_code\n      FROM bank_financial_report\n      WHERE\n        year = 2024\n        AND quarter = 0\n        AND category_code = 'BS_100' -- Assuming 'BS_100' represents total assets.  Adjust if needed.\n        AND data > 100000\n      UNION\n      SELECT\n        stock_code\n      FROM non_bank_financial_report\n      WHERE\n        year = 2024\n        AND quarter = 0\n        AND category_code = 'BS_100' -- Assuming 'BS_100' represents total assets.  Adjust if needed.\n        AND data > 100000\n      UNION\n      SELECT\n        stock_code\n      FROM securities_financial_report\n      WHERE\n        year = 2024\n        AND quarter = 0\n        AND category_code = 'BS_100' -- Assuming 'BS_100' represents total assets.  Adjust if needed.\n        AND data > 100000\n    )\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  rc.operating_cash_flow\nFROM RankedCompanies AS rc\nJOIN company_info AS ci\n  ON rc.stock_code = ci.stock_code\nWHERE\n  rc.cash_flow_rank <= 5\nORDER BY\n  rc.cash_flow_rank;\n"
            }
        ],
        "time": 10.707436084747314,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "32d92561-df33-4214-ab25-af40d4de6971",
        "question": "What were the Return on Equity (ROE) and Debt-to-Equity ratios for Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   | ratio_code   | ratio_name           |      data |\n|:-------------|:-------------|:---------------------|----------:|\n| TCB          | DTER         | Debt To Equity Ratio |  5.16295  |\n| VCB          | DTER         | Debt To Equity Ratio | 12.3717   |\n| TCB          | ROE          | Return On Equity     |  0.180176 |\n| VCB          | ROE          | Return On Equity     |  0.220567 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    fr.ratio_code, \n    mcr.ratio_name, \n    fr.data \nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.stock_code IN ('VCB', 'TCB') \n    AND fr.year = 2022 \n    AND fr.quarter = 0 \n    AND fr.ratio_code IN ('ROE', 'DTER');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| ratio_code   |      data |\n|:-------------|----------:|\n| DTER         |  5.16295  |\n| DTER         | 12.3717   |\n| ROE          |  0.180176 |\n| ROE          |  0.220567 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.ratio_code,\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  (\n    ci.stock_code = 'VCB' OR ci.stock_code = 'TCB'\n  )\n  AND fr.year = 2022\n  AND fr.quarter = 0\n  AND mcr.ratio_name IN ('Return On Equity', 'Debt To Equity Ratio')\nLIMIT 10;\n"
            }
        ],
        "time": 3.941291332244873,
        "evaluate": 0,
        "input_token": 6307,
        "output_token": 1173
    },
    {
        "id": "f6998c23-5ecd-44d3-a4ae-bf48c341f901",
        "question": "Compare the Current Ratio and Quick Ratio of Mobile World Investment, Vinamilk, and Masan Group for the first quarter of 2024.",
        "answer": "Table 1\n| stock_code   | ratio_name    |     data |\n|:-------------|:--------------|---------:|\n| MSN          | Current Ratio | 0.87025  |\n| MSN          | Quick Ratio   | 0.611971 |\n| MWG          | Current Ratio | 1.80429  |\n| MWG          | Quick Ratio   | 1.15211  |\n| VNM          | Current Ratio | 2.30115  |\n| VNM          | Quick Ratio   | 1.85779  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    mc.ratio_name,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mc ON fr.ratio_code = mc.ratio_code\nWHERE \n    fr.stock_code IN ('MWG', 'VNM', 'MSN') -- Stock codes for Mobile World Investment, Vinamilk, and Masan Group\n    AND fr.year = 2024\n    AND fr.quarter = 1 -- First quarter\n    AND mc.ratio_name IN ('Current Ratio', 'Quick Ratio');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| en_company_name                            |   current_ratio |   quick_ratio |\n|:-------------------------------------------|----------------:|--------------:|\n| Masan Group Corporation                    |         0.87025 |      0.611971 |\n| Vietnam Dairy Products Joint Stock Company |         2.30115 |      1.85779  |\n| Mobile World Investment Corporation        |         1.80429 |      1.15211  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.en_company_name,\n  fr.data AS current_ratio,\n  fr2.data AS quick_ratio\nFROM company_info AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN financial_ratio AS fr2\n  ON ci.stock_code = fr2.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN map_category_code_ratio AS mcr2\n  ON fr2.ratio_code = mcr2.ratio_code\nWHERE\n  ci.en_company_name IN ('Mobile World Investment Corporation', 'Vietnam Dairy Products Joint Stock Company', 'Masan Group Corporation')\n  AND fr.year = 2024\n  AND fr.quarter = 1\n  AND mcr.ratio_name = 'Current Ratio'\n  AND fr2.year = 2024\n  AND fr2.quarter = 1\n  AND mcr2.ratio_name = 'Quick Ratio'\nLIMIT 3;\n"
            }
        ],
        "time": 5.01021671295166,
        "evaluate": 1,
        "input_token": 4734,
        "output_token": 589
    },
    {
        "id": "68482aa2-d5ec-43e5-8f1a-17ba50d8107b",
        "question": "What was the average Return on Equity (ROE) for Vietcombank, Techcombank, and VPBank in Q2 2024, and how does this compare to their respective average ROE for the same quarter in 2020, considering their investments in subsidiaries?",
        "answer": "Table 1\n| stock_code   |   year |   average_roe |\n|:-------------|-------:|--------------:|\n| EIB          |   2020 |    0.00463626 |\n| MBB          |   2020 |    0.0521778  |\n| OCB          |   2020 |    0.039273   |\n| TCB          |   2020 |    0.0428449  |\n| TCB          |   2024 |    0.0457096  |\n| VCB          |   2020 |    0.0515214  |\n| VPB          |   2020 |    0.0621598  |\n| VPB          |   2024 |    0.026311   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_and_subsidiaries AS (\n    SELECT DISTINCT f.stock_code, f.year, f.quarter, f.data\n    FROM financial_ratio f\n    JOIN map_category_code_ratio m ON f.ratio_code = m.ratio_code\n    LEFT JOIN sub_and_shareholder s ON f.stock_code = s.stock_code OR f.stock_code = s.invest_on\n    WHERE m.ratio_name = 'Return On Equity'\n      AND f.quarter = 2\n      AND f.year IN (2020, 2024)\n      AND (f.stock_code IN ('VCB', 'TCB', 'VPB') OR s.stock_code IN ('VCB', 'TCB', 'VPB'))\n)\nSELECT stock_code, year, AVG(data) AS average_roe\nFROM bank_and_subsidiaries\nGROUP BY stock_code, year\nORDER BY stock_code, year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| en_company_name                                          |   avg_roe_2024 |   avg_roe_2020 |   roe_difference |\n|:---------------------------------------------------------|---------------:|---------------:|-----------------:|\n| Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    nan         |      0.0515214 |      nan         |\n| Vietnam Prosperity Joint Stock Commercial Bank           |      0.026311  |      0.0621598 |       -0.0358488 |\n| Vietnam Technological And Commercial Joint Stock Bank    |      0.0457096 |      0.0428449 |        0.0028647 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantROE AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS roe\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.stock_code IN ('VCB', 'TCB', 'VPB')\n    AND fr.quarter = 2\n    AND fr.year IN (2020, 2024)\n), AvgROE AS (\n  SELECT\n    stock_code,\n    AVG(CASE WHEN year = 2024 THEN roe ELSE NULL END) AS avg_roe_2024,\n    AVG(CASE WHEN year = 2020 THEN roe ELSE NULL END) AS avg_roe_2020\n  FROM RelevantROE\n  GROUP BY\n    stock_code\n)\nSELECT\n  ci.en_company_name,\n  ar.avg_roe_2024,\n  ar.avg_roe_2020,\n  ar.avg_roe_2024 - ar.avg_roe_2020 AS roe_difference\nFROM AvgROE AS ar\nJOIN company_info AS ci\n  ON ar.stock_code = ci.stock_code\nORDER BY\n  ci.en_company_name;\n"
            }
        ],
        "time": 5.640700101852417,
        "evaluate": 1,
        "input_token": 2421,
        "output_token": 495
    },
    {
        "id": "3b87156b-84ba-4a7a-ac63-78e7629b7a76",
        "question": "What is the Return on Equity (ROE) and Debt-to-Equity Ratio for Vinamilk and Masan Group for the fiscal year 2023, and how do these compare to their respective figures in 2020?  Analyze the change in these ratios over time for each company, considering the impact of both profitability and financial leverage.",
        "answer": "Table 1\n| stock_code   |   year | ratio_code   |   ratio_value |\n|:-------------|-------:|:-------------|--------------:|\n| MSN          |   2020 | DTER         |     3.62386   |\n| MSN          |   2023 | DTER         |     2.85445   |\n| MSN          |   2020 | ROE          |     0.055733  |\n| MSN          |   2023 | ROE          |     0.0489033 |\n| VNM          |   2020 | DTER         |     0.439424  |\n| VNM          |   2023 | DTER         |     0.503847  |\n| VNM          |   2020 | ROE          |     0.333928  |\n| VNM          |   2023 | ROE          |     0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    ratio_code, \n    data AS ratio_value\nFROM \n    financial_ratio\nWHERE \n    stock_code IN ('VNM', 'MSN') AND\n    ratio_code IN ('ROE', 'DTER') AND\n    year IN (2023, 2020) AND\n    quarter = 0\nORDER BY \n    stock_code, \n    ratio_code, \n    year;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| company_name                 |   year | roe   | dter   | roe_prev   | dter_prev   | roe_change_percent   | dter_change_percent   |\n|:-----------------------------|-------:|:------|:-------|:-----------|:------------|:---------------------|:----------------------|\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam |   2020 |       |        |            |             |                      |                       |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan')\n), RatioData AS (\n  SELECT\n    ci.company_name,\n    fr.year,\n    fr.quarter,\n    CASE\n      WHEN mcr.ratio_name = 'Return On Equity'\n      THEN fr.data\n      ELSE NULL\n    END AS roe,\n    CASE\n      WHEN mcr.ratio_name = 'Debt To Equity Ratio'\n      THEN fr.data\n      ELSE NULL\n    END AS dter\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  JOIN company_info AS ci\n    ON fr.stock_code = ci.stock_code\n  JOIN CompanyCodes AS cc\n    ON ci.stock_code = cc.stock_code\n  WHERE\n    fr.year IN (2020, 2023) AND fr.quarter = 0\n)\nSELECT\n  company_name,\n  year,\n  roe,\n  dter,\n  LAG(roe, 1, NULL) OVER (PARTITION BY company_name ORDER BY year) AS roe_prev,\n  LAG(dter, 1, NULL) OVER (PARTITION BY company_name ORDER BY year) AS dter_prev,\n  (\n    roe - LAG(roe, 1, NULL) OVER (PARTITION BY company_name ORDER BY year)\n  ) * 100.0 / LAG(roe, 1, NULL) OVER (PARTITION BY company_name ORDER BY year) AS roe_change_percent,\n  (\n    dter - LAG(dter, 1, NULL) OVER (PARTITION BY company_name ORDER BY year)\n  ) * 100.0 / LAG(dter, 1, NULL) OVER (PARTITION BY company_name ORDER BY year) AS dter_change_percent\nFROM RatioData\nORDER BY\n  company_name,\n  year\nLIMIT 10;\n"
            }
        ],
        "time": 6.6162660121917725,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "78183cf7-204e-4442-b5b1-209c51e9ab3f",
        "question": "For the year 2023, what was the Debt-to-Equity ratio for VinGroup,  and how does this ratio change when considering the consolidated financial statements including its subsidiaries' debt and equity?",
        "answer": "Table 1\n|   standalone_dter |\n|------------------:|\n|           3.50444 |\n\nTable 2\n|   standalone_dter |   consolidated_dter |\n|------------------:|--------------------:|\n|           3.50444 |            0.499221 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve the Debt-to-Equity ratio for VinGroup for the year 2023\nSELECT fr.data AS standalone_dter\nFROM financial_ratio fr\nJOIN map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE fr.stock_code = 'VIC'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND mccr.ratio_name = 'Debt To Equity Ratio';\n\n-- Step 2: Identify the subsidiaries of VinGroup\nWITH subsidiaries AS (\n    SELECT invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VIC'\n)\n\n-- Step 3: Retrieve debt and equity data for VinGroup and its subsidiaries\n, debt_equity_data AS (\n    SELECT stock_code,\n           SUM(CASE WHEN category_code = 'BS_400' THEN data ELSE 0 END) AS total_liabilities,\n           SUM(CASE WHEN category_code IN ('BS_400', 'BS_410', 'BS_420') THEN data ELSE 0 END) AS total_equity\n    FROM non_bank_financial_report\n    WHERE (stock_code = 'VIC' OR stock_code IN (SELECT invest_on FROM subsidiaries))\n      AND year = 2023\n      AND quarter = 0\n    GROUP BY stock_code\n)\n\n-- Step 4: Calculate the consolidated Debt-to-Equity ratio\n, consolidated_dter AS (\n    SELECT SUM(total_liabilities) / NULLIF(SUM(total_equity), 0) AS consolidated_dter\n    FROM debt_equity_data\n)\n\n-- Step 5: Combine results\nSELECT standalone_dter, consolidated_dter\nFROM (\n    SELECT fr.data AS standalone_dter\n    FROM financial_ratio fr\n    JOIN map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE fr.stock_code = 'VIC'\n      AND fr.year = 2023\n      AND fr.quarter = 0\n      AND mccr.ratio_name = 'Debt To Equity Ratio'\n) AS standalone,\nconsolidated_dter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n|   standalone_dter |\n|------------------:|\n|           3.50444 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve VinGroup's Debt and Equity for 2023.  Since we don't have direct Debt and Equity codes, we'll use the pre-calculated ratio.\n\nSELECT \n    fr.data as standalone_dter\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nJOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE ci.stock_code = 'VIC'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND mcr.ratio_name = 'Debt To Equity Ratio'\nLIMIT 1;\n\n\n-- Step 2:  Calculate consolidated Debt-to-Equity ratio. This requires subsidiary data, which isn't directly available in the provided schema to calculate a true consolidated DTE.  The following query attempts to show the standalone ratio.  A true consolidated ratio would require significant data restructuring and aggregation not feasible with the current schema.\n\n-- The following is a placeholder; a true consolidated calculation is not possible without more detailed subsidiary financial data linked to the parent company.\n\n-- Placeholder:  Assume consolidated data is not available in this simplified schema.\n\n-- Output: The query will return the standalone Debt-to-Equity ratio for VinGroup in 2023.  A comparison with a consolidated ratio is not possible due to data limitations.\n\n"
            }
        ],
        "time": 5.734057188034058,
        "evaluate": 0,
        "input_token": 7793,
        "output_token": 1416
    },
    {
        "id": "367dc7bd-7224-409a-a7c9-849e587f88e5",
        "question": "What is the trend of the current ratio for Vietcombank, Techcombank, and Sacombank from 2020 to Q2 2024?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |   current_ratio |\n|-------:|----------:|:-------------|----------------:|\n|   2020 |         0 | STB          |        1.56301  |\n|   2020 |         0 | TCB          |        2.83619  |\n|   2020 |         0 | VCB          |        7.25011  |\n|   2021 |         0 | STB          |        1.02262  |\n|   2021 |         0 | TCB          |        4.35343  |\n|   2021 |         0 | VCB          |        6.29498  |\n|   2022 |         0 | STB          |        1.09035  |\n|   2022 |         0 | TCB          |        3.29776  |\n|   2022 |         0 | VCB          |        3.56816  |\n|   2023 |         0 | STB          |        0.700152 |\n|   2023 |         0 | TCB          |        2.66367  |\n|   2023 |         0 | VCB          |        4.7828   |\n|   2024 |         1 | STB          |        1.0368   |\n|   2024 |         1 | TCB          |        2.40445  |\n|   2024 |         1 | VCB          |        3.48899  |\n|   2024 |         2 | TCB          |        2.88946  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    year, \n    quarter, \n    stock_code, \n    data AS current_ratio\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'CurrentR'\n    AND stock_code IN ('VCB', 'TCB', 'STB')\n    AND (\n        (year = 2020 AND quarter = 0) OR\n        (year = 2021 AND quarter = 0) OR\n        (year = 2022 AND quarter = 0) OR\n        (year = 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (0, 1, 2))\n    )\nORDER BY \n    year, \n    quarter, \n    stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs\n\nWITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('VCB', 'TCB', 'STB') -- Vietcombank, Techcombank, Sacombank\n)\n\n-- Step 2: Retrieve the current ratio data\n\nSELECT \n  ci.company_name,\n  fr.year,\n  fr.quarter,\n  fr.data AS current_ratio\nFROM CompanyIDs ci\nJOIN financial_ratio fr ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Current Ratio'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY ci.company_name, fr.year, fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.989041328430176,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "76f8d91f-264c-4654-aad8-17a86d41aafd",
        "question": "For the period 2020-Q2 2024, provide the year-over-year change in cash and cash equivalents, and short-term borrowings for Mobile World Investment, Vinamilk, and PetroVietnam Gas.  Calculate the cash ratio for each company for each year.",
        "answer": "Table 1\n| stock_code   |   year |   yoy_change_cash |   yoy_change_borrowings |   cash_ratio |\n|:-------------|-------:|------------------:|------------------------:|-------------:|\n| GAS          |   2020 |         nan       |                nan      |     5.14732  |\n| GAS          |   2021 |           1.20453 |                -52.3583 |    10.9344   |\n| GAS          |   2022 |          99.0317  |                -90.7175 |   234.451    |\n| GAS          |   2023 |         -46.263   |               3466.5    |     3.5325   |\n| MWG          |   2020 |         nan       |                nan      |     0.470257 |\n| MWG          |   2021 |         -43.6296  |                 57.742  |     0.16805  |\n| MWG          |   2022 |          22.1874  |                -56.636  |     0.473517 |\n| MWG          |   2023 |           6.02021 |                 78.9698 |     0.280508 |\n| VNM          |   2020 |         nan       |                nan      |     0.288559 |\n| VNM          |   2021 |          11.2403  |                 28.2356 |     0.250316 |\n| VNM          |   2022 |          -2.0697  |                -48.1246 |     0.472546 |\n| VNM          |   2023 |          26.613   |                 68.842  |     0.354358 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH cash_data AS (\n    SELECT \n        stock_code,\n        year,\n        SUM(CASE WHEN category_code = 'BS_110' THEN data ELSE 0 END) AS cash_and_cash_equivalents,\n        SUM(CASE WHEN category_code = 'BS_320' THEN data ELSE 0 END) AS short_term_borrowings\n    FROM \n        non_bank_financial_report\n    WHERE \n        stock_code IN ('MWG', 'VNM', 'GAS') \n        AND year BETWEEN 2020 AND 2024\n        AND quarter = 0\n    GROUP BY \n        stock_code, year\n),\nyear_over_year_change AS (\n    SELECT \n        a.stock_code,\n        a.year,\n        (a.cash_and_cash_equivalents - b.cash_and_cash_equivalents) / NULLIF(b.cash_and_cash_equivalents, 0) * 100 AS yoy_change_cash,\n        (a.short_term_borrowings - b.short_term_borrowings) / NULLIF(b.short_term_borrowings, 0) * 100 AS yoy_change_borrowings\n    FROM \n        cash_data a\n    LEFT JOIN \n        cash_data b ON a.stock_code = b.stock_code AND a.year = b.year + 1\n),\ncash_ratio AS (\n    SELECT \n        stock_code,\n        year,\n        cash_and_cash_equivalents / NULLIF(short_term_borrowings, 0) AS cash_ratio\n    FROM \n        cash_data\n)\nSELECT \n    y.stock_code,\n    y.year,\n    y.yoy_change_cash,\n    y.yoy_change_borrowings,\n    c.cash_ratio\nFROM \n    year_over_year_change y\nJOIN \n    cash_ratio c ON y.stock_code = c.stock_code AND y.year = c.year\nORDER BY \n    y.stock_code, y.year;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n|   year | stock_code   |   yoy_cash_change |   yoy_borrowings_change |   cash_ratio |\n|-------:|:-------------|------------------:|------------------------:|-------------:|\n|   2020 | GAS          |       1.49504e+07 |             1.01747e+06 |     0.537221 |\n|   2021 | GAS          |  887525           |       -532730           |     0.320044 |\n|   2022 | GAS          |       1.05611e+07 |       -439744           |     0.844761 |\n|   2023 | GAS          |      -2.07301e+07 |             1.55979e+06 |     0.378634 |\n|   2020 | MWG          |       1.7811e+07  |             1.56252e+07 |     0.249736 |\n|   2021 | MWG          |      -2.17906e+06 |             9.02229e+06 |     0.097246 |\n|   2022 | MWG          |      -1.36783e+06 |            -1.39593e+07 |     0.194653 |\n|   2023 | MWG          |       1.52837e+06 |             8.4404e+06  |     0.174408 |\n|   2020 | VNM          |       6.88768e+06 |             7.3165e+06  |     0.148547 |\n|   2021 | VNM          |  -79334           |             2.06586e+06 |     0.137596 |\n|   2022 | VNM          |  140093           |            -4.51522e+06 |     0.15024  |\n|   2023 | VNM          |       1.17556e+06 |             3.35063e+06 |     0.16991  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH YearlyData AS (\n  SELECT\n    yr.year,\n    yr.stock_code,\n    SUM(CASE WHEN mc.en_caption LIKE '%Cash and cash equivalents%' THEN yr.data ELSE 0 END) AS cash_equivalents,\n    SUM(CASE WHEN mc.en_caption LIKE '%Short-term borrowings%' THEN yr.data ELSE 0 END) AS short_term_borrowings\n  FROM non_bank_financial_report AS yr\n  JOIN map_category_code_non_bank AS mc\n    ON yr.category_code = mc.category_code\n  WHERE\n    yr.stock_code IN ('MWG', 'VNM', 'GAS')\n    AND yr.quarter = 0\n    AND yr.year BETWEEN 2020 AND 2024\n  GROUP BY\n    yr.year,\n    yr.stock_code\n), YoYChanges AS (\n  SELECT\n    y1.year,\n    y1.stock_code,\n    y1.cash_equivalents - COALESCE(y2.cash_equivalents, 0) AS yoy_cash_change,\n    y1.short_term_borrowings - COALESCE(y2.short_term_borrowings, 0) AS yoy_borrowings_change\n  FROM YearlyData AS y1\n  LEFT JOIN YearlyData AS y2\n    ON y1.stock_code = y2.stock_code AND y1.year = y2.year + 1\n), CashRatios AS (\n  SELECT\n    fr.year,\n    fr.stock_code,\n    fr.data AS cash_ratio\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Cash Ratio'\n    AND fr.stock_code IN ('MWG', 'VNM', 'GAS')\n    AND fr.quarter = 0\n    AND fr.year BETWEEN 2020 AND 2024\n)\nSELECT\n  yoy.year,\n  yoy.stock_code,\n  yoy.yoy_cash_change,\n  yoy.yoy_borrowings_change,\n  cr.cash_ratio\nFROM YoYChanges AS yoy\nJOIN CashRatios AS cr\n  ON yoy.stock_code = cr.stock_code AND yoy.year = cr.year\nORDER BY\n  yoy.stock_code,\n  yoy.year\nLIMIT 100;\n"
            }
        ],
        "time": 7.612379312515259,
        "evaluate": 0,
        "input_token": 2462,
        "output_token": 586
    },
    {
        "id": "05531948-0c7c-4c04-b5b6-ed8dc6ba4d19",
        "question": "What were the Debt-to-Equity ratios of Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   |     dter |\n|:-------------|---------:|\n| TCB          |  5.16295 |\n| VCB          | 12.3717  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS dter\nFROM financial_ratio\nWHERE ratio_code = 'DTER'\nAND stock_code IN ('VCB', 'TCB')\nAND year = 2022\nAND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|     data |\n|---------:|\n|  5.16295 |\n| 12.3717  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Debt To Equity Ratio'\n  AND fr.year = 2022\n  AND fr.quarter = 0\n  AND ci.stock_code IN ('VCB', 'TCB')\nLIMIT 2;\n"
            }
        ],
        "time": 3.669118881225586,
        "evaluate": 0,
        "input_token": 10701,
        "output_token": 1221
    },
    {
        "id": "6ee96cd0-65dc-4dca-b7d0-0320dc63353c",
        "question": "What is the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| HPG          | 0.0661282 |\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN', 'HPG')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|      data |\n|----------:|\n| 0.0661282 |\n| 0.0489033 |\n| 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND ci.stock_code IN ('VNM', 'MSN', 'HPG')\nLIMIT 3;\n"
            }
        ],
        "time": 3.5997657775878906,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "9421f908-f430-45de-b536-6b9e1ebdfb1c",
        "question": "What were the total assets and total liabilities of Vietcombank, Techcombank, and ACB at the end of 2022?",
        "answer": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VCB          | BS_300          | 1.81382e+09 |\n| VCB          | BS_400          | 1.67817e+09 |\n| ACB          | BS_300          | 6.07875e+08 |\n| ACB          | BS_400          | 5.49437e+08 |\n| TCB          | BS_300          | 6.99033e+08 |\n| TCB          | BS_400          | 5.85608e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    category_code,\n    data\nFROM \n    bank_financial_report\nWHERE \n    year = 2022\n    AND quarter = 0\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND category_code IN ('BS_300', 'BS_400');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |   total_assets |   total_liabilities |\n|:-------------|---------------:|--------------------:|\n| ACB          |    6.07875e+08 |         5.49437e+08 |\n| TCB          |    6.99033e+08 |         5.85608e+08 |\n| VCB          |    1.81382e+09 |         1.67817e+09 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.stock_code,\n  SUM(CASE WHEN bfr.category_code = 'BS_300' THEN bfr.data ELSE 0 END) AS total_assets,\n  SUM(CASE WHEN bfr.category_code = 'BS_400' THEN bfr.data ELSE 0 END) AS total_liabilities\nFROM company_info AS ci\nJOIN bank_financial_report AS bfr\n  ON ci.stock_code = bfr.stock_code\nWHERE\n  ci.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND bfr.year = 2022\n  AND bfr.quarter = 0\nGROUP BY\n  ci.stock_code\nLIMIT 3;\n"
            }
        ],
        "time": 4.064009189605713,
        "evaluate": 1,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "52880a2b-08dd-4e7e-b453-7bfa90617938",
        "question": "Compare the Return on Assets (ROA) and Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.  Additionally, provide the total assets and total equity for both companies for the same period.",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | ROA          |     0.0126875 |\n| MSN          | ROE          |     0.0489033 |\n| VNM          | ROA          |     0.171232  |\n| VNM          | ROE          |     0.257506  |\n\nTable 2\n| stock_code   | en_caption     |       value |\n|:-------------|:---------------|------------:|\n| VNM          | TOTAL ASSETS   | 5.26734e+07 |\n| VNM          | Owner's equity | 3.50257e+07 |\n| MSN          | TOTAL ASSETS   | 1.47383e+08 |\n| MSN          | Owner's equity | 3.82372e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve ROA and ROE for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    fr.stock_code,\n    fr.ratio_code,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nWHERE \n    fr.stock_code IN ('VNM', 'MSN') AND\n    fr.year = 2023 AND\n    fr.quarter = 0 AND\n    fr.ratio_code IN ('ROA', 'ROE');\n\n-- Step 2: Retrieve total assets and total equity for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data AS value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN') AND\n    nfr.year = 2023 AND\n    nfr.quarter = 0 AND\n    mcc.category_code IN ('BS_270', 'BS_410'); -- BS_270: TOTAL ASSETS, BS_410: Owner's equity\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| company_name   | roa   | roe   | total_assets   | total_equity   |\n|----------------|-------|-------|----------------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.company_name,\n  fr.data AS roa,\n  fr2.data AS roe,\n  fr3.data AS total_assets,\n  fr4.data AS total_equity\nFROM company_info AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN financial_ratio AS fr2\n  ON ci.stock_code = fr2.stock_code\nJOIN financial_ratio AS fr3\n  ON ci.stock_code = fr3.stock_code\nJOIN financial_ratio AS fr4\n  ON ci.stock_code = fr4.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN map_category_code_ratio AS mcr2\n  ON fr2.ratio_code = mcr2.ratio_code\nJOIN map_category_code_ratio AS mcr3\n  ON fr3.ratio_code = mcr3.ratio_code\nJOIN map_category_code_ratio AS mcr4\n  ON fr4.ratio_code = mcr4.ratio_code\nWHERE\n  ci.stock_code IN ('VNM', 'MSN')\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND mcr.ratio_name = 'Return On Assets'\n  AND fr2.year = 2023\n  AND fr2.quarter = 0\n  AND mcr2.ratio_name = 'Return On Equity'\n  AND fr3.year = 2023\n  AND fr3.quarter = 0\n  AND mcr3.ratio_name = 'Total Assets' -- Placeholder, needs actual ratio code\n  AND fr4.year = 2023\n  AND fr4.quarter = 0\n  AND mcr4.ratio_name = 'Total Equity'; -- Placeholder, needs actual ratio code\n\n"
            }
        ],
        "time": 8.337777853012085,
        "evaluate": 0,
        "input_token": 4728,
        "output_token": 1456
    },
    {
        "id": "481ebd36-c43a-4af2-901b-99a8e6964217",
        "question": "Compare the Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| company_name                   |       roe |\n|:-------------------------------|----------:|\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan | 0.0489033 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam   | 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.company_name,\n  fr.data AS roe\nFROM company_info AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND ci.stock_code IN ('VNM', 'MSN')\n  AND fr.year = 2023\n  AND fr.quarter = 0\nLIMIT 2;\n"
            }
        ],
        "time": 3.8237624168395996,
        "evaluate": 1,
        "input_token": 5317,
        "output_token": 552
    },
    {
        "id": "61803c95-30e1-4a6f-8f02-ebde74c1120c",
        "question": "What were the operating cash flows and capital expenditures for Vietcombank, Techcombank, and VPBank in Q2 2024?  Calculate the free cash flow for each bank.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |   free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|-----------------:|\n| TCB          |   2024 |         2 |                     0 |                -280254 |           280254 |\n| VPB          |   2024 |         2 |                     0 |                  -1490 |             1490 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) AS operating_cash_flow,\n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS capital_expenditures,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) - \n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS free_cash_flow\nFROM \n    bank_financial_report bfr\nWHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'VPB') AND\n    bfr.year = 2024 AND\n    bfr.quarter = 2 AND\n    bfr.category_code IN ('CF_009', 'CF_025')\nGROUP BY \n    bfr.stock_code, bfr.year, bfr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | operating_cash_flow   | capital_expenditures   | free_cash_flow   |\n|--------------|-----------------------|------------------------|------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH OperatingCashFlow AS (\n  SELECT\n    b.stock_code,\n    b.data AS operating_cash_flow\n  FROM bank_financial_report AS b\n  JOIN map_category_code_bank AS m\n    ON b.category_code = m.category_code\n  WHERE\n    m.en_caption = 'Net cash flow from operating activities before changes in assets and working capital'\n    AND b.year = 2024\n    AND b.quarter = 2\n    AND b.stock_code IN ('VCB', 'TCB', 'VPB')\n), CapitalExpenditures AS (\n  SELECT\n    b.stock_code,\n    b.data * -1 AS capital_expenditures\n  FROM bank_financial_report AS b\n  JOIN map_category_code_bank AS m\n    ON b.category_code = m.category_code\n  WHERE\n    m.en_caption LIKE '%purchase, construction of fixed assets%'\n    AND b.year = 2024\n    AND b.quarter = 2\n    AND b.stock_code IN ('VCB', 'TCB', 'VPB')\n)\nSELECT\n  ocf.stock_code,\n  ocf.operating_cash_flow,\n  ce.capital_expenditures,\n  ocf.operating_cash_flow + ce.capital_expenditures AS free_cash_flow\nFROM OperatingCashFlow AS ocf\nJOIN CapitalExpenditures AS ce\n  ON ocf.stock_code = ce.stock_code;\n"
            }
        ],
        "time": 5.135547399520874,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "5972ee68-a39a-4051-b3d5-59aa6a533359",
        "question": "For the year 2023, what was the total revenue, net income, and total assets of  Masan Group, Vinamilk, and  PetroVietnam Gas?  Additionally, provide the percentage of total assets attributable to subsidiaries or investments for each company.",
        "answer": "Table 1\n| stock_code   |   total_revenue |   net_income |   total_assets |   percentage_investment_assets |\n|:-------------|----------------:|-------------:|---------------:|-------------------------------:|\n| GAS          |     8.99539e+07 |  1.46395e+07 |    8.77545e+07 |                        2.05086 |\n| MSN          |     7.82516e+07 |  2.56297e+06 |    1.47383e+08 |                        0       |\n| VNM          |     6.03689e+07 |  1.09679e+07 |    5.26734e+07 |                        0       |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH financial_data AS (\n    SELECT\n        nfr.stock_code,\n        SUM(CASE WHEN mcc.category_code = 'IS_010' THEN nfr.data ELSE 0 END) AS total_revenue,\n        SUM(CASE WHEN mcc.category_code = 'IS_050' THEN nfr.data ELSE 0 END) AS net_income,\n        SUM(CASE WHEN mcc.category_code = 'BS_270' THEN nfr.data ELSE 0 END) AS total_assets\n    FROM\n        non_bank_financial_report nfr\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND nfr.stock_code IN ('MSN', 'VNM', 'GAS')\n    GROUP BY\n        nfr.stock_code\n),\ninvestment_data AS (\n    SELECT\n        s.stock_code,\n        SUM(nfr.data) AS investment_assets\n    FROM\n        sub_and_shareholder s\n    JOIN\n        non_bank_financial_report nfr ON s.invest_on = nfr.stock_code\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND mcc.category_code = 'BS_270'\n    GROUP BY\n        s.stock_code\n)\nSELECT\n    fd.stock_code,\n    fd.total_revenue,\n    fd.net_income,\n    fd.total_assets,\n    COALESCE(id.investment_assets / NULLIF(fd.total_assets, 0) * 100, 0) AS percentage_investment_assets\nFROM\n    financial_data fd\nLEFT JOIN\n    investment_data id ON fd.stock_code = id.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| company_name                                |   total_revenue |   net_income |   total_assets |   subsidiary_assets_percentage |\n|:--------------------------------------------|----------------:|-------------:|---------------:|-------------------------------:|\n| T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n |               0 |            0 |    6.22178e+07 |                              0 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan              |               0 |            0 |    4.37635e+07 |                              0 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                |               0 |            0 |    3.59359e+07 |                              0 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH company_data AS (\n  SELECT\n    ci.stock_code,\n    ci.company_name,\n    SUM(CASE WHEN nbfr.category_code = 'IS_100' THEN nbfr.data ELSE 0 END) AS total_revenue,\n    SUM(CASE WHEN nbfr.category_code = 'IS_140' THEN nbfr.data ELSE 0 END) AS net_income,\n    SUM(CASE WHEN nbfr.category_code = 'BS_100' THEN nbfr.data ELSE 0 END) AS total_assets\n  FROM company_info AS ci\n  JOIN non_bank_financial_report AS nbfr\n    ON ci.stock_code = nbfr.stock_code\n  WHERE\n    ci.stock_code IN ('MSN', 'VNM', 'GAS')\n    AND nbfr.year = 2023\n    AND nbfr.quarter = 0\n  GROUP BY\n    ci.stock_code,\n    ci.company_name\n), subsidiary_data AS (\n  SELECT\n    sas.stock_code,\n    SUM(ci_sub.total_assets) AS subsidiary_assets\n  FROM sub_and_shareholder AS sas\n  JOIN company_data AS ci_sub\n    ON sas.invest_on = ci_sub.stock_code\n  GROUP BY\n    sas.stock_code\n)\nSELECT\n  cd.company_name,\n  cd.total_revenue,\n  cd.net_income,\n  cd.total_assets,\n  COALESCE((sd.subsidiary_assets / cd.total_assets) * 100, 0) AS subsidiary_assets_percentage\nFROM company_data AS cd\nLEFT JOIN subsidiary_data AS sd\n  ON cd.stock_code = sd.stock_code\nLIMIT 3;\n"
            }
        ],
        "time": 6.346100091934204,
        "evaluate": 0,
        "input_token": 3309,
        "output_token": 627
    },
    {
        "id": "74f9babe-9421-4bb7-a88f-a5c664b5a6da",
        "question": "What is the trend of the Current Ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |   current_ratio |\n|-------:|----------:|:-------------|----------------:|\n|   2020 |         0 | ACB          |         3.69815 |\n|   2021 |         0 | ACB          |         3.97544 |\n|   2022 |         0 | ACB          |         3.81624 |\n|   2023 |         0 | ACB          |         3.04283 |\n|   2024 |         1 | ACB          |         3.29123 |\n|   2020 |         0 | TCB          |         2.83619 |\n|   2021 |         0 | TCB          |         4.35343 |\n|   2022 |         0 | TCB          |         3.29776 |\n|   2023 |         0 | TCB          |         2.66367 |\n|   2024 |         1 | TCB          |         2.40445 |\n|   2024 |         2 | TCB          |         2.88946 |\n|   2020 |         0 | VCB          |         7.25011 |\n|   2021 |         0 | VCB          |         6.29498 |\n|   2022 |         0 | VCB          |         3.56816 |\n|   2023 |         0 | VCB          |         4.7828  |\n|   2024 |         1 | VCB          |         3.48899 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    fr.stock_code, \n    fr.data AS current_ratio\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    mccr.ratio_name = 'Current Ratio'\n    AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR \n         (fr.year = 2024 AND fr.quarter BETWEEN 1 AND 2))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n|   year |   quarter |   current_ratio |\n|-------:|----------:|----------------:|\n|   2020 |         0 |         2.83619 |\n|   2020 |         0 |         3.69815 |\n|   2020 |         0 |         7.25011 |\n|   2020 |         1 |         5.43727 |\n|   2020 |         1 |         2.89911 |\n|   2020 |         1 |         3.54284 |\n|   2020 |         2 |         3.46132 |\n|   2020 |         2 |         5.19794 |\n|   2020 |         2 |         3.84263 |\n|   2020 |         3 |         4.72611 |\n|   2020 |         3 |         3.1178  |\n|   2020 |         3 |         2.47947 |\n|   2020 |         4 |         3.69815 |\n|   2020 |         4 |         7.86737 |\n|   2020 |         4 |         2.83619 |\n|   2021 |         0 |         3.97544 |\n|   2021 |         0 |         4.35343 |\n|   2021 |         0 |         6.29498 |\n|   2021 |         1 |         5.86813 |\n|   2021 |         1 |         2.28142 |\n|   2021 |         1 |         3.16037 |\n|   2021 |         2 |         3.90106 |\n|   2021 |         2 |         2.61232 |\n|   2021 |         2 |         5.28517 |\n|   2021 |         3 |         5.41155 |\n|   2021 |         3 |         6.82119 |\n|   2021 |         3 |         3.03271 |\n|   2021 |         4 |         4.40216 |\n|   2021 |         4 |         3.97544 |\n|   2021 |         4 |         6.58505 |\n|   2022 |         0 |         3.29776 |\n|   2022 |         0 |         3.81624 |\n|   2022 |         0 |         3.56816 |\n|   2022 |         1 |         4.20104 |\n|   2022 |         1 |         3.25965 |\n|   2022 |         1 |         6.06806 |\n|   2022 |         2 |         6.27508 |\n|   2022 |         2 |         3.34928 |\n|   2022 |         2 |         3.53703 |\n|   2022 |         3 |         2.91339 |\n|   2022 |         3 |         3.1711  |\n|   2022 |         3 |         6.95249 |\n|   2022 |         4 |         3.29776 |\n|   2022 |         4 |         3.62631 |\n|   2022 |         4 |         3.81624 |\n|   2023 |         0 |         3.04283 |\n|   2023 |         0 |         2.66367 |\n|   2023 |         0 |         4.7828  |\n|   2023 |         1 |         3.53987 |\n|   2023 |         1 |         5.431   |\n|   2023 |         1 |         3.10937 |\n|   2023 |         2 |       nan       |\n|   2023 |         2 |         2.99619 |\n|   2023 |         2 |         5.5238  |\n|   2023 |         3 |         5.44838 |\n|   2023 |         3 |         4.18999 |\n|   2023 |         3 |         3.69457 |\n|   2023 |         4 |         3.32547 |\n|   2023 |         4 |         5.24741 |\n|   2024 |         1 |         3.48899 |\n|   2024 |         1 |         2.40445 |\n|   2024 |         1 |         3.29123 |\n|   2024 |         2 |         2.88946 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.year,\n  fr.quarter,\n  fr.data AS current_ratio\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Current Ratio'\n  AND ci.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.244677305221558,
        "evaluate": 0,
        "input_token": 6606,
        "output_token": 812
    },
    {
        "id": "b8a00999-b6af-4a1f-9e41-60a2aa7e4d01",
        "question": "Compare the Return on Equity (ROE) of Vinamilk, Masan Group, and Sabeco for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |   return_on_equity |\n|:-------------|-------------------:|\n| MSN          |          0.0489033 |\n| SAB          |          0.166962  |\n| VNM          |          0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    data AS return_on_equity\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    year = 2023 AND\n    quarter = 0 AND\n    stock_code IN ('VNM', 'MSN', 'SAB');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|      data |\n|----------:|\n| 0.0489033 |\n| 0.166962  |\n| 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.data\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\nLIMIT 3;\n"
            }
        ],
        "time": 3.6982040405273438,
        "evaluate": 0,
        "input_token": 600,
        "output_token": 243
    },
    {
        "id": "e4a9ec26-1d13-431d-854f-90f02a2024dd",
        "question": "What was the total equity of  Vietcombank's subsidiaries and associated companies as a percentage of Vietcombank's total equity at the end of Q2 2024?",
        "answer": "Table 1\n| equity_percentage   |\n|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify Vietcombank's subsidiaries and associated companies\nWITH vcb_subsidiaries AS (\n    SELECT invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VCB'\n),\n\n-- Step 2: Retrieve the total equity of these subsidiaries and associated companies\nsubsidiaries_equity AS (\n    SELECT SUM(data) AS total_subsidiaries_equity\n    FROM (\n        SELECT data\n        FROM bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n        UNION ALL\n        SELECT data\n        FROM non_bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for non-banks\n        UNION ALL\n        SELECT data\n        FROM securities_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for securities\n    ) AS equity_data\n),\n\n-- Step 3: Retrieve Vietcombank's total equity\nvcb_equity AS (\n    SELECT data AS total_vcb_equity\n    FROM bank_financial_report\n    WHERE stock_code = 'VCB'\n      AND year = 2024\n      AND quarter = 2\n      AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n)\n\n-- Step 4: Calculate the percentage\nSELECT (subsidiaries_equity.total_subsidiaries_equity / vcb_equity.total_vcb_equity) * 100 AS equity_percentage\nFROM subsidiaries_equity, vcb_equity;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| percentage   |\n|--------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH VietcombankSubsidiaries AS (\n  SELECT\n    invest_on\n  FROM sub_and_shareholder\n  WHERE\n    stock_code = 'VCB'\n), SubsidiaryEquity AS (\n  SELECT\n    COALESCE(SUM(CASE WHEN T1.is_bank THEN T2.data ELSE 0 END), 0) + COALESCE(SUM(CASE WHEN NOT T1.is_bank THEN T3.data ELSE 0 END), 0) AS total_equity\n  FROM company_info AS T1\n  INNER JOIN VietcombankSubsidiaries AS T4\n    ON T1.stock_code = T4.invest_on\n  LEFT JOIN bank_financial_report AS T2\n    ON T1.stock_code = T2.stock_code\n    AND T2.year = 2024\n    AND T2.quarter = 2\n    AND T2.category_code = 'BS_500'\n  LEFT JOIN non_bank_financial_report AS T3\n    ON T1.stock_code = T3.stock_code\n    AND T3.year = 2024\n    AND T3.quarter = 2\n    AND T3.category_code = 'BS_410'\n), VietcombankEquity AS (\n  SELECT\n    data AS vcb_equity\n  FROM bank_financial_report\n  WHERE\n    stock_code = 'VCB'\n    AND year = 2024\n    AND quarter = 2\n    AND category_code = 'BS_500'\n)\nSELECT\n  (\n    COALESCE(total_equity, 0) * 100.0 / COALESCE(vcb_equity, 1)\n  ) AS percentage\nFROM SubsidiaryEquity,\n  VietcombankEquity;\n"
            }
        ],
        "time": 6.074663400650024,
        "evaluate": 0,
        "input_token": 6235,
        "output_token": 1163
    },
    {
        "id": "e0c17ae2-f308-486c-b62b-97f32e813cff",
        "question": "How has the Debt-to-Equity ratio of Vinamilk, Masan Group, and SABECO changed from 2020 to Q2 2024?  Compare their respective Quick Ratios over the same period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_code   |     data |\n|:-------------|-------:|----------:|:-------------|---------:|\n| MSN          |   2020 |         0 | DTER         | 3.62386  |\n| MSN          |   2020 |         0 | QR           | 0.451862 |\n| MSN          |   2020 |         2 | DTER         | 2.36354  |\n| MSN          |   2020 |         2 | QR           | 0.356423 |\n| MSN          |   2021 |         0 | DTER         | 1.97835  |\n| MSN          |   2021 |         0 | QR           | 0.899436 |\n| MSN          |   2021 |         2 | DTER         | 2.83936  |\n| MSN          |   2021 |         2 | QR           | 0.572475 |\n| MSN          |   2022 |         0 | DTER         | 2.85795  |\n| MSN          |   2022 |         0 | QR           | 0.514436 |\n| MSN          |   2022 |         2 | DTER         | 2.22866  |\n| MSN          |   2022 |         2 | QR           | 0.44704  |\n| MSN          |   2023 |         0 | DTER         | 2.85445  |\n| MSN          |   2023 |         0 | QR           | 0.61315  |\n| MSN          |   2023 |         2 | DTER         | 2.75379  |\n| MSN          |   2023 |         2 | QR           | 0.563175 |\n| SAB          |   2020 |         0 | DTER         | 0.290342 |\n| SAB          |   2020 |         0 | QR           | 3.52024  |\n| SAB          |   2020 |         2 | DTER         | 0.32508  |\n| SAB          |   2020 |         2 | QR           | 3.0425   |\n| SAB          |   2021 |         0 | DTER         | 0.349295 |\n| SAB          |   2021 |         0 | QR           | 2.93441  |\n| SAB          |   2021 |         2 | DTER         | 0.288778 |\n| SAB          |   2021 |         2 | QR           | 3.55591  |\n| SAB          |   2022 |         0 | DTER         | 0.401541 |\n| SAB          |   2022 |         0 | QR           | 2.69688  |\n| SAB          |   2022 |         2 | DTER         | 0.280909 |\n| SAB          |   2022 |         2 | QR           | 3.53308  |\n| SAB          |   2023 |         0 | DTER         | 0.336332 |\n| SAB          |   2023 |         0 | QR           | 2.9677   |\n| SAB          |   2023 |         2 | DTER         | 0.318275 |\n| SAB          |   2023 |         2 | QR           | 3.13189  |\n| SAB          |   2024 |         2 | DTER         | 0.359095 |\n| SAB          |   2024 |         2 | QR           | 2.9152   |\n| VNM          |   2020 |         0 | DTER         | 0.439424 |\n| VNM          |   2020 |         0 | QR           | 1.7462   |\n| VNM          |   2020 |         2 | DTER         | 0.532862 |\n| VNM          |   2020 |         2 | QR           | 1.46628  |\n| VNM          |   2021 |         0 | DTER         | 0.487649 |\n| VNM          |   2021 |         0 | QR           | 1.72213  |\n| VNM          |   2021 |         2 | DTER         | 0.543159 |\n| VNM          |   2021 |         2 | QR           | 1.56154  |\n| VNM          |   2022 |         0 | DTER         | 0.477386 |\n| VNM          |   2022 |         0 | QR           | 1.70628  |\n| VNM          |   2022 |         2 | DTER         | 0.462287 |\n| VNM          |   2022 |         2 | QR           | 1.79426  |\n| VNM          |   2023 |         0 | DTER         | 0.503847 |\n| VNM          |   2023 |         0 | QR           | 1.74405  |\n| VNM          |   2023 |         2 | DTER         | 0.390309 |\n| VNM          |   2023 |         2 | QR           | 1.97817  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.ratio_code,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR fr.quarter = 2) -- Include annual reports and Q2 reports\n    AND mccr.ratio_code IN ('DTER', 'QR') -- Debt-to-Equity Ratio and Quick Ratio\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, fr.ratio_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | ratio_name           |   year |   quarter |     data |\n|:-------------|:---------------------|-------:|----------:|---------:|\n| MSN          | Debt To Equity Ratio |   2020 |         0 | 3.62386  |\n| MSN          | Quick Ratio          |   2020 |         0 | 0.451862 |\n| SAB          | Debt To Equity Ratio |   2020 |         0 | 0.290342 |\n| SAB          | Debt To Equity Ratio |   2024 |         2 | 0.359095 |\n| SAB          | Quick Ratio          |   2020 |         0 | 3.52024  |\n| SAB          | Quick Ratio          |   2024 |         2 | 2.9152   |\n| VNM          | Debt To Equity Ratio |   2020 |         0 | 0.439424 |\n| VNM          | Quick Ratio          |   2020 |         0 | 1.7462   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n')\n), RatioData AS (\n  SELECT\n    cc.stock_code,\n    mcr.ratio_name,\n    fr.year,\n    fr.quarter,\n    fr.data\n  FROM CompanyCodes AS cc\n  JOIN financial_ratio AS fr\n    ON cc.stock_code = fr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name IN ('Debt To Equity Ratio', 'Quick Ratio')\n    AND (\n      (\n        fr.year = 2020\n        AND fr.quarter = 0\n      )\n      OR (\n        fr.year = 2024\n        AND fr.quarter = 2\n      )\n    )\n)\nSELECT\n  stock_code,\n  ratio_name,\n  year,\n  quarter,\n  data\nFROM RatioData\nORDER BY\n  stock_code,\n  ratio_name,\n  year,\n  quarter\nLIMIT 100;\n"
            }
        ],
        "time": 5.335015535354614,
        "evaluate": 0,
        "input_token": 2434,
        "output_token": 319
    },
    {
        "id": "3bdd12bf-a669-4f11-bd82-b368cc2c608f",
        "question": "What is the trend of the current ratio and quick ratio for BIDV, Eximbank, and OCB Bank from 2020 to Q2 2024,  considering their respective subsidiaries and investments?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name    |     data |\n|:-------------|-------:|----------:|:--------------|---------:|\n| BID          |   2020 |         0 | Current Ratio | 2.57276  |\n| BID          |   2021 |         0 | Current Ratio | 3.94763  |\n| BID          |   2022 |         0 | Current Ratio | 5.04924  |\n| BID          |   2023 |         0 | Current Ratio | 2.5701   |\n| BID          |   2024 |         1 | Current Ratio | 2.94967  |\n| BID          |   2024 |         2 | Current Ratio | 3.65939  |\n| EIB          |   2020 |         0 | Current Ratio | 6.67582  |\n| EIB          |   2021 |         0 | Current Ratio | 5.72966  |\n| EIB          |   2022 |         0 | Current Ratio | 5.16642  |\n| EIB          |   2023 |         0 | Current Ratio | 6.12482  |\n| EIB          |   2024 |         1 | Current Ratio | 6.11042  |\n| HDB          |   2020 |         0 | Current Ratio | 4.83941  |\n| HDB          |   2021 |         0 | Current Ratio | 5.9133   |\n| HDB          |   2022 |         0 | Current Ratio | 4.00626  |\n| HDB          |   2023 |         0 | Current Ratio | 3.6528   |\n| HDB          |   2024 |         1 | Current Ratio | 3.1524   |\n| OCB          |   2020 |         0 | Current Ratio | 1.11545  |\n| OCB          |   2021 |         0 | Current Ratio | 4.2912   |\n| OCB          |   2022 |         0 | Current Ratio | 2.74653  |\n| OCB          |   2023 |         0 | Current Ratio | 1.68853  |\n| OCB          |   2024 |         1 | Current Ratio | 2.58278  |\n| STB          |   2020 |         0 | Current Ratio | 1.56301  |\n| STB          |   2021 |         0 | Current Ratio | 1.02262  |\n| STB          |   2022 |         0 | Current Ratio | 1.09035  |\n| STB          |   2023 |         0 | Current Ratio | 0.700152 |\n| STB          |   2024 |         1 | Current Ratio | 1.0368   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH relevant_companies AS (\n    SELECT stock_code\n    FROM company_info\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n    UNION\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n),\nratios AS (\n    SELECT ratio_code\n    FROM map_category_code_ratio\n    WHERE ratio_name IN ('Current Ratio', 'Quick Ratio')\n)\nSELECT fr.stock_code, fr.year, fr.quarter, mcr.ratio_name, fr.data\nFROM financial_ratio fr\nJOIN ratios r ON fr.ratio_code = r.ratio_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE fr.stock_code IN (SELECT stock_code FROM relevant_companies)\nAND ((fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY fr.stock_code, fr.year, fr.quarter, mcr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantCompanies AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('BID', 'EIB', 'OCB') -- Based on provided company names\n  UNION\n  SELECT invest_on\n  FROM sub_and_shareholder\n  WHERE stock_code IN ('BID', 'EIB', 'OCB')\n),\nRatioData AS (\n  SELECT\n    rc.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data\n  FROM RelevantCompanies rc\n  JOIN financial_ratio fr\n    ON rc.stock_code = fr.stock_code\n  JOIN map_category_code_ratio mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name IN ('Current Ratio', 'Quick Ratio')\n    AND fr.year >= 2020\n    AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\n)\nSELECT\n  stock_code,\n  year,\n  quarter,\n  MAX(CASE WHEN ratio_name = 'Current Ratio' THEN data END) AS current_ratio,\n  MAX(CASE WHEN ratio_name = 'Quick Ratio' THEN data END) AS quick_ratio\nFROM (\n  SELECT\n    stock_code,\n    year,\n    quarter,\n    'Current Ratio' AS ratio_name,\n    data\n  FROM RatioData\n  WHERE ratio_name = 'Current Ratio'\n  UNION ALL\n  SELECT\n    stock_code,\n    year,\n    quarter,\n    'Quick Ratio' AS ratio_name,\n    data\n  FROM RatioData\n  WHERE ratio_name = 'Quick Ratio'\n) AS AllRatios\nGROUP BY\n  stock_code,\n  year,\n  quarter\nORDER BY\n  stock_code,\n  year,\n  quarter\nLIMIT 100;\n"
            }
        ],
        "time": 6.157114744186401,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "1ef436da-be56-41ad-a474-7be82fff814b",
        "question": "Rank the top 5 companies with the highest Debt-to-Equity ratio as of December 31, 2023.",
        "answer": "Table 1\n| stock_code   | industry   |   debt_to_equity_ratio |\n|:-------------|:-----------|-----------------------:|\n| BID          | Banking    |                17.7184 |\n| CTG          | Banking    |                15.1483 |\n| STB          | Banking    |                13.746  |\n| HDB          | Banking    |                12.5012 |\n| SHB          | Banking    |                11.5853 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name   | en_company_name   | debt_to_equity_ratio   | rank   |\n|--------------|----------------|-------------------|------------------------|--------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedCompanies AS (\n  SELECT\n    fr.stock_code,\n    fr.data AS debt_to_equity_ratio,\n    ROW_NUMBER() OVER (ORDER BY\n      fr.data DESC) AS rank\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Debt-to-Equity ratio' AND fr.year = 2023 AND fr.quarter = 0\n)\nSELECT\n  ci.stock_code,\n  ci.company_name,\n  ci.en_company_name,\n  rc.debt_to_equity_ratio,\n  rc.rank\nFROM RankedCompanies AS rc\nJOIN company_info AS ci\n  ON rc.stock_code = ci.stock_code\nWHERE\n  rc.rank <= 5\nLIMIT 5;\n"
            }
        ],
        "time": 3.8150827884674072,
        "evaluate": 0,
        "input_token": 6058,
        "output_token": 1201
    },
    {
        "id": "23ea7012-1827-4ab6-b0cd-b24116d380df",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and Sacombank from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| STB          |   2020 |         0 | 0.0926219 |\n| STB          |   2021 |         0 | 0.0995728 |\n| STB          |   2022 |         0 | 0.130497  |\n| STB          |   2023 |         0 | 0.168772  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS ROE\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'STB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual data from 2020 to 2023\n        OR (year = 2024 AND quarter = 2) -- Q2 data for 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs.\nWITH relevant_companies AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE en_company_name IN ('Joint Stock Commercial Bank For Foreign Trade Of Vietnam', 'SaiGon Thuong Tin Commercial Joint Stock Bank', 'Vietnam Technological And Commercial Joint Stock Bank')\n)\n\n-- Step 2: Extract ROE trends.\nSELECT\n  rc.en_company_name,\n  fr.year,\n  fr.quarter,\n  fr.data AS roe\nFROM financial_ratio fr\nJOIN relevant_companies rc ON fr.stock_code = rc.stock_code\nJOIN company_info ci ON rc.stock_code = ci.stock_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY\n  rc.en_company_name,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.877216577529907,
        "evaluate": 0,
        "input_token": 2385,
        "output_token": 275
    },
    {
        "id": "650a1eb0-378d-4d82-b07a-acedf00aa716",
        "question": "For the year 2023, what was the combined net income of  VinGroup's subsidiaries and the net income of VinGroup itself, and what percentage of VinGroup's total net income came from its subsidiaries?",
        "answer": "Table 1\n|   total_net_income |   subsidiaries_net_income |   percentage_from_subsidiaries |\n|-------------------:|--------------------------:|-------------------------------:|\n|        4.45219e+07 |               4.94273e+07 |                        111.018 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH vin_subsidiaries AS (\n    SELECT invest_on AS subsidiary_code\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VIC'\n),\nvin_and_subsidiaries_net_income AS (\n    SELECT stock_code, SUM(data) AS net_income\n    FROM non_bank_financial_report\n    WHERE (stock_code = 'VIC' OR stock_code IN (SELECT subsidiary_code FROM vin_subsidiaries))\n      AND year = 2023\n      AND quarter = 0\n      AND category_code = 'IS_030'\n    GROUP BY stock_code\n),\ntotal_net_income AS (\n    SELECT SUM(net_income) AS total_net_income\n    FROM vin_and_subsidiaries_net_income\n),\nsubsidiaries_net_income AS (\n    SELECT SUM(net_income) AS subsidiaries_net_income\n    FROM vin_and_subsidiaries_net_income\n    WHERE stock_code IN (SELECT subsidiary_code FROM vin_subsidiaries)\n)\nSELECT \n    tni.total_net_income,\n    sni.subsidiaries_net_income,\n    (sni.subsidiaries_net_income / tni.total_net_income) * 100 AS percentage_from_subsidiaries\nFROM total_net_income tni, subsidiaries_net_income sni;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH VinGroupSubsidiaries AS (\n  SELECT\n    invest_on\n  FROM sub_and_shareholder\n  WHERE\n    stock_code = 'VIC'\n), VinGroupSubsidiaryIncome AS (\n  SELECT\n    COALESCE(SUM(CASE WHEN T1.quarter = 0 THEN T1.data ELSE NULL END), 0) AS subsidiary_income\n  FROM non_bank_financial_report AS T1\n  INNER JOIN VinGroupSubsidiaries AS T2\n    ON T1.stock_code = T2.invest_on\n  INNER JOIN company_info AS T3\n    ON T1.stock_code = T3.stock_code\n  WHERE\n    T1.year = 2023\n    AND T3.is_bank = FALSE\n    AND T3.is_securities = FALSE\n), VinGroupIncome AS (\n  SELECT\n    COALESCE(SUM(CASE WHEN T1.quarter = 0 THEN T1.data ELSE NULL END), 0) AS vingroup_income\n  FROM non_bank_financial_report AS T1\n  WHERE\n    T1.stock_code = 'VIC'\n    AND T1.year = 2023\n    AND T1.category_code = 'IS_004'\n)\nSELECT\n  vgsi.subsidiary_income,\n  vgi.vingroup_income,\n  (\n    vgsi.subsidiary_income * 100.0 / vgi.vingroup_income\n  ) AS percentage_from_subsidiaries\nFROM VinGroupSubsidiaryIncome AS vgsi\nCROSS JOIN VinGroupIncome AS vgi\nLIMIT 1;\n"
            }
        ],
        "time": 6.401228189468384,
        "evaluate": 0,
        "input_token": 2256,
        "output_token": 381
    },
    {
        "id": "48a8fa57-c0d7-4ba7-879f-5dbe2a9228cc",
        "question": "Compare the Net Profit Margin and the Debt-to-Equity ratio of Vinamilk and Masan Group from 2020 to Q2 2024.  Analyze the changes in their total assets and total liabilities during this period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_code   |   ratio_value |\n|:-------------|-------:|----------:|:-------------|--------------:|\n| MSN          |   2020 |         0 | DTER         |      3.62386  |\n| MSN          |   2021 |         0 | DTER         |      1.97835  |\n| MSN          |   2022 |         0 | DTER         |      2.85795  |\n| MSN          |   2023 |         0 | DTER         |      2.85445  |\n| VNM          |   2020 |         0 | DTER         |      0.439424 |\n| VNM          |   2021 |         0 | DTER         |      0.487649 |\n| VNM          |   2022 |         0 | DTER         |      0.477386 |\n| VNM          |   2023 |         0 | DTER         |      0.503847 |\n\nTable 2\n| stock_code   |   year |   quarter | category_code   |       value |\n|:-------------|-------:|----------:|:----------------|------------:|\n| MSN          |   2020 |         0 | BS_270          | 1.15737e+08 |\n| MSN          |   2020 |         0 | BS_300          | 9.07063e+07 |\n| MSN          |   2021 |         0 | BS_270          | 1.26093e+08 |\n| MSN          |   2021 |         0 | BS_300          | 8.37568e+07 |\n| MSN          |   2022 |         0 | BS_270          | 1.41343e+08 |\n| MSN          |   2022 |         0 | BS_300          | 1.04706e+08 |\n| MSN          |   2023 |         0 | BS_270          | 1.47383e+08 |\n| MSN          |   2023 |         0 | BS_300          | 1.09146e+08 |\n| VNM          |   2020 |         0 | BS_270          | 4.84325e+07 |\n| VNM          |   2020 |         0 | BS_300          | 1.47854e+07 |\n| VNM          |   2021 |         0 | BS_270          | 5.33324e+07 |\n| VNM          |   2021 |         0 | BS_300          | 1.74823e+07 |\n| VNM          |   2022 |         0 | BS_270          | 4.84827e+07 |\n| VNM          |   2022 |         0 | BS_300          | 1.56661e+07 |\n| VNM          |   2023 |         0 | BS_270          | 5.26734e+07 |\n| VNM          |   2023 |         0 | BS_300          | 1.76476e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    ratio_code,\n    data AS ratio_value\nFROM \n    financial_ratio\nWHERE \n    stock_code IN ('VNM', 'MSN')\n    AND ratio_code IN ('NPM', 'DTER')\n    AND ((year = 2020 AND quarter = 0) OR (year = 2021 AND quarter = 0) OR (year = 2022 AND quarter = 0) OR (year = 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter, ratio_code;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    category_code,\n    data AS value\nFROM \n    non_bank_financial_report\nWHERE \n    stock_code IN ('VNM', 'MSN')\n    AND category_code IN ('BS_270', 'BS_300') -- BS_270 for Total Assets, BS_300 for Total Liabilities\n    AND ((year = 2020 AND quarter = 0) OR (year = 2021 AND quarter = 0) OR (year = 2022 AND quarter = 0) OR (year = 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter, category_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter | net_profit_margin   |   debt_to_equity_ratio |   total_assets |   total_liabilities |\n|:-------------|-------:|----------:|:--------------------|-----------------------:|---------------:|--------------------:|\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |                3.62386 |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         0 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                     |              nan       |              0 |                   0 |\n| MSN          |   2020 |         1 |                   ",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan')\n), RatioData AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    CASE\n      WHEN mcr.ratio_name = 'Net profit margin'\n      THEN fr.data\n      ELSE NULL\n    END AS net_profit_margin,\n    CASE\n      WHEN mcr.ratio_name = 'Debt To Equity Ratio'\n      THEN fr.data\n      ELSE NULL\n    END AS debt_to_equity_ratio\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  JOIN CompanyCodes AS cc\n    ON fr.stock_code = cc.stock_code\n  WHERE\n    fr.year >= 2020 AND fr.year <= 2024 AND fr.quarter IN (0, 1, 2)\n), BalanceSheetData AS (\n  SELECT\n    nfr.stock_code,\n    nfr.year,\n    nfr.quarter,\n    SUM(\n      CASE\n        WHEN mcn.en_caption = 'Total assets'\n        THEN nfr.data\n        ELSE 0\n      END\n    ) AS total_assets,\n    SUM(\n      CASE\n        WHEN mcn.en_caption = 'Total liabilities'\n        THEN nfr.data\n        ELSE 0\n      END\n    ) AS total_liabilities\n  FROM non_bank_financial_report AS nfr\n  JOIN map_category_code_non_bank AS mcn\n    ON nfr.category_code = mcn.category_code\n  JOIN CompanyCodes AS cc\n    ON nfr.stock_code = cc.stock_code\n  WHERE\n    nfr.year >= 2020 AND nfr.year <= 2024 AND nfr.quarter IN (0, 1, 2)\n  GROUP BY\n    nfr.stock_code,\n    nfr.year,\n    nfr.quarter\n)\nSELECT\n  rd.stock_code,\n  rd.year,\n  rd.quarter,\n  rd.net_profit_margin,\n  rd.debt_to_equity_ratio,\n  bs.total_assets,\n  bs.total_liabilities\nFROM RatioData AS rd\nJOIN BalanceSheetData AS bs\n  ON rd.stock_code = bs.stock_code AND rd.year = bs.year AND rd.quarter = bs.quarter\nORDER BY\n  rd.stock_code,\n  rd.year,\n  rd.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 7.77132773399353,
        "evaluate": 0,
        "input_token": 3288,
        "output_token": 801
    },
    {
        "id": "ba73d2eb-be40-43aa-aae0-07913d6003b2",
        "question": "What are the top 10 companies with the lowest Return on Equity (ROE) for the fiscal year 2022?",
        "answer": "Table 1\n| stock_code   | industry                             |    roe_value |\n|:-------------|:-------------------------------------|-------------:|\n| VJC          | Travel and Leisure                   | -0.151828    |\n| NKG          | Basic Resources                      | -0.0234384   |\n| NVB          | Banking                              |  1.38787e-06 |\n| DBC          | Food and Beverages                   |  0.0011191   |\n| NHA          | Construction and Materials           |  0.00438288  |\n| HLD          | Real Estate                          |  0.0115416   |\n| VIC          | Real Estate                          |  0.0150701   |\n| YEG          | Media                                |  0.0274488   |\n| PVG          | Utilities (Electricity, Water & Gas) |  0.032697    |\n| PVC          | Oil and Gas                          |  0.0327001   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe_value\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2022\n    AND fr.quarter = 0\nORDER BY \n    fr.data ASC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | roe   |\n|--------------|-------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.stock_code,\n  fr.data AS roe\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'ROE' AND fr.year = 2022 AND fr.quarter = 0\nORDER BY\n  roe ASC\nLIMIT 10;\n"
            }
        ],
        "time": 3.1843621730804443,
        "evaluate": 0,
        "input_token": 3730,
        "output_token": 548
    },
    {
        "id": "4705a2ab-1bb2-400f-895d-b1eea6557de9",
        "question": "What was the average Return on Equity (ROE) for  Vietcombank,  Techcombank, and  Sacombank in 2022, and how did this compare to their respective subsidiaries' average ROE for the same year?",
        "answer": "Table 1\n| bank_code   |   bank_avg_roe |   subsidiary_avg_roe |\n|:------------|---------------:|---------------------:|\n| STB         |       0.130497 |           nan        |\n| TCB         |       0.180176 |           nan        |\n| VCB         |       0.220567 |             0.170252 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_roe AS (\n    SELECT stock_code, AVG(data) AS avg_roe\n    FROM financial_ratio\n    WHERE ratio_code = 'ROE'\n      AND stock_code IN ('VCB', 'TCB', 'STB')\n      AND year = 2022\n      AND quarter = 0\n    GROUP BY stock_code\n),\nsubsidiary_roe AS (\n    SELECT s.stock_code, AVG(fr.data) AS avg_roe\n    FROM sub_and_shareholder s\n    JOIN financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE s.stock_code IN ('VCB', 'TCB', 'STB')\n      AND fr.ratio_code = 'ROE'\n      AND fr.year = 2022\n      AND fr.quarter = 0\n    GROUP BY s.stock_code\n)\nSELECT b.stock_code AS bank_code, b.avg_roe AS bank_avg_roe, s.avg_roe AS subsidiary_avg_roe\nFROM bank_roe b\nLEFT JOIN subsidiary_roe s ON b.stock_code = s.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   parent_roe |   subsidiary_roe |\n|:-------------|-------------:|-----------------:|\n| STB          |     0.130497 |                0 |\n| TCB          |     0.180176 |                0 |\n| VCB          |     0.220567 |                0 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH ParentROE AS (\n  SELECT\n    fr.stock_code,\n    fr.data AS roe\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year = 2022\n    AND fr.quarter = 0\n    AND fr.stock_code IN ('VCB', 'TCB', 'STB')\n), SubsidiaryROE AS (\n  SELECT\n    s.invest_on AS stock_code,\n    AVG(fr.data) AS roe\n  FROM sub_and_shareholder AS s\n  JOIN financial_ratio AS fr\n    ON s.invest_on = fr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year = 2022\n    AND fr.quarter = 0\n    AND s.stock_code IN ('VCB', 'TCB', 'STB')\n  GROUP BY\n    s.invest_on\n)\nSELECT\n  p.stock_code,\n  p.roe AS parent_roe,\n  COALESCE(s.roe, 0) AS subsidiary_roe\nFROM ParentROE AS p\nLEFT JOIN SubsidiaryROE AS s\n  ON p.stock_code = s.stock_code\nLIMIT 100;\n"
            }
        ],
        "time": 5.807816028594971,
        "evaluate": 0,
        "input_token": 6177,
        "output_token": 973
    },
    {
        "id": "94513aff-57b5-4d36-8a98-bdf527d9190f",
        "question": "What is the trend of the Net Profit Margin ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_profit_margin\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'NPM'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (1, 2))\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| en_company_name   | year   | quarter   | net_profit_margin   |\n|-------------------|--------|-----------|---------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  ci.en_company_name,\n  fr.year,\n  fr.quarter,\n  fr.data AS net_profit_margin\nFROM company_info AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  ci.en_company_name IN ('Joint Stock Commercial Bank For Foreign Trade Of Vietnam', 'Asia Commercial Joint Stock Bank', 'Vietnam Technological And Commercial Joint Stock Bank')\n  AND mcr.ratio_name = 'Net profit margin'\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  ci.en_company_name,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.339111089706421,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "090710f9-3867-4922-9703-fd2af16e09e9",
        "question": "Calculate the Debt-to-Equity ratio for  Vinamilk,  Masan Group, and their significant subsidiaries in 2023 Q2.  Analyze the differences in leverage between the parent companies and their subsidiaries.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|-------:|----------:|-----------------------:|\n| MSN          |   2023 |         2 |               2.75379  |\n| VNM          |   2023 |         2 |               0.390309 |\n| TCB          |   2023 |         2 |               4.98106  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH parent_companies AS (\n    SELECT 'VNM' AS stock_code\n    UNION\n    SELECT 'MSN'\n),\nsubsidiaries AS (\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN (SELECT stock_code FROM parent_companies)\n),\nall_relevant_companies AS (\n    SELECT stock_code FROM parent_companies\n    UNION\n    SELECT stock_code FROM subsidiaries\n)\nSELECT fr.stock_code, fr.year, fr.quarter, fr.data AS debt_to_equity_ratio\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Debt To Equity Ratio'\nAND fr.stock_code IN (SELECT stock_code FROM all_relevant_companies)\nAND fr.year = 2023\nAND fr.quarter = 2;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | en_company_name                                       |   debt_to_equity_ratio |\n|:-------------|:------------------------------------------------------|-----------------------:|\n| MSN          | Masan Group Corporation                               |               2.75379  |\n| VNM          | Vietnam Dairy Products Joint Stock Company            |               0.390309 |\n| TCB          | Vietnam Technological And Commercial Joint Stock Bank |               4.98106  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify relevant company IDs\n\nWITH RelevantCompanies AS (\n    SELECT stock_code\n    FROM company_info\n    WHERE stock_code IN ('VNM', 'MSN') -- Vinamilk and Masan Group\n    UNION\n    SELECT invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('VNM', 'MSN') -- Subsidiaries of Vinamilk and Masan Group\n)\n\n-- Step 2: Retrieve Debt-to-Equity ratio for 2023 Q2\n\nSELECT \n    rc.stock_code,\n    ci.en_company_name,\n    fr.data AS debt_to_equity_ratio\nFROM RelevantCompanies rc\nJOIN company_info ci ON rc.stock_code = ci.stock_code\nJOIN financial_ratio fr ON rc.stock_code = fr.stock_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE fr.year = 2023\n  AND fr.quarter = 2\n  AND mcr.ratio_name = 'Debt To Equity Ratio'\nLIMIT 100;\n\n"
            }
        ],
        "time": 5.361052989959717,
        "evaluate": 0.5,
        "input_token": 3420,
        "output_token": 543
    },
    {
        "id": "113431fd-d8a9-4fcc-b8e4-44bb3cc73663",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) in 2023, based on their financial statements.",
        "answer": "Table 1\n| stock_code   | industry           |      roe |\n|:-------------|:-------------------|---------:|\n| TMB          | Basic Resources    | 0.476625 |\n| SLS          | Food and Beverages | 0.443074 |\n| CAP          | Basic Resources    | 0.43171  |\n| SAF          | Food and Beverages | 0.2894   |\n| DGC          | Chemicals          | 0.269533 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |      roe |   roe_rank |\n|:-------------|---------:|-----------:|\n| TMB          | 0.476625 |          1 |\n| SLS          | 0.443074 |          2 |\n| CAP          | 0.43171  |          3 |\n| SAF          | 0.2894   |          4 |\n| DGC          | 0.269533 |          5 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedROE AS (\n  SELECT\n    stock_code,\n    data AS roe,\n    RANK() OVER (\n      ORDER BY\n        data DESC\n    ) AS roe_rank\n  FROM financial_ratio\n  WHERE\n    ratio_code = 'ROE' AND year = 2023 AND quarter = 0\n)\nSELECT\n  stock_code,\n  roe,\n  roe_rank\nFROM RankedROE\nWHERE\n  roe_rank <= 5\nLIMIT 5;\n"
            }
        ],
        "time": 3.256225109100342,
        "evaluate": 1,
        "input_token": 6382,
        "output_token": 1131
    },
    {
        "id": "bb6f60b5-01dc-41a5-a518-ba2edf9f457b",
        "question": "Compare the evolution of the Debt-to-Equity ratio and the Current Ratio for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Analyze the implications of these ratios on the financial risk profile of each company.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name           |   ratio_value |\n|:-------------|-------:|----------:|:---------------------|--------------:|\n| HPG          |   2020 |         0 | Current Ratio        |      1.09453  |\n| HPG          |   2020 |         0 | Debt To Equity Ratio |      1.22073  |\n| HPG          |   2021 |         0 | Current Ratio        |      1.28577  |\n| HPG          |   2021 |         0 | Debt To Equity Ratio |      0.963375 |\n| HPG          |   2022 |         0 | Current Ratio        |      1.29573  |\n| HPG          |   2022 |         0 | Debt To Equity Ratio |      0.772243 |\n| HPG          |   2023 |         0 | Current Ratio        |      1.16128  |\n| HPG          |   2023 |         0 | Debt To Equity Ratio |      0.826032 |\n| HPG          |   2024 |         2 | Current Ratio        |      1.15441  |\n| HPG          |   2024 |         2 | Debt To Equity Ratio |      0.901137 |\n| MSN          |   2020 |         0 | Current Ratio        |      0.773354 |\n| MSN          |   2020 |         0 | Debt To Equity Ratio |      3.62386  |\n| MSN          |   2021 |         0 | Current Ratio        |      1.27032  |\n| MSN          |   2021 |         0 | Debt To Equity Ratio |      1.97835  |\n| MSN          |   2022 |         0 | Current Ratio        |      0.73558  |\n| MSN          |   2022 |         0 | Debt To Equity Ratio |      2.85795  |\n| MSN          |   2023 |         0 | Current Ratio        |      0.874439 |\n| MSN          |   2023 |         0 | Debt To Equity Ratio |      2.85445  |\n| VNM          |   2020 |         0 | Current Ratio        |      2.09132  |\n| VNM          |   2020 |         0 | Debt To Equity Ratio |      0.439424 |\n| VNM          |   2021 |         0 | Current Ratio        |      2.11895  |\n| VNM          |   2021 |         0 | Debt To Equity Ratio |      0.487649 |\n| VNM          |   2022 |         0 | Current Ratio        |      2.06801  |\n| VNM          |   2022 |         0 | Debt To Equity Ratio |      0.477386 |\n| VNM          |   2023 |         0 | Current Ratio        |      2.1016   |\n| VNM          |   2023 |         0 | Debt To Equity Ratio |      0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'HPG')\n    AND mccr.ratio_name IN ('Debt To Equity Ratio', 'Current Ratio')\n    AND (\n        (fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR\n        (fr.year = 2024 AND fr.quarter = 2)\n    )\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, mccr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | en_company_name                            |   year |   quarter |   Debt-to-Equity Ratio |   Current Ratio |\n|:-------------|:-------------------------------------------|-------:|----------:|-----------------------:|----------------:|\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         0 |               1.22073  |        1.09453  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         1 |               1.13947  |        1.15672  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         2 |               1.14232  |        1.1661   |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         3 |               1.13635  |        1.20774  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2020 |         4 |               1.22073  |        1.09658  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         0 |               0.963375 |        1.28577  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         1 |               1.09875  |        1.24475  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         2 |               1.16004  |        1.24071  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         3 |               1.07106  |        1.33701  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2021 |         4 |               0.96338  |        1.28576  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         0 |               0.772243 |        1.29573  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         1 |               0.878041 |        1.39032  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         2 |               1.07672  |        1.28758  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         3 |               0.874119 |        1.34087  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2022 |         4 |               0.772243 |        1.29573  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         0 |               0.826032 |        1.16128  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         1 |               0.818875 |        1.26262  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         2 |               0.801487 |        1.24127  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         3 |               0.737412 |        1.23076  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2023 |         4 |               0.826032 |        1.16128  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2024 |         1 |               0.911868 |        1.19092  |\n| HPG          | Hoa Phat Group Joint Stock Company         |   2024 |         2 |               0.901137 |        1.15441  |\n| MSN          | Masan Group Corporation                    |   2020 |         0 |               3.62386  |        0.773354 |\n| MSN          | Masan Group Corporation                    |   2020 |         1 |               1.03768  |        0.943772 |\n| MSN          | Masan Group Corporation                    |   2020 |         2 |               2.36354  |        0.671478 |\n| MSN          | Masan Group Corporation                    |   2020 |         3 |               2.82101  |        0.69027  |\n| MSN          | Masan Group Corporation                    |   2020 |         4 |               3.62386  |        0.773354 |\n| MSN          | Masan Group Corporation                    |   2021 |         0 |               1.97835  |        1.27032  |\n| MSN          | Masan Group Corporation                    |   2021 |         1 |               3.5765   |        0.838925 |\n| MSN          | Masan Group Corporation                    |   2021 |         2 |               2.83936  |        0.913651 |\n| MSN          | Masan Group Corporation                    |   2021 |         3 |               2.81245  |        0.935449 |\n| MSN          | Masan Group Corporation                    |   2021 |         4 |               1.97835  |        1.27032  |\n| MSN          | Masan Group Corporation                    |   2022 |         0 |               2.85795  |        0.73558  |\n| MSN          | Masan Group Corporation                    |   2022 |         1 |               2.38294  |        1.00047  |\n| MSN          | Masan Group Corporation                    |   2022 |         2 |               2.22866  |        0.709978 |\n| MSN          | Masan Group Corporation                    |   2022 |         3 |               2.60746  |        0.585935 |\n| MSN          | Masan Group Corporation                    |   2022 |         4 |               2.85795  |        0.73558  |\n| MSN          | Masan Group Corporation                    |   2023 |         0 |               2.85445  |        0.874439 |\n| MSN          | Masan Group Corporation                    |   2023 |         1 |               2.92883  |        0.851707 |\n| MSN          | Masan Group Corporation                    |   2023 |         2 |               2.75379  |        0.804937 |\n| MSN          | Masan Group Corporation                    |   2023 |         3 |               2.81036  |        0.893996 |\n| MSN          | Masan Group Corporation                    |   2023 |         4 |               2.85445  |        0.874439 |\n| MSN          | Masan Group Corporation                    |   2024 |         1 |               2.77309  |        0.87025  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         0 |               0.439424 |        2.09132  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         1 |               0.428786 |        2.00177  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         2 |               0.532862 |        1.80774  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         3 |               0.590219 |        1.73972  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2020 |         4 |               0.439424 |        2.09132  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         0 |               0.487649 |        2.11895  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         1 |               0.5031   |        1.99828  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         2 |               0.543159 |        1.93904  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         3 |               0.537059 |        1.9431   |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2021 |         4 |               0.487649 |        2.11895  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         0 |               0.477386 |        2.06801  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         1 |               0.515144 |        2.01857  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         2 |               0.462287 |        2.22061  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         3 |               0.512803 |        2.03288  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2022 |         4 |               0.477386 |        2.06801  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2023 |         0 |               0.503847 |        2.1016   |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2023 |         1 |               0.427542 |        2.25658  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2023 |         2 |               0.390309 |        2.43804  |\n| VNM          | Vietnam Dairy Products Joint Stock Co",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT\n    stock_code\n  FROM company_info\n  WHERE\n    stock_code IN ('VNM', 'MSN', 'HPG')\n)\nSELECT\n  ci.stock_code,\n  ci.en_company_name,\n  fr.year,\n  fr.quarter,\n  MAX(CASE WHEN fr.ratio_code = 'DTER' THEN fr.data ELSE NULL END) AS \"Debt-to-Equity Ratio\",\n  MAX(CASE WHEN fr.ratio_code = 'CurrentR' THEN fr.data ELSE NULL END) AS \"Current Ratio\"\nFROM CompanyCodes AS cc\nJOIN company_info AS ci\n  ON cc.stock_code = ci.stock_code\nLEFT JOIN financial_ratio AS fr\n  ON cc.stock_code = fr.stock_code\nWHERE\n  fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nGROUP BY\n  ci.stock_code,\n  ci.en_company_name,\n  fr.year,\n  fr.quarter\nORDER BY\n  ci.stock_code,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 7.371253728866577,
        "evaluate": 0.5,
        "input_token": 5537,
        "output_token": 1287
    },
    {
        "id": "1f330071-6ed3-48d3-912a-2bad5446636b",
        "question": "For Q4 2023, what was the Debt-to-Equity ratio for Mobile World Investment and Vinamilk, and how do these ratios change when considering the debt and equity of their subsidiaries and associated companies?",
        "answer": "Table 1\n| entity_type   | stock_code   | invest_on   |     dter |\n|:--------------|:-------------|:------------|---------:|\n| Parent        | MWG          |             | 1.57316  |\n| Parent        | VNM          |             | 0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify subsidiaries and associated companies for MWG and VNM\nWITH subsidiaries AS (\n    SELECT stock_code, invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('MWG', 'VNM')\n),\n\n-- Step 2: Retrieve Debt-to-Equity Ratio for MWG and VNM for Q4 2023\nparent_dter AS (\n    SELECT stock_code, data AS dter\n    FROM financial_ratio\n    WHERE ratio_code = 'DTER'\n      AND stock_code IN ('MWG', 'VNM')\n      AND year = 2023\n      AND quarter = 4\n),\n\n-- Step 3: Retrieve Debt-to-Equity Ratio for subsidiaries and associated companies for Q4 2023\nsubsidiary_dter AS (\n    SELECT s.stock_code, s.invest_on, fr.data AS dter\n    FROM subsidiaries s\n    JOIN financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE fr.ratio_code = 'DTER'\n      AND fr.year = 2023\n      AND fr.quarter = 4\n)\n\n-- Step 4: Combine the results\nSELECT 'Parent' AS entity_type, stock_code, NULL AS invest_on, dter\nFROM parent_dter\nUNION ALL\nSELECT 'Subsidiary', stock_code, invest_on, dter\nFROM subsidiary_dter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | en_company_name                            |   debt_to_equity_ratio |\n|:-------------|:-------------------------------------------|-----------------------:|\n| MWG          | Mobile World Investment Corporation        |               1.57316  |\n| VNM          | Vietnam Dairy Products Joint Stock Company |               0.503847 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve Debt-to-Equity ratio for MWG and VNM in Q4 2023.  The database schema does not \n-- provide a way to distinguish between consolidated and parent-company-only financial statements.\n-- The query below retrieves the Debt-to-Equity ratio for the specified companies and quarter.  \n--  Further analysis in Step 2 will address the limitations of not having consolidated/parent-only data distinction.\n\nSELECT \n    fr.stock_code,\n    ci.en_company_name,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nJOIN\n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    mcr.ratio_name = 'Debt To Equity Ratio'\n    AND fr.year = 2023\n    AND fr.quarter = 4\n    AND fr.stock_code IN ('MWG', 'VNM')\nLIMIT 2;\n\n\n-- Step 2: Analysis (This is not SQL, but an outline of the analysis that would follow the query above)\n\n-- The SQL query above retrieves the Debt-to-Equity ratio for MWG and VNM for Q4 2023.  \n-- To perform a complete analysis as requested,  we would need additional information:\n\n-- 1. Consolidated vs. Parent Company Data: The database lacks a mechanism to differentiate between \n--    consolidated and parent-company-only financial statements.  Therefore, the query's results \n--    represent a single Debt-to-Equity ratio for each company, without a breakdown based on \n--    consolidation scope.\n\n-- 2. Subsidiary Data: To incorporate subsidiary data, we would need to join the `financial_ratio` table \n--    with the `sub_and_shareholder` table. However, this requires the assumption that the `financial_ratio` \n--    table contains entries for both parent companies and their subsidiaries, which is not guaranteed by the \n--    provided schema.  The `financial_ratio` table might only contain data for the parent companies.\n\n-- 3. Interpretation: Once we obtain the Debt-to-Equity ratios (with or without subsidiary data, depending \n--    on data availability), we would compare the ratios for MWG and VNM.  A higher ratio indicates higher \n--    financial leverage (more debt relative to equity).  The inclusion of subsidiary data would likely \n--    affect the ratio, potentially increasing or decreasing it depending on the subsidiaries' financial \n--    health.  A significant difference between the ratios (if subsidiary data were available) would warrant \n--    further investigation into the financial positions of the subsidiaries.\n\n-- In summary, the SQL query provides a starting point.  A complete analysis requires enhancements to the \n-- database schema to explicitly track consolidated vs. parent-company data and potentially additional data \n-- within the `financial_ratio` table to represent subsidiary financial information.\n"
            }
        ],
        "time": 7.4503173828125,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "12a7a240-a91a-45cd-b870-50f2826a2e66",
        "question": "What are the top 10 companies with the lowest Debt-to-Equity ratio from 2020 to Q2 2024, calculated as Total Debt divided by Total Equity, and how did this ratio change for each company over this period?",
        "answer": "Table 1\n| stock_code   | company_name                                                  |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|:--------------------------------------------------------------|-------:|----------:|-----------------------:|\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2023 |         0 |               0.102494 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2020 |         0 |               0.125015 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2023 |         0 |               0.136624 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2020 |         0 |               0.17039  |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2023 |         0 |               0.176222 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2024 |         2 |               0.179365 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2021 |         0 |               0.188442 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2022 |         0 |               0.200008 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2024 |         2 |               0.206202 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2024 |         2 |               0.209858 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2022 |         0 |               0.216221 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2021 |         0 |               0.235643 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2022 |         0 |               0.237365 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2023 |         0 |               0.259786 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2020 |         0 |               0.276946 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2022 |         0 |               0.277531 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2021 |         0 |               0.277955 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2021 |         0 |               0.287564 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2020 |         0 |               0.290342 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2023 |         0 |               0.291759 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2023 |         0 |               0.297329 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2024 |         2 |               0.310486 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2022 |         0 |               0.33581  |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2023 |         0 |               0.336332 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2023 |         0 |               0.343894 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2023 |         0 |               0.344899 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2021 |         0 |               0.345608 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2021 |         0 |               0.349295 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2022 |         0 |               0.351281 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2022 |         0 |               0.353514 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2020 |         0 |               0.357263 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2024 |         2 |               0.359095 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2022 |         0 |               0.368554 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2024 |         2 |               0.369029 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2020 |         0 |               0.377942 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2023 |         0 |               0.394739 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2022 |         0 |               0.401541 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2022 |         0 |               0.402429 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2021 |         0 |               0.406165 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2020 |         0 |               0.408761 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2021 |         0 |               0.414164 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2023 |         0 |               0.419899 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2020 |         0 |               0.423653 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2024 |         2 |               0.435372 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2022 |         0 |               0.43865  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2020 |         0 |               0.439424 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2020 |         0 |               0.444683 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2023 |         0 |               0.457793 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2020 |         0 |               0.463731 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2022 |         0 |               0.46592  |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2023 |         0 |               0.471272 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2020 |         0 |               0.474374 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2022 |         0 |               0.477386 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2021 |         0 |               0.480607 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2024 |         2 |               0.483638 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2021 |         0 |               0.487649 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2023 |         0 |               0.503847 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2020 |         0 |               0.504436 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2023 |         0 |               0.508928 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2021 |         0 |               0.509177 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2021 |         0 |               0.521258 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2023 |         0 |               0.529397 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2021 |         0 |               0.543834 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2020 |         0 |               0.545038 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2023 |         0 |               0.554623 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2020 |         0 |               0.560901 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2022 |         0 |               0.561239 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2021 |         0 |               0.563492 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2020 |         0 |               0.569625 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2021 |         0 |               0.571747 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2024 |         2 |               0.576112 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2022 |         0 |               0.579462 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2023 |         0 |               0.581221 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2023 |         0 |               0.593005 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2023 |         0 |               0.603542 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2020 |         0 |               0.618346 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2022 |         0 |               0.632072 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2021 |         0 |               0.642793 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2023 |         0 |               0.660318 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2022 |         0 |               0.682692 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2024 |         2 |               0.687472 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2022 |         0 |               0.694971 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2021 |         0 |               0.702049 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2024 |         2 |               0.705204 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2023 |         0 |               0.705913 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2022 |         0 |               0.707956 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2020 |         0 |               0.708054 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2023 |         0 |               0.719185 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2021 |         0 |               0.722437 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2023 |         0 |               0.722593 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2022 |         0 |               0.725978 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2022 |         0 |               0.728122 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2020 |         0 |               0.728687 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2023 |         0 |               0.750505 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2021 |         0 |               0.751401 |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2021 |         0 |               0.754212 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2021 |         0 |               0.755797 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2021 |         0 |               0.766117 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2020 |         0 |               0.766169 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2022 |         0 |               0.772243 |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2023 |         0 |               0.772254 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2022 |         0 |               0.778332 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2021 |         0 |               0.779472 |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2024 |         2 |               0.78104  |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2022 |         0 |               0.788825 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2021 |         0 |               0.794179 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2021 |         0 |               0.808803 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2022 |         0 |               0.815038 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2021 |         0 |               0.816257 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2023 |         0 |               0.826032 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2022 |         0 |               0.826206 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2022 |         0 |               0.839544 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2021 |         0 |               0.845713 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2024 |         2 |               0.874097 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2022 |         0 |               0.898412 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2024 |         2 |               0.901137 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2024 |         2 |               0.93525  |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2023 |         0 |               0.936787 |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2021 |         0 |               0.941665 |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2024 |         2 |               0.949132 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2023 |         0 |               0.950352 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2021 |         0 |               0.963375 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2020 |         0 |               0.974251 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2020 |         0 |               0.975521 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2021 |         0 |               0.982156 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2021 |         0 |               0.991947 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2022 |         0 |               0.994639 |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2023 |         0 |               1.01392  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2023 |         0 |               1.02916  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2020 |         0 |               1.03173  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2022 |         0 |               1.037    |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2020 |         0 |               1.03966  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2023 |         0 |               1.04948  |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2023 |         0 |               1.06223  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2022 |         0 |               1.09689  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2022 |         0 |               1.10132  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2021 |         0 |               1.11143  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2024 |         2 |               1.12275  |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2022 |         0 |               1.13455  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2020 |         0 |               1.14525  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2022 |         0 |               1.1527   |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2020 |         0 |               1.22073  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2023 |         0 |               1.22591  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2020 |         0 |               1.2431   |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2023 |         0 |               1.25617  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2021 |         0 |               1.25925  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2024 |         2 |               1.26119  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2021 |         0 |               1.29267  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2021 |         0 |               1.31812  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2021 |         0 |               1.32573  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2022 |         0 |               1.33297  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2021 |         0 |               1.34428  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2024 |         2 |               1.35003  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2023 |         0 |               1.35495  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2023 |         0 |               1.36439  |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2024 |         2 |               1.36986  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2022 |         0 |               1.37252  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2024 |         2 |               1.39121  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2020 |         0 |               1.40109  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2020 |         0 |               1.41587  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2023 |         0 |               1.43451  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2022 |         0 |               1.43609  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2020 |         0 |               1.44044  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2023 |         0 |               1.46271  |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2021 |         0 |               1.47419  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2024 |         2 |               1.48784  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2021 |         0 |               1.50714  |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2023 |         0 |               1.51354  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2022 |         0 |               1.53038  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2020 |         0 |               1.53275  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2021 |         0 |               1.54511  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2020 |         0 |               1.5662   |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2023 |         0 |               1.5733   |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2024 |         2 |               1.60012  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2022 |         0 |               1.68066  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2021 |         0 |               1.68459  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2021 |         0 |               1.69044  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2022 |         0 |               1.69096  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2022 |         0 |               1.69426  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2024 |         2 |               1.72785  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2023 |         0 |               1.7435   |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2024 |         2 |               1.77546  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2023 |         0 |               1.78848  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2022 |         0 |               1.7954   |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2023 |         0 |               1.81978  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2021 |         0 |               1.84053  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2021 |         0 |               1.85522  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2021 |         0 |               1.89752  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2024 |         2 |               1.90154  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2020 |         0 |               1.91758  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2022 |         0 |               1.92198  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2022 |         0 |               1.95208  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2020 |         0 |               1.97325  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2021 |         0 |               1.97835  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2021 |         0 |               1.98675  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2022 |         0 |               2.00309  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2023 |         0 |               2.00446  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2020 |         0 |               2.01747  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2021 |         0 |               2.06474  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2021 |         0 |               2.09013  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2020 |         0 |               2.09671  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2020 |         0 |               2.11001  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2023 |         0 |               2.15907  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2022 |         0 |               2.20557  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2024 |         2 |               2.21151  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2020 |         0 |               2.22173  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2023 |         0 |               2.22761  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2024 |         2 |               2.26609  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2020 |         0 |               2.28019  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2021 |         0 |               2.51506  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2021 |         0 |               2.53892  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2021 |         0 |               2.71025  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2023 |         0 |               2.72341  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2020 |         0 |               2.74222  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2022 |         0 |               2.76126  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2023 |         0 |               2.85445  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2022 |         0 |               2.85795  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2020 |         0 |               2.88006  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2023 |         0 |               3.0692   |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2022 |         0 |               3.07163  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2021 |         0 |               3.09964  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2022 |         0 |               3.12368  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2022 |         0 |               3.25643  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2021 |         0 |               3.27534  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2020 |         0 |               3.39756  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2024 |         2 |               3.41035  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2024 |         2 |               3.44847  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2023 |         0 |               3.50444  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2020 |         0 |               3.52636  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2022 |         0 |               3.56676  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2020 |         0 |               3.62386  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2021 |         0 |               3.90207  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2022 |         0 |               4.03591  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2022 |         0 |               4.13522  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2020 |         0 |               4.17725  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2023 |         0 |               4.33049  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2021 |         0 |               4.3342   |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2023 |         0 |               4.66769  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2023 |         0 |               4.69525  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2023 |         0 |               4.69885  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2022 |         0 |               4.73317  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2022 |         0 |               4.75073  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2023 |         0 |               4.84831  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2020 |         0 |               4.89163  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2021 |         0 |               5.01874  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2022 |         0 |               5.09663  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2021 |         0 |               5.11264  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2022 |         0 |               5.16295  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2024 |         2 |               5.26066  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2021 |         0 |               5.34471  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2021 |         0 |               5.42305  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2023 |         0 |               5.50936  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2024 |         2 |               5.6117   |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2024 |         2 |               5.64646  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2020 |         0 |               5.67617  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2022 |         0 |               5.71337  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2020 |         0 |               5.90465  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2023 |         0 |               6.61905  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2022 |         0 |               6.67618  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2020 |         0 |               6.93709  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2024 |         2 |               7.08423  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2023 |         0 |               7.41452  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2021 |         0 |               7.46095  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2020 |         0 |               7.74824  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2023 |         0 |               7.9738   |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2022 |         0 |               8.03598  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2022 |         0 |               8.1509   |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2023 |         0 |               8.16639  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2021 |         0 |               8.32431  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2020 |         0 |               8.53865  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2021 |         0 |               8.71642  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2023 |         0 |               8.77089  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2020 |         0 |               8.87998  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2020 |         0 |               8.96134  |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2022 |         0 |               8.97033  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2023 |         0 |               9.13015  |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2022 |         0 |               9.19368  |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2021 |         0 |               9.31087  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2022 |         0 |               9.40194  |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2022 |         0 |               9.49887  |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2022 |         0 |               9.67507  |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2023 |         0 |               9.80353  |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2023 |         0 |               9.89194  |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2023 |         0 |              10.1483   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2023 |         0 |              10.2219   |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2021 |         0 |              10.2682   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2024 |         2 |              10.3055   |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2021 |         0 |              10.7541   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2024 |         2 |              10.8215   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2023 |         0 |              11.0259   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2021 |         0 |              11.1666   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2020 |         0 |              11.2966   |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2020 |         0 |              11.3214   |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2020 |         0 |              11.5403   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2023 |         0 |              11.5853   |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2021 |         0 |              11.7422   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2022 |         0 |              11.8402   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2020 |         0 |              11.918    |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2021 |         0 |              11.9647   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2020 |         0 |              12.0583   |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2022 |         0 |              12.3717   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2023 |         0 |              12.5012   |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2020 |         0 |              12.6129   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2022 |         0 |              12.6248   |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2020 |         0 |              13.0946   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2021 |         0 |              13.2578   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2023 |         0 |              13.746    |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2021 |         0 |              14.2101   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2022 |         0 |              14.3237   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2022 |         0 |              14.587    |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2020 |         0 |              14.7056   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2023 |         0 |              15.1483   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2021 |         0 |              15.3545   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2022 |         0 |              15.7188   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2020 |         0 |              16.009    |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2020 |         0 |              16.0284   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2021 |         0 |              16.212    |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2021 |         0 |              16.3027   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2024 |         2 |              17.7161   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2023 |         0 |              17.7184   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2020 |         0 |              18.0427   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2024 |         2 |              19.2545   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2022 |         0 |              19.3533   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2021 |         0 |              19.4068   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2020 |         0 |              20.0192   |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2022 |         0 |             nan        |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH RankedCompanies AS (\n    SELECT \n        fr.stock_code,\n        ci.company_name,\n        fr.year,\n        fr.quarter,\n        fr.data AS debt_to_equity_ratio,\n        ROW_NUMBER() OVER (PARTITION BY fr.stock_code ORDER BY fr.data ASC) AS rn\n    FROM \n        financial_ratio fr\n    JOIN \n        company_info ci ON fr.stock_code = ci.stock_code\n    WHERE \n        fr.ratio_code = 'DTER'\n        AND ((fr.year = 2020 AND fr.quarter = 0) OR\n             (fr.year = 2021 AND fr.quarter = 0) OR\n             (fr.year = 2022 AND fr.quarter = 0) OR\n             (fr.year = 2023 AND fr.quarter = 0) OR\n             (fr.year = 2024 AND fr.quarter = 2))\n)\nSELECT \n    rc.stock_code,\n    rc.company_name,\n    rc.year,\n    rc.quarter,\n    rc.debt_to_equity_ratio\nFROM \n    RankedCompanies rc\nWHERE \n    rc.rn <= 10\nORDER BY \n    rc.debt_to_equity_ratio ASC, rc.stock_code, rc.year, rc.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry   | year   | quarter   | debt_to_equity_ratio   |\n|--------------|------------|--------|-----------|------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedRatios AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS debt_to_equity_ratio,\n    ROW_NUMBER() OVER (PARTITION BY fr.stock_code ORDER BY fr.year, fr.quarter) AS rn\n  FROM financial_ratio AS fr\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Debt-to-Equity ratio'\n    AND fr.year >= 2020\n    AND (\n      fr.year < 2024\n      OR (\n        fr.year = 2024\n        AND fr.quarter <= 2\n      )\n    )\n  ORDER BY\n    fr.data ASC\n), Top10Companies AS (\n  SELECT\n    stock_code\n  FROM RankedRatios\n  GROUP BY\n    stock_code\n  ORDER BY\n    AVG(debt_to_equity_ratio) ASC\n  LIMIT 10\n)\nSELECT\n  ci.stock_code,\n  ci.industry,\n  rr.year,\n  rr.quarter,\n  rr.debt_to_equity_ratio\nFROM RankedRatios AS rr\nJOIN Top10Companies AS tc\n  ON rr.stock_code = tc.stock_code\nJOIN company_info AS ci\n  ON rr.stock_code = ci.stock_code\nORDER BY\n  rr.stock_code,\n  rr.year,\n  rr.quarter;\n"
            }
        ],
        "time": 5.181565284729004,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "eefe39ae-6424-47d5-ac08-482fc8f15531",
        "question": "For the top 10 companies with Net Income greater than 1,000,000,000,000 VND in 2023, what are their respective Net Profit Margins and Current Ratios?",
        "answer": "Table 1\n| stock_code   | net_profit_margin   | current_ratio   |\n|--------------|---------------------|-----------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TopCompanies AS (\n    SELECT\n        stock_code,\n        SUM(data) AS net_income\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'IS_021' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'IS_030' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'IS_400' AND year = 2023 AND quarter = 0\n    ) AS combined_reports\n    GROUP BY stock_code\n    HAVING SUM(data) > 1000000\n    ORDER BY net_income DESC\n    LIMIT 10\n)\n\nSELECT\n    tc.stock_code,\n    fr1.data AS net_profit_margin,\n    fr2.data AS current_ratio\nFROM\n    TopCompanies tc\nJOIN financial_ratio fr1 ON tc.stock_code = fr1.stock_code\n    AND fr1.ratio_code = 'NPM' AND fr1.year = 2023 AND fr1.quarter = 0\nJOIN financial_ratio fr2 ON tc.stock_code = fr2.stock_code\n    AND fr2.ratio_code = 'CurrentR' AND fr2.year = 2023 AND fr2.quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | netprofitmargin   | currentratio   |\n|--------------|-------------------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH Top10Companies AS (\n  SELECT\n    stock_code\n  FROM (\n    SELECT\n      stock_code,\n      SUM(CASE WHEN category_code = 'IS_003' THEN data ELSE 0 END) AS NetIncome\n    FROM (\n      SELECT\n        stock_code,\n        category_code,\n        data\n      FROM bank_financial_report\n      WHERE\n        year = 2023 AND quarter = 0\n      UNION ALL\n      SELECT\n        stock_code,\n        category_code,\n        data\n      FROM non_bank_financial_report\n      WHERE\n        year = 2023 AND quarter = 0\n      UNION ALL\n      SELECT\n        stock_code,\n        category_code,\n        data\n      FROM securities_financial_report\n      WHERE\n        year = 2023 AND quarter = 0\n    ) AS AllFinancialReports\n    GROUP BY\n      stock_code\n    HAVING\n      SUM(CASE WHEN category_code = 'IS_003' THEN data ELSE 0 END) > 1000000000000\n    ORDER BY\n      NetIncome DESC\n    LIMIT 10\n  ) AS TopCompanies\n)\nSELECT\n  tc.stock_code,\n  MAX(CASE WHEN fr.ratio_code = 'ratio_net_profit_margin' THEN fr.data ELSE NULL END) AS NetProfitMargin,\n  MAX(CASE WHEN fr.ratio_code = 'ratio_current_ratio' THEN fr.data ELSE NULL END) AS CurrentRatio\nFROM Top10Companies AS tc\nJOIN financial_ratio AS fr\n  ON tc.stock_code = fr.stock_code\nWHERE\n  fr.year = 2023 AND fr.quarter = 0\nGROUP BY\n  tc.stock_code;\n"
            }
        ],
        "time": 5.6220996379852295,
        "evaluate": 0,
        "input_token": 12929,
        "output_token": 2409
    },
    {
        "id": "a43c12a4-c2cc-4354-b458-0878a4f70bd0",
        "question": "Rank the top 5 companies with the highest Current Ratio as of December 31, 2023, among companies with total assets exceeding 100 billion VND.",
        "answer": "Table 1\n| stock_code   | industry           |   current_ratio |\n|:-------------|:-------------------|----------------:|\n| HLD          | Real Estate        |         7.25278 |\n| EIB          | Banking            |         6.12482 |\n| TCH          | Real Estate        |         6.00022 |\n| ABB          | Banking            |         5.488   |\n| SLS          | Food and Beverages |         4.98219 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TotalAssets AS (\n    SELECT stock_code\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n    UNION\n    SELECT stock_code\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n    UNION\n    SELECT stock_code\n    FROM securities_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n),\nCurrentRatios AS (\n    SELECT fr.stock_code, fr.data AS current_ratio\n    FROM financial_ratio fr\n    JOIN TotalAssets ta ON fr.stock_code = ta.stock_code\n    WHERE fr.ratio_code = 'CurrentR' AND fr.year = 2023 AND fr.quarter = 0\n)\nSELECT ci.stock_code, ci.industry, cr.current_ratio\nFROM CurrentRatios cr\nJOIN company_info ci ON cr.stock_code = ci.stock_code\nORDER BY cr.current_ratio DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | current_ratio   |\n|--------------|-----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- There's no information on total assets or a specific \"Current Ratio\" code in the provided schema.\n-- The following query assumes the existence of a 'Current Ratio' ratio_code in 'map_category_code_ratio' and that total assets are represented by a category code in the financial reports.  \n--  Replace 'BS_XXX' with the actual category code for total assets and 'CR' with the actual ratio code for Current Ratio.  This query also needs adjustment based on which financial report table (bank, non-bank, securities) holds the relevant asset data.\n\nWITH RelevantCompanies AS (\n    -- Assuming total assets are in one of the financial report tables.  Adjust table name as needed.\n    SELECT DISTINCT stock_code\n    FROM bank_financial_report  -- Or non_bank_financial_report or securities_financial_report\n    WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_XXX' AND data > 100000 -- 100 billion VND\n),\nCurrentRatios AS (\n    SELECT \n        rc.stock_code,\n        fr.data as current_ratio\n    FROM RelevantCompanies rc\n    JOIN financial_ratio fr ON rc.stock_code = fr.stock_code\n    WHERE fr.ratio_code = 'CR' AND fr.year = 2023 AND fr.quarter = 0\n)\nSELECT \n    stock_code, \n    current_ratio\nFROM CurrentRatios\nORDER BY current_ratio DESC\nLIMIT 5;\n\n"
            }
        ],
        "time": 4.716273784637451,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "5c4964d0-adc2-4847-9751-de6fad125d24",
        "question": "Calculate the Gross Profit Margin for Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.  Further, compute the year-on-year growth rate of the Gross Profit Margin for each company during this period.",
        "answer": "Table 1\n| stock_code   |   year |   avg_gpm |   yoy_growth_rate |\n|:-------------|-------:|----------:|------------------:|\n| MSN          |   2020 |  0.231665 |         nan       |\n| MSN          |   2021 |  0.249747 |           7.80519 |\n| MSN          |   2022 |  0.276089 |          10.5474  |\n| MSN          |   2023 |  0.282692 |           2.39156 |\n| SAB          |   2020 |  0.30403  |         nan       |\n| SAB          |   2021 |  0.28849  |          -5.11146 |\n| SAB          |   2022 |  0.307918 |           6.73451 |\n| SAB          |   2023 |  0.298455 |          -3.07321 |\n| VNM          |   2020 |  0.463956 |         nan       |\n| VNM          |   2021 |  0.431363 |          -7.02496 |\n| VNM          |   2022 |  0.398578 |          -7.60046 |\n| VNM          |   2023 |  0.406579 |           2.00742 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH GPM_data AS (\n    SELECT \n        fr.stock_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS gpm\n    FROM \n        financial_ratio fr\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Gross Profit Margin' AND\n        fr.stock_code IN ('VNM', 'MSN', 'SAB') AND\n        ((fr.year BETWEEN 2020 AND 2024) AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter <= 2)))\n),\nYearly_GPM AS (\n    SELECT \n        stock_code,\n        year,\n        AVG(gpm) AS avg_gpm\n    FROM \n        GPM_data\n    WHERE \n        quarter = 0\n    GROUP BY \n        stock_code, year\n),\nGrowth_Rate AS (\n    SELECT \n        a.stock_code,\n        a.year,\n        a.avg_gpm,\n        ((a.avg_gpm - b.avg_gpm) / NULLIF(b.avg_gpm, 0)) * 100 AS yoy_growth_rate\n    FROM \n        Yearly_GPM a\n    LEFT JOIN \n        Yearly_GPM b ON a.stock_code = b.stock_code AND a.year = b.year + 1\n)\nSELECT \n    stock_code,\n    year,\n    avg_gpm,\n    yoy_growth_rate\nFROM \n    Growth_Rate\nORDER BY \n    stock_code, year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n')\n),\nGrossProfitMargin AS (\n  SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS gross_profit_margin\n  FROM financial_ratio fr\n  JOIN CompanyCodes cc ON fr.stock_code = cc.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE mcr.ratio_name = 'Gross Profit Margin'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\n),\nYearlyGrossProfitMargin AS (\n  SELECT\n    stock_code,\n    year,\n    MAX(gross_profit_margin) AS yearly_gross_profit_margin\n  FROM GrossProfitMargin\n  WHERE quarter = 0\n  GROUP BY stock_code, year\n),\nGrowthRates AS (\n  SELECT\n    y1.stock_code,\n    y1.year,\n    (y1.yearly_gross_profit_margin - COALESCE(y2.yearly_gross_profit_margin, 0))::numeric / COALESCE(y2.yearly_gross_profit_margin, 1) * 100 AS growth_rate\n  FROM YearlyGrossProfitMargin y1\n  LEFT JOIN YearlyGrossProfitMargin y2 ON y1.stock_code = y2.stock_code AND y1.year = y2.year + 1\n)\nSELECT\n  cc.company_name,\n  ygm.year,\n  ygm.yearly_gross_profit_margin,\n  COALESCE(gr.growth_rate, 0) AS year_on_year_growth_rate\nFROM YearlyGrossProfitMargin ygm\nJOIN CompanyCodes cc ON ygm.stock_code = cc.stock_code\nLEFT JOIN GrowthRates gr ON ygm.stock_code = gr.stock_code AND ygm.year = gr.year\nORDER BY cc.company_name, ygm.year\nLIMIT 100;\n"
            }
        ],
        "time": 6.700191259384155,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "6ef05b65-adaa-4959-805b-0f7a613617fd",
        "question": "What is the trend of Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (1, 2))\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs.\nWITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('VCB', 'TCB', 'ACB')\n)\n\n-- Step 2: Extract ROE trends.\nSELECT\n  ci.stock_code,\n  ci.en_company_name,\n  fr.year,\n  fr.quarter,\n  fr.data AS roe\nFROM CompanyIDs AS ci\nJOIN financial_ratio AS fr\n  ON ci.stock_code = fr.stock_code\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY\n  ci.stock_code,\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.443062782287598,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "5f48b85d-d6f3-4010-a6f8-22f11cfaa754",
        "question": "What is the breakdown of equity investments (including both subsidiaries and other investments) for Mobile World Investment and its return on equity (ROE) for the fiscal year 2023?",
        "answer": "Table 1\n| category_code   | en_caption                                  |   data |\n|:----------------|:--------------------------------------------|-------:|\n| BS_213          | Business capital at subsidiaries            |      0 |\n| BS_251          | Investment in subsidiaries                  |      0 |\n| BS_252          | Investment in associates and joint ventures | 286632 |\n| BS_253          | Investment in other entities                |      0 |\n\nTable 2\n|       roe |\n|----------:|\n| 0.0071846 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to get the breakdown of equity investments for MWG in 2023\nSELECT \n    nbfr.category_code,\n    mccnb.en_caption,\n    nbfr.data\nFROM \n    non_bank_financial_report nbfr\nJOIN \n    map_category_code_non_bank mccnb ON nbfr.category_code = mccnb.category_code\nWHERE \n    nbfr.stock_code = 'MWG'\n    AND nbfr.year = 2023\n    AND nbfr.quarter = 0\n    AND nbfr.category_code IN ('BS_213', 'BS_251', 'BS_252', 'BS_253');\n\n-- Query to get the ROE for MWG in 2023\nSELECT \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code = 'MWG'\n    AND fr.year = 2023\n    AND fr.quarter = 0\n    AND mccr.ratio_name = 'Return On Equity';\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| invest_on   | roe   |\n|-------------|-------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH mwi_investments AS (\n  SELECT\n    invest_on\n  FROM sub_and_shareholder\n  WHERE\n    stock_code = 'MWG'\n), mwi_roe AS (\n  SELECT\n    data AS roe\n  FROM financial_ratio\n  WHERE\n    stock_code = 'MWG'\n    AND year = 2023\n    AND quarter = 0\n    AND ratio_code = 'ROE' -- Assuming ROE ratio code is 'ROE'.  Replace if different.\n)\nSELECT\n  i.invest_on,\n  r.roe\nFROM mwi_investments AS i\nCROSS JOIN mwi_roe AS r\nLIMIT 100;\n"
            }
        ],
        "time": 3.9217934608459473,
        "evaluate": 0,
        "input_token": 8385,
        "output_token": 1262
    },
    {
        "id": "6ebec9aa-2d66-4d22-a45a-a7e6114dad2b",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) \n        OR (year = 2024 AND quarter BETWEEN 1 AND 2)\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n|   year |   quarter | en_company_name                                          |         roe |\n|-------:|----------:|:---------------------------------------------------------|------------:|\n|   2020 |         0 | Asia Commercial Joint Stock Bank                         |   0.216734  |\n|   2020 |         1 | Asia Commercial Joint Stock Bank                         |   0.0522587 |\n|   2020 |         2 | Asia Commercial Joint Stock Bank                         |   0.0493524 |\n|   2020 |         3 | Asia Commercial Joint Stock Bank                         |   0.0630206 |\n|   2020 |         4 | Asia Commercial Joint Stock Bank                         |   0.0719231 |\n|   2021 |         0 | Asia Commercial Joint Stock Bank                         |   0.213865  |\n|   2021 |         1 | Asia Commercial Joint Stock Bank                         |   0.0654744 |\n|   2021 |         2 | Asia Commercial Joint Stock Bank                         |   0.0640966 |\n|   2021 |         3 | Asia Commercial Joint Stock Bank                         |   0.0494926 |\n|   2021 |         4 | Asia Commercial Joint Stock Bank                         |   0.0540857 |\n|   2022 |         0 | Asia Commercial Joint Stock Bank                         |   0.234232  |\n|   2022 |         1 | Asia Commercial Joint Stock Bank                         |   0.0682014 |\n|   2022 |         2 | Asia Commercial Joint Stock Bank                         |   0.0757336 |\n|   2022 |         3 | Asia Commercial Joint Stock Bank                         |   0.0643583 |\n|   2022 |         4 | Asia Commercial Joint Stock Bank                         |   0.0491202 |\n|   2023 |         0 | Asia Commercial Joint Stock Bank                         |   0.226122  |\n|   2023 |         1 | Asia Commercial Joint Stock Bank                         |   0.0661285 |\n|   2023 |         2 | Asia Commercial Joint Stock Bank                         | nan         |\n|   2023 |         3 | Asia Commercial Joint Stock Bank                         |   0.0604199 |\n|   2024 |         1 | Asia Commercial Joint Stock Bank                         |   0.052218  |\n|   2020 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.196318  |\n|   2020 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0491661 |\n|   2020 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0515214 |\n|   2020 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0427012 |\n|   2020 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0573927 |\n|   2021 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.201059  |\n|   2021 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0683861 |\n|   2021 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0377385 |\n|   2021 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.1084    |\n|   2021 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0580801 |\n|   2022 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.220567  |\n|   2022 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0680525 |\n|   2022 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0483124 |\n|   2022 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0472737 |\n|   2022 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0719881 |\n|   2023 |         0 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.200315  |\n|   2023 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0621596 |\n|   2023 |         2 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.139806  |\n|   2023 |         3 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.045712  |\n|   2023 |         4 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0555349 |\n|   2024 |         1 | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |   0.0494831 |\n|   2020 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.168632  |\n|   2020 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0387928 |\n|   2020 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0428449 |\n|   2020 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0450409 |\n|   2020 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0537099 |\n|   2021 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.197927  |\n|   2021 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0565945 |\n|   2021 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0572896 |\n|   2021 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0501452 |\n|   2021 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0503334 |\n|   2022 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.180176  |\n|   2022 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0569507 |\n|   2022 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0562806 |\n|   2022 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0488406 |\n|   2022 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.031493  |\n|   2023 |         0 | Vietnam Technological And Commercial Joint Stock Bank    |   0.139608  |\n|   2023 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0384612 |\n|   2023 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0367734 |\n|   2023 |         3 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0367239 |\n|   2023 |         4 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0381519 |\n|   2024 |         1 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0459854 |\n|   2024 |         2 | Vietnam Technological And Commercial Joint Stock Bank    |   0.0457096 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.year,\n  fr.quarter,\n  ci.en_company_name,\n  fr.data AS roe\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Return On Equity'\n  AND ci.en_company_name IN ('Joint Stock Commercial Bank For Foreign Trade Of Vietnam', 'Asia Commercial Joint Stock Bank', 'Vietnam Technological And Commercial Joint Stock Bank')\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  ci.en_company_name,\n  fr.year,\n  fr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 4.435594797134399,
        "evaluate": 0.5,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "0529969a-2008-4b24-bc19-022d11d2ecc6",
        "question": "What were the values of Total Assets, Total Liabilities, and Net Income for Vinamilk, Masan Group, and PetroVietnam Gas for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   | en_caption                           |        data |\n|:-------------|:-------------------------------------|------------:|\n| VNM          | Net profit from operating activities | 1.09036e+07 |\n| MSN          | Net profit from operating activities | 2.35043e+06 |\n| GAS          | Net profit from operating activities | 1.46191e+07 |\n| GAS          | TOTAL ASSETS                         | 8.77545e+07 |\n| GAS          | C. LIABILITIES                       | 2.24558e+07 |\n| VNM          | TOTAL ASSETS                         | 5.26734e+07 |\n| VNM          | C. LIABILITIES                       | 1.76476e+07 |\n| MSN          | TOTAL ASSETS                         | 1.47383e+08 |\n| MSN          | C. LIABILITIES                       | 1.09146e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN', 'GAS') \n    AND nfr.year = 2023 \n    AND nfr.quarter = 0 \n    AND nfr.category_code IN ('BS_270', 'BS_300', 'IS_030');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the relevant company IDs.\nWITH CompanyIDs AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n')\n)\n\n-- Step 2: Retrieve financial data.  This assumes that Total Assets, Total Liabilities, and Net Income exist in map_category_code_non_bank.  You'll need to replace the category codes below with the actual codes from your map_category_code_non_bank table.  The example codes are placeholders.\nSELECT\n  ci.company_name,\n  COALESCE(SUM(CASE WHEN nbfr.category_code = 'BS_100' THEN nbfr.data ELSE 0 END),0) AS Total_Assets,  -- Replace 'BS_100' with actual code for Total Assets\n  COALESCE(SUM(CASE WHEN nbfr.category_code = 'BS_200' THEN nbfr.data ELSE 0 END),0) AS Total_Liabilities, -- Replace 'BS_200' with actual code for Total Liabilities\n  COALESCE(SUM(CASE WHEN nbfr.category_code = 'IS_001' THEN nbfr.data ELSE 0 END),0) AS Net_Income       -- Replace 'IS_001' with actual code for Net Income\nFROM CompanyIDs AS ci\nJOIN company_info AS info ON ci.stock_code = info.stock_code\nLEFT JOIN non_bank_financial_report AS nbfr ON ci.stock_code = nbfr.stock_code AND nbfr.year = 2023 AND nbfr.quarter = 0\nGROUP BY ci.company_name\nLIMIT 3;\n\n"
            }
        ],
        "time": 5.864533185958862,
        "evaluate": 0,
        "input_token": 4452,
        "output_token": 825
    },
    {
        "id": "514613cf-7002-4698-a3b7-93db835122c6",
        "question": "Rank the top 5 companies with total assets greater than 100,000 billion VND as of December 31, 2023, based on their Return on Equity (ROE).",
        "answer": "Table 1\n| stock_code   | industry   |      roe |\n|:-------------|:-----------|---------:|\n| HDB          | Banking    | 0.232433 |\n| ACB          | Banking    | 0.226122 |\n| VIB          | Banking    | 0.225702 |\n| MBB          | Banking    | 0.217698 |\n| VCB          | Banking    | 0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT \n        stock_code,\n        SUM(data) AS total_assets\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n    ) AS combined_assets\n    GROUP BY stock_code\n    HAVING SUM(data) > 100000000\n)\n\nSELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    total_assets ta ON fr.stock_code = ta.stock_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE' AND fr.year = 2023 AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| VHM          | 0.183605  |\n| VIC          | 0.0138715 |\n| NVL          | 0.0107248 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- There's no direct information on total assets in the provided schema.\n-- The query below assumes a `BS_100` category code represents total assets, \n-- and a `ratio_code` of 'ROE' exists in `map_category_code_ratio` for Return on Equity.\n--  Adjust `BS_100` and 'ROE' if different category codes are used in your actual database.\n\nWITH TopCompanies AS (\n    SELECT \n        ci.stock_code\n    FROM \n        company_info ci\n    JOIN \n        (SELECT stock_code, data AS total_assets FROM bank_financial_report WHERE category_code = 'BS_100' AND year = 2023 AND quarter = 0\n        UNION ALL\n        SELECT stock_code, data AS total_assets FROM non_bank_financial_report WHERE category_code = 'BS_100' AND year = 2023 AND quarter = 0\n        UNION ALL\n        SELECT stock_code, data AS total_assets FROM securities_financial_report WHERE category_code = 'BS_100' AND year = 2023 AND quarter = 0) as assets\n        ON ci.stock_code = assets.stock_code\n    WHERE \n        total_assets > 100000000 \n)\n\nSELECT \n    tc.stock_code,\n    fr.data AS roe\nFROM \n    TopCompanies tc\nJOIN \n    financial_ratio fr ON tc.stock_code = fr.stock_code\nWHERE \n    fr.ratio_code = 'ROE' AND fr.year = 2023 AND fr.quarter = 0\nORDER BY \n    roe DESC\nLIMIT 5;\n\n"
            }
        ],
        "time": 4.924239635467529,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "c831d896-2da0-445e-8184-0699fc43e0db",
        "question": "What is the trend of Net Profit Margin for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_profit_margin\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'NPM' \n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual reports from 2020 to 2023\n        OR \n        (year = 2024 AND quarter IN (1, 2)) -- Quarterly reports for Q1 and Q2 of 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| year   | quarter   | net_profit_margin   |\n|--------|-----------|---------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.year,\n  fr.quarter,\n  fr.data AS net_profit_margin\nFROM financial_ratio AS fr\nJOIN map_category_code_ratio AS mcr\n  ON fr.ratio_code = mcr.ratio_code\nJOIN company_info AS ci\n  ON fr.stock_code = ci.stock_code\nWHERE\n  mcr.ratio_name = 'Net profit margin'\n  AND ci.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND fr.year >= 2020\n  AND (\n    fr.year < 2024\n    OR (\n      fr.year = 2024\n      AND fr.quarter <= 2\n    )\n  )\nORDER BY\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.221615791320801,
        "evaluate": 0,
        "input_token": 5871,
        "output_token": 1058
    },
    {
        "id": "a6c11447-d4dd-4ae8-99b8-57138309a422",
        "question": "Show the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Calculate the average ROE for each company over this period.",
        "answer": "Table 1\n| stock_code   |   average_roe |\n|:-------------|--------------:|\n| HPG          |     0.136672  |\n| MSN          |     0.0970669 |\n| VNM          |     0.242186  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    AVG(data) AS average_roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    stock_code IN ('VNM', 'MSN', 'HPG') AND\n    ((year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n    (year = 2024 AND quarter IN (1, 2)))\nGROUP BY \n    stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| company_name                      |   year |   quarter |         roe |   avg_roe |\n|:----------------------------------|-------:|----------:|------------:|----------:|\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         0 |  0.333928   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         1 |  0.0861112  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         2 |  0.095333   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         3 |  0.0990225  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         4 |  0.0664599  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         0 |  0.296583   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         1 |  0.0764615  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         2 |  0.0832651  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         3 |  0.0874017  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         4 |  0.0617182  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         0 |  0.26138    | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         1 |  0.06528    | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         2 |  0.057095   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         3 |  0.0686339  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         4 |  0.0569567  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         0 |  0.257506   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         1 |  0.0552366  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         2 |  0.112804   | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         3 |  0.0745011  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         4 |  0.0671136  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2024 |         1 |  0.0615314  | 0.115444  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         0 |  0.228068   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         1 |  0.0460368  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         2 |  0.0524064  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         3 |  0.0688363  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         4 |  0.0787021  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         0 |  0.380268   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         1 |  0.10579    | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         2 |  0.131719   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         3 |  0.122748   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         4 |  0.0817293  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         0 |  0.0878594  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         1 |  0.0829275  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         2 |  0.0402598  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         3 | -0.0182075  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         4 | -0.020796   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         0 |  0.0661282  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         1 |  0.00397384 | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         2 |  0.0147948  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         3 |  0.0200306  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         4 |  0.0288708  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2024 |         1 |  0.027164   | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2024 |         2 |  0.0305454  | 0.075448  |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         0 |  0.055733   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         1 | -0.00419562 | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         2 |  0.00174282 | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         3 |  0.0340108  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         4 |  0.0233474  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         0 |  0.238597   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         1 |  0.0134906  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         2 |  0.0335106  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         3 |  0.0490112  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         4 |  0.168149   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         0 |  0.129771   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         1 |  0.0515801  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         2 |  0.0313142  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         3 |  0.0236221  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         4 |  0.021933   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         0 |  0.0489033  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         1 |  0.0118431  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         2 |  0.0114376  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         3 |  0.0127258  | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         4 |  0.013515   | 0.0467796 |\n| C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2024 |         1 |  0.0123309  | 0.0467796 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompanyCodes AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE company_name IN ('C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan', 'C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t')\n),\nROEData AS (\n  SELECT\n    ci.company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS roe\n  FROM financial_ratio fr\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN CompanyCodes cc ON fr.stock_code = cc.stock_code\n  WHERE mcr.ratio_name = 'Return On Equity'\n  AND fr.year >= 2020\n  AND (fr.year < 2024 OR (fr.year = 2024 AND fr.quarter <= 2))\n)\nSELECT\n  company_name,\n  year,\n  quarter,\n  roe,\n  AVG(roe) OVER (PARTITION BY company_name) AS avg_roe\nFROM ROEData\nORDER BY company_name, year, quarter\nLIMIT 100;\n"
            }
        ],
        "time": 5.303208351135254,
        "evaluate": 0,
        "input_token": 2762,
        "output_token": 364
    },
    {
        "id": "0139ac4a-8687-4aac-a031-3b29b413d83a",
        "question": "For the period 2020-Q2 2024, which 10 companies have the highest total assets,  with the condition that total assets must be greater than 100 billion VND?",
        "answer": "Table 1\n| stock_code   |   total_assets |\n|:-------------|---------------:|\n| BID          |    3.1738e+10  |\n| CTG          |    2.57372e+10 |\n| VCB          |    2.56522e+10 |\n| TCB          |    1.1165e+10  |\n| VPB          |    9.8242e+09  |\n| VIC          |    9.36372e+09 |\n| MBB          |    9.02315e+09 |\n| STB          |    8.76012e+09 |\n| SHB          |    8.57265e+09 |\n| ACB          |    7.8037e+09  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN bank_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_300'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n\n    UNION ALL\n\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN non_bank_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_270'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n\n    UNION ALL\n\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN securities_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_270'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n)\n\nSELECT\n    t.stock_code,\n    t.total_assets\nFROM\n    total_assets t\nWHERE\n    t.total_assets > 100000\nORDER BY\n    t.total_assets DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry                             |\n|:-------------|:-------------------------------------|\n| VIC          | Real Estate                          |\n| VHM          | Real Estate                          |\n| NVL          | Real Estate                          |\n| HPG          | Basic Resources                      |\n| GAS          | Utilities (Electricity, Water & Gas) |\n| MWG          | Retail                               |\n| SSI          | Financial Services                   |\n| PLX          | Oil and Gas                          |\n| MSN          | Food and Beverages                   |\n| VGI          | Telecommunications                   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH ConsolidatedAssets AS (\n  SELECT\n    stock_code,\n    SUM(data) AS total_assets\n  FROM (\n    SELECT\n      stock_code,\n      data\n    FROM bank_financial_report\n    WHERE\n      year >= 2020\n      AND (\n        quarter = 0\n        OR quarter BETWEEN 1 AND 2\n      )\n      AND category_code = 'BS_100' -- Assuming BS_100 represents Total Assets.  Adjust if needed.\n    UNION ALL\n    SELECT\n      stock_code,\n      data\n    FROM non_bank_financial_report\n    WHERE\n      year >= 2020\n      AND (\n        quarter = 0\n        OR quarter BETWEEN 1 AND 2\n      )\n      AND category_code = 'BS_100' -- Assuming BS_100 represents Total Assets. Adjust if needed.\n    UNION ALL\n    SELECT\n      stock_code,\n      data\n    FROM securities_financial_report\n    WHERE\n      year >= 2020\n      AND (\n        quarter = 0\n        OR quarter BETWEEN 1 AND 2\n      )\n      AND category_code = 'BS_100' -- Assuming BS_100 represents Total Assets. Adjust if needed.\n  ) AS AllReports\n  GROUP BY\n    stock_code\n  HAVING\n    SUM(data) > 100000\n)\nSELECT\n  ci.stock_code,\n  ci.industry\nFROM ConsolidatedAssets\nJOIN company_info AS ci\n  ON ConsolidatedAssets.stock_code = ci.stock_code\nORDER BY\n  total_assets DESC\nLIMIT 10;\n"
            }
        ],
        "time": 5.348229169845581,
        "evaluate": 0,
        "input_token": 4636,
        "output_token": 686
    },
    {
        "id": "14f189a3-a158-450b-9b00-6970b80da60a",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) among Vietcombank, Techcombank, ACB, BIDV, and VPBank for the period from 2020 to Q2 2024.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |      roe |\n|:-------------|-------:|----------:|---------:|\n| ACB          |   2022 |         0 | 0.234232 |\n| ACB          |   2023 |         0 | 0.226122 |\n| VCB          |   2022 |         0 | 0.220567 |\n| ACB          |   2020 |         0 | 0.216734 |\n| ACB          |   2021 |         0 | 0.213865 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, year, quarter, data AS roe\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'VPB')\n  AND (\n    (year = 2024 AND quarter <= 2) OR\n    (year BETWEEN 2020 AND 2023 AND quarter = 0)\n  )\nORDER BY roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name                                                       |       roe |   year |   quarter |\n|:-------------|:----------------------------------------------------------------------|----------:|-------:|----------:|\n| BID          | Joint Stock Commercial Bank for Investment and Development of Vietnam | 0.0485079 |   2024 |         2 |\n| TCB          | Vietnam Technological And Commercial Joint Stock Bank                 | 0.0457096 |   2024 |         2 |\n| VPB          | Vietnam Prosperity Joint Stock Commercial Bank                        | 0.026311  |   2024 |         2 |\n| ACB          | Asia Commercial Joint Stock Bank                                      | 0.052218  |   2024 |         1 |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam              | 0.0494831 |   2024 |         1 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedROE AS (\n  SELECT\n    ci.stock_code,\n    ci.en_company_name,\n    fr.data AS roe,\n    fr.year,\n    fr.quarter,\n    RANK() OVER (PARTITION BY fr.year, fr.quarter ORDER BY fr.data DESC) AS rank_within_year_quarter\n  FROM company_info AS ci\n  JOIN financial_ratio AS fr\n    ON ci.stock_code = fr.stock_code\n  JOIN map_category_code_ratio AS mcr\n    ON fr.ratio_code = mcr.ratio_code\n  WHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND ci.stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'VPB')\n    AND fr.year >= 2020\n    AND (\n      fr.quarter = 0\n      OR fr.quarter IN (1, 2)\n    )\n)\nSELECT\n  stock_code,\n  en_company_name,\n  roe,\n  year,\n  quarter\nFROM RankedROE\nWHERE\n  rank_within_year_quarter <= 5\nORDER BY\n  year DESC,\n  quarter DESC,\n  rank_within_year_quarter ASC\nLIMIT 5;\n"
            }
        ],
        "time": 5.39182186126709,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    }
]