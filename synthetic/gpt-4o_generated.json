[
    {
        "id": "05531948-0c7c-4c04-b5b6-ed8dc6ba4d19",
        "question": "What were the Debt-to-Equity ratios of Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   |     dter |\n|:-------------|---------:|\n| TCB          |  5.16295 |\n| VCB          | 12.3717  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS dter\nFROM financial_ratio\nWHERE ratio_code = 'DTER'\nAND stock_code IN ('VCB', 'TCB')\nAND year = 2022\nAND quarter = 0;\n"
            }
        ]
    },
    {
        "id": "6ee96cd0-65dc-4dca-b7d0-0320dc63353c",
        "question": "What is the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |   year |       roe |\n|:-------------|-------:|----------:|\n| HPG          |   2023 | 0.0661282 |\n| MSN          |   2023 | 0.0489033 |\n| VNM          |   2023 | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT\n    fr.stock_code,\n    fr.year,\n    fr.data AS roe\nFROM\n    financial_ratio AS fr\nJOIN\n    map_category_code_ratio AS mcr ON fr.ratio_code = mcr.ratio_code\nWHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.stock_code IN ('VNM', 'MSN', 'HPG')\n    AND fr.year = 2023\n    AND fr.quarter = 0;\n"
            }
        ]
    },
    {
        "id": "9421f908-f430-45de-b536-6b9e1ebdfb1c",
        "question": "What were the total assets and total liabilities of Vietcombank, Techcombank, and ACB at the end of 2022?",
        "answer": "Table 1\n| stock_code   |   total_assets |\n|:-------------|---------------:|\n| VCB          |    1.81382e+09 |\n| ACB          |    6.07875e+08 |\n| TCB          |    6.99033e+08 |\n| VCB          |    1.67817e+09 |\n| ACB          |    5.49437e+08 |\n| TCB          |    5.85608e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT bfr.stock_code, bfr.data AS total_assets\nFROM bank_financial_report AS bfr\nJOIN map_category_code_bank AS mccb ON bfr.category_code = mccb.category_code\nWHERE bfr.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND bfr.year = 2022\n  AND bfr.quarter = 0\n  AND mccb.en_caption = 'Total assets'\nUNION ALL\nSELECT bfr.stock_code, bfr.data AS total_liabilities\nFROM bank_financial_report AS bfr\nJOIN map_category_code_bank AS mccb ON bfr.category_code = mccb.category_code\nWHERE bfr.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND bfr.year = 2022\n  AND bfr.quarter = 0\n  AND mccb.en_caption = 'Total liabilities';\n"
            }
        ]
    },
    {
        "id": "61803c95-30e1-4a6f-8f02-ebde74c1120c",
        "question": "What were the operating cash flows and capital expenditures for Vietcombank, Techcombank, and VPBank in Q2 2024?  Calculate the free cash flow for each bank.",
        "answer": "Table 1\n| stock_code   | operating_cash_flow   | capital_expenditures   | free_cash_flow   |\n|--------------|-----------------------|------------------------|------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH OperatingCashFlow AS (\r\n    SELECT\r\n        stock_code,\r\n        data AS operating_cash_flow\r\n    FROM\r\n        bank_financial_report\r\n    WHERE\r\n        stock_code IN ('VCB', 'TCB', 'VPB')\r\n        AND year = 2024\r\n        AND quarter = 2\r\n        AND category_code = 'CF_009'  -- Operating cash flow code\r\n),\r\nCapitalExpenditures AS (\r\n    SELECT\r\n        stock_code,\r\n        -data AS capital_expenditures  -- Purchase is an outflow, so negate\r\n    FROM\r\n        bank_financial_report\r\n    WHERE\r\n        stock_code IN ('VCB', 'TCB', 'VPB')\r\n        AND year = 2024\r\n        AND quarter = 2\r\n        AND category_code = 'CF_025' -- Capital expenditure code (Purchase of fixed assets)\r\n)\r\nSELECT\r\n    ocf.stock_code,\r\n    operating_cash_flow,\r\n    capital_expenditures,\r\n    (operating_cash_flow + capital_expenditures) AS free_cash_flow\r\nFROM\r\n    OperatingCashFlow ocf\r\nJOIN\r\n    CapitalExpenditures ce ON ocf.stock_code = ce.stock_code;\n"
            }
        ]
    },
    {
        "id": "52880a2b-08dd-4e7e-b453-7bfa90617938",
        "question": "Compare the Return on Assets (ROA) and Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.  Additionally, provide the total assets and total equity for both companies for the same period.",
        "answer": "Table 1\n| stock_code   |   year | ratio_name       |      data |   total_assets |   total_equity |\n|:-------------|-------:|:-----------------|----------:|---------------:|---------------:|\n| MSN          |   2023 | Return On Assets | 0.0126875 |    8.28568e+08 |    2.88202e+08 |\n| MSN          |   2023 | Return On Equity | 0.0489033 |    8.28568e+08 |    2.88202e+08 |\n| VNM          |   2023 | Return On Assets | 0.171232  |    1.68518e+08 |    1.82576e+08 |\n| VNM          |   2023 | Return On Equity | 0.257506  |    1.68518e+08 |    1.82576e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH CompanyFinancials AS (\r\n    SELECT\r\n        fr.stock_code,\r\n        fr.year,\r\n        fr.quarter,\r\n        mccr.ratio_name,\r\n        fr.data\r\n    FROM\r\n        financial_ratio AS fr\r\n    JOIN\r\n        map_category_code_ratio AS mccr ON fr.ratio_code = mccr.ratio_code\r\n    WHERE\r\n        fr.stock_code IN ('VNM', 'MSN') AND fr.year = 2023 AND fr.quarter = 0 AND mccr.ratio_name IN ('Return On Assets', 'Return On Equity')\r\n),\r\nCompanyBalanceSheet AS (\r\n  SELECT\r\n        stock_code,\r\n        year,\r\n        quarter,\r\n        SUM(CASE WHEN category_code LIKE 'BS_2%' OR category_code LIKE 'BS_3%' THEN data ELSE 0 END) AS total_assets,\r\n        SUM(CASE WHEN category_code LIKE 'BS_4%' THEN data ELSE 0 END) as total_equity\r\n    FROM\r\n        non_bank_financial_report\r\n    WHERE stock_code IN ('VNM', 'MSN') AND year = 2023 AND quarter = 0\r\n    GROUP BY stock_code, year, quarter\r\n)\r\nSELECT\r\n    cf.stock_code,\r\n    cf.year,\r\n    cf.ratio_name,\r\n    cf.data,\r\n    cbs.total_assets,\r\n    cbs.total_equity\r\nFROM\r\n    CompanyFinancials AS cf\r\nJOIN\r\n    CompanyBalanceSheet AS cbs ON cf.stock_code = cbs.stock_code AND cf.year = cbs.year\r\nORDER BY\r\n    cf.stock_code, cf.ratio_name;\n"
            }
        ]
    },
    {
        "id": "aa8089b1-5d73-452a-8574-f704b0525e52",
        "question": "What was the total revenue of Vietcombank and Techcombank in Q2 2024?",
        "answer": "Table 1\n| stock_code   |       data |\n|:-------------|-----------:|\n| TCB          | 1.5349e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data\nFROM bank_financial_report\nWHERE stock_code IN ('VCB', 'TCB')\n  AND year = 2024\n  AND quarter = 2\n  AND category_code = 'IS_001';\n"
            }
        ]
    },
    {
        "id": "481ebd36-c43a-4af2-901b-99a8e6964217",
        "question": "Compare the Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |   year |       roe |\n|:-------------|-------:|----------:|\n| MSN          |   2023 | 0.0489033 |\n| VNM          |   2023 | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT\n    fr.stock_code,\n    fr.year,\n    fr.data AS ROE\nFROM\n    financial_ratio AS fr\nJOIN\n    map_category_code_ratio AS mcr ON fr.ratio_code = mcr.ratio_code\nWHERE\n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year = 2023\n    AND fr.quarter = 0\n    AND fr.stock_code IN ('VNM', 'MSN');\n"
            }
        ]
    },
    {
        "id": "5972ee68-a39a-4051-b3d5-59aa6a533359",
        "question": "For the year 2023, what was the total revenue, net income, and total assets of  Masan Group, Vinamilk, and  PetroVietnam Gas?  Additionally, provide the percentage of total assets attributable to subsidiaries or investments for each company.",
        "answer": "Table 1\n| stock_code   |   total_revenue |   net_income |   total_assets |   subsidiary_investments |   percentage_of_assets_from_subsidiaries |\n|:-------------|----------------:|-------------:|---------------:|-------------------------:|-----------------------------------------:|\n| GAS          |     9.00141e+07 |            0 |    4.79925e+07 |              5.195e+07   |                                 108.246  |\n| MSN          |     7.8517e+07  |            0 |    2.12766e+08 |              1.87798e+07 |                                   8.8265 |\n| VNM          |     6.04789e+07 |            0 |    3.43851e+07 |              2.66669e+07 |                                  77.5537 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH CompanyFinancials AS (\r\n    SELECT\r\n        stock_code,\r\n        year,\r\n        quarter,\r\n        SUM(CASE WHEN category_code = 'IS_001' THEN data ELSE 0 END) AS total_revenue,\r\n        SUM(CASE WHEN category_code = 'IS_200' THEN data ELSE 0 END) AS net_income,\r\n        SUM(CASE WHEN category_code IN ('BS_200', 'BS_300') THEN data ELSE 0 END) AS total_assets\r\n    FROM non_bank_financial_report\r\n    WHERE\r\n        stock_code IN ('MSN', 'VNM', 'GAS') AND year = 2023 AND quarter = 0\r\n    GROUP BY stock_code, year, quarter\r\n),\r\nSubsidiaryInvestments AS (\r\n    SELECT\r\n        stock_code,\r\n        SUM(CASE WHEN category_code IN ('BS_120', 'BS_130') THEN data ELSE 0 END) AS subsidiary_investments\r\n    FROM non_bank_financial_report\r\n    WHERE\r\n        stock_code IN ('MSN', 'VNM', 'GAS') AND year = 2023 AND quarter = 0\r\n    GROUP BY stock_code\r\n)\r\nSELECT\r\n    cf.stock_code,\r\n    cf.total_revenue,\r\n    cf.net_income,\r\n    cf.total_assets,\r\n    COALESCE(si.subsidiary_investments, 0) AS subsidiary_investments,\r\n    (COALESCE(si.subsidiary_investments, 0) / cf.total_assets) * 100 AS percentage_of_assets_from_subsidiaries\r\nFROM CompanyFinancials cf\r\nLEFT JOIN SubsidiaryInvestments si ON cf.stock_code = si.stock_code;\n"
            }
        ]
    },
    {
        "id": "74f9babe-9421-4bb7-a88f-a5c664b5a6da",
        "question": "What is the trend of the Current Ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   current_ratio |\n|:-------------|-------:|----------:|----------------:|\n| ACB          |   2020 |         0 |         3.69815 |\n| ACB          |   2020 |         1 |         3.54284 |\n| ACB          |   2020 |         2 |         3.46132 |\n| ACB          |   2020 |         3 |         3.1178  |\n| ACB          |   2020 |         4 |         3.69815 |\n| ACB          |   2021 |         0 |         3.97544 |\n| ACB          |   2021 |         1 |         2.28142 |\n| ACB          |   2021 |         2 |         2.61232 |\n| ACB          |   2021 |         3 |         3.03271 |\n| ACB          |   2021 |         4 |         3.97544 |\n| ACB          |   2022 |         0 |         3.81624 |\n| ACB          |   2022 |         1 |         3.25965 |\n| ACB          |   2022 |         2 |         3.34928 |\n| ACB          |   2022 |         3 |         2.91339 |\n| ACB          |   2022 |         4 |         3.81624 |\n| ACB          |   2023 |         0 |         3.04283 |\n| ACB          |   2023 |         1 |         3.53987 |\n| ACB          |   2023 |         2 |       nan       |\n| ACB          |   2023 |         3 |         3.69457 |\n| ACB          |   2024 |         1 |         3.29123 |\n| TCB          |   2020 |         0 |         2.83619 |\n| TCB          |   2020 |         1 |         2.89911 |\n| TCB          |   2020 |         2 |         3.84263 |\n| TCB          |   2020 |         3 |         2.47947 |\n| TCB          |   2020 |         4 |         2.83619 |\n| TCB          |   2021 |         0 |         4.35343 |\n| TCB          |   2021 |         1 |         3.16037 |\n| TCB          |   2021 |         2 |         3.90106 |\n| TCB          |   2021 |         3 |         5.41155 |\n| TCB          |   2021 |         4 |         4.40216 |\n| TCB          |   2022 |         0 |         3.29776 |\n| TCB          |   2022 |         1 |         4.20104 |\n| TCB          |   2022 |         2 |         3.53703 |\n| TCB          |   2022 |         3 |         3.1711  |\n| TCB          |   2022 |         4 |         3.29776 |\n| TCB          |   2023 |         0 |         2.66367 |\n| TCB          |   2023 |         1 |         3.10937 |\n| TCB          |   2023 |         2 |         2.99619 |\n| TCB          |   2023 |         3 |         4.18999 |\n| TCB          |   2023 |         4 |         3.32547 |\n| TCB          |   2024 |         1 |         2.40445 |\n| TCB          |   2024 |         2 |         2.88946 |\n| VCB          |   2020 |         0 |         7.25011 |\n| VCB          |   2020 |         1 |         5.43727 |\n| VCB          |   2020 |         2 |         5.19794 |\n| VCB          |   2020 |         3 |         4.72611 |\n| VCB          |   2020 |         4 |         7.86737 |\n| VCB          |   2021 |         0 |         6.29498 |\n| VCB          |   2021 |         1 |         5.86813 |\n| VCB          |   2021 |         2 |         5.28517 |\n| VCB          |   2021 |         3 |         6.82119 |\n| VCB          |   2021 |         4 |         6.58505 |\n| VCB          |   2022 |         0 |         3.56816 |\n| VCB          |   2022 |         1 |         6.06806 |\n| VCB          |   2022 |         2 |         6.27508 |\n| VCB          |   2022 |         3 |         6.95249 |\n| VCB          |   2022 |         4 |         3.62631 |\n| VCB          |   2023 |         0 |         4.7828  |\n| VCB          |   2023 |         1 |         5.431   |\n| VCB          |   2023 |         2 |         5.5238  |\n| VCB          |   2023 |         3 |         5.44838 |\n| VCB          |   2023 |         4 |         5.24741 |\n| VCB          |   2024 |         1 |         3.48899 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT\n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS current_ratio\nFROM\n    financial_ratio fr\nWHERE\n    fr.ratio_code = 'CurrentR'\n    AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter != 0 OR (fr.quarter = 0 AND fr.year != 2024)) -- Include annual data except for 2024\n    AND (fr.quarter <=2 or fr.year != 2024) -- Only include data up to Q2 2024\nORDER BY\n    fr.stock_code, fr.year, fr.quarter;\n"
            }
        ]
    },
    {
        "id": "e0c17ae2-f308-486c-b62b-97f32e813cff",
        "question": "How has the Debt-to-Equity ratio of Vinamilk, Masan Group, and SABECO changed from 2020 to Q2 2024?  Compare their respective Quick Ratios over the same period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |     dter |       qr |\n|:-------------|-------:|----------:|---------:|---------:|\n| MSN          |   2020 |         0 | 3.62386  | 0.451862 |\n| MSN          |   2021 |         0 | 1.97835  | 0.899436 |\n| MSN          |   2022 |         0 | 2.85795  | 0.514436 |\n| MSN          |   2023 |         0 | 2.85445  | 0.61315  |\n| SAB          |   2020 |         0 | 0.290342 | 3.52024  |\n| SAB          |   2021 |         0 | 0.349295 | 2.93441  |\n| SAB          |   2022 |         0 | 0.401541 | 2.69688  |\n| SAB          |   2023 |         0 | 0.336332 | 2.9677   |\n| SAB          |   2024 |         2 | 0.359095 | 2.9152   |\n| VNM          |   2020 |         0 | 0.439424 | 1.7462   |\n| VNM          |   2021 |         0 | 0.487649 | 1.72213  |\n| VNM          |   2022 |         0 | 0.477386 | 1.70628  |\n| VNM          |   2023 |         0 | 0.503847 | 1.74405  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH company_ratios AS (\r\n    SELECT\r\n        fr.stock_code,\r\n        fr.year,\r\n        fr.quarter,\r\n        MAX(CASE WHEN mcr.ratio_name = 'Debt To Equity Ratio' THEN fr.data ELSE NULL END) as dter,\r\n        MAX(CASE WHEN mcr.ratio_name = 'Quick Ratio' THEN fr.data ELSE NULL END) as qr\r\n    FROM\r\n        financial_ratio fr\r\n    JOIN\r\n        map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\r\n    WHERE\r\n        fr.stock_code IN ('VNM', 'MSN', 'SAB')\r\n        AND fr.year BETWEEN 2020 AND 2024\r\n        AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\r\n    GROUP BY\r\n        fr.stock_code, fr.year, fr.quarter\r\n)\r\nSELECT\r\n    cr.stock_code,\r\n    cr.year,\r\n    cr.quarter,\r\n    cr.dter,\r\n    cr.qr\r\nFROM\r\n    company_ratios cr\r\nORDER BY\r\n    cr.stock_code, cr.year, cr.quarter;\n"
            }
        ]
    }
]