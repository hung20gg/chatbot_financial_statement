[
    {
        "id": "05531948-0c7c-4c04-b5b6-ed8dc6ba4d19",
        "question": "What were the Debt-to-Equity ratios of Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   |     dter |\n|:-------------|---------:|\n| TCB          |  5.16295 |\n| VCB          | 12.3717  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS dter\nFROM financial_ratio\nWHERE ratio_code = 'DTER'\nAND stock_code IN ('VCB', 'TCB')\nAND year = 2022\nAND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   |\n|:-------------|\n| VCB          |\n| TCB          |\n\nTable 2\n|     data |\n|---------:|\n|  5.16295 |\n| 12.3717  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT fr.data\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Debt To Equity Ratio'\n  AND fr.stock_code IN ('VCB', 'TCB')\n  AND fr.year = 2022\n  AND fr.quarter = 0;\n"
            }
        ],
        "time": 6.096292018890381,
        "evaluate": 0,
        "input_token": 24647,
        "output_token": 1618
    },
    {
        "id": "6ee96cd0-65dc-4dca-b7d0-0320dc63353c",
        "question": "What is the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| HPG          | 0.0661282 |\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN', 'HPG')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   |\n|:-------------|\n| VNM          |\n| HPG          |\n| MSN          |\n\nTable 2\n|      data |\n|----------:|\n| 0.0661282 |\n| 0.0489033 |\n| 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT fr.data\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Return On Equity'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND fr.stock_code IN ('VNM', 'HPG', 'MSN');\n"
            }
        ],
        "time": 6.527326822280884,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "9421f908-f430-45de-b536-6b9e1ebdfb1c",
        "question": "What were the total assets and total liabilities of Vietcombank, Techcombank, and ACB at the end of 2022?",
        "answer": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VCB          | BS_300          | 1.81382e+09 |\n| VCB          | BS_400          | 1.67817e+09 |\n| ACB          | BS_300          | 6.07875e+08 |\n| ACB          | BS_400          | 5.49437e+08 |\n| TCB          | BS_300          | 6.99033e+08 |\n| TCB          | BS_400          | 5.85608e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    category_code,\n    data\nFROM \n    bank_financial_report\nWHERE \n    year = 2022\n    AND quarter = 0\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND category_code IN ('BS_300', 'BS_400');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |\n|:-------------|\n| VCB          |\n| ACB          |\n| TCB          |\n\nTable 2\n| stock_code   |   total_assets |   total_liabilities |\n|:-------------|---------------:|--------------------:|\n| ACB          |    6.07875e+08 |         5.49437e+08 |\n| TCB          |    6.99033e+08 |         5.85608e+08 |\n| VCB          |    1.81382e+09 |         1.67817e+09 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  b.stock_code,\n  SUM(CASE WHEN b.category_code = 'BS_300' THEN b.data ELSE 0 END) as total_assets,\n  SUM(CASE WHEN b.category_code = 'BS_400' THEN b.data ELSE 0 END) as total_liabilities\nFROM bank_financial_report b\nJOIN (SELECT stock_code FROM company_info WHERE stock_code IN ('VCB', 'TCB', 'ACB')) as c ON b.stock_code = c.stock_code\nWHERE b.year = 2022 AND b.quarter = 0\nGROUP BY b.stock_code;\n"
            }
        ],
        "time": 6.453535079956055,
        "evaluate": 1,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "52880a2b-08dd-4e7e-b453-7bfa90617938",
        "question": "Compare the Return on Assets (ROA) and Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.  Additionally, provide the total assets and total equity for both companies for the same period.",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | ROA          |     0.0126875 |\n| MSN          | ROE          |     0.0489033 |\n| VNM          | ROA          |     0.171232  |\n| VNM          | ROE          |     0.257506  |\n\nTable 2\n| stock_code   | en_caption     |       value |\n|:-------------|:---------------|------------:|\n| VNM          | TOTAL ASSETS   | 5.26734e+07 |\n| VNM          | Owner's equity | 3.50257e+07 |\n| MSN          | TOTAL ASSETS   | 1.47383e+08 |\n| MSN          | Owner's equity | 3.82372e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve ROA and ROE for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    fr.stock_code,\n    fr.ratio_code,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nWHERE \n    fr.stock_code IN ('VNM', 'MSN') AND\n    fr.year = 2023 AND\n    fr.quarter = 0 AND\n    fr.ratio_code IN ('ROA', 'ROE');\n\n-- Step 2: Retrieve total assets and total equity for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data AS value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN') AND\n    nfr.year = 2023 AND\n    nfr.quarter = 0 AND\n    mcc.category_code IN ('BS_270', 'BS_410'); -- BS_270: TOTAL ASSETS, BS_410: Owner's equity\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |\n|:-------------|\n| VNM          |\n| MSN          |\n\nTable 2\n| en_company_name                            |       roa |\n|:-------------------------------------------|----------:|\n| Masan Group Corporation                    | 0.0126875 |\n| Vietnam Dairy Products Joint Stock Company | 0.171232  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n    ci.en_company_name,\n    fr.data AS ROA\nFROM\n    company_info ci\nJOIN\n    financial_ratio fr ON ci.stock_code = fr.stock_code\nJOIN\n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE\n    ci.stock_code IN ('VNM', 'MSN')\n    AND fr.year = 2023\n    AND fr.quarter = 0\n    AND mcr.ratio_name = 'Return On Assets';\n"
            }
        ],
        "time": 6.369823455810547,
        "evaluate": 0,
        "input_token": 1764,
        "output_token": 416
    },
    {
        "id": "481ebd36-c43a-4af2-901b-99a8e6964217",
        "question": "Compare the Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   |\n|:-------------|\n| VNM          |\n| MSN          |\n\nTable 2\n|      data |\n|----------:|\n| 0.0489033 |\n| 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT fr.data\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Return On Equity'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND fr.stock_code IN ('VNM', 'MSN');\n"
            }
        ],
        "time": 4.146054744720459,
        "evaluate": 0,
        "input_token": 11319,
        "output_token": 939
    },
    {
        "id": "61803c95-30e1-4a6f-8f02-ebde74c1120c",
        "question": "What were the operating cash flows and capital expenditures for Vietcombank, Techcombank, and VPBank in Q2 2024?  Calculate the free cash flow for each bank.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |   free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|-----------------:|\n| TCB          |   2024 |         2 |                     0 |                -280254 |           280254 |\n| VPB          |   2024 |         2 |                     0 |                  -1490 |             1490 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) AS operating_cash_flow,\n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS capital_expenditures,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) - \n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS free_cash_flow\nFROM \n    bank_financial_report bfr\nWHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'VPB') AND\n    bfr.year = 2024 AND\n    bfr.quarter = 2 AND\n    bfr.category_code IN ('CF_009', 'CF_025')\nGROUP BY \n    bfr.stock_code, bfr.year, bfr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name   | operating_cash_flow   | capital_expenditures   |\n|--------------|-------------------|-----------------------|------------------------|\n\nTable 2\n| stock_code   | en_company_name   | operating_cash_flow   | capital_expenditures   | free_cash_flow   |\n|--------------|-------------------|-----------------------|------------------------|------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH step1_results AS (\n  -- Paste the corrected SQL query from Step 1 here.  It should return stock_code, operating_cash_flow, capital_expenditures\n  SELECT\n    ci.stock_code,\n    ci.en_company_name,\n    b.data AS operating_cash_flow,\n    c.data AS capital_expenditures\n  FROM company_info AS ci\n  JOIN bank_financial_report AS b\n    ON ci.stock_code = b.stock_code\n  JOIN map_category_code_bank AS mcb\n    ON b.category_code = mcb.category_code\n  LEFT JOIN bank_financial_report AS c\n    ON ci.stock_code = c.stock_code\n    AND c.year = b.year\n    AND c.quarter = b.quarter\n    AND c.category_code = 'CF_021' -- Needs verification against the data dictionary\n  WHERE\n    ci.stock_code IN ('VCB', 'TCB', 'VPB')\n    AND b.year = 2024\n    AND b.quarter = 2\n    AND mcb.en_caption = 'Net cash flow from operating activities' -- Needs verification against the data dictionary\n)\nSELECT\n  stock_code,\n  en_company_name,\n  operating_cash_flow,\n  capital_expenditures,\n  operating_cash_flow - capital_expenditures AS free_cash_flow\nFROM step1_results;\n"
            }
        ],
        "time": 9.562866687774658,
        "evaluate": 0,
        "input_token": 6487,
        "output_token": 855
    },
    {
        "id": "74f9babe-9421-4bb7-a88f-a5c664b5a6da",
        "question": "What is the trend of the Current Ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |   current_ratio |\n|-------:|----------:|:-------------|----------------:|\n|   2020 |         0 | ACB          |         3.69815 |\n|   2021 |         0 | ACB          |         3.97544 |\n|   2022 |         0 | ACB          |         3.81624 |\n|   2023 |         0 | ACB          |         3.04283 |\n|   2024 |         1 | ACB          |         3.29123 |\n|   2020 |         0 | TCB          |         2.83619 |\n|   2021 |         0 | TCB          |         4.35343 |\n|   2022 |         0 | TCB          |         3.29776 |\n|   2023 |         0 | TCB          |         2.66367 |\n|   2024 |         1 | TCB          |         2.40445 |\n|   2024 |         2 | TCB          |         2.88946 |\n|   2020 |         0 | VCB          |         7.25011 |\n|   2021 |         0 | VCB          |         6.29498 |\n|   2022 |         0 | VCB          |         3.56816 |\n|   2023 |         0 | VCB          |         4.7828  |\n|   2024 |         1 | VCB          |         3.48899 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    fr.stock_code, \n    fr.data AS current_ratio\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    mccr.ratio_name = 'Current Ratio'\n    AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR \n         (fr.year = 2024 AND fr.quarter BETWEEN 1 AND 2))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |\n|:-------------|\n| VCB          |\n| ACB          |\n| TCB          |\n\nTable 2\n| stock_code   |   year |   quarter |   current_ratio |\n|:-------------|-------:|----------:|----------------:|\n| ACB          |   2020 |         0 |         3.69815 |\n| ACB          |   2020 |         1 |         3.54284 |\n| ACB          |   2020 |         2 |         3.46132 |\n| ACB          |   2021 |         0 |         3.97544 |\n| ACB          |   2021 |         1 |         2.28142 |\n| ACB          |   2021 |         2 |         2.61232 |\n| ACB          |   2022 |         0 |         3.81624 |\n| ACB          |   2022 |         1 |         3.25965 |\n| ACB          |   2022 |         2 |         3.34928 |\n| ACB          |   2023 |         0 |         3.04283 |\n| ACB          |   2023 |         1 |         3.53987 |\n| ACB          |   2023 |         2 |       nan       |\n| ACB          |   2024 |         1 |         3.29123 |\n| TCB          |   2020 |         0 |         2.83619 |\n| TCB          |   2020 |         1 |         2.89911 |\n| TCB          |   2020 |         2 |         3.84263 |\n| TCB          |   2021 |         0 |         4.35343 |\n| TCB          |   2021 |         1 |         3.16037 |\n| TCB          |   2021 |         2 |         3.90106 |\n| TCB          |   2022 |         0 |         3.29776 |\n| TCB          |   2022 |         1 |         4.20104 |\n| TCB          |   2022 |         2 |         3.53703 |\n| TCB          |   2023 |         0 |         2.66367 |\n| TCB          |   2023 |         1 |         3.10937 |\n| TCB          |   2023 |         2 |         2.99619 |\n| TCB          |   2024 |         1 |         2.40445 |\n| TCB          |   2024 |         2 |         2.88946 |\n| VCB          |   2020 |         0 |         7.25011 |\n| VCB          |   2020 |         1 |         5.43727 |\n| VCB          |   2020 |         2 |         5.19794 |\n| VCB          |   2021 |         0 |         6.29498 |\n| VCB          |   2021 |         1 |         5.86813 |\n| VCB          |   2021 |         2 |         5.28517 |\n| VCB          |   2022 |         0 |         3.56816 |\n| VCB          |   2022 |         1 |         6.06806 |\n| VCB          |   2022 |         2 |         6.27508 |\n| VCB          |   2023 |         0 |         4.7828  |\n| VCB          |   2023 |         1 |         5.431   |\n| VCB          |   2023 |         2 |         5.5238  |\n| VCB          |   2024 |         1 |         3.48899 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT\n  fr.stock_code,\n  fr.year,\n  fr.quarter,\n  fr.data AS current_ratio\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr\n  ON fr.ratio_code = mcr.ratio_code\nWHERE\n  mcr.ratio_name = 'Current Ratio'\n  AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND fr.year >= 2020\n  AND fr.year <= 2024\n  AND (fr.quarter = 0 OR fr.quarter <=2)\nORDER BY\n  fr.stock_code,\n  fr.year,\n  fr.quarter;\n"
            }
        ],
        "time": 4.946772336959839,
        "evaluate": 0.5,
        "input_token": 7245,
        "output_token": 1013
    },
    {
        "id": "5972ee68-a39a-4051-b3d5-59aa6a533359",
        "question": "For the year 2023, what was the total revenue, net income, and total assets of  Masan Group, Vinamilk, and  PetroVietnam Gas?  Additionally, provide the percentage of total assets attributable to subsidiaries or investments for each company.",
        "answer": "Table 1\n| stock_code   |   total_revenue |   net_income |   total_assets |   percentage_investment_assets |\n|:-------------|----------------:|-------------:|---------------:|-------------------------------:|\n| GAS          |     8.99539e+07 |  1.46395e+07 |    8.77545e+07 |                        2.05086 |\n| MSN          |     7.82516e+07 |  2.56297e+06 |    1.47383e+08 |                        0       |\n| VNM          |     6.03689e+07 |  1.09679e+07 |    5.26734e+07 |                        0       |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH financial_data AS (\n    SELECT\n        nfr.stock_code,\n        SUM(CASE WHEN mcc.category_code = 'IS_010' THEN nfr.data ELSE 0 END) AS total_revenue,\n        SUM(CASE WHEN mcc.category_code = 'IS_050' THEN nfr.data ELSE 0 END) AS net_income,\n        SUM(CASE WHEN mcc.category_code = 'BS_270' THEN nfr.data ELSE 0 END) AS total_assets\n    FROM\n        non_bank_financial_report nfr\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND nfr.stock_code IN ('MSN', 'VNM', 'GAS')\n    GROUP BY\n        nfr.stock_code\n),\ninvestment_data AS (\n    SELECT\n        s.stock_code,\n        SUM(nfr.data) AS investment_assets\n    FROM\n        sub_and_shareholder s\n    JOIN\n        non_bank_financial_report nfr ON s.invest_on = nfr.stock_code\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND mcc.category_code = 'BS_270'\n    GROUP BY\n        s.stock_code\n)\nSELECT\n    fd.stock_code,\n    fd.total_revenue,\n    fd.net_income,\n    fd.total_assets,\n    COALESCE(id.investment_assets / NULLIF(fd.total_assets, 0) * 100, 0) AS percentage_investment_assets\nFROM\n    financial_data fd\nLEFT JOIN\n    investment_data id ON fd.stock_code = id.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | company_name                                |   total_revenue |   net_income |   total_assets |\n|:-------------|:--------------------------------------------|----------------:|-------------:|---------------:|\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n |               0 |            0 |    6.22178e+07 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan              |               0 |            0 |    4.37635e+07 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                |               0 |            0 |    3.59359e+07 |\n\nTable 2\n| stock_code   | company_name                                |   total_revenue |   net_income |   total_assets |   percentage_of_assets_from_subsidiaries |\n|:-------------|:--------------------------------------------|----------------:|-------------:|---------------:|-----------------------------------------:|\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n |               0 |            0 |    6.22178e+07 |                                        0 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan              |               0 |            0 |    4.37635e+07 |                                        0 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                |               0 |            0 |    3.59359e+07 |                                        0 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH company_assets AS (\n  SELECT\n    ci.stock_code,\n    ci.company_name,\n    SUM(CASE WHEN nbfr.category_code = 'IS_100' THEN nbfr.data ELSE 0 END) AS total_revenue,\n    SUM(CASE WHEN nbfr.category_code = 'IS_140' THEN nbfr.data ELSE 0 END) AS net_income,\n    SUM(CASE WHEN nbfr.category_code = 'BS_100' THEN nbfr.data ELSE 0 END) AS total_assets\n  FROM company_info AS ci\n  JOIN non_bank_financial_report AS nbfr\n    ON ci.stock_code = nbfr.stock_code\n  WHERE\n    ci.stock_code IN ('MSN', 'VNM', 'GAS')\n    AND nbfr.year = 2023\n    AND nbfr.quarter = 0\n  GROUP BY\n    ci.stock_code,\n    ci.company_name\n)\nSELECT\n  ca.stock_code,\n  ca.company_name,\n  ca.total_revenue,\n  ca.net_income,\n  ca.total_assets,\n  (\n    COALESCE(SUM(ca2.total_assets), 0) / ca.total_assets\n  ) * 100 AS percentage_of_assets_from_subsidiaries\nFROM company_assets AS ca\nLEFT JOIN company_assets AS ca2\n  ON ca.stock_code = (\n    SELECT\n      stock_code\n    FROM sub_and_shareholder\n    WHERE\n      invest_on = ca2.stock_code\n  )\nGROUP BY\n  ca.stock_code,\n  ca.company_name,\n  ca.total_revenue,\n  ca.net_income,\n  ca.total_assets;\n"
            }
        ],
        "time": 9.86567234992981,
        "evaluate": 0,
        "input_token": 2480,
        "output_token": 52
    },
    {
        "id": "b8a00999-b6af-4a1f-9e41-60a2aa7e4d01",
        "question": "Compare the Return on Equity (ROE) of Vinamilk, Masan Group, and Sabeco for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |   return_on_equity |\n|:-------------|-------------------:|\n| MSN          |          0.0489033 |\n| SAB          |          0.166962  |\n| VNM          |          0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    data AS return_on_equity\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    year = 2023 AND\n    quarter = 0 AND\n    stock_code IN ('VNM', 'MSN', 'SAB');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   |\n|:-------------|\n| VNM          |\n| MSN          |\n| SAB          |\n\nTable 2\n| stock_code   |       roe |\n|:-------------|----------:|\n| MSN          | 0.0489033 |\n| SAB          | 0.166962  |\n| VNM          | 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT fr.stock_code, fr.data AS roe\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Return On Equity'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND fr.stock_code IN ('VNM', 'MSN', 'SAB')\nLIMIT 3;\n"
            }
        ],
        "time": 4.619643926620483,
        "evaluate": 0.5,
        "input_token": 3474,
        "output_token": 321
    },
    {
        "id": "3bdd12bf-a669-4f11-bd82-b368cc2c608f",
        "question": "What is the trend of the current ratio and quick ratio for BIDV, Eximbank, and OCB Bank from 2020 to Q2 2024,  considering their respective subsidiaries and investments?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name    |     data |\n|:-------------|-------:|----------:|:--------------|---------:|\n| BID          |   2020 |         0 | Current Ratio | 2.57276  |\n| BID          |   2021 |         0 | Current Ratio | 3.94763  |\n| BID          |   2022 |         0 | Current Ratio | 5.04924  |\n| BID          |   2023 |         0 | Current Ratio | 2.5701   |\n| BID          |   2024 |         1 | Current Ratio | 2.94967  |\n| BID          |   2024 |         2 | Current Ratio | 3.65939  |\n| EIB          |   2020 |         0 | Current Ratio | 6.67582  |\n| EIB          |   2021 |         0 | Current Ratio | 5.72966  |\n| EIB          |   2022 |         0 | Current Ratio | 5.16642  |\n| EIB          |   2023 |         0 | Current Ratio | 6.12482  |\n| EIB          |   2024 |         1 | Current Ratio | 6.11042  |\n| HDB          |   2020 |         0 | Current Ratio | 4.83941  |\n| HDB          |   2021 |         0 | Current Ratio | 5.9133   |\n| HDB          |   2022 |         0 | Current Ratio | 4.00626  |\n| HDB          |   2023 |         0 | Current Ratio | 3.6528   |\n| HDB          |   2024 |         1 | Current Ratio | 3.1524   |\n| OCB          |   2020 |         0 | Current Ratio | 1.11545  |\n| OCB          |   2021 |         0 | Current Ratio | 4.2912   |\n| OCB          |   2022 |         0 | Current Ratio | 2.74653  |\n| OCB          |   2023 |         0 | Current Ratio | 1.68853  |\n| OCB          |   2024 |         1 | Current Ratio | 2.58278  |\n| STB          |   2020 |         0 | Current Ratio | 1.56301  |\n| STB          |   2021 |         0 | Current Ratio | 1.02262  |\n| STB          |   2022 |         0 | Current Ratio | 1.09035  |\n| STB          |   2023 |         0 | Current Ratio | 0.700152 |\n| STB          |   2024 |         1 | Current Ratio | 1.0368   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH relevant_companies AS (\n    SELECT stock_code\n    FROM company_info\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n    UNION\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n),\nratios AS (\n    SELECT ratio_code\n    FROM map_category_code_ratio\n    WHERE ratio_name IN ('Current Ratio', 'Quick Ratio')\n)\nSELECT fr.stock_code, fr.year, fr.quarter, mcr.ratio_name, fr.data\nFROM financial_ratio fr\nJOIN ratios r ON fr.ratio_code = r.ratio_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE fr.stock_code IN (SELECT stock_code FROM relevant_companies)\nAND ((fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY fr.stock_code, fr.year, fr.quarter, mcr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Error in getting the answer",
        "code_response": "Error in getting the code",
        "evaluate": 0,
        "input_token": 4846,
        "output_token": 759
    },
    {
        "id": "e4a9ec26-1d13-431d-854f-90f02a2024dd",
        "question": "What was the total equity of  Vietcombank's subsidiaries and associated companies as a percentage of Vietcombank's total equity at the end of Q2 2024?",
        "answer": "Table 1\n| equity_percentage   |\n|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify Vietcombank's subsidiaries and associated companies\nWITH vcb_subsidiaries AS (\n    SELECT invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VCB'\n),\n\n-- Step 2: Retrieve the total equity of these subsidiaries and associated companies\nsubsidiaries_equity AS (\n    SELECT SUM(data) AS total_subsidiaries_equity\n    FROM (\n        SELECT data\n        FROM bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n        UNION ALL\n        SELECT data\n        FROM non_bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for non-banks\n        UNION ALL\n        SELECT data\n        FROM securities_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for securities\n    ) AS equity_data\n),\n\n-- Step 3: Retrieve Vietcombank's total equity\nvcb_equity AS (\n    SELECT data AS total_vcb_equity\n    FROM bank_financial_report\n    WHERE stock_code = 'VCB'\n      AND year = 2024\n      AND quarter = 2\n      AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n)\n\n-- Step 4: Calculate the percentage\nSELECT (subsidiaries_equity.total_subsidiaries_equity / vcb_equity.total_vcb_equity) * 100 AS equity_percentage\nFROM subsidiaries_equity, vcb_equity;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n|   total_subsidiary_equity |\n|--------------------------:|\n|               9.57516e+08 |\n\nTable 2\n|   percentage |\n|-------------:|\n|      1802.2  |\n|       778.53 |\n|       912.48 |\n|      1068.92 |\n|      1238.11 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH VietcombankSubsidiaries AS (\n  SELECT\n    invest_on\n  FROM sub_and_shareholder\n  WHERE\n    stock_code = 'VCB'\n), SubsidiaryEquity AS (\n  SELECT\n    s.invest_on,\n    COALESCE(SUM(CASE WHEN b.quarter = 2 THEN b.data ELSE 0 END), 0) AS equity\n  FROM VietcombankSubsidiaries AS s\n  LEFT JOIN bank_financial_report AS b\n    ON s.invest_on = b.stock_code\n    AND b.category_code = 'BS_500'\n  LEFT JOIN non_bank_financial_report AS nb\n    ON s.invest_on = nb.stock_code\n    AND nb.category_code = 'BS_400'\n    AND nb.quarter = 2\n  LEFT JOIN securities_financial_report AS sec\n    ON s.invest_on = sec.stock_code\n    AND sec.quarter = 2\n  GROUP BY\n    s.invest_on\n), TotalSubsidiaryEquity AS (\n  SELECT\n    SUM(equity) AS total_equity\n  FROM SubsidiaryEquity\n), VietcombankEquity AS (\n  SELECT\n    data AS vcb_equity\n  FROM bank_financial_report\n  WHERE\n    stock_code = 'VCB'\n    AND category_code = 'BS_500'\n    AND quarter = 2\n)\nSELECT\n  (\n    tse.total_equity * 100.0 / ve.vcb_equity\n  )::NUMERIC(10, 2) AS percentage\nFROM TotalSubsidiaryEquity AS tse,\n  VietcombankEquity AS ve;\n"
            }
        ],
        "time": 8.805989027023315,
        "evaluate": 0,
        "input_token": 11785,
        "output_token": 1326
    },
    {
        "id": "e0c17ae2-f308-486c-b62b-97f32e813cff",
        "question": "How has the Debt-to-Equity ratio of Vinamilk, Masan Group, and SABECO changed from 2020 to Q2 2024?  Compare their respective Quick Ratios over the same period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_code   |     data |\n|:-------------|-------:|----------:|:-------------|---------:|\n| MSN          |   2020 |         0 | DTER         | 3.62386  |\n| MSN          |   2020 |         0 | QR           | 0.451862 |\n| MSN          |   2020 |         2 | DTER         | 2.36354  |\n| MSN          |   2020 |         2 | QR           | 0.356423 |\n| MSN          |   2021 |         0 | DTER         | 1.97835  |\n| MSN          |   2021 |         0 | QR           | 0.899436 |\n| MSN          |   2021 |         2 | DTER         | 2.83936  |\n| MSN          |   2021 |         2 | QR           | 0.572475 |\n| MSN          |   2022 |         0 | DTER         | 2.85795  |\n| MSN          |   2022 |         0 | QR           | 0.514436 |\n| MSN          |   2022 |         2 | DTER         | 2.22866  |\n| MSN          |   2022 |         2 | QR           | 0.44704  |\n| MSN          |   2023 |         0 | DTER         | 2.85445  |\n| MSN          |   2023 |         0 | QR           | 0.61315  |\n| MSN          |   2023 |         2 | DTER         | 2.75379  |\n| MSN          |   2023 |         2 | QR           | 0.563175 |\n| SAB          |   2020 |         0 | DTER         | 0.290342 |\n| SAB          |   2020 |         0 | QR           | 3.52024  |\n| SAB          |   2020 |         2 | DTER         | 0.32508  |\n| SAB          |   2020 |         2 | QR           | 3.0425   |\n| SAB          |   2021 |         0 | DTER         | 0.349295 |\n| SAB          |   2021 |         0 | QR           | 2.93441  |\n| SAB          |   2021 |         2 | DTER         | 0.288778 |\n| SAB          |   2021 |         2 | QR           | 3.55591  |\n| SAB          |   2022 |         0 | DTER         | 0.401541 |\n| SAB          |   2022 |         0 | QR           | 2.69688  |\n| SAB          |   2022 |         2 | DTER         | 0.280909 |\n| SAB          |   2022 |         2 | QR           | 3.53308  |\n| SAB          |   2023 |         0 | DTER         | 0.336332 |\n| SAB          |   2023 |         0 | QR           | 2.9677   |\n| SAB          |   2023 |         2 | DTER         | 0.318275 |\n| SAB          |   2023 |         2 | QR           | 3.13189  |\n| SAB          |   2024 |         2 | DTER         | 0.359095 |\n| SAB          |   2024 |         2 | QR           | 2.9152   |\n| VNM          |   2020 |         0 | DTER         | 0.439424 |\n| VNM          |   2020 |         0 | QR           | 1.7462   |\n| VNM          |   2020 |         2 | DTER         | 0.532862 |\n| VNM          |   2020 |         2 | QR           | 1.46628  |\n| VNM          |   2021 |         0 | DTER         | 0.487649 |\n| VNM          |   2021 |         0 | QR           | 1.72213  |\n| VNM          |   2021 |         2 | DTER         | 0.543159 |\n| VNM          |   2021 |         2 | QR           | 1.56154  |\n| VNM          |   2022 |         0 | DTER         | 0.477386 |\n| VNM          |   2022 |         0 | QR           | 1.70628  |\n| VNM          |   2022 |         2 | DTER         | 0.462287 |\n| VNM          |   2022 |         2 | QR           | 1.79426  |\n| VNM          |   2023 |         0 | DTER         | 0.503847 |\n| VNM          |   2023 |         0 | QR           | 1.74405  |\n| VNM          |   2023 |         2 | DTER         | 0.390309 |\n| VNM          |   2023 |         2 | QR           | 1.97817  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.ratio_code,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR fr.quarter = 2) -- Include annual reports and Q2 reports\n    AND mccr.ratio_code IN ('DTER', 'QR') -- Debt-to-Equity Ratio and Quick Ratio\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, fr.ratio_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |   year |   quarter | ratio_name           |     data |\n|:-------------|-------:|----------:|:---------------------|---------:|\n| MSN          |   2020 |         0 | Debt-to-Equity Ratio | 3.62386  |\n| SAB          |   2020 |         0 | Debt-to-Equity Ratio | 0.290342 |\n| SAB          |   2024 |         2 | Debt-to-Equity Ratio | 0.359095 |\n| VNM          |   2020 |         0 | Debt-to-Equity Ratio | 0.439424 |\n| MSN          |   2020 |         0 | Quick Ratio          | 0.451862 |\n| SAB          |   2020 |         0 | Quick Ratio          | 3.52024  |\n| SAB          |   2024 |         2 | Quick Ratio          | 2.9152   |\n| VNM          |   2020 |         0 | Quick Ratio          | 1.7462   |\n\n",
        "code_response": [
            {
                "language": "text",
                "code": "Step 2 doesn't require SQL.  The previous query's result already provides the data needed for comparison.  The data is structured to show the Debt-to-Equity Ratio and Quick Ratio for each company (VNM, MSN, SAB) in 2020 (quarter 0) and Q2 2024 (year 2024, quarter 2).  To facilitate analysis, this data could be further organized in a spreadsheet or other analytical tool.  For example, one could create a table like this:\n\n\n| Company | Ratio Type          | 2020 (Q0) | 2024 (Q2) | Change (%) |\n|---------|----------------------|-----------|-----------|------------|\n| VNM     | Debt-to-Equity Ratio |  0.439424 |  (Value)  | (Calculated)|\n| VNM     | Quick Ratio          |  1.7462   |  (Value)  | (Calculated)|\n| MSN     | Debt-to-Equity Ratio |  3.62386  |  (Value)  | (Calculated)|\n| MSN     | Quick Ratio          |  0.451862 |  (Value)  | (Calculated)|\n| SAB     | Debt-to-Equity Ratio |  0.290342 |  0.359095 | (Calculated)|\n| SAB     | Quick Ratio          |  3.52024  |  2.9152   | (Calculated)|\n\n\nThe \"(Value)\" and \"(Calculated)\" entries would be populated using the data from the SQL query result. The \"Change (%)\" column would be calculated as `((2024 (Q2) - 2020 (Q0)) / 2020 (Q0)) * 100`.  This table makes it easy to compare the changes in the ratios over time for the three companies.  No further SQL is necessary.\n\n\n### The result of the given SQL:\n\n"
            }
        ],
        "time": 8.195732355117798,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    }
]