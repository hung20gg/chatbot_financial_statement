[
    {
        "id": "05531948-0c7c-4c04-b5b6-ed8dc6ba4d19",
        "question": "What were the Debt-to-Equity ratios of Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   |     dter |\n|:-------------|---------:|\n| TCB          |  5.16295 |\n| VCB          | 12.3717  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS dter\nFROM financial_ratio\nWHERE ratio_code = 'DTER'\nAND stock_code IN ('VCB', 'TCB')\nAND year = 2022\nAND quarter = 0;\n"
            }
        ],
        "score": 1,
        "response": "Table 1\n| stock_code   |   year |   quarter |     data |\n|:-------------|-------:|----------:|---------:|\n| TCB          |   2022 |         0 |  5.16295 |\n| TCB          |   2022 |         1 |  5.24095 |\n| TCB          |   2022 |         2 |  4.97041 |\n| TCB          |   2022 |         3 |  5.10881 |\n| TCB          |   2022 |         4 |  5.16295 |\n| VCB          |   2022 |         0 | 12.3717  |\n| VCB          |   2022 |         1 | 11.4938  |\n| VCB          |   2022 |         2 | 12.0287  |\n| VCB          |   2022 |         3 | 11.8489  |\n| VCB          |   2022 |         4 | 12.1474  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT stock_code, year, quarter, data \nFROM financial_ratio \nWHERE ratio_code = 'DTER' \nAND stock_code IN ('VCB', 'TCB') \nAND year = 2022;\n"
            }
        ],
        "evaluate": 0,
        "input_token": 1918,
        "output_token": 264
    },
    {
        "id": "6ee96cd0-65dc-4dca-b7d0-0320dc63353c",
        "question": "What is the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| HPG          | 0.0661282 |\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN', 'HPG')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "response": "Table 1\n| stock_code   |   year |   quarter |        roe |\n|:-------------|-------:|----------:|-----------:|\n| HPG          |   2023 |         0 | 0.0661282  |\n| HPG          |   2023 |         1 | 0.00397384 |\n| HPG          |   2023 |         2 | 0.0147948  |\n| HPG          |   2023 |         3 | 0.0200306  |\n| HPG          |   2023 |         4 | 0.0288708  |\n| MSN          |   2023 |         0 | 0.0489033  |\n| MSN          |   2023 |         1 | 0.0118431  |\n| MSN          |   2023 |         2 | 0.0114376  |\n| MSN          |   2023 |         3 | 0.0127258  |\n| MSN          |   2023 |         4 | 0.013515   |\n| VNM          |   2023 |         0 | 0.257506   |\n| VNM          |   2023 |         1 | 0.0552366  |\n| VNM          |   2023 |         2 | 0.112804   |\n| VNM          |   2023 |         3 | 0.0745011  |\n| VNM          |   2023 |         4 | 0.0671136  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT stock_code, year, quarter, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND year = 2023\n  AND stock_code IN ('VNM', 'MSN', 'HPG');\n"
            }
        ],
        "evaluate": 0,
        "input_token": 1898,
        "output_token": 257
    },
    {
        "id": "9421f908-f430-45de-b536-6b9e1ebdfb1c",
        "question": "What were the total assets and total liabilities of Vietcombank, Techcombank, and ACB at the end of 2022?",
        "answer": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VCB          | BS_300          | 1.81382e+09 |\n| VCB          | BS_400          | 1.67817e+09 |\n| ACB          | BS_300          | 6.07875e+08 |\n| ACB          | BS_400          | 5.49437e+08 |\n| TCB          | BS_300          | 6.99033e+08 |\n| TCB          | BS_400          | 5.85608e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    category_code,\n    data\nFROM \n    bank_financial_report\nWHERE \n    year = 2022\n    AND quarter = 0\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND category_code IN ('BS_300', 'BS_400');\n"
            }
        ],
        "score": 1,
        "response": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VCB          | BS_300          | 1.81382e+09 |\n| ACB          | BS_300          | 6.07875e+08 |\n| TCB          | BS_300          | 6.99033e+08 |\n| VCB          | BS_400          | 1.67817e+09 |\n| ACB          | BS_400          | 5.49437e+08 |\n| TCB          | BS_400          | 5.85608e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT stock_code, category_code, data\nFROM bank_financial_report\nWHERE stock_code IN ('VCB', 'TCB', 'ACB')\n  AND year = 2022\n  AND quarter = 0\n  AND category_code = 'BS_300' -- Total Assets\nUNION ALL\nSELECT stock_code, category_code, data\nFROM bank_financial_report\nWHERE stock_code IN ('VCB', 'TCB', 'ACB')\n  AND year = 2022\n  AND quarter = 0\n  AND category_code = 'BS_400'; -- Total Liabilities\n"
            }
        ],
        "evaluate": 1,
        "input_token": 2239,
        "output_token": 403
    },
    {
        "id": "52880a2b-08dd-4e7e-b453-7bfa90617938",
        "question": "Compare the Return on Assets (ROA) and Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.  Additionally, provide the total assets and total equity for both companies for the same period.",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | ROA          |     0.0126875 |\n| MSN          | ROE          |     0.0489033 |\n| VNM          | ROA          |     0.171232  |\n| VNM          | ROE          |     0.257506  |\n\nTable 2\n| stock_code   | en_caption     |       value |\n|:-------------|:---------------|------------:|\n| VNM          | TOTAL ASSETS   | 5.26734e+07 |\n| VNM          | Owner's equity | 3.50257e+07 |\n| MSN          | TOTAL ASSETS   | 1.47383e+08 |\n| MSN          | Owner's equity | 3.82372e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve ROA and ROE for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    fr.stock_code,\n    fr.ratio_code,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nWHERE \n    fr.stock_code IN ('VNM', 'MSN') AND\n    fr.year = 2023 AND\n    fr.quarter = 0 AND\n    fr.ratio_code IN ('ROA', 'ROE');\n\n-- Step 2: Retrieve total assets and total equity for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data AS value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN') AND\n    nfr.year = 2023 AND\n    nfr.quarter = 0 AND\n    mcc.category_code IN ('BS_270', 'BS_410'); -- BS_270: TOTAL ASSETS, BS_410: Owner's equity\n"
            }
        ],
        "score": 1,
        "response": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | ROA          |   0.0126875   |\n| MSN          | ROE          |   0.0489033   |\n| MSN          | ROA          |   0.00301441  |\n| MSN          | ROE          |   0.0118431   |\n| MSN          | ROA          |   0.00304694  |\n| MSN          | ROE          |   0.0114376   |\n| VNM          | ROA          |   0.0460866   |\n| VNM          | ROE          |   0.0745011   |\n| VNM          | ROA          |   0.044628    |\n| VNM          | ROE          |   0.0671136   |\n| MSN          | ROA          |   0.0033398   |\n| MSN          | ROE          |   0.0127258   |\n| MSN          | ROA          |   0.00350634  |\n| MSN          | ROE          |   0.013515    |\n| VNM          | ROA          |   0.171232    |\n| VNM          | ROE          |   0.257506    |\n| VNM          | ROA          |   0.0386935   |\n| VNM          | ROE          |   0.0552366   |\n| VNM          | ROA          |   0.0811356   |\n| VNM          | ROE          |   0.112804    |\n| VNM          | BS_270       |   5.49674e+07 |\n| VNM          | BS_270       |   5.26734e+07 |\n| VNM          | BS_270       |   4.92648e+07 |\n| VNM          | BS_270       |   5.09688e+07 |\n| MSN          | BS_270       |   1.45073e+08 |\n| MSN          | BS_270       |   1.47383e+08 |\n| MSN          | BS_270       |   1.45784e+08 |\n| MSN          | BS_270       |   1.40858e+08 |\n| MSN          | BS_400       |   3.80732e+07 |\n| MSN          | BS_400       |   3.82372e+07 |\n| MSN          | BS_400       |   3.71061e+07 |\n| MSN          | BS_400       |   3.75243e+07 |\n| VNM          | BS_270       |   5.26734e+07 |\n| VNM          | BS_400       |   3.50257e+07 |\n| MSN          | BS_270       |   1.47383e+08 |\n| MSN          | BS_400       |   3.82372e+07 |\n| VNM          | BS_400       |   3.40031e+07 |\n| VNM          | BS_400       |   3.50257e+07 |\n| VNM          | BS_400       |   3.45102e+07 |\n| VNM          | BS_400       |   3.666e+07   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Retrieve ROA and ROE for VNM and MSN for the fiscal year 2023\nSELECT \n    stock_code, \n    ratio_code, \n    data AS ratio_value \nFROM \n    financial_ratio \nWHERE \n    stock_code IN ('VNM', 'MSN') \n    AND year = 2023 \n    AND ratio_code IN ('ROA', 'ROE')\n\nUNION ALL\n\n-- Retrieve total assets and total equity for VNM and MSN for the fiscal year 2023\nSELECT \n    stock_code, \n    category_code, \n    data AS financial_value \nFROM \n    non_bank_financial_report \nWHERE \n    stock_code IN ('VNM', 'MSN') \n    AND year = 2023 \n    AND category_code IN ('BS_270', 'BS_400');\n"
            }
        ],
        "evaluate": 0,
        "input_token": 2236,
        "output_token": 607
    },
    {
        "id": "61803c95-30e1-4a6f-8f02-ebde74c1120c",
        "question": "What were the operating cash flows and capital expenditures for Vietcombank, Techcombank, and VPBank in Q2 2024?  Calculate the free cash flow for each bank.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |   free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|-----------------:|\n| TCB          |   2024 |         2 |                     0 |                -280254 |           280254 |\n| VPB          |   2024 |         2 |                     0 |                  -1490 |             1490 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) AS operating_cash_flow,\n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS capital_expenditures,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) - \n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS free_cash_flow\nFROM \n    bank_financial_report bfr\nWHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'VPB') AND\n    bfr.year = 2024 AND\n    bfr.quarter = 2 AND\n    bfr.category_code IN ('CF_009', 'CF_025')\nGROUP BY \n    bfr.stock_code, bfr.year, bfr.quarter;\n"
            }
        ],
        "score": 1,
        "response": "Table 1\n| stock_code   | operating_cash_flow   | capital_expenditure   | free_cash_flow   |\n|--------------|-----------------------|-----------------------|------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH operating_cash_flows AS (\n    SELECT stock_code, data AS operating_cash_flow\n    FROM bank_financial_report\n    WHERE stock_code IN ('VCB', 'TCB', 'VPB')\n      AND year = 2024\n      AND quarter = 2\n      AND category_code = 'CF_009'\n),\ncapital_expenditures AS (\n    SELECT stock_code, data AS capital_expenditure\n    FROM bank_financial_report\n    WHERE stock_code IN ('VCB', 'TCB', 'VPB')\n      AND year = 2024\n      AND quarter = 2\n      AND category_code = 'CF_025'\n)\nSELECT o.stock_code,\n       o.operating_cash_flow,\n       c.capital_expenditure,\n       (o.operating_cash_flow - c.capital_expenditure) AS free_cash_flow\nFROM operating_cash_flows o\nJOIN capital_expenditures c ON o.stock_code = c.stock_code;\n"
            }
        ],
        "evaluate": 0,
        "input_token": 2421,
        "output_token": 628
    }
]