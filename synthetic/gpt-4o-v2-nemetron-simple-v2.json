[
    {
        "id": "9421f908-f430-45de-b536-6b9e1ebdfb1c",
        "question": "What were the total assets and total liabilities of Vietcombank, Techcombank, and ACB at the end of 2022?",
        "answer": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VCB          | BS_300          | 1.81382e+09 |\n| VCB          | BS_400          | 1.67817e+09 |\n| ACB          | BS_300          | 6.07875e+08 |\n| ACB          | BS_400          | 5.49437e+08 |\n| TCB          | BS_300          | 6.99033e+08 |\n| TCB          | BS_400          | 5.85608e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    category_code,\n    data\nFROM \n    bank_financial_report\nWHERE \n    year = 2022\n    AND quarter = 0\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND category_code IN ('BS_300', 'BS_400');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| metric            | stock_code   |   year |   quarter |        data |\n|:------------------|:-------------|-------:|----------:|------------:|\n| Total Assets      | VCB          |   2022 |         0 | 1.81382e+09 |\n| Total Assets      | ACB          |   2022 |         0 | 6.07875e+08 |\n| Total Assets      | TCB          |   2022 |         0 | 6.99033e+08 |\n| Total Liabilities | VCB          |   2022 |         0 | 1.67817e+09 |\n| Total Liabilities | ACB          |   2022 |         0 | 5.49437e+08 |\n| Total Liabilities | TCB          |   2022 |         0 | 5.85608e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  'Total Assets' AS Metric,\n  stock_code,\n  year,\n  quarter,\n  data\nFROM \n  bank_financial_report\nWHERE \n  stock_code IN ('VCB', 'TCB', 'ACB')\n  AND year = 2022\n  AND quarter = 0\n  AND category_code = 'BS_300'\n\nUNION ALL\n\nSELECT \n  'Total Liabilities' AS Metric,\n  stock_code,\n  year,\n  quarter,\n  data\nFROM \n  bank_financial_report\nWHERE \n  stock_code IN ('VCB', 'TCB', 'ACB')\n  AND year = 2022\n  AND quarter = 0\n  AND category_code = 'BS_400'\n\nLIMIT 100;\n"
            }
        ],
        "time": 23.610432863235474,
        "evaluate": 0.5,
        "input_token": 2688,
        "output_token": 941
    },
    {
        "id": "05531948-0c7c-4c04-b5b6-ed8dc6ba4d19",
        "question": "What were the Debt-to-Equity ratios of Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   |     dter |\n|:-------------|---------:|\n| TCB          |  5.16295 |\n| VCB          | 12.3717  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS dter\nFROM financial_ratio\nWHERE ratio_code = 'DTER'\nAND stock_code IN ('VCB', 'TCB')\nAND year = 2022\nAND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   | en_company_name                                          |   debt_to_equity_ratio |\n|:-------------|:---------------------------------------------------------|-----------------------:|\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |               12.3717  |\n| TCB          | Vietnam Technological And Commercial Joint Stock Bank    |                5.16295 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code, \n  ci.en_company_name, \n  fr.data AS Debt_To_Equity_Ratio\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.ratio_code = 'DTER' \n  AND fr.stock_code IN ('VCB', 'TCB')\n  AND fr.year = 2022\n  AND fr.quarter = 0\nLIMIT 100;\n"
            }
        ],
        "time": 27.730981588363647,
        "evaluate": 0.5,
        "input_token": 1943,
        "output_token": 623
    },
    {
        "id": "6ee96cd0-65dc-4dca-b7d0-0320dc63353c",
        "question": "What is the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| HPG          | 0.0661282 |\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN', 'HPG')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   |   year |   quarter | ratio_name       |   roe_value |\n|:-------------|-------:|----------:|:-----------------|------------:|\n| HPG          |   2023 |         0 | Return On Equity |   0.0661282 |\n| MSN          |   2023 |         0 | Return On Equity |   0.0489033 |\n| VNM          |   2023 |         0 | Return On Equity |   0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  fr.year,\n  fr.quarter,\n  mcr.ratio_name,\n  fr.data AS roe_value\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.ratio_code = 'ROE'\n  AND fr.stock_code IN ('VNM', 'MSN', 'HPG')\n  AND fr.year = 2023\n  AND fr.quarter = 0\nLIMIT 100;  -- Add a limit as per the database access note\n"
            }
        ],
        "time": 31.400450229644775,
        "evaluate": 0.5,
        "input_token": 1980,
        "output_token": 581
    },
    {
        "id": "52880a2b-08dd-4e7e-b453-7bfa90617938",
        "question": "Compare the Return on Assets (ROA) and Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.  Additionally, provide the total assets and total equity for both companies for the same period.",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | ROA          |     0.0126875 |\n| MSN          | ROE          |     0.0489033 |\n| VNM          | ROA          |     0.171232  |\n| VNM          | ROE          |     0.257506  |\n\nTable 2\n| stock_code   | en_caption     |       value |\n|:-------------|:---------------|------------:|\n| VNM          | TOTAL ASSETS   | 5.26734e+07 |\n| VNM          | Owner's equity | 3.50257e+07 |\n| MSN          | TOTAL ASSETS   | 1.47383e+08 |\n| MSN          | Owner's equity | 3.82372e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve ROA and ROE for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    fr.stock_code,\n    fr.ratio_code,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nWHERE \n    fr.stock_code IN ('VNM', 'MSN') AND\n    fr.year = 2023 AND\n    fr.quarter = 0 AND\n    fr.ratio_code IN ('ROA', 'ROE');\n\n-- Step 2: Retrieve total assets and total equity for Vinamilk (VNM) and Masan Group (MSN) for fiscal year 2023\nSELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data AS value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN') AND\n    nfr.year = 2023 AND\n    nfr.quarter = 0 AND\n    mcc.category_code IN ('BS_270', 'BS_410'); -- BS_270: TOTAL ASSETS, BS_410: Owner's equity\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | financialratio   |   ratiovalue | totalassets   | totalequity   |\n|:-------------|:-----------------|-------------:|:--------------|:--------------|\n| MSN          | Return On Assets |    0.0126875 |               |               |\n| MSN          | Return On Equity |    0.0489033 |               |               |\n| VNM          | Return On Assets |    0.171232  |               |               |\n| VNM          | Return On Equity |    0.257506  |               |               |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: ROA and ROE for VNM and MSN in 2023\nWITH FinancialRatios AS (\n  SELECT \n    stock_code,\n    ratio_code,\n    data\n  FROM \n    financial_ratio\n  WHERE \n    year = 2023 AND \n    quarter = 0 AND  -- Annual report\n    stock_code IN ('VNM', 'MSN') AND\n    ratio_code IN ('ROA', 'ROE')\n),\n-- Mapping for clarity (not strictly necessary but added for understanding)\nRatioNames AS (\n  SELECT \n    ratio_code,\n    ratio_name\n  FROM \n    map_category_code_ratio\n  WHERE \n    ratio_code IN ('ROA', 'ROE')\n),\n\n-- Step 2: Total Assets and Total Equity (Hypothetical category codes used)\nBalanceSheetItems AS (\n  SELECT \n    stock_code,\n    category_code,\n    data\n  FROM \n    non_bank_financial_report\n  WHERE \n    year = 2023 AND \n    quarter = 0 AND  -- Annual report\n    stock_code IN ('VNM', 'MSN') AND\n    category_code IN ('BS_TotalAssets', 'BS_TotalEquity')  -- REPLACE WITH ACTUAL CATEGORY CODES\n)\n\n-- Combine Results\nSELECT \n  -- ROA and ROE\n  FR.stock_code,\n  RN.ratio_name AS FinancialRatio,\n  FR.data AS RatioValue,\n  \n  -- Total Assets and Total Equity (NULL if not directly queried but shown for completeness)\n  (SELECT data FROM BalanceSheetItems BSI WHERE BSI.stock_code = FR.stock_code AND BSI.category_code = 'BS_TotalAssets') AS TotalAssets,\n  (SELECT data FROM BalanceSheetItems BSI WHERE BSI.stock_code = FR.stock_code AND BSI.category_code = 'BS_TotalEquity') AS TotalEquity\n  \nFROM \n  FinancialRatios FR\n  JOIN RatioNames RN ON FR.ratio_code = RN.ratio_code\n\nLIMIT 100;  -- Add a limit as per the database usage note\n"
            }
        ],
        "time": 33.84339237213135,
        "evaluate": 0,
        "input_token": 1972,
        "output_token": 874
    },
    {
        "id": "5972ee68-a39a-4051-b3d5-59aa6a533359",
        "question": "For the year 2023, what was the total revenue, net income, and total assets of  Masan Group, Vinamilk, and  PetroVietnam Gas?  Additionally, provide the percentage of total assets attributable to subsidiaries or investments for each company.",
        "answer": "Table 1\n| stock_code   |   total_revenue |   net_income |   total_assets |   percentage_investment_assets |\n|:-------------|----------------:|-------------:|---------------:|-------------------------------:|\n| GAS          |     8.99539e+07 |  1.46395e+07 |    8.77545e+07 |                        2.05086 |\n| MSN          |     7.82516e+07 |  2.56297e+06 |    1.47383e+08 |                        0       |\n| VNM          |     6.03689e+07 |  1.09679e+07 |    5.26734e+07 |                        0       |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH financial_data AS (\n    SELECT\n        nfr.stock_code,\n        SUM(CASE WHEN mcc.category_code = 'IS_010' THEN nfr.data ELSE 0 END) AS total_revenue,\n        SUM(CASE WHEN mcc.category_code = 'IS_050' THEN nfr.data ELSE 0 END) AS net_income,\n        SUM(CASE WHEN mcc.category_code = 'BS_270' THEN nfr.data ELSE 0 END) AS total_assets\n    FROM\n        non_bank_financial_report nfr\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND nfr.stock_code IN ('MSN', 'VNM', 'GAS')\n    GROUP BY\n        nfr.stock_code\n),\ninvestment_data AS (\n    SELECT\n        s.stock_code,\n        SUM(nfr.data) AS investment_assets\n    FROM\n        sub_and_shareholder s\n    JOIN\n        non_bank_financial_report nfr ON s.invest_on = nfr.stock_code\n    JOIN\n        map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\n    WHERE\n        nfr.year = 2023 AND nfr.quarter = 0 AND mcc.category_code = 'BS_270'\n    GROUP BY\n        s.stock_code\n)\nSELECT\n    fd.stock_code,\n    fd.total_revenue,\n    fd.net_income,\n    fd.total_assets,\n    COALESCE(id.investment_assets / NULLIF(fd.total_assets, 0) * 100, 0) AS percentage_investment_assets\nFROM\n    financial_data fd\nLEFT JOIN\n    investment_data id ON fd.stock_code = id.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Error in getting the answer",
        "code_response": "Error in getting the code",
        "evaluate": 0,
        "input_token": 194,
        "output_token": 106
    },
    {
        "id": "481ebd36-c43a-4af2-901b-99a8e6964217",
        "question": "Compare the Return on Equity (ROE) of Vinamilk and Masan Group for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   |   year |   quarter |   roe_value |\n|:-------------|-------:|----------:|------------:|\n| MSN          |   2023 |         0 |   0.0489033 |\n| VNM          |   2023 |         0 |   0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  stock_code,\n  year,\n  quarter,\n  data AS ROE_Value\nFROM \n  financial_ratio\nWHERE \n  ratio_code = 'ROE'  -- Return on Equity\n  AND year = 2023\n  AND quarter = 0  -- For Annual Report\n  AND stock_code IN ('VNM', 'MSN')  -- For Vinamilk and Masan Group\nLIMIT 100;  -- Adding a limit as per the instructions\n"
            }
        ],
        "time": 20.90409278869629,
        "evaluate": 0.5,
        "input_token": 2100,
        "output_token": 866
    },
    {
        "id": "61803c95-30e1-4a6f-8f02-ebde74c1120c",
        "question": "What were the operating cash flows and capital expenditures for Vietcombank, Techcombank, and VPBank in Q2 2024?  Calculate the free cash flow for each bank.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |   free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|-----------------:|\n| TCB          |   2024 |         2 |                     0 |                -280254 |           280254 |\n| VPB          |   2024 |         2 |                     0 |                  -1490 |             1490 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) AS operating_cash_flow,\n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS capital_expenditures,\n    SUM(CASE WHEN bfr.category_code = 'CF_009' THEN bfr.data ELSE 0 END) - \n    SUM(CASE WHEN bfr.category_code = 'CF_025' THEN bfr.data ELSE 0 END) AS free_cash_flow\nFROM \n    bank_financial_report bfr\nWHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'VPB') AND\n    bfr.year = 2024 AND\n    bfr.quarter = 2 AND\n    bfr.category_code IN ('CF_009', 'CF_025')\nGROUP BY \n    bfr.stock_code, bfr.year, bfr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name                                          |   operatingcashflow | freecashflow   |\n|:-------------|:---------------------------------------------------------|--------------------:|:---------------|\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         6.92051e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         7.0749e+07  |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         8.81127e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.08122e+08 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         3.77132e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         4.61588e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         5.5864e+07  |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         6.77242e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.54471e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         3.10037e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.92834e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         4.05014e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.29354e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.35583e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         3.5159e+06  |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         3.42776e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    744461           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    707109           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    874378           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.77798e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    376349           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    256298           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    281539           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    357970           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.80025e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.39326e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.05396e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.27217e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.91719e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.09953e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         3.23436e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         3.0698e+06  |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    461385           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    129810           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    208436           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    266456           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |     71556           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    325767           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.71617e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |    245096           |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.60382e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.75742e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.12505e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.19149e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         9.95044e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.18675e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.36111e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.58176e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         3.30243e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         3.91494e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         4.68323e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         4.58086e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.49292e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.75355e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.56673e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.99128e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         9.97473e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         1.17608e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         9.46422e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         4.56488e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         6.40611e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         6.19842e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         7.39811e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         6.79043e+06 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.30496e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         2.73886e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign Trade Of Vietnam |         3.73681e+07 |                |\n| VCB          | Joint Stock Commercial Bank For Foreign ",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Retrieve Operating Cash Flows and Free Cash Flow for VCB, TCB, VPB in Q2 2024\nSELECT \n  -- Company Information\n  ci.stock_code,\n  ci.en_company_name,\n  \n  -- Operating Cash Flows (Assuming CF_009 is the closest match for banks)\n  bfr.data AS OperatingCashFlow,\n  \n  -- Free Cash Flow (Using pre-calculated ratio for accuracy)\n  fr.data AS FreeCashFlow\n  \nFROM \n  company_info ci\n  -- Join with bank_financial_report for Operating Cash Flows\n  LEFT JOIN bank_financial_report bfr ON ci.stock_code = bfr.stock_code\n  -- Join with financial_ratio for Free Cash Flow\n  LEFT JOIN financial_ratio fr ON ci.stock_code = fr.stock_code\n  \n  -- Conditions for Operating Cash Flow\n  AND bfr.category_code = 'CF_009'  -- Assuming this as Operating Cash Flow for banks\n  AND bfr.year = 2024\n  AND bfr.quarter = 2  -- Q2\n  \n  -- Conditions for Free Cash Flow\n  AND fr.ratio_code = 'FCF'\n  AND fr.year = 2024\n  AND fr.quarter = 2  -- Q2\n  \nWHERE \n  -- Filter for the specific banks\n  ci.stock_code IN ('VCB', 'TCB', 'VPB')\n  \nLIMIT 100;\n"
            }
        ],
        "time": 36.04408645629883,
        "evaluate": 0,
        "input_token": 2071,
        "output_token": 876
    },
    {
        "id": "b8a00999-b6af-4a1f-9e41-60a2aa7e4d01",
        "question": "Compare the Return on Equity (ROE) of Vinamilk, Masan Group, and Sabeco for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   |   return_on_equity |\n|:-------------|-------------------:|\n| MSN          |          0.0489033 |\n| SAB          |          0.166962  |\n| VNM          |          0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    data AS return_on_equity\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    year = 2023 AND\n    quarter = 0 AND\n    stock_code IN ('VNM', 'MSN', 'SAB');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   | industry           |   roe_value |\n|:-------------|:-------------------|------------:|\n| MSN          | Food and Beverages |   0.0489033 |\n| SAB          | Food and Beverages |   0.166962  |\n| VNM          | Food and Beverages |   0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  ci.stock_code,\n  ci.industry, -- Optional, for additional context\n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.year = 2023 \n  AND fr.quarter = 0 \n  AND mcr.ratio_name = 'Return On Equity'\n  AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\nLIMIT 100; -- Adding a limit as per the database access note\n"
            }
        ],
        "time": 31.61317014694214,
        "evaluate": 0.5,
        "input_token": 2210,
        "output_token": 889
    },
    {
        "id": "74f9babe-9421-4bb7-a88f-a5c664b5a6da",
        "question": "What is the trend of the Current Ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |   current_ratio |\n|-------:|----------:|:-------------|----------------:|\n|   2020 |         0 | ACB          |         3.69815 |\n|   2021 |         0 | ACB          |         3.97544 |\n|   2022 |         0 | ACB          |         3.81624 |\n|   2023 |         0 | ACB          |         3.04283 |\n|   2024 |         1 | ACB          |         3.29123 |\n|   2020 |         0 | TCB          |         2.83619 |\n|   2021 |         0 | TCB          |         4.35343 |\n|   2022 |         0 | TCB          |         3.29776 |\n|   2023 |         0 | TCB          |         2.66367 |\n|   2024 |         1 | TCB          |         2.40445 |\n|   2024 |         2 | TCB          |         2.88946 |\n|   2020 |         0 | VCB          |         7.25011 |\n|   2021 |         0 | VCB          |         6.29498 |\n|   2022 |         0 | VCB          |         3.56816 |\n|   2023 |         0 | VCB          |         4.7828  |\n|   2024 |         1 | VCB          |         3.48899 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    fr.stock_code, \n    fr.data AS current_ratio\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    mccr.ratio_name = 'Current Ratio'\n    AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR \n         (fr.year = 2024 AND fr.quarter BETWEEN 1 AND 2))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Assuming BS_100 for Current Assets and BS_310 for Current Liabilities\nCurrentRatioData AS (\n  SELECT \n    stock_code,\n    year,\n    quarter,\n    -- Calculate Current Ratio\n    (CASE \n       WHEN CLR.data = 0 THEN NULL  -- Avoid division by zero\n       ELSE CA.data / CLR.data \n     END) AS CurrentRatio\n  FROM \n    bank_financial_report CA\n  INNER JOIN \n    bank_financial_report CLR ON CA.stock_code = CLR.stock_code AND CA.year = CLR.year AND CA.quarter = CLR.quarter\n  WHERE \n    CA.category_code = 'BS_100'  -- Assumed for Current Assets\n    AND CLR.category_code = 'BS_310'  -- For Current Liabilities\n    AND CA.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND ((CA.year BETWEEN 2020 AND 2023 AND CA.quarter = 0) OR (CA.year = 2024 AND CA.quarter = 2))\n)\n-- Select the data\nSELECT \n  stock_code,\n  year,\n  quarter,\n  CurrentRatio\nFROM \n  CurrentRatioData\nORDER BY \n  stock_code, year, quarter\nLIMIT 100;  -- To adhere to the limit requirement\n"
            }
        ],
        "time": 39.3913848400116,
        "evaluate": 0,
        "input_token": 2060,
        "output_token": 772
    },
    {
        "id": "3bdd12bf-a669-4f11-bd82-b368cc2c608f",
        "question": "What is the trend of the current ratio and quick ratio for BIDV, Eximbank, and OCB Bank from 2020 to Q2 2024,  considering their respective subsidiaries and investments?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name    |     data |\n|:-------------|-------:|----------:|:--------------|---------:|\n| BID          |   2020 |         0 | Current Ratio | 2.57276  |\n| BID          |   2021 |         0 | Current Ratio | 3.94763  |\n| BID          |   2022 |         0 | Current Ratio | 5.04924  |\n| BID          |   2023 |         0 | Current Ratio | 2.5701   |\n| BID          |   2024 |         1 | Current Ratio | 2.94967  |\n| BID          |   2024 |         2 | Current Ratio | 3.65939  |\n| EIB          |   2020 |         0 | Current Ratio | 6.67582  |\n| EIB          |   2021 |         0 | Current Ratio | 5.72966  |\n| EIB          |   2022 |         0 | Current Ratio | 5.16642  |\n| EIB          |   2023 |         0 | Current Ratio | 6.12482  |\n| EIB          |   2024 |         1 | Current Ratio | 6.11042  |\n| HDB          |   2020 |         0 | Current Ratio | 4.83941  |\n| HDB          |   2021 |         0 | Current Ratio | 5.9133   |\n| HDB          |   2022 |         0 | Current Ratio | 4.00626  |\n| HDB          |   2023 |         0 | Current Ratio | 3.6528   |\n| HDB          |   2024 |         1 | Current Ratio | 3.1524   |\n| OCB          |   2020 |         0 | Current Ratio | 1.11545  |\n| OCB          |   2021 |         0 | Current Ratio | 4.2912   |\n| OCB          |   2022 |         0 | Current Ratio | 2.74653  |\n| OCB          |   2023 |         0 | Current Ratio | 1.68853  |\n| OCB          |   2024 |         1 | Current Ratio | 2.58278  |\n| STB          |   2020 |         0 | Current Ratio | 1.56301  |\n| STB          |   2021 |         0 | Current Ratio | 1.02262  |\n| STB          |   2022 |         0 | Current Ratio | 1.09035  |\n| STB          |   2023 |         0 | Current Ratio | 0.700152 |\n| STB          |   2024 |         1 | Current Ratio | 1.0368   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH relevant_companies AS (\n    SELECT stock_code\n    FROM company_info\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n    UNION\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('BID', 'EIB', 'OCB')\n),\nratios AS (\n    SELECT ratio_code\n    FROM map_category_code_ratio\n    WHERE ratio_name IN ('Current Ratio', 'Quick Ratio')\n)\nSELECT fr.stock_code, fr.year, fr.quarter, mcr.ratio_name, fr.data\nFROM financial_ratio fr\nJOIN ratios r ON fr.ratio_code = r.ratio_code\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE fr.stock_code IN (SELECT stock_code FROM relevant_companies)\nAND ((fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY fr.stock_code, fr.year, fr.quarter, mcr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | ratio_name    |   year |   quarter |   ratio_value |\n|:-------------|:--------------|-------:|----------:|--------------:|\n| ACB          | Current Ratio |   2020 |         0 |      3.69815  |\n| ACB          | Current Ratio |   2021 |         0 |      3.97544  |\n| ACB          | Current Ratio |   2022 |         0 |      3.81624  |\n| ACB          | Current Ratio |   2023 |         0 |      3.04283  |\n| BID          | Current Ratio |   2020 |         0 |      2.57276  |\n| BID          | Current Ratio |   2021 |         0 |      3.94763  |\n| BID          | Current Ratio |   2022 |         0 |      5.04924  |\n| BID          | Current Ratio |   2023 |         0 |      2.5701   |\n| BID          | Current Ratio |   2024 |         2 |      3.65939  |\n| EIB          | Current Ratio |   2020 |         0 |      6.67582  |\n| EIB          | Current Ratio |   2021 |         0 |      5.72966  |\n| EIB          | Current Ratio |   2022 |         0 |      5.16642  |\n| EIB          | Current Ratio |   2023 |         0 |      6.12482  |\n| HDB          | Current Ratio |   2020 |         0 |      4.83941  |\n| HDB          | Current Ratio |   2021 |         0 |      5.9133   |\n| HDB          | Current Ratio |   2022 |         0 |      4.00626  |\n| HDB          | Current Ratio |   2023 |         0 |      3.6528   |\n| OCB          | Current Ratio |   2020 |         0 |      1.11545  |\n| OCB          | Current Ratio |   2021 |         0 |      4.2912   |\n| OCB          | Current Ratio |   2022 |         0 |      2.74653  |\n| OCB          | Current Ratio |   2023 |         0 |      1.68853  |\n| STB          | Current Ratio |   2020 |         0 |      1.56301  |\n| STB          | Current Ratio |   2021 |         0 |      1.02262  |\n| STB          | Current Ratio |   2022 |         0 |      1.09035  |\n| STB          | Current Ratio |   2023 |         0 |      0.700152 |\n| VCB          | Current Ratio |   2020 |         0 |      7.25011  |\n| VCB          | Current Ratio |   2021 |         0 |      6.29498  |\n| VCB          | Current Ratio |   2022 |         0 |      3.56816  |\n| VCB          | Current Ratio |   2023 |         0 |      4.7828   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Identify relevant companies and their subsidiaries/investments\nRelevantCompanies AS (\n  SELECT stock_code FROM company_info WHERE stock_code IN ('BID', 'EIB', 'OCB')\n  UNION \n  SELECT invest_on FROM sub_and_shareholder WHERE stock_code IN ('BID', 'EIB', 'OCB')\n  UNION \n  SELECT stock_code FROM sub_and_shareholder WHERE invest_on IN ('BID', 'EIB', 'OCB')\n),\n\n-- Filter for Current and Quick Ratios\nRelevantRatios AS (\n  SELECT ratio_code, ratio_name \n  FROM map_category_code_ratio \n  WHERE ratio_name IN ('Current Ratio', 'Quick Ratio')\n)\n\n-- Main Query: Fetching Ratios for Relevant Companies over Time\nSELECT \n  rc.stock_code, \n  rr.ratio_name, \n  fr.year, \n  fr.quarter, \n  fr.data AS ratio_value\nFROM \n  RelevantCompanies rc\n  JOIN financial_ratio fr ON rc.stock_code = fr.stock_code\n  JOIN RelevantRatios rr ON fr.ratio_code = rr.ratio_code\nWHERE \n  fr.year BETWEEN 2020 AND 2024 \n  AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))  -- Annual data or Q2 2024\nORDER BY \n  rc.stock_code, \n  rr.ratio_name, \n  fr.year, \n  fr.quarter\nLIMIT 100;  -- Adjust limit as necessary\n"
            }
        ],
        "time": 42.253260135650635,
        "evaluate": 0.5,
        "input_token": 2491,
        "output_token": 1035
    },
    {
        "id": "e0c17ae2-f308-486c-b62b-97f32e813cff",
        "question": "How has the Debt-to-Equity ratio of Vinamilk, Masan Group, and SABECO changed from 2020 to Q2 2024?  Compare their respective Quick Ratios over the same period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_code   |     data |\n|:-------------|-------:|----------:|:-------------|---------:|\n| MSN          |   2020 |         0 | DTER         | 3.62386  |\n| MSN          |   2020 |         0 | QR           | 0.451862 |\n| MSN          |   2020 |         2 | DTER         | 2.36354  |\n| MSN          |   2020 |         2 | QR           | 0.356423 |\n| MSN          |   2021 |         0 | DTER         | 1.97835  |\n| MSN          |   2021 |         0 | QR           | 0.899436 |\n| MSN          |   2021 |         2 | DTER         | 2.83936  |\n| MSN          |   2021 |         2 | QR           | 0.572475 |\n| MSN          |   2022 |         0 | DTER         | 2.85795  |\n| MSN          |   2022 |         0 | QR           | 0.514436 |\n| MSN          |   2022 |         2 | DTER         | 2.22866  |\n| MSN          |   2022 |         2 | QR           | 0.44704  |\n| MSN          |   2023 |         0 | DTER         | 2.85445  |\n| MSN          |   2023 |         0 | QR           | 0.61315  |\n| MSN          |   2023 |         2 | DTER         | 2.75379  |\n| MSN          |   2023 |         2 | QR           | 0.563175 |\n| SAB          |   2020 |         0 | DTER         | 0.290342 |\n| SAB          |   2020 |         0 | QR           | 3.52024  |\n| SAB          |   2020 |         2 | DTER         | 0.32508  |\n| SAB          |   2020 |         2 | QR           | 3.0425   |\n| SAB          |   2021 |         0 | DTER         | 0.349295 |\n| SAB          |   2021 |         0 | QR           | 2.93441  |\n| SAB          |   2021 |         2 | DTER         | 0.288778 |\n| SAB          |   2021 |         2 | QR           | 3.55591  |\n| SAB          |   2022 |         0 | DTER         | 0.401541 |\n| SAB          |   2022 |         0 | QR           | 2.69688  |\n| SAB          |   2022 |         2 | DTER         | 0.280909 |\n| SAB          |   2022 |         2 | QR           | 3.53308  |\n| SAB          |   2023 |         0 | DTER         | 0.336332 |\n| SAB          |   2023 |         0 | QR           | 2.9677   |\n| SAB          |   2023 |         2 | DTER         | 0.318275 |\n| SAB          |   2023 |         2 | QR           | 3.13189  |\n| SAB          |   2024 |         2 | DTER         | 0.359095 |\n| SAB          |   2024 |         2 | QR           | 2.9152   |\n| VNM          |   2020 |         0 | DTER         | 0.439424 |\n| VNM          |   2020 |         0 | QR           | 1.7462   |\n| VNM          |   2020 |         2 | DTER         | 0.532862 |\n| VNM          |   2020 |         2 | QR           | 1.46628  |\n| VNM          |   2021 |         0 | DTER         | 0.487649 |\n| VNM          |   2021 |         0 | QR           | 1.72213  |\n| VNM          |   2021 |         2 | DTER         | 0.543159 |\n| VNM          |   2021 |         2 | QR           | 1.56154  |\n| VNM          |   2022 |         0 | DTER         | 0.477386 |\n| VNM          |   2022 |         0 | QR           | 1.70628  |\n| VNM          |   2022 |         2 | DTER         | 0.462287 |\n| VNM          |   2022 |         2 | QR           | 1.79426  |\n| VNM          |   2023 |         0 | DTER         | 0.503847 |\n| VNM          |   2023 |         0 | QR           | 1.74405  |\n| VNM          |   2023 |         2 | DTER         | 0.390309 |\n| VNM          |   2023 |         2 | QR           | 1.97817  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.ratio_code,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR fr.quarter = 2) -- Include annual reports and Q2 reports\n    AND mccr.ratio_code IN ('DTER', 'QR') -- Debt-to-Equity Ratio and Quick Ratio\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, fr.ratio_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name                                             | ratio_name           |   year |   quarter |   ratio_value |\n|:-------------|:---------------------------------------------------------|:---------------------|-------:|----------:|--------------:|\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           | Debt To Equity Ratio |   2020 |         0 |      3.62386  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           | Debt To Equity Ratio |   2021 |         0 |      1.97835  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           | Debt To Equity Ratio |   2022 |         0 |      2.85795  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           | Debt To Equity Ratio |   2023 |         0 |      2.85445  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           | Quick Ratio          |   2020 |         0 |      0.451862 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           | Quick Ratio          |   2021 |         0 |      0.899436 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           | Quick Ratio          |   2022 |         0 |      0.514436 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                           | Quick Ratio          |   2023 |         0 |      0.61315  |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Debt To Equity Ratio |   2020 |         0 |      0.290342 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Debt To Equity Ratio |   2021 |         0 |      0.349295 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Debt To Equity Ratio |   2022 |         0 |      0.401541 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Debt To Equity Ratio |   2023 |         0 |      0.336332 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Debt To Equity Ratio |   2024 |         2 |      0.359095 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Quick Ratio          |   2020 |         0 |      3.52024  |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Quick Ratio          |   2021 |         0 |      2.93441  |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Quick Ratio          |   2022 |         0 |      2.69688  |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Quick Ratio          |   2023 |         0 |      2.9677   |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n | Quick Ratio          |   2024 |         2 |      2.9152   |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             | Debt To Equity Ratio |   2020 |         0 |      0.439424 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             | Debt To Equity Ratio |   2021 |         0 |      0.487649 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             | Debt To Equity Ratio |   2022 |         0 |      0.477386 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             | Debt To Equity Ratio |   2023 |         0 |      0.503847 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             | Quick Ratio          |   2020 |         0 |      1.7462   |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             | Quick Ratio          |   2021 |         0 |      1.72213  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             | Quick Ratio          |   2022 |         0 |      1.70628  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                             | Quick Ratio          |   2023 |         0 |      1.74405  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.company_name,\n  mcr.ratio_name,\n  fr.year,\n  fr.quarter,\n  fr.data AS ratio_value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('VNM', 'MSN', 'SAB')\n  AND fr.ratio_code IN ('DTER', 'QR')\n  AND (\n    (fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0)  -- Annual reports for 2020-2023\n    OR (fr.year = 2024 AND fr.quarter = 2)  -- Q2 for 2024\n  )\nORDER BY \n  fr.stock_code, fr.ratio_code, fr.year, fr.quarter\nLIMIT 100;  -- Adjust the limit as necessary\n"
            }
        ],
        "time": 43.957762479782104,
        "evaluate": 0,
        "input_token": 1914,
        "output_token": 679
    },
    {
        "id": "e4a9ec26-1d13-431d-854f-90f02a2024dd",
        "question": "What was the total equity of  Vietcombank's subsidiaries and associated companies as a percentage of Vietcombank's total equity at the end of Q2 2024?",
        "answer": "Table 1\n| equity_percentage   |\n|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify Vietcombank's subsidiaries and associated companies\nWITH vcb_subsidiaries AS (\n    SELECT invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VCB'\n),\n\n-- Step 2: Retrieve the total equity of these subsidiaries and associated companies\nsubsidiaries_equity AS (\n    SELECT SUM(data) AS total_subsidiaries_equity\n    FROM (\n        SELECT data\n        FROM bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n        UNION ALL\n        SELECT data\n        FROM non_bank_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for non-banks\n        UNION ALL\n        SELECT data\n        FROM securities_financial_report\n        WHERE stock_code IN (SELECT invest_on FROM vcb_subsidiaries)\n          AND year = 2024\n          AND quarter = 2\n          AND category_code = 'BS_400' -- Owner's equity for securities\n    ) AS equity_data\n),\n\n-- Step 3: Retrieve Vietcombank's total equity\nvcb_equity AS (\n    SELECT data AS total_vcb_equity\n    FROM bank_financial_report\n    WHERE stock_code = 'VCB'\n      AND year = 2024\n      AND quarter = 2\n      AND category_code = 'BS_500' -- Shareholders\u2019 equity for banks\n)\n\n-- Step 4: Calculate the percentage\nSELECT (subsidiaries_equity.total_subsidiaries_equity / vcb_equity.total_vcb_equity) * 100 AS equity_percentage\nFROM subsidiaries_equity, vcb_equity;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| vietcombank_total_equity   |\n|----------------------------|\n\nTable 2\n| subsidiary_code   |\n|:------------------|\n| PGI               |\n| EIB               |\n| MBB               |\n| HVN               |\n| PVD               |\n| OCB               |\n| EIB               |\n| MBB               |\n| OCB               |\n\nTable 3\n| invest_on   | subsidiary_total_equity   |\n|-------------|---------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  T1.data AS Vietcombank_Total_Equity\nFROM \n  bank_financial_report T1\n  JOIN map_category_code_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code = 'VCB' \n  AND T1.year = 2024 \n  AND T1.quarter = 2 \n  AND T2.category_code = 'BS_500'\nLIMIT 1;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  invest_on AS Subsidiary_Code\nFROM \n  sub_and_shareholder\nWHERE \n  stock_code = 'VCB';\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  T1.invest_on, \n  T2.data AS Subsidiary_Total_Equity\nFROM \n  sub_and_shareholder T1\n  JOIN non_bank_financial_report T2 ON T1.invest_on = T2.stock_code\n  JOIN map_category_code_non_bank T3 ON T2.category_code = T3.category_code\nWHERE \n  T1.stock_code = 'VCB' \n  AND T2.year = 2024 \n  AND T2.quarter = 2 \n  AND T3.category_code = 'BS_400';\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  (SUM(T4.data) / T1.data) * 100 AS Percentage_of_Vietcombank_Total_Equity\nFROM \n  bank_financial_report T1\n  JOIN map_category_code_bank T2 ON T1.category_code = T2.category_code\n  JOIN sub_and_shareholder T3 ON T3.stock_code = T1.stock_code\n  JOIN non_bank_financial_report T4 ON T3.invest_on = T4.stock_code\n  JOIN map_category_code_non_bank T5 ON T4.category_code = T5.category_code\nWHERE \n  T1.stock_code = 'VCB' \n  AND T1.year = 2024 \n  AND T1.quarter = 2 \n  AND T2.category_code = 'BS_500'\n  AND T4.year = 2024 \n  AND T4.quarter = 2 \n  AND T5.category_code = 'BS_400'\nLIMIT 1;\n"
            }
        ],
        "time": 61.32511043548584,
        "evaluate": 0,
        "input_token": 1922,
        "output_token": 1230
    },
    {
        "id": "1ef436da-be56-41ad-a474-7be82fff814b",
        "question": "Rank the top 5 companies with the highest Debt-to-Equity ratio as of December 31, 2023.",
        "answer": "Table 1\n| stock_code   | industry   |   debt_to_equity_ratio |\n|:-------------|:-----------|-----------------------:|\n| BID          | Banking    |                17.7184 |\n| CTG          | Banking    |                15.1483 |\n| STB          | Banking    |                13.746  |\n| HDB          | Banking    |                12.5012 |\n| SHB          | Banking    |                11.5853 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name                                                  |   debttoequityratio |\n|:-------------|:--------------------------------------------------------------|--------------------:|\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |             17.7184 |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |             15.1483 |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |             13.746  |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |             12.5012 |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |             11.5853 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.company_name, -- Assuming company_name exists in company_info for demonstration\n  fr.data AS DebtToEquityRatio\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Debt To Equity Ratio'\n  AND fr.year = 2023\n  AND fr.quarter = 0 -- For annual reports\nORDER BY \n  fr.data DESC -- Highest DTER first\nLIMIT 5;\n"
            }
        ],
        "time": 28.403160095214844,
        "evaluate": 1,
        "input_token": 2702,
        "output_token": 1000
    },
    {
        "id": "23ea7012-1827-4ab6-b0cd-b24116d380df",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and Sacombank from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| STB          |   2020 |         0 | 0.0926219 |\n| STB          |   2021 |         0 | 0.0995728 |\n| STB          |   2022 |         0 | 0.130497  |\n| STB          |   2023 |         0 | 0.168772  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS ROE\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'STB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual data from 2020 to 2023\n        OR (year = 2024 AND quarter = 2) -- Q2 data for 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.company_name, -- Assuming 'company_name' exists in 'company_info'; if not, use 'en_company_name' or the available name field\n    fr.year,\n    fr.quarter,\n    fr.data AS ROE_Value\nFROM \n    financial_ratio fr\nINNER JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nINNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.stock_code IN ('VCB', 'TCB', 'STB')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND fr.quarter = 2  -- Specifically for Q2\nORDER BY \n    fr.stock_code, fr.year, fr.quarter\nLIMIT 100;  -- To adhere to the 'must add limit' instruction; adjust as necessary\n"
            }
        ],
        "time": 33.558783292770386,
        "evaluate": 0,
        "input_token": 2249,
        "output_token": 678
    },
    {
        "id": "4705a2ab-1bb2-400f-895d-b1eea6557de9",
        "question": "What was the average Return on Equity (ROE) for  Vietcombank,  Techcombank, and  Sacombank in 2022, and how did this compare to their respective subsidiaries' average ROE for the same year?",
        "answer": "Table 1\n| bank_code   |   bank_avg_roe |   subsidiary_avg_roe |\n|:------------|---------------:|---------------------:|\n| STB         |       0.130497 |           nan        |\n| TCB         |       0.180176 |           nan        |\n| VCB         |       0.220567 |             0.170252 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_roe AS (\n    SELECT stock_code, AVG(data) AS avg_roe\n    FROM financial_ratio\n    WHERE ratio_code = 'ROE'\n      AND stock_code IN ('VCB', 'TCB', 'STB')\n      AND year = 2022\n      AND quarter = 0\n    GROUP BY stock_code\n),\nsubsidiary_roe AS (\n    SELECT s.stock_code, AVG(fr.data) AS avg_roe\n    FROM sub_and_shareholder s\n    JOIN financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE s.stock_code IN ('VCB', 'TCB', 'STB')\n      AND fr.ratio_code = 'ROE'\n      AND fr.year = 2022\n      AND fr.quarter = 0\n    GROUP BY s.stock_code\n)\nSELECT b.stock_code AS bank_code, b.avg_roe AS bank_avg_roe, s.avg_roe AS subsidiary_avg_roe\nFROM bank_roe b\nLEFT JOIN subsidiary_roe s ON b.stock_code = s.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Error in getting the answer",
        "code_response": "Error in getting the code",
        "evaluate": 0,
        "input_token": 190,
        "output_token": 73
    },
    {
        "id": "650a1eb0-378d-4d82-b07a-acedf00aa716",
        "question": "For the year 2023, what was the combined net income of  VinGroup's subsidiaries and the net income of VinGroup itself, and what percentage of VinGroup's total net income came from its subsidiaries?",
        "answer": "Table 1\n|   total_net_income |   subsidiaries_net_income |   percentage_from_subsidiaries |\n|-------------------:|--------------------------:|-------------------------------:|\n|        4.45219e+07 |               4.94273e+07 |                        111.018 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH vin_subsidiaries AS (\n    SELECT invest_on AS subsidiary_code\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VIC'\n),\nvin_and_subsidiaries_net_income AS (\n    SELECT stock_code, SUM(data) AS net_income\n    FROM non_bank_financial_report\n    WHERE (stock_code = 'VIC' OR stock_code IN (SELECT subsidiary_code FROM vin_subsidiaries))\n      AND year = 2023\n      AND quarter = 0\n      AND category_code = 'IS_030'\n    GROUP BY stock_code\n),\ntotal_net_income AS (\n    SELECT SUM(net_income) AS total_net_income\n    FROM vin_and_subsidiaries_net_income\n),\nsubsidiaries_net_income AS (\n    SELECT SUM(net_income) AS subsidiaries_net_income\n    FROM vin_and_subsidiaries_net_income\n    WHERE stock_code IN (SELECT subsidiary_code FROM vin_subsidiaries)\n)\nSELECT \n    tni.total_net_income,\n    sni.subsidiaries_net_income,\n    (sni.subsidiaries_net_income / tni.total_net_income) * 100 AS percentage_from_subsidiaries\nFROM total_net_income tni, subsidiaries_net_income sni;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| vin_group_net_income   |\n|------------------------|\n\nTable 2\n| subsidiary_net_income   | subsidiary_stock_code   |\n|-------------------------|-------------------------|\n\nTable 3\n| combined_net_income   | percentage_from_subsidiaries   |\n|:----------------------|:-------------------------------|\n|                       |                                |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT invest_on AS subsidiary_stock_code\nFROM sub_and_shareholder\nWHERE stock_code = 'VIC';\n"
            },
            {
                "language": "sql",
                "code": "-- Hypothetical, assuming IS_XXX is the actual code for Net Income\nSELECT 'IS_XXX' AS category_code;\n"
            },
            {
                "language": "sql",
                "code": "-- For VinGroup\nSELECT data AS vin_group_net_income\nFROM non_bank_financial_report\nWHERE stock_code = 'VIC'\n  AND year = 2023\n  AND quarter = 0\n  AND category_code = 'IS_XXX';\n\n-- For Subsidiaries\nSELECT T2.data AS subsidiary_net_income, T1.invest_on AS subsidiary_stock_code\nFROM sub_and_shareholder T1\nJOIN non_bank_financial_report T2 ON T1.invest_on = T2.stock_code\nWHERE T1.stock_code = 'VIC'\n  AND T2.year = 2023\n  AND T2.quarter = 0\n  AND T2.category_code = 'IS_XXX';\n"
            },
            {
                "language": "sql",
                "code": "WITH \n  -- VinGroup's Net Income\n  VinGroupIncome AS (\n    SELECT data AS net_income\n    FROM non_bank_financial_report\n    WHERE stock_code = 'VIC'\n      AND year = 2023\n      AND quarter = 0\n      AND category_code = 'IS_XXX'  -- Replace with actual code\n  ),\n  \n  -- Subsidiaries' Net Income\n  SubsidiariesIncome AS (\n    SELECT T2.data AS net_income\n    FROM sub_and_shareholder T1\n    JOIN non_bank_financial_report T2 ON T1.invest_on = T2.stock_code\n    WHERE T1.stock_code = 'VIC'\n      AND T2.year = 2023\n      AND T2.quarter = 0\n      AND T2.category_code = 'IS_XXX'  -- Replace with actual code\n  )\n\nSELECT \n  -- Combined Net Income\n  (SELECT SUM(net_income) FROM SubsidiariesIncome) + (SELECT net_income FROM VinGroupIncome) AS combined_net_income,\n  \n  -- Percentage from Subsidiaries\n  (SELECT SUM(net_income) FROM SubsidiariesIncome) * 100.0 / \n  ((SELECT SUM(net_income) FROM SubsidiariesIncome) + (SELECT net_income FROM VinGroupIncome)) AS percentage_from_subsidiaries\n\nLIMIT 1;\n"
            }
        ],
        "time": 46.08221650123596,
        "evaluate": 0,
        "input_token": 1714,
        "output_token": 1028
    },
    {
        "id": "48a8fa57-c0d7-4ba7-879f-5dbe2a9228cc",
        "question": "Compare the Net Profit Margin and the Debt-to-Equity ratio of Vinamilk and Masan Group from 2020 to Q2 2024.  Analyze the changes in their total assets and total liabilities during this period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_code   |   ratio_value |\n|:-------------|-------:|----------:|:-------------|--------------:|\n| MSN          |   2020 |         0 | DTER         |      3.62386  |\n| MSN          |   2021 |         0 | DTER         |      1.97835  |\n| MSN          |   2022 |         0 | DTER         |      2.85795  |\n| MSN          |   2023 |         0 | DTER         |      2.85445  |\n| VNM          |   2020 |         0 | DTER         |      0.439424 |\n| VNM          |   2021 |         0 | DTER         |      0.487649 |\n| VNM          |   2022 |         0 | DTER         |      0.477386 |\n| VNM          |   2023 |         0 | DTER         |      0.503847 |\n\nTable 2\n| stock_code   |   year |   quarter | category_code   |       value |\n|:-------------|-------:|----------:|:----------------|------------:|\n| MSN          |   2020 |         0 | BS_270          | 1.15737e+08 |\n| MSN          |   2020 |         0 | BS_300          | 9.07063e+07 |\n| MSN          |   2021 |         0 | BS_270          | 1.26093e+08 |\n| MSN          |   2021 |         0 | BS_300          | 8.37568e+07 |\n| MSN          |   2022 |         0 | BS_270          | 1.41343e+08 |\n| MSN          |   2022 |         0 | BS_300          | 1.04706e+08 |\n| MSN          |   2023 |         0 | BS_270          | 1.47383e+08 |\n| MSN          |   2023 |         0 | BS_300          | 1.09146e+08 |\n| VNM          |   2020 |         0 | BS_270          | 4.84325e+07 |\n| VNM          |   2020 |         0 | BS_300          | 1.47854e+07 |\n| VNM          |   2021 |         0 | BS_270          | 5.33324e+07 |\n| VNM          |   2021 |         0 | BS_300          | 1.74823e+07 |\n| VNM          |   2022 |         0 | BS_270          | 4.84827e+07 |\n| VNM          |   2022 |         0 | BS_300          | 1.56661e+07 |\n| VNM          |   2023 |         0 | BS_270          | 5.26734e+07 |\n| VNM          |   2023 |         0 | BS_300          | 1.76476e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    ratio_code,\n    data AS ratio_value\nFROM \n    financial_ratio\nWHERE \n    stock_code IN ('VNM', 'MSN')\n    AND ratio_code IN ('NPM', 'DTER')\n    AND ((year = 2020 AND quarter = 0) OR (year = 2021 AND quarter = 0) OR (year = 2022 AND quarter = 0) OR (year = 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter, ratio_code;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    category_code,\n    data AS value\nFROM \n    non_bank_financial_report\nWHERE \n    stock_code IN ('VNM', 'MSN')\n    AND category_code IN ('BS_270', 'BS_300') -- BS_270 for Total Assets, BS_300 for Total Liabilities\n    AND ((year = 2020 AND quarter = 0) OR (year = 2021 AND quarter = 0) OR (year = 2022 AND quarter = 0) OR (year = 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter, category_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| ratio_type   |   year |   quarter | stock_code   |   ratio_value |\n|:-------------|-------:|----------:|:-------------|--------------:|\n| DTER         |   2020 |         0 | MSN          |      3.62386  |\n| DTER         |   2021 |         0 | MSN          |      1.97835  |\n| DTER         |   2022 |         0 | MSN          |      2.85795  |\n| DTER         |   2023 |         0 | MSN          |      2.85445  |\n| DTER         |   2020 |         0 | VNM          |      0.439424 |\n| DTER         |   2021 |         0 | VNM          |      0.487649 |\n| DTER         |   2022 |         0 | VNM          |      0.477386 |\n| DTER         |   2023 |         0 | VNM          |      0.503847 |\n\nTable 2\n| metric            |   year |   quarter | stock_code   |   metric_value |\n|:------------------|-------:|----------:|:-------------|---------------:|\n| Total Assets      |   2020 |         0 | VNM          |    2.96657e+07 |\n| Total Assets      |   2021 |         0 | VNM          |    3.61099e+07 |\n| Total Assets      |   2022 |         0 | VNM          |    3.15604e+07 |\n| Total Assets      |   2023 |         0 | VNM          |    3.59359e+07 |\n| Total Assets      |   2020 |         0 | MSN          |    2.97607e+07 |\n| Total Assets      |   2021 |         0 | MSN          |    4.36302e+07 |\n| Total Assets      |   2022 |         0 | MSN          |    4.76746e+07 |\n| Total Assets      |   2023 |         0 | MSN          |    4.37635e+07 |\n| Total Liabilities |   2020 |         0 | VNM          |    1.87668e+07 |\n| Total Liabilities |   2021 |         0 | VNM          |    1.72225e+07 |\n| Total Liabilities |   2022 |         0 | VNM          |    1.69223e+07 |\n| Total Liabilities |   2023 |         0 | VNM          |    1.67375e+07 |\n| Total Liabilities |   2020 |         0 | MSN          |    8.59759e+07 |\n| Total Liabilities |   2021 |         0 | MSN          |    8.24633e+07 |\n| Total Liabilities |   2022 |         0 | MSN          |    9.36682e+07 |\n| Total Liabilities |   2023 |         0 | MSN          |    1.0362e+08  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Given the complexity and the need to union non-bank reports (as both VNM and MSN are non-bank),\n-- we first identify the ratio codes and then query the financial_ratio table.\n\n-- Step 1: Identify Ratio Codes (Already identified from the mapping table)\n-- NPM for Net Profit Margin\n-- DTER for Debt To Equity Ratio\n\n-- Step 2: Query Financial Ratios for VNM and MSN from 2020 to Q2 2024\nSELECT \n    'NPM' AS Ratio_Type, \n    fr.year, \n    fr.quarter, \n    ci.stock_code, \n    fr.data AS Ratio_Value\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nJOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    mcr.ratio_code = 'NPM'\n    AND ci.stock_code IN ('VNM', 'MSN')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\n\nUNION ALL\n\nSELECT \n    'DTER' AS Ratio_Type, \n    fr.year, \n    fr.quarter, \n    ci.stock_code, \n    fr.data AS Ratio_Value\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nJOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    mcr.ratio_code = 'DTER'\n    AND ci.stock_code IN ('VNM', 'MSN')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\n\n-- Limit the output for practicality\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n    'Total Assets' AS Metric, \n    nfr.year, \n    nfr.quarter, \n    ci.stock_code, \n    nfr.data AS Metric_Value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    company_info ci ON nfr.stock_code = ci.stock_code\nJOIN \n    map_category_code_non_bank mcnb ON nfr.category_code = mcnb.category_code\nWHERE \n    mcnb.category_code = 'BS_100'\n    AND ci.stock_code IN ('VNM', 'MSN')\n    AND nfr.year BETWEEN 2020 AND 2024\n    AND (nfr.quarter = 0 OR (nfr.year = 2024 AND nfr.quarter = 2))\n\nUNION ALL\n\nSELECT \n    'Total Liabilities' AS Metric, \n    nfr.year, \n    nfr.quarter, \n    ci.stock_code, \n    nfr.data AS Metric_Value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    company_info ci ON nfr.stock_code = ci.stock_code\nJOIN \n    map_category_code_non_bank mcnb ON nfr.category_code = mcnb.category_code\nWHERE \n    mcnb.category_code = 'BS_200'\n    AND ci.stock_code IN ('VNM', 'MSN')\n    AND nfr.year BETWEEN 2020 AND 2024\n    AND (nfr.quarter = 0 OR (nfr.year = 2024 AND nfr.quarter = 2))\n\nLIMIT 100;\n"
            }
        ],
        "time": 49.80625033378601,
        "evaluate": 0,
        "input_token": 2002,
        "output_token": 1337
    },
    {
        "id": "ba73d2eb-be40-43aa-aae0-07913d6003b2",
        "question": "What are the top 10 companies with the lowest Return on Equity (ROE) for the fiscal year 2022?",
        "answer": "Table 1\n| stock_code   | industry                             |    roe_value |\n|:-------------|:-------------------------------------|-------------:|\n| VJC          | Travel and Leisure                   | -0.151828    |\n| NKG          | Basic Resources                      | -0.0234384   |\n| NVB          | Banking                              |  1.38787e-06 |\n| DBC          | Food and Beverages                   |  0.0011191   |\n| NHA          | Construction and Materials           |  0.00438288  |\n| HLD          | Real Estate                          |  0.0115416   |\n| VIC          | Real Estate                          |  0.0150701   |\n| YEG          | Media                                |  0.0274488   |\n| PVG          | Utilities (Electricity, Water & Gas) |  0.032697    |\n| PVC          | Oil and Gas                          |  0.0327001   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe_value\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2022\n    AND fr.quarter = 0\nORDER BY \n    fr.data ASC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry                             |    roe_value |\n|:-------------|:-------------------------------------|-------------:|\n| VJC          | Travel and Leisure                   | -0.151828    |\n| NKG          | Basic Resources                      | -0.0234384   |\n| NVB          | Banking                              |  1.38787e-06 |\n| DBC          | Food and Beverages                   |  0.0011191   |\n| NHA          | Construction and Materials           |  0.00438288  |\n| HLD          | Real Estate                          |  0.0115416   |\n| VIC          | Real Estate                          |  0.0150701   |\n| YEG          | Media                                |  0.0274488   |\n| PVG          | Utilities (Electricity, Water & Gas) |  0.032697    |\n| PVC          | Oil and Gas                          |  0.0327001   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  ci.stock_code, \n  ci.industry, \n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Return On Equity' \n  AND fr.year = 2022 \n  AND fr.quarter = 0\nORDER BY \n  fr.data ASC  -- ASC for the lowest values\nLIMIT 10;\n"
            }
        ],
        "time": 24.532310962677002,
        "evaluate": 1,
        "input_token": 2212,
        "output_token": 639
    },
    {
        "id": "94513aff-57b5-4d36-8a98-bdf527d9190f",
        "question": "What is the trend of the Net Profit Margin ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_profit_margin\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'NPM'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (1, 2))\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name   | year   | quarter   | netprofitmargin   |\n|--------------|-------------------|--------|-----------|-------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.en_company_name,  -- Assuming en_company_name exists in company_info for clarity\n    fr.year,\n    fr.quarter,\n    fr.data AS NetProfitMargin\nFROM \n    financial_ratio fr\nINNER JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nINNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.ratio_code = 'NPM'  -- Net Profit Margin\n    AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0)  -- Annual reports up to 2023\n        OR (fr.year = 2024 AND fr.quarter = 2)  -- Q2 of 2024\n    )\nORDER BY \n    fr.stock_code, fr.year, fr.quarter\nLIMIT 100;  -- Adding a limit as per the instructions\n"
            }
        ],
        "time": 27.340880632400513,
        "evaluate": 0,
        "input_token": 2438,
        "output_token": 891
    },
    {
        "id": "1f330071-6ed3-48d3-912a-2bad5446636b",
        "question": "For Q4 2023, what was the Debt-to-Equity ratio for Mobile World Investment and Vinamilk, and how do these ratios change when considering the debt and equity of their subsidiaries and associated companies?",
        "answer": "Table 1\n| entity_type   | stock_code   | invest_on   |     dter |\n|:--------------|:-------------|:------------|---------:|\n| Parent        | MWG          |             | 1.57316  |\n| Parent        | VNM          |             | 0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify subsidiaries and associated companies for MWG and VNM\nWITH subsidiaries AS (\n    SELECT stock_code, invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code IN ('MWG', 'VNM')\n),\n\n-- Step 2: Retrieve Debt-to-Equity Ratio for MWG and VNM for Q4 2023\nparent_dter AS (\n    SELECT stock_code, data AS dter\n    FROM financial_ratio\n    WHERE ratio_code = 'DTER'\n      AND stock_code IN ('MWG', 'VNM')\n      AND year = 2023\n      AND quarter = 4\n),\n\n-- Step 3: Retrieve Debt-to-Equity Ratio for subsidiaries and associated companies for Q4 2023\nsubsidiary_dter AS (\n    SELECT s.stock_code, s.invest_on, fr.data AS dter\n    FROM subsidiaries s\n    JOIN financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE fr.ratio_code = 'DTER'\n      AND fr.year = 2023\n      AND fr.quarter = 4\n)\n\n-- Step 4: Combine the results\nSELECT 'Parent' AS entity_type, stock_code, NULL AS invest_on, dter\nFROM parent_dter\nUNION ALL\nSELECT 'Subsidiary', stock_code, invest_on, dter\nFROM subsidiary_dter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |   debttoequityratio |\n|:-------------|--------------------:|\n| MWG          |            1.57316  |\n| VNM          |            0.503847 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RelevantCompanies AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('MWG', 'VNM')\n),\nSubsidiariesAndAssociated AS (\n  SELECT \n    CASE \n      WHEN stock_code IN (SELECT stock_code FROM RelevantCompanies) THEN invest_on\n      ELSE stock_code \n    END AS RelevantStockCode\n  FROM sub_and_shareholder\n  WHERE stock_code IN (SELECT stock_code FROM RelevantCompanies)\n  OR invest_on IN (SELECT stock_code FROM RelevantCompanies)\n),\nCombinedStockCodes AS (\n  SELECT stock_code FROM RelevantCompanies\n  UNION\n  SELECT RelevantStockCode FROM SubsidiariesAndAssociated\n)\nSELECT \n  C.stock_code,\n  FR.data AS DebtToEquityRatio\nFROM CombinedStockCodes C\nJOIN financial_ratio FR ON C.stock_code = FR.stock_code\nJOIN map_category_code_ratio MCR ON FR.ratio_code = MCR.ratio_code\nWHERE \n  MCR.ratio_name = 'Debt To Equity Ratio'\n  AND FR.year = 2023\n  AND FR.quarter = 4  -- Adjusted to reflect Q4, as per the task's specific request\nLIMIT 100;  -- Added to comply with the database access note\n"
            }
        ],
        "time": 32.30555033683777,
        "evaluate": 1,
        "input_token": 1953,
        "output_token": 783
    },
    {
        "id": "090710f9-3867-4922-9703-fd2af16e09e9",
        "question": "Calculate the Debt-to-Equity ratio for  Vinamilk,  Masan Group, and their significant subsidiaries in 2023 Q2.  Analyze the differences in leverage between the parent companies and their subsidiaries.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|-------:|----------:|-----------------------:|\n| MSN          |   2023 |         2 |               2.75379  |\n| VNM          |   2023 |         2 |               0.390309 |\n| TCB          |   2023 |         2 |               4.98106  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH parent_companies AS (\n    SELECT 'VNM' AS stock_code\n    UNION\n    SELECT 'MSN'\n),\nsubsidiaries AS (\n    SELECT invest_on AS stock_code\n    FROM sub_and_shareholder\n    WHERE stock_code IN (SELECT stock_code FROM parent_companies)\n),\nall_relevant_companies AS (\n    SELECT stock_code FROM parent_companies\n    UNION\n    SELECT stock_code FROM subsidiaries\n)\nSELECT fr.stock_code, fr.year, fr.quarter, fr.data AS debt_to_equity_ratio\nFROM financial_ratio fr\nJOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE mcr.ratio_name = 'Debt To Equity Ratio'\nAND fr.stock_code IN (SELECT stock_code FROM all_relevant_companies)\nAND fr.year = 2023\nAND fr.quarter = 2;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter |     dter |\n|:-------------|-------:|----------:|---------:|\n| MSN          |   2023 |         2 | 2.75379  |\n| VNM          |   2023 |         2 | 0.390309 |\n| TCB          |   2023 |         2 | 4.98106  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Identify Vinamilk, Masan Group, and their Subsidiaries\nRelevantCompanies AS (\n  SELECT 'VNM' AS stock_code UNION\n  SELECT 'MSN' UNION\n  SELECT invest_on FROM sub_and_shareholder WHERE stock_code IN ('VNM', 'MSN')\n),\n\n-- Collect DTER for Relevant Companies from Financial Ratio Table (Assuming DTER is Directly Available)\nDTERatios AS (\n  SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS DTER\n  FROM \n    financial_ratio fr\n  INNER JOIN \n    RelevantCompanies rc ON fr.stock_code = rc.stock_code\n  WHERE \n    fr.ratio_code = 'DTER' AND\n    fr.year = 2023 AND\n    fr.quarter = 2  -- Q2\n)\n\n-- Union with Bank and Securities Reports if Necessary (Assuming Subsidiaries Could Be in Different Sectors)\n-- NOTE: Since the direct calculation of DTER or its components isn't fully detailed for all sectors in the question,\n--       and given the instruction to select from the database instead of calculating, this part is conceptually included\n--       but not fully elaborated due to the complexity and assumptions required.\n\nSELECT * FROM DTERatios\nLIMIT 100;  -- To adhere to the instruction of adding a LIMIT\n"
            }
        ],
        "time": 44.98446226119995,
        "evaluate": 1,
        "input_token": 1786,
        "output_token": 909
    },
    {
        "id": "bb6f60b5-01dc-41a5-a518-ba2edf9f457b",
        "question": "Compare the evolution of the Debt-to-Equity ratio and the Current Ratio for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Analyze the implications of these ratios on the financial risk profile of each company.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name           |   ratio_value |\n|:-------------|-------:|----------:|:---------------------|--------------:|\n| HPG          |   2020 |         0 | Current Ratio        |      1.09453  |\n| HPG          |   2020 |         0 | Debt To Equity Ratio |      1.22073  |\n| HPG          |   2021 |         0 | Current Ratio        |      1.28577  |\n| HPG          |   2021 |         0 | Debt To Equity Ratio |      0.963375 |\n| HPG          |   2022 |         0 | Current Ratio        |      1.29573  |\n| HPG          |   2022 |         0 | Debt To Equity Ratio |      0.772243 |\n| HPG          |   2023 |         0 | Current Ratio        |      1.16128  |\n| HPG          |   2023 |         0 | Debt To Equity Ratio |      0.826032 |\n| HPG          |   2024 |         2 | Current Ratio        |      1.15441  |\n| HPG          |   2024 |         2 | Debt To Equity Ratio |      0.901137 |\n| MSN          |   2020 |         0 | Current Ratio        |      0.773354 |\n| MSN          |   2020 |         0 | Debt To Equity Ratio |      3.62386  |\n| MSN          |   2021 |         0 | Current Ratio        |      1.27032  |\n| MSN          |   2021 |         0 | Debt To Equity Ratio |      1.97835  |\n| MSN          |   2022 |         0 | Current Ratio        |      0.73558  |\n| MSN          |   2022 |         0 | Debt To Equity Ratio |      2.85795  |\n| MSN          |   2023 |         0 | Current Ratio        |      0.874439 |\n| MSN          |   2023 |         0 | Debt To Equity Ratio |      2.85445  |\n| VNM          |   2020 |         0 | Current Ratio        |      2.09132  |\n| VNM          |   2020 |         0 | Debt To Equity Ratio |      0.439424 |\n| VNM          |   2021 |         0 | Current Ratio        |      2.11895  |\n| VNM          |   2021 |         0 | Debt To Equity Ratio |      0.487649 |\n| VNM          |   2022 |         0 | Current Ratio        |      2.06801  |\n| VNM          |   2022 |         0 | Debt To Equity Ratio |      0.477386 |\n| VNM          |   2023 |         0 | Current Ratio        |      2.1016   |\n| VNM          |   2023 |         0 | Debt To Equity Ratio |      0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'HPG')\n    AND mccr.ratio_name IN ('Debt To Equity Ratio', 'Current Ratio')\n    AND (\n        (fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR\n        (fr.year = 2024 AND fr.quarter = 2)\n    )\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, mccr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | ratio_name           |   year |   quarter |   ratio_value |\n|:-------------|:---------------------|-------:|----------:|--------------:|\n| HPG          | Current Ratio        |   2020 |         0 |      1.09453  |\n| HPG          | Current Ratio        |   2021 |         0 |      1.28577  |\n| HPG          | Current Ratio        |   2022 |         0 |      1.29573  |\n| HPG          | Current Ratio        |   2023 |         0 |      1.16128  |\n| HPG          | Current Ratio        |   2024 |         2 |      1.15441  |\n| HPG          | Debt To Equity Ratio |   2020 |         0 |      1.22073  |\n| HPG          | Debt To Equity Ratio |   2021 |         0 |      0.963375 |\n| HPG          | Debt To Equity Ratio |   2022 |         0 |      0.772243 |\n| HPG          | Debt To Equity Ratio |   2023 |         0 |      0.826032 |\n| HPG          | Debt To Equity Ratio |   2024 |         2 |      0.901137 |\n| MSN          | Current Ratio        |   2020 |         0 |      0.773354 |\n| MSN          | Current Ratio        |   2021 |         0 |      1.27032  |\n| MSN          | Current Ratio        |   2022 |         0 |      0.73558  |\n| MSN          | Current Ratio        |   2023 |         0 |      0.874439 |\n| MSN          | Debt To Equity Ratio |   2020 |         0 |      3.62386  |\n| MSN          | Debt To Equity Ratio |   2021 |         0 |      1.97835  |\n| MSN          | Debt To Equity Ratio |   2022 |         0 |      2.85795  |\n| MSN          | Debt To Equity Ratio |   2023 |         0 |      2.85445  |\n| VNM          | Current Ratio        |   2020 |         0 |      2.09132  |\n| VNM          | Current Ratio        |   2021 |         0 |      2.11895  |\n| VNM          | Current Ratio        |   2022 |         0 |      2.06801  |\n| VNM          | Current Ratio        |   2023 |         0 |      2.1016   |\n| VNM          | Debt To Equity Ratio |   2020 |         0 |      0.439424 |\n| VNM          | Debt To Equity Ratio |   2021 |         0 |      0.487649 |\n| VNM          | Debt To Equity Ratio |   2022 |         0 |      0.477386 |\n| VNM          | Debt To Equity Ratio |   2023 |         0 |      0.503847 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Confirm Ratio Codes (Not strictly necessary given the direct reference, but for clarity)\nRatioCodes AS (\n  SELECT ratio_code, ratio_name\n  FROM map_category_code_ratio\n  WHERE ratio_name IN ('Debt To Equity Ratio', 'Current Ratio')\n),\n\n-- Filter Companies of Interest\nCompanies AS (\n  SELECT stock_code\n  FROM company_info\n  WHERE stock_code IN ('VNM', 'MSN', 'HPG')\n),\n\n-- Main Query: Fetching Desired Ratios for Companies over Time\nMainQuery AS (\n  SELECT \n    fr.stock_code,\n    c.ratio_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS ratio_value\n  FROM \n    financial_ratio fr\n  INNER JOIN \n    RatioCodes c ON fr.ratio_code = c.ratio_code\n  INNER JOIN \n    Companies co ON fr.stock_code = co.stock_code\n  WHERE \n    fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))  -- Annual data or Q2 2024\n)\n-- Final Presentation\nSELECT \n  stock_code,\n  ratio_name,\n  year,\n  quarter,\n  ratio_value\nFROM \n  MainQuery\nORDER BY \n  stock_code, ratio_name, year, quarter\nLIMIT 100;  -- To adhere to the limit requirement\n"
            }
        ],
        "time": 63.293628454208374,
        "evaluate": 1,
        "input_token": 2057,
        "output_token": 768
    },
    {
        "id": "113431fd-d8a9-4fcc-b8e4-44bb3cc73663",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) in 2023, based on their financial statements.",
        "answer": "Table 1\n| stock_code   | industry           |      roe |\n|:-------------|:-------------------|---------:|\n| TMB          | Basic Resources    | 0.476625 |\n| SLS          | Food and Beverages | 0.443074 |\n| CAP          | Basic Resources    | 0.43171  |\n| SAF          | Food and Beverages | 0.2894   |\n| DGC          | Chemicals          | 0.269533 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | ratio_name       |   roe_value |\n|:-------------|:-----------------|------------:|\n| TMB          | Return On Equity |    0.476625 |\n| SLS          | Return On Equity |    0.443074 |\n| CAP          | Return On Equity |    0.43171  |\n| SAF          | Return On Equity |    0.2894   |\n| DGC          | Return On Equity |    0.269533 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code, \n  mcr.ratio_name, \n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Return On Equity' \n  AND fr.year = 2023 \n  AND fr.quarter = 0\nORDER BY \n  fr.data DESC\nLIMIT \n  5;\n"
            }
        ],
        "time": 47.38209342956543,
        "evaluate": 1,
        "input_token": 2024,
        "output_token": 565
    },
    {
        "id": "12a7a240-a91a-45cd-b870-50f2826a2e66",
        "question": "What are the top 10 companies with the lowest Debt-to-Equity ratio from 2020 to Q2 2024, calculated as Total Debt divided by Total Equity, and how did this ratio change for each company over this period?",
        "answer": "Table 1\n| stock_code   | company_name                                                  |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|:--------------------------------------------------------------|-------:|----------:|-----------------------:|\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2023 |         0 |               0.102494 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2020 |         0 |               0.125015 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2023 |         0 |               0.136624 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2020 |         0 |               0.17039  |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2023 |         0 |               0.176222 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2024 |         2 |               0.179365 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2021 |         0 |               0.188442 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2022 |         0 |               0.200008 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2024 |         2 |               0.206202 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2024 |         2 |               0.209858 |\n| TCH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 D\u1ecbch v\u1ee5 T\u00e0i ch\u00ednh Ho\u00e0ng Huy            |   2022 |         0 |               0.216221 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2021 |         0 |               0.235643 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2022 |         0 |               0.237365 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2023 |         0 |               0.259786 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2020 |         0 |               0.276946 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2022 |         0 |               0.277531 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2021 |         0 |               0.277955 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2021 |         0 |               0.287564 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2020 |         0 |               0.290342 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2023 |         0 |               0.291759 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2023 |         0 |               0.297329 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2024 |         2 |               0.310486 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2022 |         0 |               0.33581  |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2023 |         0 |               0.336332 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2023 |         0 |               0.343894 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2023 |         0 |               0.344899 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2021 |         0 |               0.345608 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2021 |         0 |               0.349295 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2022 |         0 |               0.351281 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2022 |         0 |               0.353514 |\n| VRE          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vincom Retail                                 |   2020 |         0 |               0.357263 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2024 |         2 |               0.359095 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2022 |         0 |               0.368554 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2024 |         2 |               0.369029 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2020 |         0 |               0.377942 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2023 |         0 |               0.394739 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n      |   2022 |         0 |               0.401541 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2022 |         0 |               0.402429 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2021 |         0 |               0.406165 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2020 |         0 |               0.408761 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2021 |         0 |               0.414164 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2023 |         0 |               0.419899 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2020 |         0 |               0.423653 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2024 |         2 |               0.435372 |\n| HLD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n B\u1ea5t \u0111\u1ed9ng s\u1ea3n HUDLAND     |   2022 |         0 |               0.43865  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2020 |         0 |               0.439424 |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang                   |   2020 |         0 |               0.444683 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2023 |         0 |               0.457793 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2020 |         0 |               0.463731 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2022 |         0 |               0.46592  |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2023 |         0 |               0.471272 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2020 |         0 |               0.474374 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2022 |         0 |               0.477386 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2021 |         0 |               0.480607 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2024 |         2 |               0.483638 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2021 |         0 |               0.487649 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam                                  |   2023 |         0 |               0.503847 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2020 |         0 |               0.504436 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2023 |         0 |               0.508928 |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n                   |   2021 |         0 |               0.509177 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2021 |         0 |               0.521258 |\n| DCM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e2n b\u00f3n D\u1ea7u Kh\u00ed C\u00e0 Mau                       |   2023 |         0 |               0.529397 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2021 |         0 |               0.543834 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2020 |         0 |               0.545038 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                                     |   2023 |         0 |               0.554623 |\n| GVR          | T\u1eadp \u0111o\u00e0n C\u00f4ng nghi\u1ec7p Cao su Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n        |   2020 |         0 |               0.560901 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2022 |         0 |               0.561239 |\n| YEG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Yeah1                                |   2021 |         0 |               0.563492 |\n| VCS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n VICOSTONE                                     |   2020 |         0 |               0.569625 |\n| SAF          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u01b0\u01a1ng th\u1ef1c Th\u1ef1c ph\u1ea9m SAFOCO                   |   2021 |         0 |               0.571747 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2024 |         2 |               0.576112 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2022 |         0 |               0.579462 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2023 |         0 |               0.581221 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2023 |         0 |               0.593005 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2023 |         0 |               0.603542 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2020 |         0 |               0.618346 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2022 |         0 |               0.632072 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2021 |         0 |               0.642793 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2023 |         0 |               0.660318 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2022 |         0 |               0.682692 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i                |   2024 |         2 |               0.687472 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2022 |         0 |               0.694971 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2021 |         0 |               0.702049 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2024 |         2 |               0.705204 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2023 |         0 |               0.705913 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2022 |         0 |               0.707956 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2020 |         0 |               0.708054 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2023 |         0 |               0.719185 |\n| LAS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Supe Ph\u1ed1t ph\u00e1t v\u00e0 H\u00f3a ch\u1ea5t L\u00e2m Thao           |   2021 |         0 |               0.722437 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2023 |         0 |               0.722593 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2022 |         0 |               0.725978 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2022 |         0 |               0.728122 |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2020 |         0 |               0.728687 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2023 |         0 |               0.750505 |\n| TIG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 Th\u0103ng Long                    |   2021 |         0 |               0.751401 |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2021 |         0 |               0.754212 |\n| LHC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng Th\u1ee7y l\u1ee3i L\u00e2m \u0110\u1ed3ng          |   2021 |         0 |               0.755797 |\n| PNJ          | C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u00e0ng b\u1ea1c \u0110\u00e1 qu\u00fd Ph\u00fa Nhu\u1eadn                     |   2021 |         0 |               0.766117 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2020 |         0 |               0.766169 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2022 |         0 |               0.772243 |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2023 |         0 |               0.772254 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2022 |         0 |               0.778332 |\n| NHA          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Nh\u00e0 v\u00e0 \u0110\u00f4 th\u1ecb Nam H\u00e0 N\u1ed9i       |   2021 |         0 |               0.779472 |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2024 |         2 |               0.78104  |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2022 |         0 |               0.788825 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2021 |         0 |               0.794179 |\n| NTP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Nh\u1ef1a Thi\u1ebfu ni\u00ean Ti\u1ec1n Phong                    |   2021 |         0 |               0.808803 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2022 |         0 |               0.815038 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2021 |         0 |               0.816257 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2023 |         0 |               0.826032 |\n| KDH          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Kinh doanh nh\u00e0 Khang \u0110i\u1ec1n           |   2022 |         0 |               0.826206 |\n| DHT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c ph\u1ea9m H\u00e0 T\u00e2y                              |   2022 |         0 |               0.839544 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2021 |         0 |               0.845713 |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2024 |         2 |               0.874097 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2022 |         0 |               0.898412 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2024 |         2 |               0.901137 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2024 |         2 |               0.93525  |\n| PVT          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n V\u1eadn t\u1ea3i D\u1ea7u kh\u00ed                          |   2023 |         0 |               0.936787 |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2021 |         0 |               0.941665 |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2024 |         2 |               0.949132 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2023 |         0 |               0.950352 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2021 |         0 |               0.963375 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                              |   2020 |         0 |               0.974251 |\n| VGI          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Qu\u1ed1c t\u1ebf Viettel                   |   2020 |         0 |               0.975521 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2021 |         0 |               0.982156 |\n| CEO          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C.E.O                                |   2021 |         0 |               0.991947 |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2022 |         0 |               0.994639 |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2023 |         0 |               1.01392  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2023 |         0 |               1.02916  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2020 |         0 |               1.03173  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2022 |         0 |               1.037    |\n| PVS          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 K\u1ef9 thu\u1eadt D\u1ea7u kh\u00ed Vi\u1ec7t Nam        |   2020 |         0 |               1.03966  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2023 |         0 |               1.04948  |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2023 |         0 |               1.06223  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2022 |         0 |               1.09689  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2022 |         0 |               1.10132  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2021 |         0 |               1.11143  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2024 |         2 |               1.12275  |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2022 |         0 |               1.13455  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2020 |         0 |               1.14525  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2022 |         0 |               1.1527   |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t                             |   2020 |         0 |               1.22073  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2023 |         0 |               1.22591  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2020 |         0 |               1.2431   |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2023 |         0 |               1.25617  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2021 |         0 |               1.25925  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2024 |         2 |               1.26119  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2021 |         0 |               1.29267  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2021 |         0 |               1.31812  |\n| CMG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n C\u00f4ng ngh\u1ec7 CMC                        |   2021 |         0 |               1.32573  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2022 |         0 |               1.33297  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2021 |         0 |               1.34428  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2024 |         2 |               1.35003  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2023 |         0 |               1.35495  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2023 |         0 |               1.36439  |\n| POW          | T\u1ed5ng C\u00f4ng ty \u0110i\u1ec7n l\u1ef1c D\u1ea7u kh\u00ed Vi\u1ec7t Nam - CTCP                 |   2024 |         2 |               1.36986  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2022 |         0 |               1.37252  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2024 |         2 |               1.39121  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2020 |         0 |               1.40109  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2020 |         0 |               1.41587  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2023 |         0 |               1.43451  |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                      |   2022 |         0 |               1.43609  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2020 |         0 |               1.44044  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2023 |         0 |               1.46271  |\n| DTD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Ph\u00e1t tri\u1ec3n Th\u00e0nh \u0110\u1ea1t                   |   2021 |         0 |               1.47419  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2024 |         2 |               1.48784  |\n| FPT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n FPT                                           |   2021 |         0 |               1.50714  |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2023 |         0 |               1.51354  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2022 |         0 |               1.53038  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2020 |         0 |               1.53275  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2021 |         0 |               1.54511  |\n| DXG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea5t Xanh                             |   2020 |         0 |               1.5662   |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2023 |         0 |               1.5733   |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2024 |         2 |               1.60012  |\n| PLX          | T\u1eadp \u0111o\u00e0n X\u0103ng d\u1ea7u Vi\u1ec7t Nam                                    |   2022 |         0 |               1.68066  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2021 |         0 |               1.68459  |\n| NKG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Th\u00e9p Nam Kim                                  |   2021 |         0 |               1.69044  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2022 |         0 |               1.69096  |\n| PVC          | T\u1ed5ng C\u00f4ng ty H\u00f3a ch\u1ea5t v\u00e0 D\u1ecbch v\u1ee5 D\u1ea7u kh\u00ed - C\u00f4ng ty C\u1ed5 ph\u1ea7n    |   2022 |         0 |               1.69426  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2024 |         2 |               1.72785  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2023 |         0 |               1.7435   |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2024 |         2 |               1.77546  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2023 |         0 |               1.78848  |\n| DBC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Dabaco Vi\u1ec7t Nam                      |   2022 |         0 |               1.7954   |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2023 |         0 |               1.81978  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2021 |         0 |               1.84053  |\n| BCM          | T\u1ed5ng C\u00f4ng ty \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n C\u00f4ng nghi\u1ec7p - CTCP          |   2021 |         0 |               1.85522  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2021 |         0 |               1.89752  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2024 |         2 |               1.90154  |\n| HDC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Ph\u00e1t tri\u1ec3n Nh\u00e0 B\u00e0 R\u1ecba V\u0169ng T\u00e0u                |   2020 |         0 |               1.91758  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2022 |         0 |               1.92198  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2022 |         0 |               1.95208  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2020 |         0 |               1.97325  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2021 |         0 |               1.97835  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2021 |         0 |               1.98675  |\n| HUT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Tasco                                         |   2022 |         0 |               2.00309  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2023 |         0 |               2.00446  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2020 |         0 |               2.01747  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2021 |         0 |               2.06474  |\n| MWG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 Th\u1ebf Gi\u1edbi Di \u0110\u1ed9ng                       |   2021 |         0 |               2.09013  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2020 |         0 |               2.09671  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2020 |         0 |               2.11001  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2023 |         0 |               2.15907  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2022 |         0 |               2.20557  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2024 |         2 |               2.21151  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2020 |         0 |               2.22173  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2023 |         0 |               2.22761  |\n| TNG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Th\u01b0\u01a1ng m\u1ea1i TNG                      |   2024 |         2 |               2.26609  |\n| VPI          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 V\u0103n Ph\u00fa - Invest                       |   2020 |         0 |               2.28019  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2021 |         0 |               2.51506  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2021 |         0 |               2.53892  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2021 |         0 |               2.71025  |\n| PVG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh LPG Vi\u1ec7t Nam                       |   2023 |         0 |               2.72341  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2020 |         0 |               2.74222  |\n| PLC          | T\u1ed5ng C\u00f4ng ty H\u00f3a d\u1ea7u Petrolimex - C\u00f4ng ty C\u1ed5 ph\u1ea7n             |   2022 |         0 |               2.76126  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2023 |         0 |               2.85445  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2022 |         0 |               2.85795  |\n| DVM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u01b0\u1ee3c li\u1ec7u Vi\u1ec7t Nam                            |   2020 |         0 |               2.88006  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2023 |         0 |               3.0692   |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2022 |         0 |               3.07163  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2021 |         0 |               3.09964  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2022 |         0 |               3.12368  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2022 |         0 |               3.25643  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2021 |         0 |               3.27534  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2020 |         0 |               3.39756  |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                        |   2024 |         2 |               3.41035  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2024 |         2 |               3.44847  |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                                |   2023 |         0 |               3.50444  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2020 |         0 |               3.52636  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2022 |         0 |               3.56676  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan                                |   2020 |         0 |               3.62386  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2021 |         0 |               3.90207  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2022 |         0 |               4.03591  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2022 |         0 |               4.13522  |\n| TVD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Than V\u00e0ng Danh - Vinacomin                    |   2020 |         0 |               4.17725  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2023 |         0 |               4.33049  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2021 |         0 |               4.3342   |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2023 |         0 |               4.66769  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2023 |         0 |               4.69525  |\n| VJC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n H\u00e0ng kh\u00f4ng Vietjet                            |   2023 |         0 |               4.69885  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2022 |         0 |               4.73317  |\n| NVL          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n \u0110\u1ea7u t\u01b0 \u0110\u1ecba \u1ed1c No Va                  |   2022 |         0 |               4.75073  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2023 |         0 |               4.84831  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2020 |         0 |               4.89163  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2021 |         0 |               5.01874  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2022 |         0 |               5.09663  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2021 |         0 |               5.11264  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2022 |         0 |               5.16295  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2024 |         2 |               5.26066  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2021 |         0 |               5.34471  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2021 |         0 |               5.42305  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2023 |         0 |               5.50936  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam               |   2024 |         2 |               5.6117   |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2024 |         2 |               5.64646  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2020 |         0 |               5.67617  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2022 |         0 |               5.71337  |\n| PSD          | C\u00f4ng ty C\u1ed5 ph\u1ea7n D\u1ecbch v\u1ee5 Ph\u00e2n ph\u1ed1i T\u1ed5ng h\u1ee3p D\u1ea7u kh\u00ed            |   2020 |         0 |               5.90465  |\n| FRT          | C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u00e1n l\u1ebb K\u1ef9 thu\u1eadt s\u1ed1 FPT                        |   2023 |         0 |               6.61905  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2022 |         0 |               6.67618  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng             |   2020 |         0 |               6.93709  |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2024 |         2 |               7.08423  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2023 |         0 |               7.41452  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2021 |         0 |               7.46095  |\n| OCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u01b0\u01a1ng \u0110\u00f4ng                      |   2020 |         0 |               7.74824  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2023 |         0 |               7.9738   |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2022 |         0 |               8.03598  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2022 |         0 |               8.1509   |\n| L18          | C\u00f4ng ty C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 X\u00e2y d\u1ef1ng s\u1ed1 18                      |   2023 |         0 |               8.16639  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2021 |         0 |               8.32431  |\n| EIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Xu\u1ea5t nh\u1eadp kh\u1ea9u Vi\u1ec7t Nam          |   2020 |         0 |               8.53865  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2021 |         0 |               8.71642  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2023 |         0 |               8.77089  |\n| MBB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u00e2n \u0111\u1ed9i                         |   2020 |         0 |               8.87998  |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin          |   2020 |         0 |               8.96134  |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2022 |         0 |               8.97033  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2023 |         0 |               9.13015  |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2022 |         0 |               9.19368  |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2021 |         0 |               9.31087  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2022 |         0 |               9.40194  |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2022 |         0 |               9.49887  |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2022 |         0 |               9.67507  |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2023 |         0 |               9.80353  |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2023 |         0 |               9.89194  |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2023 |         0 |              10.1483   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2023 |         0 |              10.2219   |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2021 |         0 |              10.2682   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2024 |         2 |              10.3055   |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2021 |         0 |              10.7541   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2024 |         2 |              10.8215   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2023 |         0 |              11.0259   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2021 |         0 |              11.1666   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2020 |         0 |              11.2966   |\n| TPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ti\u00ean Phong                       |   2020 |         0 |              11.3214   |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                           |   2020 |         0 |              11.5403   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2023 |         0 |              11.5853   |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2021 |         0 |              11.7422   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2022 |         0 |              11.8402   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2020 |         0 |              11.918    |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2021 |         0 |              11.9647   |\n| ABB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n An B\u00ecnh                          |   2020 |         0 |              12.0583   |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2022 |         0 |              12.3717   |\n| HDB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ph\u00e1t Tri\u1ec3n Th\u00e0nh ph\u1ed1 H\u1ed3 Ch\u00ed Minh |   2023 |         0 |              12.5012   |\n| VIB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c t\u1ebf Vi\u1ec7t Nam                 |   2020 |         0 |              12.6129   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2022 |         0 |              12.6248   |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam            |   2020 |         0 |              13.0946   |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i                 |   2021 |         0 |              13.2578   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2023 |         0 |              13.746    |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2021 |         0 |              14.2101   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2022 |         0 |              14.3237   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2022 |         0 |              14.587    |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2020 |         0 |              14.7056   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2023 |         0 |              15.1483   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2021 |         0 |              15.3545   |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam             |   2022 |         0 |              15.7188   |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn               |   2020 |         0 |              16.009    |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2020 |         0 |              16.0284   |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam                |   2021 |         0 |              16.212    |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2021 |         0 |              16.3027   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2024 |         2 |              17.7161   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2023 |         0 |              17.7184   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2020 |         0 |              18.0427   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2024 |         2 |              19.2545   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2022 |         0 |              19.3533   |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam    |   2021 |         0 |              19.4068   |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                         |   2020 |         0 |              20.0192   |\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                          |   2022 |         0 |             nan        |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH RankedCompanies AS (\n    SELECT \n        fr.stock_code,\n        ci.company_name,\n        fr.year,\n        fr.quarter,\n        fr.data AS debt_to_equity_ratio,\n        ROW_NUMBER() OVER (PARTITION BY fr.stock_code ORDER BY fr.data ASC) AS rn\n    FROM \n        financial_ratio fr\n    JOIN \n        company_info ci ON fr.stock_code = ci.stock_code\n    WHERE \n        fr.ratio_code = 'DTER'\n        AND ((fr.year = 2020 AND fr.quarter = 0) OR\n             (fr.year = 2021 AND fr.quarter = 0) OR\n             (fr.year = 2022 AND fr.quarter = 0) OR\n             (fr.year = 2023 AND fr.quarter = 0) OR\n             (fr.year = 2024 AND fr.quarter = 2))\n)\nSELECT \n    rc.stock_code,\n    rc.company_name,\n    rc.year,\n    rc.quarter,\n    rc.debt_to_equity_ratio\nFROM \n    RankedCompanies rc\nWHERE \n    rc.rn <= 10\nORDER BY \n    rc.debt_to_equity_ratio ASC, rc.stock_code, rc.year, rc.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Non-Bank Corporations\nNonBankData AS (\n  SELECT \n    'Non-Bank' AS CompanyType,\n    ci.stock_code,\n    ci.industry,\n    nbfr.year,\n    nbfr.quarter,\n    -- Approximating Total Debt\n    (nbfr_debt.data - nbfr_equity.data) AS TotalDebt,\n    nbfr_equity.data AS TotalEquity,\n    -- DTE Ratio\n    (nbfr_debt.data - nbfr_equity.data) / nbfr_equity.data AS DTERatio\n  FROM \n    company_info ci\n  JOIN \n    non_bank_financial_report nbfr_debt ON ci.stock_code = nbfr_debt.stock_code AND nbfr_debt.category_code = 'BS_440'\n  JOIN \n    non_bank_financial_report nbfr_equity ON ci.stock_code = nbfr_equity.stock_code AND nbfr_equity.category_code = 'BS_400'\n  WHERE \n    nbfr_debt.year BETWEEN 2020 AND 2024 AND nbfr_debt.quarter IN (0, 2) -- Adjust quarter filter as needed\n    AND ci.is_bank = FALSE AND ci.is_securities = FALSE\n),\n\n-- Bank Corporations\nBankData AS (\n  SELECT \n    'Bank' AS CompanyType,\n    ci.stock_code,\n    ci.industry,\n    bfr.year,\n    bfr.quarter,\n    -- Approximating Total Debt\n    (bfr_debt.data - bfr_equity.data) AS TotalDebt,\n    bfr_equity.data AS TotalEquity,\n    -- DTE Ratio\n    (bfr_debt.data - bfr_equity.data) / bfr_equity.data AS DTERatio\n  FROM \n    company_info ci\n  JOIN \n    bank_financial_report bfr_debt ON ci.stock_code = bfr_debt.stock_code AND bfr_debt.category_code = 'BS_800'\n  JOIN \n    bank_financial_report bfr_equity ON ci.stock_code = bfr_equity.stock_code AND bfr_equity.category_code = 'BS_500'\n  WHERE \n    bfr_debt.year BETWEEN 2020 AND 2024 AND bfr_debt.quarter IN (0, 2) -- Adjust quarter filter as needed\n    AND ci.is_bank = TRUE\n),\n\n-- Securities Firms\nSecuritiesData AS (\n  SELECT \n    'Securities' AS CompanyType,\n    ci.stock_code,\n    ci.industry,\n    sfr.year,\n    sfr.quarter,\n    -- Approximating Total Debt\n    (sfr_debt.data - sfr_equity.data) AS TotalDebt,\n    sfr_equity.data AS TotalEquity,\n    -- DTE Ratio\n    (sfr_debt.data - sfr_equity.data) / sfr_equity.data AS DTERatio\n  FROM \n    company_info ci\n  JOIN \n    securities_financial_report sfr_debt ON ci.stock_code = sfr_debt.stock_code AND sfr_debt.category_code = 'BS_440'\n  JOIN \n    securities_financial_report sfr_equity ON ci.stock_code = sfr_equity.stock_code AND sfr_equity.category_code = 'BS_400'\n  WHERE \n    sfr_debt.year BETWEEN 2020 AND 2024 AND sfr_debt.quarter IN (0, 2) -- Adjust quarter filter as needed\n    AND ci.is_securities = TRUE\n)\n\n-- Union and Rank\nSELECT \n  CompanyType, stock_code, industry, year, quarter, TotalDebt, TotalEquity, DTERatio\nFROM (\n  SELECT *, ROW_NUMBER() OVER (PARTITION BY stock_code ORDER BY DTERatio ASC) AS RowNum\n  FROM (\n    SELECT * FROM NonBankData\n    UNION ALL\n    SELECT * FROM BankData\n    UNION ALL\n    SELECT * FROM SecuritiesData\n  ) AS CombinedData\n) AS FinalData\nWHERE RowNum = 1 -- Top row for each company with the lowest DTE Ratio\nORDER BY DTERatio ASC\nLIMIT 10; -- Top 10 Companies with the Lowest DTE Ratio\n"
            }
        ],
        "time": 69.02276277542114,
        "evaluate": 0,
        "input_token": 1996,
        "output_token": 1553
    },
    {
        "id": "eefe39ae-6424-47d5-ac08-482fc8f15531",
        "question": "For the top 10 companies with Net Income greater than 1,000,000,000,000 VND in 2023, what are their respective Net Profit Margins and Current Ratios?",
        "answer": "Table 1\n| stock_code   | net_profit_margin   | current_ratio   |\n|--------------|---------------------|-----------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TopCompanies AS (\n    SELECT\n        stock_code,\n        SUM(data) AS net_income\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'IS_021' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'IS_030' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'IS_400' AND year = 2023 AND quarter = 0\n    ) AS combined_reports\n    GROUP BY stock_code\n    HAVING SUM(data) > 1000000\n    ORDER BY net_income DESC\n    LIMIT 10\n)\n\nSELECT\n    tc.stock_code,\n    fr1.data AS net_profit_margin,\n    fr2.data AS current_ratio\nFROM\n    TopCompanies tc\nJOIN financial_ratio fr1 ON tc.stock_code = fr1.stock_code\n    AND fr1.ratio_code = 'NPM' AND fr1.year = 2023 AND fr1.quarter = 0\nJOIN financial_ratio fr2 ON tc.stock_code = fr2.stock_code\n    AND fr2.ratio_code = 'CurrentR' AND fr2.year = 2023 AND fr2.quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine all financial reports for 2023, assuming different net income categories\n-- This part assumes the closest matches based on provided data; actual categories might differ\nCombinedReports AS (\n  SELECT stock_code, data AS NetIncome, 'bank' AS Type\n  FROM bank_financial_report \n  WHERE year = 2023 AND quarter = 0 AND category_code = 'IS_012'  -- Assuming IS_012 for banks\n  UNION ALL\n  SELECT stock_code, data AS NetIncome, 'non_bank' AS Type\n  FROM non_bank_financial_report \n  WHERE year = 2023 AND quarter = 0 AND category_code = 'IS_030'  -- Assuming IS_030 for non-banks\n  UNION ALL\n  SELECT stock_code, data AS NetIncome, 'securities' AS Type\n  FROM securities_financial_report \n  WHERE year = 2023 AND quarter = 0 AND category_code = 'IS_400'  -- Assuming IS_400 for securities\n),\n\n-- Rank the top 10 companies by Net Income\nTop10Companies AS (\n  SELECT stock_code, NetIncome, Type,\n         ROW_NUMBER() OVER (ORDER BY NetIncome DESC) AS Rank\n  FROM CombinedReports\n  WHERE NetIncome > 1000000000000  -- Net Income > 1,000,000,000,000 VND\n),\n\n-- Fetch NPM and CurrentR for these top companies\nFinancialRatios AS (\n  SELECT \n    T.stock_code,\n    (SELECT data FROM financial_ratio WHERE stock_code = T.stock_code AND ratio_code = 'NPM' AND year = 2023 AND quarter = 0) AS NPM,\n    (SELECT data FROM financial_ratio WHERE stock_code = T.stock_code AND ratio_code = 'CurrentR' AND year = 2023 AND quarter = 0) AS CurrentR\n  FROM Top10Companies T\n  WHERE T.Rank <= 10\n)\n\n-- Final Query\nSELECT * FROM FinancialRatios\nLIMIT 10;  -- Always add a limit as per instructions\n"
            }
        ],
        "time": 40.288636207580566,
        "evaluate": 0,
        "input_token": 4697,
        "output_token": 1972
    },
    {
        "id": "6ef05b65-adaa-4959-805b-0f7a613617fd",
        "question": "What is the trend of Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (1, 2))\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| ratio_code   |\n|:-------------|\n| ROE          |\n\nTable 2\n| stock_code   | company_name                                       |   year |   quarter |   roe_value |\n|:-------------|:---------------------------------------------------|-------:|----------:|------------:|\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                |   2020 |         0 |   0.216734  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                |   2021 |         0 |   0.213865  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                |   2022 |         0 |   0.234232  |\n| ACB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u00c1 Ch\u00e2u                |   2023 |         0 |   0.226122  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2020 |         0 |   0.168632  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2021 |         0 |   0.197927  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2022 |         0 |   0.180176  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2023 |         0 |   0.139608  |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2024 |         2 |   0.0457096 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         0 |   0.196318  |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2021 |         0 |   0.201059  |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2022 |         0 |   0.220567  |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2023 |         0 |   0.200315  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Verify the ROE ratio code (Assumed 'ROE' based on provided mapping)\nSELECT ratio_code \nFROM map_category_code_ratio \nWHERE ratio_name = 'Return On Equity';\n\n-- Assuming the ratio_code for ROE is indeed 'ROE', proceed with the main query\n\nSELECT \n  fr.stock_code,\n  ci.company_name, -- Assuming company_name exists in company_info for clarity\n  fr.year,\n  fr.quarter,\n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n  fr.ratio_code = 'ROE' -- Using the verified ratio code\n  AND fr.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND (\n    (fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) -- Annual reports for 2020-2023\n    OR (fr.year = 2024 AND fr.quarter = 2) -- Q2 2024\n  )\nORDER BY \n  fr.stock_code, fr.year, fr.quarter\nLIMIT 100; -- Adding a limit as per the instructions\n"
            }
        ],
        "time": 40.31132888793945,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "5c4964d0-adc2-4847-9751-de6fad125d24",
        "question": "Calculate the Gross Profit Margin for Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.  Further, compute the year-on-year growth rate of the Gross Profit Margin for each company during this period.",
        "answer": "Table 1\n| stock_code   |   year |   avg_gpm |   yoy_growth_rate |\n|:-------------|-------:|----------:|------------------:|\n| MSN          |   2020 |  0.231665 |         nan       |\n| MSN          |   2021 |  0.249747 |           7.80519 |\n| MSN          |   2022 |  0.276089 |          10.5474  |\n| MSN          |   2023 |  0.282692 |           2.39156 |\n| SAB          |   2020 |  0.30403  |         nan       |\n| SAB          |   2021 |  0.28849  |          -5.11146 |\n| SAB          |   2022 |  0.307918 |           6.73451 |\n| SAB          |   2023 |  0.298455 |          -3.07321 |\n| VNM          |   2020 |  0.463956 |         nan       |\n| VNM          |   2021 |  0.431363 |          -7.02496 |\n| VNM          |   2022 |  0.398578 |          -7.60046 |\n| VNM          |   2023 |  0.406579 |           2.00742 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH GPM_data AS (\n    SELECT \n        fr.stock_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS gpm\n    FROM \n        financial_ratio fr\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Gross Profit Margin' AND\n        fr.stock_code IN ('VNM', 'MSN', 'SAB') AND\n        ((fr.year BETWEEN 2020 AND 2024) AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter <= 2)))\n),\nYearly_GPM AS (\n    SELECT \n        stock_code,\n        year,\n        AVG(gpm) AS avg_gpm\n    FROM \n        GPM_data\n    WHERE \n        quarter = 0\n    GROUP BY \n        stock_code, year\n),\nGrowth_Rate AS (\n    SELECT \n        a.stock_code,\n        a.year,\n        a.avg_gpm,\n        ((a.avg_gpm - b.avg_gpm) / NULLIF(b.avg_gpm, 0)) * 100 AS yoy_growth_rate\n    FROM \n        Yearly_GPM a\n    LEFT JOIN \n        Yearly_GPM b ON a.stock_code = b.stock_code AND a.year = b.year + 1\n)\nSELECT \n    stock_code,\n    year,\n    avg_gpm,\n    yoy_growth_rate\nFROM \n    Growth_Rate\nORDER BY \n    stock_code, year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | en_company_name                              |   year | period   |   gpm_value |   yoy_growth_rate |\n|:-------------|:---------------------------------------------|-------:|:---------|------------:|------------------:|\n| MSN          | Masan Group Corporation                      |   2020 | Annual   |    0.231665 |         nan       |\n| MSN          | Masan Group Corporation                      |   2020 | Q2       |    0.219211 |         nan       |\n| MSN          | Masan Group Corporation                      |   2021 | Annual   |    0.249747 |           7.80519 |\n| MSN          | Masan Group Corporation                      |   2021 | Q2       |    0.228436 |           4.20826 |\n| MSN          | Masan Group Corporation                      |   2022 | Annual   |    0.276089 |          10.5474  |\n| MSN          | Masan Group Corporation                      |   2022 | Q2       |    0.278537 |          21.9322  |\n| MSN          | Masan Group Corporation                      |   2023 | Annual   |    0.282692 |           2.39156 |\n| MSN          | Masan Group Corporation                      |   2023 | Q2       |    0.286292 |           2.78417 |\n| SAB          | Saigon Beer - Alcohol - Beverage Corporation |   2020 | Annual   |    0.30403  |         nan       |\n| SAB          | Saigon Beer - Alcohol - Beverage Corporation |   2020 | Q2       |    0.309339 |         nan       |\n| SAB          | Saigon Beer - Alcohol - Beverage Corporation |   2021 | Annual   |    0.28849  |          -5.11146 |\n| SAB          | Saigon Beer - Alcohol - Beverage Corporation |   2021 | Q2       |    0.313188 |           1.24451 |\n| SAB          | Saigon Beer - Alcohol - Beverage Corporation |   2022 | Annual   |    0.307918 |           6.73451 |\n| SAB          | Saigon Beer - Alcohol - Beverage Corporation |   2022 | Q2       |    0.342558 |           9.37753 |\n| SAB          | Saigon Beer - Alcohol - Beverage Corporation |   2023 | Annual   |    0.298455 |          -3.07321 |\n| SAB          | Saigon Beer - Alcohol - Beverage Corporation |   2023 | Q2       |    0.299307 |         -12.6259  |\n| VNM          | Vietnam Dairy Products Joint Stock Company   |   2020 | Annual   |    0.463956 |         nan       |\n| VNM          | Vietnam Dairy Products Joint Stock Company   |   2020 | Q2       |    0.460651 |         nan       |\n| VNM          | Vietnam Dairy Products Joint Stock Company   |   2021 | Annual   |    0.431363 |          -7.02496 |\n| VNM          | Vietnam Dairy Products Joint Stock Company   |   2021 | Q2       |    0.436144 |          -5.32004 |\n| VNM          | Vietnam Dairy Products Joint Stock Company   |   2022 | Annual   |    0.398578 |          -7.60046 |\n| VNM          | Vietnam Dairy Products Joint Stock Company   |   2022 | Q2       |    0.407002 |          -6.68166 |\n| VNM          | Vietnam Dairy Products Joint Stock Company   |   2023 | Annual   |    0.406579 |           2.00742 |\n| VNM          | Vietnam Dairy Products Joint Stock Company   |   2023 | Q2       |    0.396666 |          -2.5397  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Step 1: Extract Relevant Financial Ratio Data for Companies\nCompanyGPM AS (\n  SELECT \n    fr.stock_code,\n    ci.en_company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS GPM_Value\n  FROM \n    financial_ratio fr\n  JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\n  JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE \n    mcr.ratio_code = 'GPM'\n    AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.quarter = 2 AND fr.year < 2024))  -- Include Q2 up to 2023 for YoY comparison\n),\n-- Step 2: Calculate Year-on-Year Growth Rate for GPM\nYoYGPMGrowth AS (\n  SELECT \n    stock_code,\n    en_company_name,\n    year,\n    quarter,\n    GPM_Value,\n    -- Calculate YoY Growth Rate, considering both quarterly and annual data\n    CASE \n      WHEN LAG(GPM_Value, 1, NULL) OVER (PARTITION BY stock_code, CASE WHEN quarter = 0 THEN 'Annual' ELSE 'Q2' END ORDER BY year) IS NULL \n      THEN NULL  -- First year/quarter has no previous value\n      ELSE ((GPM_Value - LAG(GPM_Value, 1, NULL) OVER (PARTITION BY stock_code, CASE WHEN quarter = 0 THEN 'Annual' ELSE 'Q2' END ORDER BY year)) / \n            LAG(GPM_Value, 1, NULL) OVER (PARTITION BY stock_code, CASE WHEN quarter = 0 THEN 'Annual' ELSE 'Q2' END ORDER BY year)) * 100\n    END AS YoY_Growth_Rate\n  FROM \n    CompanyGPM\n)\n-- Final Output\nSELECT \n  stock_code,\n  en_company_name,\n  year,\n  CASE WHEN quarter = 0 THEN 'Annual' ELSE 'Q2' END AS Period,\n  GPM_Value,\n  YoY_Growth_Rate\nFROM \n  YoYGPMGrowth\nORDER BY \n  stock_code, year, quarter\nLIMIT 100;  -- As per the instruction to always add a LIMIT\n"
            }
        ],
        "time": 44.930389165878296,
        "evaluate": 0.5,
        "input_token": 2000,
        "output_token": 845
    },
    {
        "id": "a43c12a4-c2cc-4354-b458-0878a4f70bd0",
        "question": "Rank the top 5 companies with the highest Current Ratio as of December 31, 2023, among companies with total assets exceeding 100 billion VND.",
        "answer": "Table 1\n| stock_code   | industry           |   current_ratio |\n|:-------------|:-------------------|----------------:|\n| HLD          | Real Estate        |         7.25278 |\n| EIB          | Banking            |         6.12482 |\n| TCH          | Real Estate        |         6.00022 |\n| ABB          | Banking            |         5.488   |\n| SLS          | Food and Beverages |         4.98219 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TotalAssets AS (\n    SELECT stock_code\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n    UNION\n    SELECT stock_code\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n    UNION\n    SELECT stock_code\n    FROM securities_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0 AND data > 100000\n),\nCurrentRatios AS (\n    SELECT fr.stock_code, fr.data AS current_ratio\n    FROM financial_ratio fr\n    JOIN TotalAssets ta ON fr.stock_code = ta.stock_code\n    WHERE fr.ratio_code = 'CurrentR' AND fr.year = 2023 AND fr.quarter = 0\n)\nSELECT ci.stock_code, ci.industry, cr.current_ratio\nFROM CurrentRatios cr\nJOIN company_info ci ON cr.stock_code = ci.stock_code\nORDER BY cr.current_ratio DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | current_ratio   |\n|--------------|-----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine financial reports for total assets, filtering for 2023 annual reports\nTotalAssets AS (\n  SELECT 'non_bank' AS report_type, stock_code, data AS total_assets\n  FROM non_bank_financial_report\n  WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_270'\n  UNION ALL\n  SELECT 'bank' AS report_type, stock_code, data AS total_assets\n  FROM bank_financial_report\n  WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_300'\n  UNION ALL\n  SELECT 'securities' AS report_type, stock_code, data AS total_assets\n  FROM securities_financial_report\n  WHERE year = 2023 AND quarter = 0 AND category_code = 'BS_270'\n),\n\n-- Combine financial reports for current assets and liabilities, focusing on clearer mappings\nCurrentAssetsLiabilities AS (\n  SELECT 'non_bank' AS report_type, stock_code, \n         SUM(CASE WHEN category_code = 'BS_100' THEN data ELSE 0 END) AS current_assets,\n         SUM(CASE WHEN category_code = 'BS_310' THEN data ELSE 0 END) AS current_liabilities\n  FROM non_bank_financial_report\n  WHERE year = 2023 AND quarter = 0 AND category_code IN ('BS_100', 'BS_310')\n  GROUP BY stock_code\n  UNION ALL\n  SELECT 'securities' AS report_type, stock_code, \n         SUM(CASE WHEN category_code = 'BS_100' THEN data ELSE 0 END) AS current_assets,\n         SUM(CASE WHEN category_code = 'BS_310' THEN data ELSE 0 END) AS current_liabilities\n  FROM securities_financial_report\n  WHERE year = 2023 AND quarter = 0 AND category_code IN ('BS_100', 'BS_310')\n  GROUP BY stock_code\n),\n\n-- Calculate Current Ratio and filter by total assets > 100 billion VND\nCompanyRatios AS (\n  SELECT TA.stock_code, \n         (CAL.current_assets / CAL.current_liabilities) AS current_ratio,\n         TA.total_assets\n  FROM TotalAssets TA\n  JOIN CurrentAssetsLiabilities CAL ON TA.stock_code = CAL.stock_code AND TA.report_type = CAL.report_type\n  WHERE TA.total_assets > 100000000000  -- 100 billion VND\n)\n\n-- Rank the top 5 companies by Current Ratio\nSELECT stock_code, current_ratio\nFROM CompanyRatios\nORDER BY current_ratio DESC\nLIMIT 5;\n"
            }
        ],
        "time": 52.19266176223755,
        "evaluate": 0,
        "input_token": 2536,
        "output_token": 1478
    },
    {
        "id": "6ebec9aa-2d66-4d22-a45a-a7e6114dad2b",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) \n        OR (year = 2024 AND quarter BETWEEN 1 AND 2)\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n|   year |   quarter | stock_code   | industry   | ratio_name       |   roe_value |\n|-------:|----------:|:-------------|:-----------|:-----------------|------------:|\n|   2020 |         0 | ACB          | Banking    | Return On Equity |   0.216734  |\n|   2020 |         0 | TCB          | Banking    | Return On Equity |   0.168632  |\n|   2020 |         0 | VCB          | Banking    | Return On Equity |   0.196318  |\n|   2021 |         0 | ACB          | Banking    | Return On Equity |   0.213865  |\n|   2021 |         0 | TCB          | Banking    | Return On Equity |   0.197927  |\n|   2021 |         0 | VCB          | Banking    | Return On Equity |   0.201059  |\n|   2022 |         0 | ACB          | Banking    | Return On Equity |   0.234232  |\n|   2022 |         0 | TCB          | Banking    | Return On Equity |   0.180176  |\n|   2022 |         0 | VCB          | Banking    | Return On Equity |   0.220567  |\n|   2023 |         0 | ACB          | Banking    | Return On Equity |   0.226122  |\n|   2023 |         0 | TCB          | Banking    | Return On Equity |   0.139608  |\n|   2023 |         0 | VCB          | Banking    | Return On Equity |   0.200315  |\n|   2024 |         2 | TCB          | Banking    | Return On Equity |   0.0457096 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.year, \n  fr.quarter, \n  ci.stock_code, \n  ci.industry, \n  mcr.ratio_name, \n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  ci.stock_code IN ('VCB', 'TCB', 'ACB') \n  AND mcr.ratio_code = 'ROE'\n  AND (\n    (fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) \n    OR (fr.year = 2024 AND fr.quarter = 2)\n  )\nORDER BY \n  fr.year, \n  fr.quarter, \n  ci.stock_code\nLIMIT 100;\n"
            }
        ],
        "time": 38.88159203529358,
        "evaluate": 1,
        "input_token": 2261,
        "output_token": 729
    },
    {
        "id": "0529969a-2008-4b24-bc19-022d11d2ecc6",
        "question": "What were the values of Total Assets, Total Liabilities, and Net Income for Vinamilk, Masan Group, and PetroVietnam Gas for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   | en_caption                           |        data |\n|:-------------|:-------------------------------------|------------:|\n| VNM          | Net profit from operating activities | 1.09036e+07 |\n| MSN          | Net profit from operating activities | 2.35043e+06 |\n| GAS          | Net profit from operating activities | 1.46191e+07 |\n| GAS          | TOTAL ASSETS                         | 8.77545e+07 |\n| GAS          | C. LIABILITIES                       | 2.24558e+07 |\n| VNM          | TOTAL ASSETS                         | 5.26734e+07 |\n| VNM          | C. LIABILITIES                       | 1.76476e+07 |\n| MSN          | TOTAL ASSETS                         | 1.47383e+08 |\n| MSN          | C. LIABILITIES                       | 1.09146e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN', 'GAS') \n    AND nfr.year = 2023 \n    AND nfr.quarter = 0 \n    AND nfr.category_code IN ('BS_270', 'BS_300', 'IS_030');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| metric            | stock_code   |       value |\n|:------------------|:-------------|------------:|\n| Total Assets      | VNM          | 3.59359e+07 |\n| Total Assets      | MSN          | 4.37635e+07 |\n| Total Liabilities | VNM          | 1.67375e+07 |\n| Total Liabilities | MSN          | 1.0362e+08  |\n| Total Liabilities | GAS          | 2.55367e+07 |\n| Total Assets      | GAS          | 6.22178e+07 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  'Total Assets' AS Metric,\n  T1.stock_code,\n  T1.data AS Value\nFROM \n  non_bank_financial_report T1\n  INNER JOIN map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code IN ('VNM', 'MSN', 'GAS')\n  AND T1.year = 2023\n  AND T1.quarter = 0\n  AND T2.category_code = 'BS_100'  -- Assumed code for Total Assets\n\nUNION ALL\n\nSELECT \n  'Total Liabilities' AS Metric,\n  T1.stock_code,\n  T1.data AS Value\nFROM \n  non_bank_financial_report T1\n  INNER JOIN map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code IN ('VNM', 'MSN', 'GAS')\n  AND T1.year = 2023\n  AND T1.quarter = 0\n  AND T2.category_code = 'BS_200'  -- Assumed code for Total Liabilities\n\nUNION ALL\n\nSELECT \n  'Net Income' AS Metric,\n  T1.stock_code,\n  T1.data AS Value\nFROM \n  non_bank_financial_report T1\n  INNER JOIN map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code IN ('VNM', 'MSN', 'GAS')\n  AND T1.year = 2023\n  AND T1.quarter = 0\n  AND T2.category_code = 'IS_005'  -- Assumed code for Net Income\n\nLIMIT 9;  -- Assuming each company will have one record for each metric, thus 3 companies * 3 metrics = 9 records\n"
            }
        ],
        "time": 37.619340658187866,
        "evaluate": 0,
        "input_token": 3510,
        "output_token": 1819
    },
    {
        "id": "5f48b85d-d6f3-4010-a6f8-22f11cfaa754",
        "question": "What is the breakdown of equity investments (including both subsidiaries and other investments) for Mobile World Investment and its return on equity (ROE) for the fiscal year 2023?",
        "answer": "Table 1\n| category_code   | en_caption                                  |   data |\n|:----------------|:--------------------------------------------|-------:|\n| BS_213          | Business capital at subsidiaries            |      0 |\n| BS_251          | Investment in subsidiaries                  |      0 |\n| BS_252          | Investment in associates and joint ventures | 286632 |\n| BS_253          | Investment in other entities                |      0 |\n\nTable 2\n|       roe |\n|----------:|\n| 0.0071846 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to get the breakdown of equity investments for MWG in 2023\nSELECT \n    nbfr.category_code,\n    mccnb.en_caption,\n    nbfr.data\nFROM \n    non_bank_financial_report nbfr\nJOIN \n    map_category_code_non_bank mccnb ON nbfr.category_code = mccnb.category_code\nWHERE \n    nbfr.stock_code = 'MWG'\n    AND nbfr.year = 2023\n    AND nbfr.quarter = 0\n    AND nbfr.category_code IN ('BS_213', 'BS_251', 'BS_252', 'BS_253');\n\n-- Query to get the ROE for MWG in 2023\nSELECT \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code = 'MWG'\n    AND fr.year = 2023\n    AND fr.quarter = 0\n    AND mccr.ratio_name = 'Return On Equity';\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter | investment_category                                                                 |   investment_amount |\n|:-------------|-------:|----------:|:------------------------------------------------------------------------------------|--------------------:|\n| MWG          |   2023 |         0 | Short-term prepaid expenses                                                         |    481240           |\n| MWG          |   2023 |         0 | Deductible VAT                                                                      |    159821           |\n| MWG          |   2023 |         0 | Taxes and other receivables from the State                                          |     23473           |\n| MWG          |   2023 |         0 | Government bond repurchase transactions                                             |         0           |\n| MWG          |   2023 |         0 | Other current assets                                                                |         0           |\n| MWG          |   2023 |         0 | B. NON-CURRENT ASSETS                                                               |         8.1609e+06  |\n| MWG          |   2023 |         0 | I. Long-term receivables                                                            |    457569           |\n| MWG          |   2023 |         0 | Long-term trade receivables                                                         |         0           |\n| MWG          |   2023 |         0 | Long-term prepayments to suppliers                                                  |         0           |\n| MWG          |   2023 |         0 | Business capital at subsidiaries                                                    |         0           |\n| MWG          |   2023 |         0 | Long-term intra-group receivables                                                   |         0           |\n| MWG          |   2023 |         0 | Long-term loan receivables                                                          |      9244           |\n| MWG          |   2023 |         0 | Other long-term receivables                                                         |    448325           |\n| MWG          |   2023 |         0 | Provision for doubtful long-term receivables                                        |         0           |\n| MWG          |   2023 |         0 | II. Fixed assets                                                                    |         6.50014e+06 |\n| MWG          |   2023 |         0 | Tangible fixed assets                                                               |         6.43132e+06 |\n| MWG          |   2023 |         0 | Historical cost                                                                     |         2.01393e+07 |\n| MWG          |   2023 |         0 | Accumulated depreciation                                                            |        -1.3708e+07  |\n| MWG          |   2023 |         0 | Finance-leased fixed assets                                                         |         0           |\n| MWG          |   2023 |         0 | Historical cost                                                                     |         0           |\n| MWG          |   2023 |         0 | Accumulated depreciation                                                            |         0           |\n| MWG          |   2023 |         0 | Intangible fixed assets                                                             |     68820           |\n| MWG          |   2023 |         0 | Historical cost                                                                     |     90297           |\n| MWG          |   2023 |         0 | Accumulated depreciation                                                            |    -21477           |\n| MWG          |   2023 |         0 | III. Investment properties                                                          |         0           |\n| MWG          |   2023 |         0 | Historical cost                                                                     |         0           |\n| MWG          |   2023 |         0 | Accumulated depreciation                                                            |         0           |\n| MWG          |   2023 |         0 | IV. Long-term work in progress                                                      |      4493           |\n| MWG          |   2023 |         0 | Long-term unfinished production and business costs                                  |         0           |\n| MWG          |   2023 |         0 | Long-term construction in progress                                                  |      4493           |\n| MWG          |   2023 |         0 | V. Long-term financial investments                                                  |    746632           |\n| MWG          |   2023 |         0 | Investment in subsidiaries                                                          |         0           |\n| MWG          |   2023 |         0 | Investment in associates and joint ventures                                         |    286632           |\n| MWG          |   2023 |         0 | Investment in other entities                                                        |         0           |\n| MWG          |   2023 |         0 | Provision for long-term financial investments                                       |         0           |\n| MWG          |   2023 |         0 | Held-to-maturity investments                                                        |    460000           |\n| MWG          |   2023 |         0 | VI. Other non-current assets                                                        |    452067           |\n| MWG          |   2023 |         0 | Long-term prepaid expenses                                                          |    105411           |\n| MWG          |   2023 |         0 | Deferred tax assets                                                                 |    101088           |\n| MWG          |   2023 |         0 | Long-term equipment, supplies, spare parts                                          |         0           |\n| MWG          |   2023 |         0 | Other non-current assets                                                            |         0           |\n| MWG          |   2023 |         0 | Goodwill                                                                            |    245567           |\n| MWG          |   2023 |         0 | TOTAL ASSETS                                                                        |         6.01112e+07 |\n| MWG          |   2023 |         0 | C. LIABILITIES                                                                      |         3.67517e+07 |\n| MWG          |   2023 |         0 | I. Current liabilities                                                              |         3.07653e+07 |\n| MWG          |   2023 |         0 | Other cash payments for business activities                                         |         0           |\n| MWG          |   2023 |         0 | Net cash flow from operating activities                                             |         3.43583e+06 |\n| MWG          |   2023 |         0 | Cash outflows for purchase, construction of fixed assets and other long-term assets |   -523383           |\n| MWG          |   2023 |         0 | Cash inflows from disposal of fixed assets and other long-term assets               |     31276           |\n| MWG          |   2023 |         0 | Cash outflows for loans, purchasing debt instruments of other entities              |        -3.41514e+07 |\n| MWG          |   2023 |         0 | Cash inflows from recovering loans, reselling debt instruments of other entities    |         2.28051e+07 |\n| MWG          |   2023 |         0 | Cash outflows for capital investments in other entities                             |   -105597           |\n| MWG          |   2023 |         0 | Cash inflows from recovering capital investments in other entities    ",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Part 1: Equity Investments Breakdown for MWG in 2023\nSELECT \n    T1.stock_code,\n    T1.year,\n    T1.quarter,\n    T2.en_caption AS investment_category,\n    T1.data AS investment_amount\nFROM \n    non_bank_financial_report T1\nINNER JOIN \n    map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n    T1.stock_code = 'MWG'\n    AND T1.year = 2023\n    AND T1.quarter = 0  -- Annual Report\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "-- Part 2: ROE for MWG in 2023\nSELECT \n    T1.data AS ROE\nFROM \n    financial_ratio T1\nINNER JOIN \n    map_category_code_ratio T2 ON T1.ratio_code = T2.ratio_code\nWHERE \n    T2.ratio_name = 'Return On Equity'\n    AND T1.stock_code = 'MWG'\n    AND T1.year = 2023\n    AND T1.quarter = 0  -- Annual Report\nLIMIT 1;\n"
            },
            {
                "language": "sql",
                "code": "-- Combined Query\n(\n    -- Part 1: Equity Investments Breakdown for MWG in 2023\n    SELECT \n        'Equity Investment' AS Query_Part,\n        T1.stock_code,\n        T1.year,\n        T1.quarter,\n        T2.en_caption AS Category,\n        T1.data AS Amount\n    FROM \n        non_bank_financial_report T1\n    INNER JOIN \n        map_category_code_non_bank T2 ON T1.category_code = T2.category_code\n    WHERE \n        T1.stock_code = 'MWG'\n        AND T1.year = 2023\n        AND T1.quarter = 0  \n    LIMIT 100\n)\nUNION ALL\n(\n    -- Part 2: ROE for MWG in 2023\n    SELECT \n        'ROE' AS Query_Part,\n        T1.stock_code,\n        T1.year,\n        T1.quarter,\n        'Return On Equity' AS Category,\n        T1.data AS Amount\n    FROM \n        financial_ratio T1\n    INNER JOIN \n        map_category_code_ratio T2 ON T1.ratio_code = T2.ratio_code\n    WHERE \n        T2.ratio_name = 'Return On Equity'\n        AND T1.stock_code = 'MWG'\n        AND T1.year = 2023\n        AND T1.quarter = 0  \n    LIMIT 1\n)\nLIMIT 101;  -- Adjusted limit to accommodate both query parts\n"
            }
        ],
        "time": 43.32481861114502,
        "evaluate": 0.5,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "514613cf-7002-4698-a3b7-93db835122c6",
        "question": "Rank the top 5 companies with total assets greater than 100,000 billion VND as of December 31, 2023, based on their Return on Equity (ROE).",
        "answer": "Table 1\n| stock_code   | industry   |      roe |\n|:-------------|:-----------|---------:|\n| HDB          | Banking    | 0.232433 |\n| ACB          | Banking    | 0.226122 |\n| VIB          | Banking    | 0.225702 |\n| MBB          | Banking    | 0.217698 |\n| VCB          | Banking    | 0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT \n        stock_code,\n        SUM(data) AS total_assets\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n        \n        UNION ALL\n        \n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n    ) AS combined_assets\n    GROUP BY stock_code\n    HAVING SUM(data) > 100000000\n)\n\nSELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    total_assets ta ON fr.stock_code = ta.stock_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE' AND fr.year = 2023 AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Union of all companies' financial reports for total assets\nTotalAssets AS (\n  SELECT 'Bank' AS Type, stock_code, data AS TotalAssets\n  FROM bank_financial_report\n  WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n  \n  UNION ALL\n  \n  SELECT 'Non-Bank' AS Type, stock_code, data AS TotalAssets\n  FROM non_bank_financial_report\n  WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n  \n  UNION ALL\n  \n  SELECT 'Securities' AS Type, stock_code, data AS TotalAssets\n  FROM securities_financial_report\n  WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n),\n\n-- Joining TotalAssets with financial_ratio for ROE and filtering\nRankedCompanies AS (\n  SELECT \n    ci.stock_code,\n    ci.industry,\n    fr.data AS ROE,\n    ta.TotalAssets\n  FROM \n    TotalAssets ta\n  JOIN \n    company_info ci ON ta.stock_code = ci.stock_code\n  JOIN \n    financial_ratio fr ON ta.stock_code = fr.stock_code AND fr.ratio_code = 'ROE' AND fr.year = 2023 AND fr.quarter = 0\n  WHERE \n    ta.TotalAssets > 100000 * 1000 * 1000 * 1000  -- 100,000 billion VND\n)\n\n-- Ranking the top 5 companies by ROE\nSELECT \n  stock_code, \n  industry, \n  ROE, \n  TotalAssets\nFROM \n  RankedCompanies\nORDER BY \n  ROE DESC\nLIMIT 5;\n"
            }
        ],
        "time": 34.56580662727356,
        "evaluate": 0,
        "input_token": 1841,
        "output_token": 744
    },
    {
        "id": "c831d896-2da0-445e-8184-0699fc43e0db",
        "question": "What is the trend of Net Profit Margin for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_profit_margin\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'NPM' \n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual reports from 2020 to 2023\n        OR \n        (year = 2024 AND quarter IN (1, 2)) -- Quarterly reports for Q1 and Q2 of 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| year   | quarter   | stock_code   | en_company_name   | ratio_name   | net_profit_margin_value   |\n|--------|-----------|--------------|-------------------|--------------|---------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.year, \n  fr.quarter, \n  ci.stock_code, \n  ci.en_company_name, \n  mcr.ratio_name, \n  fr.data AS Net_Profit_Margin_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  ci.stock_code IN ('VCB', 'TCB', 'ACB') \n  AND mcr.ratio_code = 'NPM'  -- Assuming 'NPM' is the correct ratio_code for Net Profit Margin\n  AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n  fr.year, \n  fr.quarter, \n  ci.stock_code\nLIMIT 100;  -- To adhere to the requirement of adding a LIMIT\n"
            }
        ],
        "time": 40.88357162475586,
        "evaluate": 0,
        "input_token": 6394,
        "output_token": 2622
    },
    {
        "id": "0139ac4a-8687-4aac-a031-3b29b413d83a",
        "question": "For the period 2020-Q2 2024, which 10 companies have the highest total assets,  with the condition that total assets must be greater than 100 billion VND?",
        "answer": "Table 1\n| stock_code   |   total_assets |\n|:-------------|---------------:|\n| BID          |    3.1738e+10  |\n| CTG          |    2.57372e+10 |\n| VCB          |    2.56522e+10 |\n| TCB          |    1.1165e+10  |\n| VPB          |    9.8242e+09  |\n| VIC          |    9.36372e+09 |\n| MBB          |    9.02315e+09 |\n| STB          |    8.76012e+09 |\n| SHB          |    8.57265e+09 |\n| ACB          |    7.8037e+09  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN bank_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_300'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n\n    UNION ALL\n\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN non_bank_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_270'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n\n    UNION ALL\n\n    SELECT\n        c.stock_code,\n        SUM(f.data) AS total_assets\n    FROM\n        company_info c\n    LEFT JOIN securities_financial_report f ON c.stock_code = f.stock_code\n    WHERE\n        f.category_code = 'BS_270'\n        AND f.year BETWEEN 2020 AND 2024\n        AND f.quarter != 0\n    GROUP BY c.stock_code\n)\n\nSELECT\n    t.stock_code,\n    t.total_assets\nFROM\n    total_assets t\nWHERE\n    t.total_assets > 100000\nORDER BY\n    t.total_assets DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | company_name                                               | en_company_name                                                       | industry   | is_bank   | is_securities   |   total_assets |\n|:-------------|:-----------------------------------------------------------|:----------------------------------------------------------------------|:-----------|:----------|:----------------|---------------:|\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam | Joint Stock Commercial Bank for Investment and Development of Vietnam | Banking    | True      | False           |    2.30081e+09 |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam | Joint Stock Commercial Bank for Investment and Development of Vietnam | Banking    | True      | False           |    2.12061e+09 |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam          | Vietnam Joint Stock Commercial Bank For Industry and Trade            | Banking    | True      | False           |    2.03261e+09 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam         | Joint Stock Commercial Bank For Foreign Trade Of Vietnam              | Banking    | True      | False           |    1.83961e+09 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam         | Joint Stock Commercial Bank For Foreign Trade Of Vietnam              | Banking    | True      | False           |    1.81382e+09 |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam          | Vietnam Joint Stock Commercial Bank For Industry and Trade            | Banking    | True      | False           |    1.80843e+09 |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam | Joint Stock Commercial Bank for Investment and Development of Vietnam | Banking    | True      | False           |    1.7617e+09  |\n| CTG          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n C\u00f4ng th\u01b0\u01a1ng Vi\u1ec7t Nam          | Vietnam Joint Stock Commercial Bank For Industry and Trade            | Banking    | True      | False           |    1.53159e+09 |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam | Joint Stock Commercial Bank for Investment and Development of Vietnam | Banking    | True      | False           |    1.51669e+09 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam         | Joint Stock Commercial Bank For Foreign Trade Of Vietnam              | Banking    | True      | False           |    1.41467e+09 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CombinedReports AS (\n  SELECT stock_code, year, 'Bank' AS report_type, category_code, data\n  FROM bank_financial_report\n  WHERE quarter = 0 AND category_code = 'BS_300'\n  UNION ALL\n  SELECT stock_code, year, 'Non-Bank' AS report_type, category_code, data\n  FROM non_bank_financial_report\n  WHERE quarter = 0 AND category_code = 'BS_270'\n  UNION ALL\n  SELECT stock_code, year, 'Securities' AS report_type, category_code, data\n  FROM securities_financial_report\n  WHERE quarter = 0 AND category_code = 'BS_270'\n)\nSELECT \n  cr.stock_code, \n  ci.company_name, \n  ci.en_company_name, \n  ci.industry, \n  ci.is_bank, \n  ci.is_securities,\n  cr.data AS total_assets\nFROM \n  CombinedReports cr\n  JOIN company_info ci ON cr.stock_code = ci.stock_code\nWHERE \n  cr.year BETWEEN 2020 AND 2024 \n  AND cr.data > 100000\nORDER BY \n  cr.data DESC\nLIMIT 10;\n"
            }
        ],
        "time": 37.80158567428589,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "a6c11447-d4dd-4ae8-99b8-57138309a422",
        "question": "Show the Return on Equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Calculate the average ROE for each company over this period.",
        "answer": "Table 1\n| stock_code   |   average_roe |\n|:-------------|--------------:|\n| HPG          |     0.136672  |\n| MSN          |     0.0970669 |\n| VNM          |     0.242186  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    AVG(data) AS average_roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    stock_code IN ('VNM', 'MSN', 'HPG') AND\n    ((year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n    (year = 2024 AND quarter IN (1, 2)))\nGROUP BY \n    stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry           |   year |   quarter | ratio_name       |   roe_value |   average_roe |\n|:-------------|:-------------------|-------:|----------:|:-----------------|------------:|--------------:|\n| HPG          | Basic Resources    |   2024 |         2 | Return On Equity |   0.0305454 |      0.158574 |\n| HPG          | Basic Resources    |   2022 |         0 | Return On Equity |   0.0878594 |      0.158574 |\n| HPG          | Basic Resources    |   2021 |         0 | Return On Equity |   0.380268  |      0.158574 |\n| HPG          | Basic Resources    |   2020 |         0 | Return On Equity |   0.228068  |      0.158574 |\n| HPG          | Basic Resources    |   2023 |         0 | Return On Equity |   0.0661282 |      0.158574 |\n| MSN          | Food and Beverages |   2020 |         0 | Return On Equity |   0.055733  |      0.118251 |\n| MSN          | Food and Beverages |   2023 |         0 | Return On Equity |   0.0489033 |      0.118251 |\n| MSN          | Food and Beverages |   2022 |         0 | Return On Equity |   0.129771  |      0.118251 |\n| MSN          | Food and Beverages |   2021 |         0 | Return On Equity |   0.238597  |      0.118251 |\n| VNM          | Food and Beverages |   2020 |         0 | Return On Equity |   0.333928  |      0.287349 |\n| VNM          | Food and Beverages |   2023 |         0 | Return On Equity |   0.257506  |      0.287349 |\n| VNM          | Food and Beverages |   2021 |         0 | Return On Equity |   0.296583  |      0.287349 |\n| VNM          | Food and Beverages |   2022 |         0 | Return On Equity |   0.26138   |      0.287349 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  ci.stock_code,\n  ci.industry,\n  fr.year,\n  fr.quarter,\n  mcr.ratio_name,\n  fr.data AS ROE_Value,\n  AVG(fr.data) OVER (PARTITION BY ci.stock_code) AS Average_ROE\nFROM \n  company_info ci\n  INNER JOIN financial_ratio fr ON ci.stock_code = fr.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  ci.stock_code IN ('VNM', 'MSN', 'HPG')\n  AND mcr.ratio_name = 'Return On Equity'\n  AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) \n       OR (fr.year = 2024 AND fr.quarter = 2))\nLIMIT 100;\n"
            }
        ],
        "time": 26.656313180923462,
        "evaluate": 0.5,
        "input_token": 2175,
        "output_token": 779
    },
    {
        "id": "14f189a3-a158-450b-9b00-6970b80da60a",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) among Vietcombank, Techcombank, ACB, BIDV, and VPBank for the period from 2020 to Q2 2024.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |      roe |\n|:-------------|-------:|----------:|---------:|\n| ACB          |   2022 |         0 | 0.234232 |\n| ACB          |   2023 |         0 | 0.226122 |\n| VCB          |   2022 |         0 | 0.220567 |\n| ACB          |   2020 |         0 | 0.216734 |\n| ACB          |   2021 |         0 | 0.213865 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, year, quarter, data AS roe\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'VPB')\n  AND (\n    (year = 2024 AND quarter <= 2) OR\n    (year BETWEEN 2020 AND 2023 AND quarter = 0)\n  )\nORDER BY roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name                                         |   year |   quarter |   roe_value |\n|:-------------|:-----------------------------------------------------|-------:|----------:|------------:|\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i       |   2024 |         2 |         nan |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i       |   2024 |         2 |         nan |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                     |   2024 |         2 |         nan |\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin |   2024 |         2 |         nan |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i       |   2024 |         2 |         nan |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.company_name, -- Assuming 'en_company_name' is what we want, but since 'company_name' is not directly provided in the schema, we'll use this as a placeholder. You might need to adjust based on the actual schema.\n  fr.year,\n  fr.quarter,\n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Return On Equity' -- To ensure we're getting ROE\n  AND fr.stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'VPB') -- Filtering for the specified companies\n  AND (fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) -- Annual data up to 2024\n  OR (fr.year = 2024 AND fr.quarter = 2) -- Specifically Q2 2024\nORDER BY \n  fr.data DESC -- Ranking by ROE value in descending order\nLIMIT 5; -- To get the top 5\n"
            }
        ],
        "time": 40.846829414367676,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "62907a1f-3544-4f00-acbc-9099a5fa6f67",
        "question": "What were the Return on Equity (ROE) and Debt-to-Equity ratios for Vietcombank and Techcombank in 2023?",
        "answer": "Table 1\n| stock_code   | ratio_code   |      data |\n|:-------------|:-------------|----------:|\n| TCB          | DTER         |  5.50936  |\n| VCB          | DTER         | 10.1483   |\n| TCB          | ROE          |  0.139608 |\n| VCB          | ROE          |  0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    ratio_code, \n    data \nFROM \n    financial_ratio \nWHERE \n    (stock_code = 'VCB' OR stock_code = 'TCB') \n    AND year = 2023 \n    AND quarter = 0 \n    AND (ratio_code = 'ROE' OR ratio_code = 'DTER');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   | ratio_name           |   year |      data |\n|:-------------|:---------------------|-------:|----------:|\n| VCB          | Debt To Equity Ratio |   2023 | 10.1483   |\n| VCB          | Return On Equity     |   2023 |  0.200315 |\n| TCB          | Debt To Equity Ratio |   2023 |  5.50936  |\n| TCB          | Return On Equity     |   2023 |  0.139608 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  mcr.ratio_name,\n  fr.year,\n  fr.data\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n  fr.stock_code IN ('VCB', 'TCB') \n  AND fr.year = 2023 \n  AND fr.quarter = 0 \n  AND mcr.ratio_name IN ('Return On Equity', 'Debt To Equity Ratio')\nLIMIT 100;\n"
            }
        ],
        "time": 32.95011806488037,
        "evaluate": 1,
        "input_token": 4944,
        "output_token": 1723
    },
    {
        "id": "c7ee3213-142c-4b94-ac63-6f90c9317169",
        "question": "What is the trend of Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024, considering their respective subsidiaries' financial performance?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |       roe |\n|-------:|----------:|:-------------|----------:|\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2020 |         0 | ACB          | 0.216734  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2021 |         0 | ACB          | 0.213865  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2022 |         0 | ACB          | 0.234232  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2023 |         0 | ACB          | 0.226122  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2024 |         1 | ACB          | 0.052218  |\n|   2020 |         0 | EIB          | 0.0636274 |\n|   2020 |         0 | EIB          | 0.0636274 |\n|   2020 |         0 | EIB          | 0.0636274 |\n|   2021 |         0 | EIB          | 0.0542841 |\n|   2021 |         0 | EIB          | 0.0542841 |\n|   2021 |         0 | EIB          | 0.0542841 |\n|   2022 |         0 | EIB          | 0.143836  |\n|   2022 |         0 | EIB          | 0.143836  |\n|   2022 |         0 | EIB          | 0.143836  |\n|   2023 |         0 | EIB          | 0.0964624 |\n|   2023 |         0 | EIB          | 0.0964624 |\n|   2023 |         0 | EIB          | 0.0964624 |\n|   2024 |         1 | EIB          | 0.0229559 |\n|   2024 |         1 | EIB          | 0.0229559 |\n|   2024 |         1 | EIB          | 0.0229559 |\n|   2020 |         0 | MBB          | 0.171779  |\n|   2020 |         0 | MBB          | 0.171779  |\n|   2021 |         0 | MBB          | 0.21159   |\n|   2021 |         0 | MBB          | 0.21159   |\n|   2022 |         0 | MBB          | 0.228042  |\n|   2022 |         0 | MBB          | 0.228042  |\n|   2023 |         0 | MBB          | 0.217698  |\n|   2023 |         0 | MBB          | 0.217698  |\n|   2020 |         0 | MSN          | 0.055733  |\n|   2021 |         0 | MSN          | 0.238597  |\n|   2022 |         0 | MSN          | 0.129771  |\n|   2023 |         0 | MSN          | 0.0489033 |\n|   2024 |         1 | MSN          | 0.0123309 |\n|   2020 |         0 | OCB          | 0.202736  |\n|   2020 |         0 | OCB          | 0.202736  |\n|   2021 |         0 | OCB          | 0.202016  |\n|   2021 |         0 | OCB          | 0.202016  |\n|   2022 |         0 | OCB          | 0.138876  |\n|   2022 |         0 | OCB          | 0.138876  |\n|   2023 |         0 | OCB          | 0.11576   |\n|   2023 |         0 | OCB          | 0.11576   |\n|   2024 |         1 | OCB          | 0.03233   |\n|   2024 |         1 | OCB          | 0.03233   |\n|   2020 |         0 | PVT          | 0.132256  |\n|   2021 |         0 | PVT          | 0.119846  |\n|   2022 |         0 | PVT          | 0.144227  |\n|   2023 |         0 | PVT          | 0.135265  |\n|   2024 |         1 | PVT          | 0.0327416 |\n|   2024 |         2 | PVT          | 0.0394265 |\n|   2020 |         0 | TCB          | 0.168632  |\n|   2020 |         0 | TCB          | 0.168632  |\n|   2020 |         0 | TCB          | 0.168632  |\n|   2021 |         0 | TCB          | 0.197927  |\n|   2021 |         0 | TCB          | 0.197927  |\n|   2021 |         0 | TCB          | 0.197927  |\n|   2022 |         0 | TCB          | 0.180176  |\n|   2022 |         0 | TCB          | 0.180176  |\n|   2022 |         0 | TCB          | 0.180176  |\n|   2023 |         0 | TCB          | 0.139608  |\n|   2023 |         0 | TCB          | 0.139608  |\n|   2023 |         0 | TCB          | 0.139608  |\n|   2024 |         1 | TCB          | 0.0459854 |\n|   2024 |         1 | TCB          | 0.0459854 |\n|   2024 |         1 | TCB          | 0.0459854 |\n|   2024 |         2 | TCB          | 0.0457096 |\n|   2024 |         2 | TCB          | 0.0457096 |\n|   2024 |         2 | TCB          | 0.0457096 |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2020 |         0 | VCB          | 0.196318  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2021 |         0 | VCB          | 0.201059  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2022 |         0 | VCB          | 0.220567  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2023 |         0 | VCB          | 0.200315  |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n|   2024 |         1 | VCB          | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    fr.stock_code, \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    sub_and_shareholder ssh ON fr.stock_code = ssh.stock_code OR fr.stock_code = ssh.invest_on\nWHERE \n    mccr.ratio_name = 'Return On Equity'\n    AND (ssh.stock_code IN ('VCB', 'TCB', 'ACB') OR ssh.invest_on IN ('VCB', 'TCB', 'ACB'))\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter <= 2))\nORDER BY \n    fr.stock_code, \n    fr.year, \n    fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |   year |   quarter |   roe_value |\n|:-------------|-------:|----------:|------------:|\n| ACB          |   2020 |         0 |   0.216734  |\n| ACB          |   2021 |         0 |   0.213865  |\n| ACB          |   2022 |         0 |   0.234232  |\n| ACB          |   2023 |         0 |   0.226122  |\n| EIB          |   2020 |         0 |   0.0636274 |\n| EIB          |   2021 |         0 |   0.0542841 |\n| EIB          |   2022 |         0 |   0.143836  |\n| EIB          |   2023 |         0 |   0.0964624 |\n| MBB          |   2020 |         0 |   0.171779  |\n| MBB          |   2021 |         0 |   0.21159   |\n| MBB          |   2022 |         0 |   0.228042  |\n| MBB          |   2023 |         0 |   0.217698  |\n| OCB          |   2020 |         0 |   0.202736  |\n| OCB          |   2021 |         0 |   0.202016  |\n| OCB          |   2022 |         0 |   0.138876  |\n| OCB          |   2023 |         0 |   0.11576   |\n| PVT          |   2020 |         0 |   0.132256  |\n| PVT          |   2021 |         0 |   0.119846  |\n| PVT          |   2022 |         0 |   0.144227  |\n| PVT          |   2023 |         0 |   0.135265  |\n| PVT          |   2024 |         2 |   0.0394265 |\n| TCB          |   2020 |         0 |   0.168632  |\n| TCB          |   2021 |         0 |   0.197927  |\n| TCB          |   2022 |         0 |   0.180176  |\n| TCB          |   2023 |         0 |   0.139608  |\n| TCB          |   2024 |         2 |   0.0457096 |\n| VCB          |   2020 |         0 |   0.196318  |\n| VCB          |   2021 |         0 |   0.201059  |\n| VCB          |   2022 |         0 |   0.220567  |\n| VCB          |   2023 |         0 |   0.200315  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Step 1: Identify Stock Codes of Interest (including subsidiaries)\ncompanies_of_interest AS (\n  SELECT stock_code FROM company_info\n  WHERE stock_code IN ('VCB', 'TCB', 'ACB')\n  UNION\n  SELECT invest_on AS stock_code FROM sub_and_shareholder\n  WHERE stock_code IN ('VCB', 'TCB', 'ACB')\n),\n\n-- Step 2: Retrieve ROE Data for These Companies\nroe_data AS (\n  SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    fr.data AS roe_value\n  FROM \n    financial_ratio fr\n  INNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  INNER JOIN \n    companies_of_interest coi ON fr.stock_code = coi.stock_code\n  WHERE \n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\n)\n\n-- Step 3: Present the Trend\nSELECT \n  stock_code,\n  year,\n  quarter,\n  roe_value\nFROM \n  roe_data\nORDER BY \n  stock_code, year, quarter\nLIMIT 100;  -- To adhere to the 'must add limit' instruction\n"
            }
        ],
        "time": 33.1171772480011,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "360e3adc-d07d-4357-9c84-5526619e7f5f",
        "question": "How has the Net Profit Margin of Vinamilk, Masan Group, and other companies with significant investments in subsidiaries evolved from 2020 to Q2 2024?  Analyze this considering the profitability contributions from their subsidiaries.",
        "answer": "Table 1\n| stock_code   | en_company_name   | year   | quarter   | net_profit_margin   |\n|--------------|-------------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.en_company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS net_profit_margin\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nLEFT JOIN \n    sub_and_shareholder ss ON ci.stock_code = ss.stock_code\nWHERE \n    mccr.ratio_name = 'Net profit margin'\n    AND (ci.stock_code = 'VNM' OR ci.stock_code = 'MSN' OR ss.stock_code IS NOT NULL)\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | year   | quarter   | npm   |\n|--------------|--------|-----------|-------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH CompaniesOfInterest AS (\n  SELECT stock_code \n  FROM company_info \n  WHERE stock_code IN ('VNM', 'MSN') \n  UNION \n  SELECT DISTINCT stock_code \n  FROM sub_and_shareholder \n  WHERE invest_on IS NOT NULL\n),\nNetProfitMarginEvolution AS (\n  SELECT \n    fri.stock_code, \n    fri.year, \n    fri.quarter, \n    fri.data AS NPM\n  FROM \n    financial_ratio fri\n  INNER JOIN \n    map_category_code_ratio mcr ON fri.ratio_code = mcr.ratio_code\n  INNER JOIN \n    CompaniesOfInterest coi ON fri.stock_code = coi.stock_code\n  WHERE \n    mcr.ratio_name = 'Net profit margin' \n    AND fri.year BETWEEN 2020 AND 2024\n    AND (fri.year < 2024 OR (fri.year = 2024 AND fri.quarter <= 2))\n)\nSELECT * FROM NetProfitMarginEvolution\nORDER BY stock_code, year, quarter\nLIMIT 100;  -- Adjust the LIMIT as necessary\n"
            }
        ],
        "time": 37.60465455055237,
        "evaluate": 0,
        "input_token": 1954,
        "output_token": 850
    },
    {
        "id": "e2b68420-a9fe-4c34-b33a-0b2f2f44c423",
        "question": "Compare the operating cash flow and capital expenditures of Vinamilk and Masan Group for the period from 2020 to Q2 2024.  Calculate the free cash flow for each company during this period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   operating_cash_flow |   capital_expenditures |   free_cash_flow |\n|:-------------|-------:|----------:|----------------------:|-----------------------:|-----------------:|\n| MSN          |   2020 |         0 |           1.3513e+06  |           -3.67816e+06 |      5.02946e+06 |\n| MSN          |   2021 |         0 |           1.14391e+06 |           -2.80543e+06 |      3.94934e+06 |\n| MSN          |   2022 |         0 |          -3.78885e+06 |           -4.16532e+06 | 376469           |\n| MSN          |   2023 |         0 |      500461           |           -2.2288e+06  |      2.72926e+06 |\n| MSN          |   2024 |         1 |      -35373           |      -396763           | 361390           |\n| VNM          |   2020 |         0 |           1.01802e+07 |           -1.26482e+06 |      1.1445e+07  |\n| VNM          |   2021 |         0 |           9.43197e+06 |           -1.53102e+06 |      1.0963e+07  |\n| VNM          |   2022 |         0 |           8.82727e+06 |           -1.45691e+06 |      1.02842e+07 |\n| VNM          |   2023 |         0 |           7.88742e+06 |           -1.57964e+06 |      9.46706e+06 |\n| VNM          |   2024 |         1 |      907549           |      -378452           |      1.286e+06   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nbfr.stock_code,\n    nbfr.year,\n    nbfr.quarter,\n    SUM(CASE WHEN nbfr.category_code = 'CF_020' THEN nbfr.data ELSE 0 END) AS operating_cash_flow,\n    SUM(CASE WHEN nbfr.category_code = 'CF_021' THEN nbfr.data ELSE 0 END) AS capital_expenditures,\n    SUM(CASE WHEN nbfr.category_code = 'CF_020' THEN nbfr.data ELSE 0 END) - \n    SUM(CASE WHEN nbfr.category_code = 'CF_021' THEN nbfr.data ELSE 0 END) AS free_cash_flow\nFROM \n    non_bank_financial_report nbfr\nWHERE \n    nbfr.stock_code IN ('VNM', 'MSN') AND\n    ((nbfr.year = 2020 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2021 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2022 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2023 AND nbfr.quarter = 0) OR\n     (nbfr.year = 2024 AND nbfr.quarter <= 2))\n    AND nbfr.category_code IN ('CF_020', 'CF_021')\nGROUP BY \n    nbfr.stock_code, nbfr.year, nbfr.quarter\nORDER BY \n    nbfr.stock_code, nbfr.year, nbfr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Assuming category codes for demonstration; replace with actual codes from map_category_code_non_bank\nOperatingCashFlow AS (\n  SELECT stock_code, year, quarter, data AS OCF\n  FROM non_bank_financial_report\n  WHERE category_code = 'CF_001' -- Hypothetical code for Operating Cash Flow\n  AND stock_code IN ('VNM', 'MSN')\n  AND year BETWEEN 2020 AND 2024\n  AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n),\nCapitalExpenditures AS (\n  SELECT stock_code, year, quarter, data AS CE\n  FROM non_bank_financial_report\n  WHERE category_code = 'CF_002' -- Hypothetical code for Capital Expenditures\n  AND stock_code IN ('VNM', 'MSN')\n  AND year BETWEEN 2020 AND 2024\n  AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n),\n-- Attempt to use pre-calculated FCF if available, otherwise calculate\nFreeCashFlow AS (\n  SELECT \n    fr.stock_code, \n    fr.year, \n    fr.quarter, \n    COALESCE(fr.data, (OCF.data - CE.data)) AS FCF\n  FROM \n    financial_ratio fr\n    FULL OUTER JOIN OperatingCashFlow OCF ON fr.stock_code = OCF.stock_code AND fr.year = OCF.year AND fr.quarter = OCF.quarter\n    FULL OUTER JOIN CapitalExpenditures CE ON fr.stock_code = CE.stock_code AND fr.year = CE.year AND fr.quarter = CE.quarter\n  WHERE \n    (fr.ratio_code = 'FCF' AND fr.stock_code IN ('VNM', 'MSN') AND fr.year BETWEEN 2020 AND 2024 \n     AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2)))\n    OR (fr.stock_code IS NULL AND OCF.stock_code IS NOT NULL)\n)\n\n-- Final Query\nSELECT \n  stock_code,\n  year,\n  quarter,\n  (SELECT OCF FROM OperatingCashFlow OCF WHERE OCF.stock_code = FCF.stock_code AND OCF.year = FCF.year AND OCF.quarter = FCF.quarter) AS OperatingCashFlow,\n  (SELECT CE FROM CapitalExpenditures CE WHERE CE.stock_code = FCF.stock_code AND CE.year = FCF.year AND CE.quarter = FCF.quarter) AS CapitalExpenditures,\n  FCF AS FreeCashFlow\nFROM \n  FreeCashFlow\nLIMIT 100;\n"
            }
        ],
        "time": 44.71824502944946,
        "evaluate": 0,
        "input_token": 1962,
        "output_token": 1231
    },
    {
        "id": "b7305bbf-5414-4848-8c0d-223f54960820",
        "question": "Rank the top 5 companies with total assets greater than 100,000 billion VND as of December 31, 2023, based on their Return on Equity (ROE).",
        "answer": "Table 1\n| stock_code   | industry   |      roe |\n|:-------------|:-----------|---------:|\n| HDB          | Banking    | 0.232433 |\n| ACB          | Banking    | 0.226122 |\n| VIB          | Banking    | 0.225702 |\n| MBB          | Banking    | 0.217698 |\n| VCB          | Banking    | 0.200315 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT stock_code, data AS total_assets\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM securities_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n),\nfiltered_companies AS (\n    SELECT stock_code\n    FROM total_assets\n    WHERE total_assets > 100000000\n),\nroe_data AS (\n    SELECT stock_code, data AS roe\n    FROM financial_ratio\n    WHERE ratio_code = 'ROE' AND year = 2023 AND quarter = 0\n)\nSELECT ci.stock_code, ci.industry, roe_data.roe\nFROM filtered_companies fc\nJOIN roe_data ON fc.stock_code = roe_data.stock_code\nJOIN company_info ci ON fc.stock_code = ci.stock_code\nORDER BY roe_data.roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |      roe |\n|:-------------|---------:|\n| HDB          | 0.232433 |\n| ACB          | 0.226122 |\n| VIB          | 0.225702 |\n| MBB          | 0.217698 |\n| VCB          | 0.200315 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine all financial reports for total assets\nTotalAssets AS (\n  SELECT 'bank' AS report_type, stock_code, year, quarter, category_code, data \n  FROM bank_financial_report \n  WHERE category_code = 'BS_300' -- Total Assets for Banks\n  UNION ALL\n  SELECT 'non_bank' AS report_type, stock_code, year, quarter, category_code, data \n  FROM non_bank_financial_report \n  WHERE category_code = 'BS_270' -- Total Assets for Non-Banks\n  UNION ALL\n  SELECT 'securities' AS report_type, stock_code, year, quarter, category_code, data \n  FROM securities_financial_report \n  WHERE category_code = 'BS_270' -- Total Assets for Securities\n),\n\n-- Filter companies with total assets > 100,000 billion VND as of 2023\nEligibleCompanies AS (\n  SELECT stock_code, data AS total_assets\n  FROM TotalAssets\n  WHERE year = 2023 AND quarter = 0 AND data > 100000000\n),\n\n-- Get ROE for eligible companies\nCompanyROE AS (\n  SELECT ec.stock_code, fr.data AS roe\n  FROM EligibleCompanies ec\n  JOIN financial_ratio fr ON ec.stock_code = fr.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE mcr.ratio_name = 'Return On Equity' AND fr.year = 2023 AND fr.quarter = 0\n)\n\n-- Rank companies by ROE and limit to top 5\nSELECT stock_code, roe\nFROM CompanyROE\nORDER BY roe DESC\nLIMIT 5;\n"
            }
        ],
        "time": 31.389793872833252,
        "evaluate": 1,
        "input_token": 2226,
        "output_token": 913
    },
    {
        "id": "0759f255-d239-4e78-be61-78f7c00f8b42",
        "question": "What is the total amount of  property, plant, and equipment (PP&E) for Vinamilk, Masan Group, and Hoa Phat Group at the end of 2023?",
        "answer": "Table 1\n| stock_code   |   total_ppe |\n|:-------------|------------:|\n| HPG          | 7.19984e+07 |\n| MSN          | 4.28858e+07 |\n| VNM          | 1.26897e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    SUM(data) AS total_ppe\nFROM \n    non_bank_financial_report\nWHERE \n    year = 2023 \n    AND quarter = 0 \n    AND stock_code IN ('VNM', 'MSN', 'HPG')\n    AND category_code IN ('BS_221', 'BS_224', 'BS_227')\nGROUP BY \n    stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | total_pp_e   |\n|--------------|--------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    T1.stock_code,\n    T1.data AS Total_PP_E\nFROM \n    non_bank_financial_report T1\nINNER JOIN \n    map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nINNER JOIN \n    company_info T3 ON T1.stock_code = T3.stock_code\nWHERE \n    T1.stock_code IN ('VNM', 'MSN', 'HPG')  -- Target companies\n    AND T1.year = 2023  -- Year of interest\n    AND T1.quarter = 0  -- Annual report\n    AND T2.en_caption = 'Property, Plant and Equipment'  -- Assuming this matches the caption for PP&E\nLIMIT 100;  -- Adding a limit as per the database access note\n"
            }
        ],
        "time": 33.60287666320801,
        "evaluate": 0,
        "input_token": 1751,
        "output_token": 601
    },
    {
        "id": "15ce94fa-2646-4432-b91e-8ef1497dda44",
        "question": "For the period 2020-Q2 2024, provide the year-over-year change in the return on equity (ROE) for Vinamilk, Masan Group, and Hoa Phat Group,  separately showing the impact of their subsidiaries and investments on their overall ROE.",
        "answer": "Table 1\n| main_company   |   year |   quarter |   main_company_roe | subsidiary_code   |   subsidiary_roe |\n|:---------------|-------:|----------:|-------------------:|:------------------|-----------------:|\n| HPG            |   2020 |         2 |         0.0524064  |                   |      nan         |\n| HPG            |   2020 |         3 |         0.0688363  |                   |      nan         |\n| HPG            |   2020 |         4 |         0.0787021  |                   |      nan         |\n| HPG            |   2021 |         0 |         0.380268   |                   |      nan         |\n| HPG            |   2021 |         1 |         0.10579    |                   |      nan         |\n| HPG            |   2021 |         2 |         0.131719   |                   |      nan         |\n| HPG            |   2021 |         3 |         0.122748   |                   |      nan         |\n| HPG            |   2021 |         4 |         0.0817293  |                   |      nan         |\n| HPG            |   2022 |         0 |         0.0878594  |                   |      nan         |\n| HPG            |   2022 |         1 |         0.0829275  |                   |      nan         |\n| HPG            |   2022 |         2 |         0.0402598  |                   |      nan         |\n| HPG            |   2022 |         3 |        -0.0182075  |                   |      nan         |\n| HPG            |   2022 |         4 |        -0.020796   |                   |      nan         |\n| HPG            |   2023 |         0 |         0.0661282  |                   |      nan         |\n| HPG            |   2023 |         1 |         0.00397384 |                   |      nan         |\n| HPG            |   2023 |         2 |         0.0147948  |                   |      nan         |\n| HPG            |   2023 |         3 |         0.0200306  |                   |      nan         |\n| HPG            |   2023 |         4 |         0.0288708  |                   |      nan         |\n| HPG            |   2024 |         1 |         0.027164   |                   |      nan         |\n| HPG            |   2024 |         2 |         0.0305454  |                   |      nan         |\n| MSN            |   2020 |         2 |         0.00174282 | TCB               |        0.0428449 |\n| MSN            |   2020 |         3 |         0.0340108  | TCB               |        0.0450409 |\n| MSN            |   2020 |         4 |         0.0233474  | TCB               |        0.0537099 |\n| MSN            |   2021 |         0 |         0.238597   | TCB               |        0.197927  |\n| MSN            |   2021 |         1 |         0.0134906  | TCB               |        0.0565945 |\n| MSN            |   2021 |         2 |         0.0335106  | TCB               |        0.0572896 |\n| MSN            |   2021 |         3 |         0.0490112  | TCB               |        0.0501452 |\n| MSN            |   2021 |         4 |         0.168149   | TCB               |        0.0503334 |\n| MSN            |   2022 |         0 |         0.129771   | TCB               |        0.180176  |\n| MSN            |   2022 |         1 |         0.0515801  | TCB               |        0.0569507 |\n| MSN            |   2022 |         2 |         0.0313142  | TCB               |        0.0562806 |\n| MSN            |   2022 |         3 |         0.0236221  | TCB               |        0.0488406 |\n| MSN            |   2022 |         4 |         0.021933   | TCB               |        0.031493  |\n| MSN            |   2023 |         0 |         0.0489033  | TCB               |        0.139608  |\n| MSN            |   2023 |         1 |         0.0118431  | TCB               |        0.0384612 |\n| MSN            |   2023 |         2 |         0.0114376  | TCB               |        0.0367734 |\n| MSN            |   2023 |         3 |         0.0127258  | TCB               |        0.0367239 |\n| MSN            |   2023 |         4 |         0.013515   | TCB               |        0.0381519 |\n| MSN            |   2024 |         1 |         0.0123309  | TCB               |        0.0459854 |\n| VNM            |   2020 |         2 |         0.095333   |                   |      nan         |\n| VNM            |   2020 |         3 |         0.0990225  |                   |      nan         |\n| VNM            |   2020 |         4 |         0.0664599  |                   |      nan         |\n| VNM            |   2021 |         0 |         0.296583   |                   |      nan         |\n| VNM            |   2021 |         1 |         0.0764615  |                   |      nan         |\n| VNM            |   2021 |         2 |         0.0832651  |                   |      nan         |\n| VNM            |   2021 |         3 |         0.0874017  |                   |      nan         |\n| VNM            |   2021 |         4 |         0.0617182  |                   |      nan         |\n| VNM            |   2022 |         0 |         0.26138    |                   |      nan         |\n| VNM            |   2022 |         1 |         0.06528    |                   |      nan         |\n| VNM            |   2022 |         2 |         0.057095   |                   |      nan         |\n| VNM            |   2022 |         3 |         0.0686339  |                   |      nan         |\n| VNM            |   2022 |         4 |         0.0569567  |                   |      nan         |\n| VNM            |   2023 |         0 |         0.257506   |                   |      nan         |\n| VNM            |   2023 |         1 |         0.0552366  |                   |      nan         |\n| VNM            |   2023 |         2 |         0.112804   |                   |      nan         |\n| VNM            |   2023 |         3 |         0.0745011  |                   |      nan         |\n| VNM            |   2023 |         4 |         0.0671136  |                   |      nan         |\n| VNM            |   2024 |         1 |         0.0615314  |                   |      nan         |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH main_company_roe AS (\n    SELECT \n        fr.stock_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS roe\n    FROM \n        financial_ratio fr\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Return On Equity'\n        AND fr.stock_code IN ('VNM', 'MSN', 'HPG')\n        AND ((fr.year = 2020 AND fr.quarter >= 2) OR (fr.year > 2020 AND fr.year < 2024) OR (fr.year = 2024 AND fr.quarter <= 2))\n),\nsubsidiary_roe AS (\n    SELECT \n        s.stock_code,\n        s.invest_on AS subsidiary_code,\n        fr.year,\n        fr.quarter,\n        fr.data AS roe\n    FROM \n        sub_and_shareholder s\n    JOIN \n        financial_ratio fr ON s.invest_on = fr.stock_code\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Return On Equity'\n        AND s.stock_code IN ('VNM', 'MSN', 'HPG')\n        AND ((fr.year = 2020 AND fr.quarter >= 2) OR (fr.year > 2020 AND fr.year < 2024) OR (fr.year = 2024 AND fr.quarter <= 2))\n)\nSELECT \n    mc.stock_code AS main_company,\n    mc.year,\n    mc.quarter,\n    mc.roe AS main_company_roe,\n    sr.subsidiary_code,\n    sr.roe AS subsidiary_roe\nFROM \n    main_company_roe mc\nLEFT JOIN \n    subsidiary_roe sr ON mc.stock_code = sr.stock_code AND mc.year = sr.year AND mc.quarter = sr.quarter\nORDER BY \n    mc.stock_code, mc.year, mc.quarter, sr.subsidiary_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | company_name                      |   year |   roe_value |   yoy_roe_change | subsidiary_impact   |\n|:-------------|:----------------------------------|-------:|------------:|-----------------:|:--------------------|\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |   0.228068  |     nan          | [None]              |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |   0.380268  |       0.152199   | [None]              |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |   0.0878594 |      -0.292408   | [None]              |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |   0.0661282 |      -0.0217312  | [None]              |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |   0.055733  |     nan          | [None]              |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |   0.238597  |       0.182864   | [None]              |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |   0.129771  |      -0.108826   | [None]              |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |   0.0489033 |      -0.0808676  | [None]              |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |   0.333928  |     nan          | [None]              |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |   0.296583  |      -0.0373455  | [None]              |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |   0.26138   |      -0.0352032  | [None]              |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |   0.257506  |      -0.00387337 | [None]              |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Annual ROE for specified companies\nCompany_ROE AS (\n  SELECT \n    fr.stock_code,\n    ci.company_name,\n    fr.year,\n    fr.data AS ROE_Value\n  FROM \n    financial_ratio fr\n  JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\n  JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE \n    mcr.ratio_name = 'Return On Equity'\n    AND fr.quarter = 0  -- Annual reports\n    AND fr.year BETWEEN 2020 AND 2024\n    AND ci.stock_code IN ('VNM', 'MSN', 'HPG')\n),\n\n-- Subsidiaries and Investments ROE (if any)\nSubsidiary_ROE AS (\n  SELECT \n    sass.stock_code AS Parent_Code,\n    sass.invest_on AS Subsidiary_Code,\n    croe.year,\n    croe.ROE_Value AS Subsidiary_ROE_Value\n  FROM \n    sub_and_shareholder sass\n  JOIN \n    Company_ROE croe ON sass.invest_on = croe.stock_code\n  WHERE \n    sass.stock_code IN ('VNM', 'MSN', 'HPG')\n)\n\n-- Main Query: Combining Company ROE with Subsidiary/Investment Impact\nSELECT \n  croe.stock_code,\n  croe.company_name,\n  croe.year,\n  croe.ROE_Value,\n  -- Calculate Year-over-Year Change\n  (croe.ROE_Value - LAG(croe.ROE_Value) OVER (PARTITION BY croe.stock_code ORDER BY croe.year)) AS YoY_ROE_Change,\n  -- Subsidiary/Investment Details (if exists)\n  ARRAY_AGG(DISTINCT sro.Subsidiary_Code || ': ' || sro.Subsidiary_ROE_Value) AS Subsidiary_Impact\nFROM \n  Company_ROE croe\n  LEFT JOIN Subsidiary_ROE sro ON croe.stock_code = sro.Parent_Code AND croe.year = sro.year\nGROUP BY \n  croe.stock_code, croe.company_name, croe.year, croe.ROE_Value\nORDER BY \n  croe.stock_code, croe.year\nLIMIT 100;  -- To adhere to the limit requirement\n"
            }
        ],
        "time": 37.013041734695435,
        "evaluate": 0,
        "input_token": 2186,
        "output_token": 1168
    },
    {
        "id": "2021f2a2-50f4-49c3-8242-38373e361aa0",
        "question": "What is the trend of total assets and total liabilities for Vietcombank, Techcombank, and VPBank from 2020 to Q2 2024, broken down by the assets and liabilities of their subsidiaries and other investments?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | category          |   bank_data |   subsidiary_data |\n|:-------------|-------:|----------:|:------------------|------------:|------------------:|\n| TCB          |   2020 |         0 | Total assets      | 4.39603e+08 |                 0 |\n| TCB          |   2020 |         0 | Total liabilities | 3.64988e+08 |                 0 |\n| TCB          |   2021 |         0 | Total assets      | 5.68729e+08 |                 0 |\n| TCB          |   2021 |         0 | Total liabilities | 4.75687e+08 |                 0 |\n| TCB          |   2022 |         0 | Total assets      | 6.99033e+08 |                 0 |\n| TCB          |   2022 |         0 | Total liabilities | 5.85608e+08 |                 0 |\n| TCB          |   2023 |         0 | Total assets      | 8.49482e+08 |                 0 |\n| TCB          |   2023 |         0 | Total liabilities | 7.17866e+08 |                 0 |\n| TCB          |   2024 |         2 | Total assets      | 9.08307e+08 |                 0 |\n| TCB          |   2024 |         2 | Total liabilities | 7.69755e+08 |                 0 |\n| VCB          |   2020 |         0 | Total assets      | 1.32623e+09 |                 0 |\n| VCB          |   2020 |         0 | Total liabilities | 1.23214e+09 |                 0 |\n| VCB          |   2021 |         0 | Total assets      | 1.41467e+09 |                 0 |\n| VCB          |   2021 |         0 | Total liabilities | 1.30556e+09 |                 0 |\n| VCB          |   2022 |         0 | Total assets      | 1.81382e+09 |                 0 |\n| VCB          |   2022 |         0 | Total liabilities | 1.67817e+09 |                 0 |\n| VCB          |   2023 |         0 | Total assets      | 1.83961e+09 |                 0 |\n| VCB          |   2023 |         0 | Total liabilities | 1.6746e+09  |                 0 |\n| VPB          |   2020 |         0 | Total assets      | 4.19027e+08 |                 0 |\n| VPB          |   2020 |         0 | Total liabilities | 3.66233e+08 |                 0 |\n| VPB          |   2021 |         0 | Total assets      | 5.47409e+08 |                 0 |\n| VPB          |   2021 |         0 | Total liabilities | 4.61131e+08 |                 0 |\n| VPB          |   2022 |         0 | Total assets      | 6.31013e+08 |                 0 |\n| VPB          |   2022 |         0 | Total liabilities | 5.27511e+08 |                 0 |\n| VPB          |   2023 |         0 | Total assets      | 8.17567e+08 |                 0 |\n| VPB          |   2023 |         0 | Total liabilities | 6.77771e+08 |                 0 |\n| VPB          |   2024 |         2 | Total assets      | 8.64392e+08 |                 0 |\n| VPB          |   2024 |         2 | Total liabilities | 7.26325e+08 |                 0 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_assets_liabilities AS (\n    SELECT\n        stock_code,\n        year,\n        quarter,\n        category_code,\n        data\n    FROM\n        bank_financial_report\n    WHERE\n        stock_code IN ('VCB', 'TCB', 'VPB')\n        AND category_code IN ('BS_300', 'BS_400') -- Total assets and total liabilities\n        AND ((year BETWEEN 2020 AND 2024) AND (quarter = 0 OR (year = 2024 AND quarter = 2)))\n),\nsubsidiary_investments AS (\n    SELECT\n        ss.stock_code,\n        ss.invest_on,\n        bf.year,\n        bf.quarter,\n        bf.category_code,\n        bf.data\n    FROM\n        sub_and_shareholder ss\n    JOIN\n        bank_financial_report bf ON ss.invest_on = bf.stock_code\n    WHERE\n        ss.stock_code IN ('VCB', 'TCB', 'VPB')\n        AND bf.category_code IN ('BS_211', 'BS_213', 'BS_214') -- Investments in subsidiaries and other entities\n        AND ((bf.year BETWEEN 2020 AND 2024) AND (bf.quarter = 0 OR (bf.year = 2024 AND bf.quarter = 2)))\n)\nSELECT\n    ba.stock_code,\n    ba.year,\n    ba.quarter,\n    mc.en_caption AS category,\n    ba.data AS bank_data,\n    COALESCE(SUM(si.data), 0) AS subsidiary_data\nFROM\n    bank_assets_liabilities ba\nJOIN\n    map_category_code_bank mc ON ba.category_code = mc.category_code\nLEFT JOIN\n    subsidiary_investments si ON ba.stock_code = si.stock_code AND ba.year = si.year AND ba.quarter = si.quarter AND ba.category_code = si.category_code\nGROUP BY\n    ba.stock_code, ba.year, ba.quarter, mc.en_caption, ba.data\nORDER BY\n    ba.stock_code, ba.year, ba.quarter, mc.en_caption;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Subquery to identify Total Assets and Total Liabilities for the specified banks\nbank_financials AS (\n  SELECT \n    'Direct' AS Investment_Type,\n    bfr.stock_code,\n    bfr.year,\n    bfr.quarter,\n    mccb.en_caption,\n    bfr.data\n  FROM \n    bank_financial_report bfr\n  JOIN \n    map_category_code_bank mccb ON bfr.category_code = mccb.category_code\n  WHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'VPB')\n    AND bfr.year BETWEEN 2020 AND 2024\n    AND (bfr.quarter = 0 OR (bfr.quarter = 2 AND bfr.year = 2024))  -- Annual or Q2 2024\n    AND mccb.en_caption IN ('Total assets', 'Total liabilities')\n),\n\n-- Subquery to identify financials for subsidiaries and other investments\ninvestment_financials AS (\n  SELECT \n    'Subsidiary/Investment' AS Investment_Type,\n    COALESCE(sas.invest_on, sas.stock_code) AS Related_Company,\n    bfr.year,\n    bfr.quarter,\n    mccb.en_caption,\n    bfr.data\n  FROM \n    bank_financial_report bfr\n  JOIN \n    map_category_code_bank mccb ON bfr.category_code = mccb.category_code\n  RIGHT JOIN \n    sub_and_shareholder sas ON bfr.stock_code = sas.stock_code OR bfr.stock_code = sas.invest_on\n  WHERE \n    (sas.stock_code IN ('VCB', 'TCB', 'VPB') OR sas.invest_on IN ('VCB', 'TCB', 'VPB'))\n    AND bfr.year BETWEEN 2020 AND 2024\n    AND (bfr.quarter = 0 OR (bfr.quarter = 2 AND bfr.year = 2024))\n    AND mccb.en_caption IN ('Total assets', 'Total liabilities')\n)\n\n-- Union the two subqueries and filter for the companies of interest\nSELECT \n  Investment_Type,\n  Related_Company AS stock_code,\n  year,\n  quarter,\n  en_caption,\n  data\nFROM \n  (\n    SELECT * FROM bank_financials\n    UNION ALL\n    SELECT * FROM investment_financials\n  ) AS Combined\nWHERE \n  Related_Company IN ('VCB', 'TCB', 'VPB')  -- Focus on the primary companies\nORDER BY \n  stock_code, year, quarter, Investment_Type, en_caption\nLIMIT 100;  -- Adjust the limit as necessary\n"
            }
        ],
        "time": 47.13083624839783,
        "evaluate": 0,
        "input_token": 2251,
        "output_token": 987
    },
    {
        "id": "2bd167d2-27c8-45cc-bf1a-c5bf42eb5ec9",
        "question": "What is the Return on Equity (ROE) for Vinamilk and Masan Group for the fiscal year 2023?",
        "answer": "Table 1\n| stock_code   |       roe |\n|:-------------|----------:|\n| MSN          | 0.0489033 |\n| VNM          | 0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS ROE\nFROM financial_ratio\nWHERE ratio_code = 'ROE'\n  AND stock_code IN ('VNM', 'MSN')\n  AND year = 2023\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n|   roe_value | stock_code   | industry           |\n|------------:|:-------------|:-------------------|\n|   0.0489033 | MSN          | Food and Beverages |\n|   0.257506  | VNM          | Food and Beverages |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.data AS ROE_Value, \n  ci.stock_code, \n  ci.industry\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.year = 2023 \n  AND fr.quarter = 0 \n  AND mcr.ratio_name = 'Return On Equity'\n  AND ci.stock_code IN ('VNM', 'MSN')\nLIMIT 100;\n"
            }
        ],
        "time": 29.730058431625366,
        "evaluate": 0.5,
        "input_token": 2134,
        "output_token": 853
    },
    {
        "id": "0a7260e6-0f4a-4061-bd8f-11bea613819f",
        "question": "What was the Return on Equity (ROE) for Vietcombank, Techcombank, and VPBank in Q2 2024, and how does this compare to their respective ROE in Q2 2020, considering their investments in subsidiaries?",
        "answer": "Table 1\n| stock_code   | company_name                                       |   year |   quarter |       roe |\n|:-------------|:---------------------------------------------------|-------:|----------:|----------:|\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2020 |         2 | 0.0428449 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2020 |         2 | 0.0428449 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2024 |         2 | 0.0457096 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |   2024 |         2 | 0.0457096 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |   2020 |         2 | 0.0515214 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2020 |         2 | 0.0621598 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2020 |         2 | 0.0621598 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2024 |         2 | 0.026311  |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |   2024 |         2 | 0.026311  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    ci.company_name, \n    fr.year, \n    fr.quarter, \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nLEFT JOIN \n    sub_and_shareholder ss ON fr.stock_code = ss.stock_code\nWHERE \n    mccr.ratio_name = 'Return On Equity'\n    AND fr.quarter = 2\n    AND fr.year IN (2020, 2024)\n    AND fr.stock_code IN ('VCB', 'TCB', 'VPB')\nORDER BY \n    fr.stock_code, fr.year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| parent_company   | subsidiary   |\n|:-----------------|:-------------|\n| VCB              | PGI          |\n| VCB              | EIB          |\n| VCB              | MBB          |\n| VCB              | HVN          |\n| VCB              | PVD          |\n| VCB              | OCB          |\n| VPB              | SGP          |\n| VPB              | FDC          |\n| TCB              | VCG          |\n| TCB              | HVN          |\n| VCB              | EIB          |\n| VCB              | MBB          |\n| VCB              | OCB          |\n\nTable 2\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| TCB          |   2020 |         2 | 0.0428449 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         2 | 0.0515214 |\n| VPB          |   2020 |         2 | 0.0621598 |\n| VPB          |   2024 |         2 | 0.026311  |\n\nTable 3\n| parent_company   | subsidiary   |\n|:-----------------|:-------------|\n| VCB              | PGI          |\n| VCB              | EIB          |\n| VCB              | MBB          |\n| VCB              | HVN          |\n| VCB              | PVD          |\n| VCB              | OCB          |\n| VPB              | SGP          |\n| VPB              | FDC          |\n| TCB              | VCG          |\n| TCB              | HVN          |\n| VCB              | EIB          |\n| VCB              | MBB          |\n| VCB              | OCB          |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  fr.year,\n  fr.quarter,\n  fr.data AS ROE\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n  mcr.ratio_name = 'Return On Equity'\n  AND fr.stock_code IN ('VCB', 'TCB', 'VPB')\n  AND ((fr.year = 2024 AND fr.quarter = 2) OR (fr.year = 2020 AND fr.quarter = 2))\nORDER BY \n  fr.stock_code, fr.year\nLIMIT 6;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  sas.stock_code AS Parent_Company,\n  sas.invest_on AS Subsidiary\nFROM \n  sub_and_shareholder sas\nWHERE \n  sas.stock_code IN ('VCB', 'TCB', 'VPB')\nLIMIT 100; -- Adjust limit as necessary\n"
            },
            {
                "language": "sql",
                "code": "-- **Primary Query for ROE Values**\nSELECT \n  fr.stock_code,\n  fr.year,\n  fr.quarter,\n  fr.data AS ROE\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n  mcr.ratio_name = 'Return On Equity'\n  AND fr.stock_code IN ('VCB', 'TCB', 'VPB')\n  AND ((fr.year = 2024 AND fr.quarter = 2) OR (fr.year = 2020 AND fr.quarter = 2))\nORDER BY \n  fr.stock_code, fr.year\nLIMIT 6;\n\n-- **Contextual Query for Subsidiary Investments (Run Separately if Needed)**\nSELECT \n  sas.stock_code AS Parent_Company,\n  sas.invest_on AS Subsidiary\nFROM \n  sub_and_shareholder sas\nWHERE \n  sas.stock_code IN ('VCB', 'TCB', 'VPB')\nLIMIT 100;\n"
            }
        ],
        "time": 54.48982524871826,
        "evaluate": 0,
        "input_token": 2188,
        "output_token": 936
    },
    {
        "id": "517268fa-0be0-45f0-ab11-c3ff9ba775a3",
        "question": "Calculate the Debt-to-Equity ratio for VinGroup, Masan Group, and Hoa Phat Group in Q2 2024.  Analyze the impact of their subsidiary investments on their overall leverage.",
        "answer": "Table 1\n| stock_code   |   debt_to_equity_ratio |   investment_in_subsidiaries |\n|:-------------|-----------------------:|-----------------------------:|\n| HPG          |               0.901137 |                            0 |\n| VIC          |               3.44847  |                            0 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the stock codes for the companies\nWITH company_codes AS (\n    SELECT 'VIC' AS stock_code\n    UNION ALL\n    SELECT 'MSN'\n    UNION ALL\n    SELECT 'HPG'\n)\n\n-- Step 2: Retrieve Debt-to-Equity ratio for Q2 2024\nSELECT \n    fr.stock_code,\n    fr.data AS debt_to_equity_ratio,\n    nbf.data AS investment_in_subsidiaries\nFROM \n    financial_ratio fr\nJOIN \n    company_codes cc ON fr.stock_code = cc.stock_code\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nLEFT JOIN \n    non_bank_financial_report nbf ON fr.stock_code = nbf.stock_code \n    AND nbf.year = 2024 \n    AND nbf.quarter = 2 \n    AND nbf.category_code = 'BS_251' -- Investment in subsidiaries\nWHERE \n    fr.year = 2024 \n    AND fr.quarter = 2 \n    AND mccr.ratio_name = 'Debt To Equity Ratio';\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | industry        |   year |   quarter |   dter_value |\n|:-------------|:----------------|-------:|----------:|-------------:|\n| HPG          | Basic Resources |   2024 |         2 |     0.901137 |\n| VIC          | Real Estate     |   2024 |         2 |     3.44847  |\n\nTable 2\n| parent_company   | subsidiary   | industry    |\n|:-----------------|:-------------|:------------|\n| VIC              | VHM          | Real Estate |\n| VIC              | VRE          | Real Estate |\n| MSN              | TCB          | Banking     |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve DTER for specified companies in Q2 2024\nSELECT \n  fr.stock_code,\n  ci.industry,\n  fr.year,\n  fr.quarter,\n  fr.data AS DTER_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.ratio_code = 'DTER'  -- Debt To Equity Ratio\n  AND fr.stock_code IN ('VIC', 'MSN', 'HPG')\n  AND fr.year = 2024\n  AND fr.quarter = 2  -- Q2\nLIMIT 100;\n\n-- Step 2: To analyze the impact of subsidiary investments, \n--         we provide a separate query to show related subsidiaries for each company.\n--         Note: This query does not directly calculate the impact on DTER but provides necessary data for analysis.\nSELECT \n  sas.stock_code AS Parent_Company,\n  sas.invest_on AS Subsidiary,\n  ci.industry\nFROM \n  sub_and_shareholder sas\n  JOIN company_info ci ON sas.invest_on = ci.stock_code\nWHERE \n  sas.stock_code IN ('VIC', 'MSN', 'HPG')\nLIMIT 100;\n"
            }
        ],
        "time": 41.6752827167511,
        "evaluate": 0.5,
        "input_token": 1783,
        "output_token": 813
    },
    {
        "id": "6eb862c7-4017-4799-a708-7e1fa7a4b1fd",
        "question": "Compare the Return on Equity (ROE) and Debt-to-Equity ratios for Vinamilk, Masan Group, and Sabeco in Q4 2023.  Also provide the total equity and total liabilities for each company in that quarter.",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| MSN          | DTER         |     2.85445   |\n| SAB          | DTER         |     0.336332  |\n| VNM          | DTER         |     0.503847  |\n| MSN          | ROE          |     0.013515  |\n| SAB          | ROE          |     0.0379247 |\n| VNM          | ROE          |     0.0671136 |\n\nTable 2\n| stock_code   | category_code   |       value |\n|:-------------|:----------------|------------:|\n| VNM          | BS_300          | 1.76476e+07 |\n| VNM          | BS_400          | 3.50257e+07 |\n| MSN          | BS_300          | 1.09146e+08 |\n| SAB          | BS_300          | 8.57147e+06 |\n| MSN          | BS_400          | 3.82372e+07 |\n| SAB          | BS_400          | 2.54852e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve ROE and Debt-to-Equity Ratios for the specified companies\nSELECT \n    fr.stock_code,\n    fr.ratio_code,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB') \n    AND fr.year = 2023 \n    AND fr.quarter = 4\n    AND fr.ratio_code IN ('ROE', 'DTER');\n\n-- Step 2: Retrieve Total Equity and Total Liabilities for the specified companies\nSELECT \n    nfr.stock_code,\n    nfr.category_code,\n    nfr.data AS value\nFROM \n    non_bank_financial_report nfr\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN', 'SAB') \n    AND nfr.year = 2023 \n    AND nfr.quarter = 4\n    AND nfr.category_code IN ('BS_400', 'BS_300'); -- BS_400 for Total Equity, BS_300 for Total Liabilities\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| ratio_code   | stock_code   | en_company_name                              |   ratio_value |   year |   quarter |\n|:-------------|:-------------|:---------------------------------------------|--------------:|-------:|----------:|\n| DTER         | VNM          | Vietnam Dairy Products Joint Stock Company   |     0.503847  |   2023 |         4 |\n| ROE          | VNM          | Vietnam Dairy Products Joint Stock Company   |     0.0671136 |   2023 |         4 |\n| DTER         | MSN          | Masan Group Corporation                      |     2.85445   |   2023 |         4 |\n| ROE          | MSN          | Masan Group Corporation                      |     0.013515  |   2023 |         4 |\n| DTER         | SAB          | Saigon Beer - Alcohol - Beverage Corporation |     0.336332  |   2023 |         4 |\n| ROE          | SAB          | Saigon Beer - Alcohol - Beverage Corporation |     0.0379247 |   2023 |         4 |\n\nTable 2\n| metric            | stock_code   | en_company_name                              |   metric_value |   year |   quarter |\n|:------------------|:-------------|:---------------------------------------------|---------------:|-------:|----------:|\n| Total Equity      | VNM          | Vietnam Dairy Products Joint Stock Company   |    3.50257e+07 |   2023 |         4 |\n| Total Equity      | MSN          | Masan Group Corporation                      |    3.82372e+07 |   2023 |         4 |\n| Total Equity      | SAB          | Saigon Beer - Alcohol - Beverage Corporation |    2.54852e+07 |   2023 |         4 |\n| Total Liabilities | VNM          | Vietnam Dairy Products Joint Stock Company   |    1.76476e+07 |   2023 |         4 |\n| Total Liabilities | MSN          | Masan Group Corporation                      |    1.09146e+08 |   2023 |         4 |\n| Total Liabilities | SAB          | Saigon Beer - Alcohol - Beverage Corporation |    8.57147e+06 |   2023 |         4 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.ratio_code,\n  ci.stock_code,\n  ci.en_company_name,\n  fr.data AS ratio_value,\n  fr.year,\n  fr.quarter\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('VNM', 'MSN', 'SAB')\n  AND fr.year = 2023\n  AND fr.quarter = 4\n  AND mcr.ratio_code IN ('ROE', 'DTER')\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  'Total Equity' AS metric,\n  ci.stock_code,\n  ci.en_company_name,\n  nbf.data AS metric_value,\n  nbf.year,\n  nbf.quarter\nFROM \n  non_bank_financial_report nbf\n  JOIN company_info ci ON nbf.stock_code = ci.stock_code\nWHERE \n  nbf.stock_code IN ('VNM', 'MSN', 'SAB')\n  AND nbf.year = 2023\n  AND nbf.quarter = 4\n  AND nbf.category_code = 'BS_400'  -- ASSUMED CODE FOR TOTAL EQUITY\nUNION ALL\nSELECT \n  'Total Liabilities' AS metric,\n  ci.stock_code,\n  ci.en_company_name,\n  nbf.data AS metric_value,\n  nbf.year,\n  nbf.quarter\nFROM \n  non_bank_financial_report nbf\n  JOIN company_info ci ON nbf.stock_code = ci.stock_code\nWHERE \n  nbf.stock_code IN ('VNM', 'MSN', 'SAB')\n  AND nbf.year = 2023\n  AND nbf.quarter = 4\n  AND nbf.category_code = 'BS_300'  -- ASSUMED CODE FOR TOTAL LIABILITIES\nLIMIT 100;\n"
            }
        ],
        "time": 44.34018874168396,
        "evaluate": 0.5,
        "input_token": 1926,
        "output_token": 999
    },
    {
        "id": "756db2fc-d60a-4119-93a9-f965164708dd",
        "question": "What is the trend of the Net Profit Margin ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_profit_margin   |\n|--------------|--------|-----------|---------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    fr.year, \n    fr.quarter, \n    fr.data AS net_profit_margin\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    mccr.ratio_name = 'Net profit margin' AND\n    fr.stock_code IN ('VCB', 'TCB', 'ACB') AND\n    ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR\n     (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n    fr.stock_code, \n    fr.year, \n    fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| year   | quarter   | stock_code   | industry   | ratio_name   | npm_ratio_value   |\n|--------|-----------|--------------|------------|--------------|-------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.year, \n  fr.quarter, \n  ci.stock_code, \n  ci.industry, \n  mcr.ratio_name, \n  fr.data AS NPM_Ratio_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.ratio_code = 'NPM'  -- Net Profit Margin\n  AND ci.stock_code IN ('VCB', 'TCB', 'ACB')  -- Filter by Vietcombank, Techcombank, and ACB\n  AND (\n    (fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0)  -- Annual reports for 2020-2023\n    OR (fr.year = 2024 AND fr.quarter = 2)  -- Q2 2024\n  )\nORDER BY \n  fr.stock_code, \n  fr.year, \n  fr.quarter\nLIMIT 100;  -- To adhere to the requirement of adding a LIMIT\n"
            }
        ],
        "time": 34.47634291648865,
        "evaluate": 0,
        "input_token": 2804,
        "output_token": 1012
    },
    {
        "id": "a9d94d50-4a5e-4023-8fa7-0ef92a370a01",
        "question": "For Q1 2023, what was the net income attributable to the parent company for  Vinamilk, and what proportion of this net income was generated by its subsidiaries and associates?  Provide a breakdown of the net income contribution from each significant subsidiary if available.",
        "answer": "Table 1\n|   net_income_parent | subsidiary_code   | category   | contribution   |\n|--------------------:|:------------------|:-----------|:---------------|\n|         1.85673e+06 |                   |            |                |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH parent_net_income AS (\n    SELECT \n        stock_code,\n        data AS net_income_parent\n    FROM \n        non_bank_financial_report\n    WHERE \n        stock_code = 'VNM' \n        AND year = 2023 \n        AND quarter = 1 \n        AND category_code = 'IS_061'\n),\nsubsidiary_contributions AS (\n    SELECT \n        s.invest_on AS subsidiary_code,\n        m.en_caption AS category,\n        f.data AS contribution\n    FROM \n        sub_and_shareholder s\n    JOIN \n        non_bank_financial_report f ON s.invest_on = f.stock_code\n    JOIN \n        map_category_code_non_bank m ON f.category_code = m.category_code\n    WHERE \n        s.stock_code = 'VNM'\n        AND f.year = 2023\n        AND f.quarter = 1\n        AND m.en_caption = 'Share of profit/(loss) from joint ventures and associates'\n)\nSELECT \n    p.net_income_parent,\n    s.subsidiary_code,\n    s.category,\n    s.contribution\nFROM \n    parent_net_income p\nLEFT JOIN \n    subsidiary_contributions s ON p.stock_code = 'VNM';\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| netincome_q1_2023   |\n|---------------------|\n\nTable 2\n| subsidiary   | subsidiary_netincome_q1_2023   |\n|--------------|--------------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Retrieve Net Income for Vinamilk (VNM) for Q1 2023\nSELECT \n  nfr.data AS NetIncome_Q1_2023\nFROM \n  non_bank_financial_report nfr\n  INNER JOIN map_category_code_non_bank mccnb ON nfr.category_code = mccnb.category_code\nWHERE \n  nfr.stock_code = 'VNM'\n  AND nfr.year = 2023\n  AND nfr.quarter = 1  -- Q1\n  AND mccnb.en_caption = 'Assumed Net Income Attributable to Parent Caption'  -- Replace with actual caption\nLIMIT 1;\n\n-- Attempt to Provide Breakdown for Subsidiaries (Hypothetical, as specific category codes and detailed breakdown logic are not provided)\nSELECT \n  sas.invest_on AS Subsidiary,\n  nfr.data AS Subsidiary_NetIncome_Q1_2023\nFROM \n  sub_and_shareholder sas\n  INNER JOIN non_bank_financial_report nfr ON sas.invest_on = nfr.stock_code\n  INNER JOIN map_category_code_non_bank mccnb ON nfr.category_code = mccnb.category_code\nWHERE \n  sas.stock_code = 'VNM'  -- Vinamilk's subsidiaries\n  AND nfr.year = 2023\n  AND nfr.quarter = 1  -- Q1\n  AND mccnb.en_caption = 'Assumed Net Income Attributable to Parent Caption'  -- Replace with actual caption\nORDER BY \n  Subsidiary_NetIncome_Q1_2023 DESC\nLIMIT 100;  -- Adjust limit as necessary\n"
            }
        ],
        "time": 38.436811447143555,
        "evaluate": 0,
        "input_token": 1698,
        "output_token": 849
    },
    {
        "id": "87f74847-ecb4-42ee-8cfc-46eb78d61d84",
        "question": "For the period 2020 to Q2 2024, rank the top 10 companies based on their Debt-to-Equity ratio, calculated as Total Debt divided by Total Equity.  This ratio will show the financial leverage of each company.",
        "answer": "Table 1\n| stock_code   | industry    |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|:------------|-------:|----------:|-----------------------:|\n| VC3          | Real Estate |   2022 |         0 |               nan      |\n| NVB          | Banking     |   2020 |         0 |                20.0192 |\n| BID          | Banking     |   2021 |         0 |                19.4068 |\n| BID          | Banking     |   2022 |         0 |                19.3533 |\n| NVB          | Banking     |   2024 |         2 |                19.2545 |\n| BID          | Banking     |   2020 |         0 |                18.0427 |\n| BID          | Banking     |   2023 |         0 |                17.7184 |\n| BID          | Banking     |   2024 |         2 |                17.7161 |\n| NVB          | Banking     |   2021 |         0 |                16.3027 |\n| LPB          | Banking     |   2021 |         0 |                16.212  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.year,\n    fr.quarter,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND ((fr.year = 2020 AND fr.quarter = 0) OR\n         (fr.year = 2021 AND fr.quarter = 0) OR\n         (fr.year = 2022 AND fr.quarter = 0) OR\n         (fr.year = 2023 AND fr.quarter = 0) OR\n         (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n    fr.data DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name                                               |   debttoequityratio |\n|:-------------|:-----------------------------------------------------------|--------------------:|\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng                       |            nan      |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                      |             20.0192 |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam |             19.4068 |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam |             19.3533 |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam |             18.0427 |\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam |             17.7184 |\n| NVB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Qu\u1ed1c D\u00e2n                      |             16.3027 |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam             |             16.212  |\n| LPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n L\u1ed9c Ph\u00e1t Vi\u1ec7t Nam             |             16.0284 |\n| STB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n Th\u01b0\u01a1ng T\u00edn            |             16.009  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH RankedCompanies AS (\n  SELECT \n    fr.stock_code,\n    ci.company_name,\n    fr.data AS DebtToEquityRatio,\n    ROW_NUMBER() OVER (ORDER BY fr.data DESC) AS Rank\n  FROM \n    financial_ratio fr\n  JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\n  JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE \n    mcr.ratio_name = 'Debt To Equity Ratio'\n    AND fr.year BETWEEN 2020 AND 2023  -- Annual Reports\n    AND fr.quarter = 0\n  UNION ALL\n  SELECT \n    fr.stock_code,\n    ci.company_name,\n    fr.data AS DebtToEquityRatio,\n    ROW_NUMBER() OVER (ORDER BY fr.data DESC) AS Rank\n  FROM \n    financial_ratio fr\n  JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\n  JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE \n    mcr.ratio_name = 'Debt To Equity Ratio'\n    AND fr.year = 2024  -- Specific Quarter\n    AND fr.quarter = 2\n)\nSELECT \n  stock_code, \n  company_name, \n  DebtToEquityRatio\nFROM \n  RankedCompanies\nWHERE \n  Rank <= 10\nLIMIT 10;\n"
            }
        ],
        "time": 46.76636052131653,
        "evaluate": 0,
        "input_token": 1997,
        "output_token": 1031
    },
    {
        "id": "5acf9fe2-b166-443f-8511-111e3acea0ce",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) from 2020 to Q2 2024, calculated as Net Income divided by Average Shareholder Equity.",
        "answer": "Table 1\n| stock_code   | company_name                                   | en_company_name                                                         | industry                             |   year |   quarter |        roe |\n|:-------------|:-----------------------------------------------|:------------------------------------------------------------------------|:-------------------------------------|-------:|----------:|-----------:|\n| VC3          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Nam M\u00ea K\u00f4ng           | Nam MeKong Group Joint Stock Company                                    | Real Estate                          |   2022 |         0 | nan        |\n| GAS          | T\u1ed5ng C\u00f4ng ty Kh\u00ed Vi\u1ec7t Nam - C\u00f4ng ty C\u1ed5 ph\u1ea7n    | PetroVietnam Gas Joint Stock Corporation                                | Utilities (Electricity, Water & Gas) |   2024 |         1 | nan        |\n| DGC          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f3a ch\u1ea5t \u0110\u1ee9c Giang    | Ducgiang Chemicals Group Joint Stock Company                            | Chemicals                            |   2022 |         0 |   0.557243 |\n| CAP          | C\u00f4ng ty C\u1ed5 ph\u1ea7n L\u00e2m N\u00f4ng s\u1ea3n Th\u1ef1c ph\u1ea9m Y\u00ean B\u00e1i | Yen Bai Joint Stock Forest Agricultural Products And Foodstuffs Company | Basic Resources                      |   2022 |         0 |   0.546075 |\n| L14          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Licogi 14                      | Licogi 14 Joint Stock Company                                           | Construction and Materials           |   2021 |         0 |   0.493854 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.company_name,\n    ci.en_company_name,\n    ci.industry,\n    fr.year,\n    fr.quarter,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND ((fr.year = 2020 AND fr.quarter = 0) OR\n         (fr.year = 2021 AND fr.quarter = 0) OR\n         (fr.year = 2022 AND fr.quarter = 0) OR\n         (fr.year = 2023 AND fr.quarter = 0) OR\n         (fr.year = 2024 AND fr.quarter IN (1, 2)))\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Union of all financial reports for simplicity; adjust category_codes as necessary\nFinancialReports AS (\n  SELECT 'Non-Bank' AS CompanyType, stock_code, year, quarter, \n         -- Assuming IS_030 for simplicity; adjust based on actual Net Income category_code\n         CASE WHEN category_code = 'IS_030' THEN 'NetIncome' \n              WHEN category_code = 'BS_410' THEN 'ShareholderEquity' \n         END AS DataType, \n         data\n  FROM non_bank_financial_report\n  WHERE year BETWEEN 2020 AND 2024 AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n  \n  UNION ALL\n  \n  SELECT 'Bank' AS CompanyType, stock_code, year, quarter, \n         -- Assuming IS_012 for simplicity; adjust based on actual Net Income category_code for Banks\n         CASE WHEN category_code = 'IS_012' THEN 'NetIncome' \n              WHEN category_code = 'BS_500' THEN 'ShareholderEquity' \n         END AS DataType, \n         data\n  FROM bank_financial_report\n  WHERE year BETWEEN 2020 AND 2024 AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n  \n  UNION ALL\n  \n  SELECT 'Securities' AS CompanyType, stock_code, year, quarter, \n         -- Assuming IS_400 for simplicity; adjust based on actual Net Income category_code for Securities\n         CASE WHEN category_code = 'IS_400' THEN 'NetIncome' \n              WHEN category_code = 'BS_410' THEN 'ShareholderEquity' \n         END AS DataType, \n         data\n  FROM securities_financial_report\n  WHERE year BETWEEN 2020 AND 2024 AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n),\n\n-- Calculate ROE\nROECalculations AS (\n  SELECT stock_code, \n         -- Calculate Net Income and Average Shareholder Equity over the period\n         SUM(CASE WHEN DataType = 'NetIncome' THEN data ELSE 0 END) AS TotalNetIncome,\n         AVG(CASE WHEN DataType = 'ShareholderEquity' THEN data ELSE NULL END) AS AvgShareholderEquity\n  FROM FinancialReports\n  GROUP BY stock_code\n),\n\n-- Rank Companies by ROE\nRankedROE AS (\n  SELECT stock_code, \n         -- Calculate ROE\n         (TotalNetIncome / AvgShareholderEquity) * 100 AS ROE,\n         -- Rank Companies\n         ROW_NUMBER() OVER (ORDER BY (TotalNetIncome / AvgShareholderEquity) * 100 DESC) AS ROERank\n  FROM ROECalculations\n  WHERE AvgShareholderEquity <> 0  -- Avoid division by zero\n)\n\n-- Select Top 5 Companies by ROE\nSELECT ci.stock_code, ci.industry, r.ROE\nFROM RankedROE r\nJOIN company_info ci ON r.stock_code = ci.stock_code\nWHERE r.ROERank <= 5\nLIMIT 5;\n"
            }
        ],
        "time": 55.43411159515381,
        "evaluate": 0,
        "input_token": 2364,
        "output_token": 1720
    },
    {
        "id": "6e85dfc8-0e0f-484a-ac9c-b472109731ef",
        "question": "What was the current ratio for Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   |    data |\n|:-------------|--------:|\n| TCB          | 3.29776 |\n| VCB          | 3.56816 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data\nFROM financial_ratio\nWHERE ratio_code = 'CurrentR'\n  AND stock_code IN ('VCB', 'TCB')\n  AND year = 2022\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   | year   | quarter   | en_caption   | data   |\n|--------------|--------|-----------|--------------|--------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Hypothetical Query Structure (Assuming Direct Access to Current Ratio or Its Components)\nSELECT \n  T1.stock_code,\n  T1.year,\n  T1.quarter,\n  T2.en_caption,\n  T1.data\nFROM \n  bank_financial_report T1\n  INNER JOIN map_category_code_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code IN ('VCB', 'TCB')\n  AND T1.year = 2022\n  AND T1.quarter = 0  -- For Annual Reports\n  AND T2.en_caption IN ('Current Assets', 'Current Liabilities')  -- Hypothetical Direct Reference\nLIMIT 100;\n"
            }
        ],
        "time": 51.34476900100708,
        "evaluate": 0,
        "input_token": 2342,
        "output_token": 1255
    },
    {
        "id": "22005fc2-07f4-41f8-9b53-2ebb12689756",
        "question": "Compare the Return on Equity (ROE) and the Debt-to-Equity ratio of Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name           |      data |\n|:-------------|-------:|----------:|:---------------------|----------:|\n| MSN          |   2020 |         0 | Debt To Equity Ratio | 3.62386   |\n| MSN          |   2020 |         0 | Return On Equity     | 0.055733  |\n| MSN          |   2021 |         0 | Debt To Equity Ratio | 1.97835   |\n| MSN          |   2021 |         0 | Return On Equity     | 0.238597  |\n| MSN          |   2022 |         0 | Debt To Equity Ratio | 2.85795   |\n| MSN          |   2022 |         0 | Return On Equity     | 0.129771  |\n| MSN          |   2023 |         0 | Debt To Equity Ratio | 2.85445   |\n| MSN          |   2023 |         0 | Return On Equity     | 0.0489033 |\n| MSN          |   2024 |         1 | Debt To Equity Ratio | 2.77309   |\n| MSN          |   2024 |         1 | Return On Equity     | 0.0123309 |\n| SAB          |   2020 |         0 | Debt To Equity Ratio | 0.290342  |\n| SAB          |   2020 |         0 | Return On Equity     | 0.232702  |\n| SAB          |   2021 |         0 | Debt To Equity Ratio | 0.349295  |\n| SAB          |   2021 |         0 | Return On Equity     | 0.173903  |\n| SAB          |   2022 |         0 | Debt To Equity Ratio | 0.401541  |\n| SAB          |   2022 |         0 | Return On Equity     | 0.223652  |\n| SAB          |   2023 |         0 | Debt To Equity Ratio | 0.336332  |\n| SAB          |   2023 |         0 | Return On Equity     | 0.166962  |\n| SAB          |   2024 |         1 | Debt To Equity Ratio | 0.215054  |\n| SAB          |   2024 |         1 | Return On Equity     | 0.038694  |\n| SAB          |   2024 |         2 | Debt To Equity Ratio | 0.359095  |\n| SAB          |   2024 |         2 | Return On Equity     | 0.0524845 |\n| VNM          |   2020 |         0 | Debt To Equity Ratio | 0.439424  |\n| VNM          |   2020 |         0 | Return On Equity     | 0.333928  |\n| VNM          |   2021 |         0 | Debt To Equity Ratio | 0.487649  |\n| VNM          |   2021 |         0 | Return On Equity     | 0.296583  |\n| VNM          |   2022 |         0 | Debt To Equity Ratio | 0.477386  |\n| VNM          |   2022 |         0 | Return On Equity     | 0.26138   |\n| VNM          |   2023 |         0 | Debt To Equity Ratio | 0.503847  |\n| VNM          |   2023 |         0 | Return On Equity     | 0.257506  |\n| VNM          |   2024 |         1 | Debt To Equity Ratio | 0.440127  |\n| VNM          |   2024 |         1 | Return On Equity     | 0.0615314 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND mccr.ratio_code IN ('ROE', 'DTER')\n    AND (\n        (fr.year = 2020 AND fr.quarter = 0) OR\n        (fr.year = 2021 AND fr.quarter = 0) OR\n        (fr.year = 2022 AND fr.quarter = 0) OR\n        (fr.year = 2023 AND fr.quarter = 0) OR\n        (fr.year = 2024 AND fr.quarter IN (1, 2))\n    )\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, mccr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| period_type   |   year |   quarter | stock_code   | industry           | ratio_name           |      data |\n|:--------------|-------:|----------:|:-------------|:-------------------|:---------------------|----------:|\n| Annual        |   2020 |         0 | MSN          | Food and Beverages | Debt To Equity Ratio | 3.62386   |\n| Annual        |   2020 |         0 | MSN          | Food and Beverages | Return On Equity     | 0.055733  |\n| Annual        |   2021 |         0 | MSN          | Food and Beverages | Debt To Equity Ratio | 1.97835   |\n| Annual        |   2021 |         0 | MSN          | Food and Beverages | Return On Equity     | 0.238597  |\n| Annual        |   2022 |         0 | MSN          | Food and Beverages | Debt To Equity Ratio | 2.85795   |\n| Annual        |   2022 |         0 | MSN          | Food and Beverages | Return On Equity     | 0.129771  |\n| Annual        |   2023 |         0 | MSN          | Food and Beverages | Debt To Equity Ratio | 2.85445   |\n| Annual        |   2023 |         0 | MSN          | Food and Beverages | Return On Equity     | 0.0489033 |\n| Annual        |   2020 |         0 | SAB          | Food and Beverages | Debt To Equity Ratio | 0.290342  |\n| Annual        |   2020 |         0 | SAB          | Food and Beverages | Return On Equity     | 0.232702  |\n| Annual        |   2021 |         0 | SAB          | Food and Beverages | Debt To Equity Ratio | 0.349295  |\n| Annual        |   2021 |         0 | SAB          | Food and Beverages | Return On Equity     | 0.173903  |\n| Annual        |   2022 |         0 | SAB          | Food and Beverages | Debt To Equity Ratio | 0.401541  |\n| Annual        |   2022 |         0 | SAB          | Food and Beverages | Return On Equity     | 0.223652  |\n| Annual        |   2023 |         0 | SAB          | Food and Beverages | Debt To Equity Ratio | 0.336332  |\n| Annual        |   2023 |         0 | SAB          | Food and Beverages | Return On Equity     | 0.166962  |\n| Q2 2024       |   2024 |         2 | SAB          | Food and Beverages | Debt To Equity Ratio | 0.359095  |\n| Q2 2024       |   2024 |         2 | SAB          | Food and Beverages | Return On Equity     | 0.0524845 |\n| Annual        |   2020 |         0 | VNM          | Food and Beverages | Debt To Equity Ratio | 0.439424  |\n| Annual        |   2020 |         0 | VNM          | Food and Beverages | Return On Equity     | 0.333928  |\n| Annual        |   2021 |         0 | VNM          | Food and Beverages | Debt To Equity Ratio | 0.487649  |\n| Annual        |   2021 |         0 | VNM          | Food and Beverages | Return On Equity     | 0.296583  |\n| Annual        |   2022 |         0 | VNM          | Food and Beverages | Debt To Equity Ratio | 0.477386  |\n| Annual        |   2022 |         0 | VNM          | Food and Beverages | Return On Equity     | 0.26138   |\n| Annual        |   2023 |         0 | VNM          | Food and Beverages | Debt To Equity Ratio | 0.503847  |\n| Annual        |   2023 |         0 | VNM          | Food and Beverages | Return On Equity     | 0.257506  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n  -- Annual Data (2020-2023)\n  annual_data AS (\n    SELECT \n      'Annual' AS period_type,\n      fr.year,\n      fr.quarter,\n      ci.stock_code,\n      ci.industry,\n      mcr.ratio_name,\n      fr.data\n    FROM \n      financial_ratio fr\n      JOIN company_info ci ON fr.stock_code = ci.stock_code\n      JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n    WHERE \n      fr.year BETWEEN 2020 AND 2023\n      AND fr.quarter = 0\n      AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\n      AND mcr.ratio_code IN ('ROE', 'DTER')\n  ),\n  \n  -- Q2 2024 Data\n  q2_2024_data AS (\n    SELECT \n      'Q2 2024' AS period_type,\n      fr.year,\n      fr.quarter,\n      ci.stock_code,\n      ci.industry,\n      mcr.ratio_name,\n      fr.data\n    FROM \n      financial_ratio fr\n      JOIN company_info ci ON fr.stock_code = ci.stock_code\n      JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n    WHERE \n      fr.year = 2024\n      AND fr.quarter = 2\n      AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\n      AND mcr.ratio_code IN ('ROE', 'DTER')\n  )\n\n-- Union Both Periods\nSELECT * FROM annual_data\nUNION ALL\nSELECT * FROM q2_2024_data\nORDER BY stock_code, period_type, year, quarter, ratio_name\nLIMIT 100;\n"
            }
        ],
        "time": 65.60635209083557,
        "evaluate": 0.5,
        "input_token": 2109,
        "output_token": 907
    },
    {
        "id": "18574cdb-3c4f-4bed-ba96-57d62355afc8",
        "question": "What is the Return on Equity (ROE) and Return on Assets (ROA) for Vinamilk and Masan Group from 2020 to Q2 2024?  Provide data for each quarter separately.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name       |         data |\n|:-------------|-------:|----------:|:-----------------|-------------:|\n| MSN          |   2020 |         1 | Return On Assets | -0.00205902  |\n| MSN          |   2020 |         1 | Return On Equity | -0.00419562  |\n| MSN          |   2020 |         2 | Return On Assets |  0.000518152 |\n| MSN          |   2020 |         2 | Return On Equity |  0.00174282  |\n| MSN          |   2020 |         3 | Return On Assets |  0.00890101  |\n| MSN          |   2020 |         3 | Return On Equity |  0.0340108   |\n| MSN          |   2020 |         4 | Return On Assets |  0.00504934  |\n| MSN          |   2020 |         4 | Return On Equity |  0.0233474   |\n| MSN          |   2021 |         1 | Return On Assets |  0.0029478   |\n| MSN          |   2021 |         1 | Return On Equity |  0.0134906   |\n| MSN          |   2021 |         2 | Return On Assets |  0.00872816  |\n| MSN          |   2021 |         2 | Return On Equity |  0.0335106   |\n| MSN          |   2021 |         3 | Return On Assets |  0.0128556   |\n| MSN          |   2021 |         3 | Return On Equity |  0.0490112   |\n| MSN          |   2021 |         4 | Return On Assets |  0.056457    |\n| MSN          |   2021 |         4 | Return On Equity |  0.168149    |\n| MSN          |   2022 |         1 | Return On Assets |  0.0152471   |\n| MSN          |   2022 |         1 | Return On Equity |  0.0515801   |\n| MSN          |   2022 |         2 | Return On Assets |  0.00969881  |\n| MSN          |   2022 |         2 | Return On Equity |  0.0313142   |\n| MSN          |   2022 |         3 | Return On Assets |  0.00654813  |\n| MSN          |   2022 |         3 | Return On Equity |  0.0236221   |\n| MSN          |   2022 |         4 | Return On Assets |  0.00568514  |\n| MSN          |   2022 |         4 | Return On Equity |  0.021933    |\n| MSN          |   2023 |         1 | Return On Assets |  0.00301441  |\n| MSN          |   2023 |         1 | Return On Equity |  0.0118431   |\n| MSN          |   2023 |         2 | Return On Assets |  0.00304694  |\n| MSN          |   2023 |         2 | Return On Equity |  0.0114376   |\n| MSN          |   2023 |         3 | Return On Assets |  0.0033398   |\n| MSN          |   2023 |         3 | Return On Equity |  0.0127258   |\n| MSN          |   2023 |         4 | Return On Assets |  0.00350634  |\n| MSN          |   2023 |         4 | Return On Equity |  0.013515    |\n| MSN          |   2024 |         1 | Return On Assets |  0.00326811  |\n| MSN          |   2024 |         1 | Return On Equity |  0.0123309   |\n| VNM          |   2020 |         1 | Return On Assets |  0.0602688   |\n| VNM          |   2020 |         1 | Return On Equity |  0.0861112   |\n| VNM          |   2020 |         2 | Return On Assets |  0.0621928   |\n| VNM          |   2020 |         2 | Return On Equity |  0.095333    |\n| VNM          |   2020 |         3 | Return On Assets |  0.0622698   |\n| VNM          |   2020 |         3 | Return On Equity |  0.0990225   |\n| VNM          |   2020 |         4 | Return On Assets |  0.0461712   |\n| VNM          |   2020 |         4 | Return On Equity |  0.0664599   |\n| VNM          |   2021 |         1 | Return On Assets |  0.0508692   |\n| VNM          |   2021 |         1 | Return On Equity |  0.0764615   |\n| VNM          |   2021 |         2 | Return On Assets |  0.0539576   |\n| VNM          |   2021 |         2 | Return On Equity |  0.0832651   |\n| VNM          |   2021 |         3 | Return On Assets |  0.0568629   |\n| VNM          |   2021 |         3 | Return On Equity |  0.0874017   |\n| VNM          |   2021 |         4 | Return On Assets |  0.0414871   |\n| VNM          |   2021 |         4 | Return On Equity |  0.0617182   |\n| VNM          |   2022 |         1 | Return On Assets |  0.043085    |\n| VNM          |   2022 |         1 | Return On Equity |  0.06528     |\n| VNM          |   2022 |         2 | Return On Assets |  0.039045    |\n| VNM          |   2022 |         2 | Return On Equity |  0.057095    |\n| VNM          |   2022 |         3 | Return On Assets |  0.0453687   |\n| VNM          |   2022 |         3 | Return On Equity |  0.0686339   |\n| VNM          |   2022 |         4 | Return On Assets |  0.0385524   |\n| VNM          |   2022 |         4 | Return On Equity |  0.0569567   |\n| VNM          |   2023 |         1 | Return On Assets |  0.0386935   |\n| VNM          |   2023 |         1 | Return On Equity |  0.0552366   |\n| VNM          |   2023 |         2 | Return On Assets |  0.0811356   |\n| VNM          |   2023 |         2 | Return On Equity |  0.112804    |\n| VNM          |   2023 |         3 | Return On Assets |  0.0460866   |\n| VNM          |   2023 |         3 | Return On Equity |  0.0745011   |\n| VNM          |   2023 |         4 | Return On Assets |  0.044628    |\n| VNM          |   2023 |         4 | Return On Equity |  0.0671136   |\n| VNM          |   2024 |         1 | Return On Assets |  0.0427264   |\n| VNM          |   2024 |         1 | Return On Equity |  0.0615314   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mcr.ratio_name,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN')\n    AND mcr.ratio_name IN ('Return On Equity', 'Return On Assets')\n    AND ((fr.year = 2020 AND fr.quarter != 0) OR\n         (fr.year = 2021 AND fr.quarter != 0) OR\n         (fr.year = 2022 AND fr.quarter != 0) OR\n         (fr.year = 2023 AND fr.quarter != 0) OR\n         (fr.year = 2024 AND fr.quarter IN (1, 2)))\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, mcr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry           |   year |   quarter | ratio_name       |         data |\n|:-------------|:-------------------|-------:|----------:|:-----------------|-------------:|\n| MSN          | Food and Beverages |   2020 |         1 | Return On Assets | -0.00205902  |\n| MSN          | Food and Beverages |   2020 |         1 | Return On Equity | -0.00419562  |\n| MSN          | Food and Beverages |   2020 |         2 | Return On Assets |  0.000518152 |\n| MSN          | Food and Beverages |   2020 |         2 | Return On Equity |  0.00174282  |\n| MSN          | Food and Beverages |   2021 |         1 | Return On Assets |  0.0029478   |\n| MSN          | Food and Beverages |   2021 |         1 | Return On Equity |  0.0134906   |\n| MSN          | Food and Beverages |   2021 |         2 | Return On Assets |  0.00872816  |\n| MSN          | Food and Beverages |   2021 |         2 | Return On Equity |  0.0335106   |\n| MSN          | Food and Beverages |   2022 |         1 | Return On Assets |  0.0152471   |\n| MSN          | Food and Beverages |   2022 |         1 | Return On Equity |  0.0515801   |\n| MSN          | Food and Beverages |   2022 |         2 | Return On Assets |  0.00969881  |\n| MSN          | Food and Beverages |   2022 |         2 | Return On Equity |  0.0313142   |\n| MSN          | Food and Beverages |   2023 |         1 | Return On Assets |  0.00301441  |\n| MSN          | Food and Beverages |   2023 |         1 | Return On Equity |  0.0118431   |\n| MSN          | Food and Beverages |   2023 |         2 | Return On Assets |  0.00304694  |\n| MSN          | Food and Beverages |   2023 |         2 | Return On Equity |  0.0114376   |\n| MSN          | Food and Beverages |   2024 |         1 | Return On Assets |  0.00326811  |\n| MSN          | Food and Beverages |   2024 |         1 | Return On Equity |  0.0123309   |\n| VNM          | Food and Beverages |   2020 |         1 | Return On Assets |  0.0602688   |\n| VNM          | Food and Beverages |   2020 |         1 | Return On Equity |  0.0861112   |\n| VNM          | Food and Beverages |   2020 |         2 | Return On Assets |  0.0621928   |\n| VNM          | Food and Beverages |   2020 |         2 | Return On Equity |  0.095333    |\n| VNM          | Food and Beverages |   2021 |         1 | Return On Assets |  0.0508692   |\n| VNM          | Food and Beverages |   2021 |         1 | Return On Equity |  0.0764615   |\n| VNM          | Food and Beverages |   2021 |         2 | Return On Assets |  0.0539576   |\n| VNM          | Food and Beverages |   2021 |         2 | Return On Equity |  0.0832651   |\n| VNM          | Food and Beverages |   2022 |         1 | Return On Assets |  0.043085    |\n| VNM          | Food and Beverages |   2022 |         1 | Return On Equity |  0.06528     |\n| VNM          | Food and Beverages |   2022 |         2 | Return On Assets |  0.039045    |\n| VNM          | Food and Beverages |   2022 |         2 | Return On Equity |  0.057095    |\n| VNM          | Food and Beverages |   2023 |         1 | Return On Assets |  0.0386935   |\n| VNM          | Food and Beverages |   2023 |         1 | Return On Equity |  0.0552366   |\n| VNM          | Food and Beverages |   2023 |         2 | Return On Assets |  0.0811356   |\n| VNM          | Food and Beverages |   2023 |         2 | Return On Equity |  0.112804    |\n| VNM          | Food and Beverages |   2024 |         1 | Return On Assets |  0.0427264   |\n| VNM          | Food and Beverages |   2024 |         1 | Return On Equity |  0.0615314   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.industry, -- Optional, for context\n  fr.year,\n  fr.quarter,\n  mcr.ratio_name,\n  fr.data\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('VNM', 'MSN') -- Vinamilk and Masan Group\n  AND fr.year BETWEEN 2020 AND 2024\n  AND (fr.quarter = 1 OR fr.quarter = 2) -- Since we're interested up to Q2\n  AND mcr.ratio_code IN ('ROE', 'ROA') -- For ROE and ROA ratios\nORDER BY \n  fr.stock_code, fr.year, fr.quarter, mcr.ratio_name\nLIMIT 100; -- To adhere to the limit requirement\n"
            }
        ],
        "time": 56.60077238082886,
        "evaluate": 0,
        "input_token": 1801,
        "output_token": 601
    },
    {
        "id": "6bd17126-d46e-4133-bedf-a54fcef397a2",
        "question": "What were the Return on Equity (ROE) and Return on Assets (ROA) for Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   | ratio_code   |   ratio_value |\n|:-------------|:-------------|--------------:|\n| VCB          | ROE          |     0.220567  |\n| TCB          | ROA          |     0.0292353 |\n| TCB          | ROE          |     0.180176  |\n| VCB          | ROA          |     0.0164951 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    ratio_code, \n    data AS ratio_value\nFROM \n    financial_ratio\nWHERE \n    (stock_code = 'VCB' OR stock_code = 'TCB') \n    AND (ratio_code = 'ROE' OR ratio_code = 'ROA') \n    AND year = 2022 \n    AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Error in getting the answer",
        "code_response": "Error in getting the code",
        "evaluate": 0,
        "input_token": 171,
        "output_token": 78
    },
    {
        "id": "55ac4539-ffb5-4f26-ac74-c282a46db6b7",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| ACB          |   2024 |         1 | 0.052218  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         1 | 0.0459854 |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n| VCB          |   2024 |         1 | 0.0494831 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS roe\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE'\n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual data from 2020 to 2023\n        OR (year = 2024 AND quarter BETWEEN 1 AND 2) -- Quarterly data for Q1 and Q2 of 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry   |   year |   quarter |   roe_value |\n|:-------------|:-----------|-------:|----------:|------------:|\n| ACB          | Banking    |   2020 |         0 |   0.216734  |\n| ACB          | Banking    |   2021 |         0 |   0.213865  |\n| ACB          | Banking    |   2022 |         0 |   0.234232  |\n| ACB          | Banking    |   2023 |         0 |   0.226122  |\n| ACB          | Banking    |   2024 |         1 |   0.052218  |\n| TCB          | Banking    |   2020 |         0 |   0.168632  |\n| TCB          | Banking    |   2021 |         0 |   0.197927  |\n| TCB          | Banking    |   2022 |         0 |   0.180176  |\n| TCB          | Banking    |   2023 |         0 |   0.139608  |\n| TCB          | Banking    |   2024 |         1 |   0.0459854 |\n| TCB          | Banking    |   2024 |         2 |   0.0457096 |\n| VCB          | Banking    |   2020 |         0 |   0.196318  |\n| VCB          | Banking    |   2021 |         0 |   0.201059  |\n| VCB          | Banking    |   2022 |         0 |   0.220567  |\n| VCB          | Banking    |   2023 |         0 |   0.200315  |\n| VCB          | Banking    |   2024 |         1 |   0.0494831 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.industry, -- Optional, to confirm industry\n  fr.year,\n  fr.quarter,\n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Return On Equity' -- Ensuring we get ROE\n  AND fr.stock_code IN ('VCB', 'TCB', 'ACB') -- Focusing on the specified companies\n  AND (\n    (fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) -- Annual data for 2020-2023\n    OR (fr.year = 2024 AND fr.quarter IN (1, 2)) -- Q1 & Q2 data for 2024\n  )\nORDER BY \n  fr.stock_code, fr.year, fr.quarter\nLIMIT 100; -- Adding a limit as per the instructions\n"
            }
        ],
        "time": 54.12716841697693,
        "evaluate": 0.5,
        "input_token": 2264,
        "output_token": 667
    },
    {
        "id": "8f89fda6-e0a1-4b9e-851f-61c5b9d2a533",
        "question": "Compare the Net Profit Margin and the Current Ratio of Vinamilk and Masan Group from 2020 to Q2 2024.  Analyze the changes in these ratios over time for both companies, focusing on any significant variations and potential contributing factors.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name    |     data |\n|:-------------|-------:|----------:|:--------------|---------:|\n| MSN          |   2020 |         0 | Current Ratio | 0.773354 |\n| MSN          |   2021 |         0 | Current Ratio | 1.27032  |\n| MSN          |   2022 |         0 | Current Ratio | 0.73558  |\n| MSN          |   2023 |         0 | Current Ratio | 0.874439 |\n| VNM          |   2020 |         0 | Current Ratio | 2.09132  |\n| VNM          |   2021 |         0 | Current Ratio | 2.11895  |\n| VNM          |   2022 |         0 | Current Ratio | 2.06801  |\n| VNM          |   2023 |         0 | Current Ratio | 2.1016   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN')\n    AND mccr.ratio_code IN ('NPM', 'CurrentR')\n    AND (\n        (fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR\n        (fr.year = 2024 AND fr.quarter = 2)\n    )\nORDER BY \n    fr.stock_code, \n    fr.year, \n    fr.quarter, \n    mccr.ratio_name;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.en_company_name, -- Assuming en_company_name exists in company_info for clarity; if not, use the provided company names directly in the analysis\n    fr.year,\n    fr.quarter,\n    mcr.ratio_name,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nINNER JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nINNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN')\n    AND fr.year BETWEEN 2020 AND 2024\n    AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2)) -- Include all annual data and Q2 2024\n    AND mcr.ratio_name IN ('Net profit margin', 'Current Ratio')\nORDER BY \n    fr.stock_code, fr.year, fr.quarter, mcr.ratio_name\nLIMIT 100; -- Adjust the limit as necessary for your analysis scope\n"
            }
        ],
        "time": 49.81346273422241,
        "evaluate": 0,
        "input_token": 2028,
        "output_token": 691
    },
    {
        "id": "bae902e9-0a14-42b8-a499-26336872e762",
        "question": "Compare the Net Income, Total Assets, and Total Liabilities of Vinamilk and Masan Group for the fiscal year 2023.  Calculate the Debt-to-Equity ratio for both companies.",
        "answer": "Table 1\n| stock_code   |   net_income |   total_assets |   total_liabilities |   debt_to_equity_ratio |\n|:-------------|-------------:|---------------:|--------------------:|-----------------------:|\n| MSN          |  2.35043e+06 |    1.47383e+08 |         1.09146e+08 |               2.85445  |\n| VNM          |  1.09036e+07 |    5.26734e+07 |         1.76476e+07 |               0.503847 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH financial_data AS (\n    SELECT \n        stock_code,\n        SUM(CASE WHEN category_code = 'IS_030' THEN data ELSE 0 END) AS net_income,\n        SUM(CASE WHEN category_code = 'BS_270' THEN data ELSE 0 END) AS total_assets,\n        SUM(CASE WHEN category_code = 'BS_300' THEN data ELSE 0 END) AS total_liabilities\n    FROM \n        non_bank_financial_report\n    WHERE \n        stock_code IN ('VNM', 'MSN') AND\n        year = 2023 AND\n        quarter = 0\n    GROUP BY \n        stock_code\n)\nSELECT \n    fd.stock_code,\n    fd.net_income,\n    fd.total_assets,\n    fd.total_liabilities,\n    (fd.total_liabilities / (fd.total_assets - fd.total_liabilities)) AS debt_to_equity_ratio\nFROM \n    financial_data fd;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| company   | netincome   |   totalassets |   totalliabilities |   debttoequityratio |\n|:----------|:------------|--------------:|-------------------:|--------------------:|\n| VNM       |             |   3.59359e+07 |        1.67375e+07 |            0.503847 |\n| MSN       |             |   4.37635e+07 |        1.0362e+08  |            2.85445  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1: Financial Data Comparison for 2023 (Annual Report, so quarter = 0)\nWITH FinancialData AS (\n  SELECT \n    'VNM' AS Company, \n    (SELECT data FROM non_bank_financial_report WHERE stock_code = 'VNM' AND year = 2023 AND quarter = 0 AND category_code = 'IS_999') AS NetIncome,\n    (SELECT data FROM non_bank_financial_report WHERE stock_code = 'VNM' AND year = 2023 AND quarter = 0 AND category_code = 'BS_100') AS TotalAssets,\n    (SELECT data FROM non_bank_financial_report WHERE stock_code = 'VNM' AND year = 2023 AND quarter = 0 AND category_code = 'BS_200') AS TotalLiabilities\n  UNION ALL\n  SELECT \n    'MSN' AS Company, \n    (SELECT data FROM non_bank_financial_report WHERE stock_code = 'MSN' AND year = 2023 AND quarter = 0 AND category_code = 'IS_999') AS NetIncome,\n    (SELECT data FROM non_bank_financial_report WHERE stock_code = 'MSN' AND year = 2023 AND quarter = 0 AND category_code = 'BS_100') AS TotalAssets,\n    (SELECT data FROM non_bank_financial_report WHERE stock_code = 'MSN' AND year = 2023 AND quarter = 0 AND category_code = 'BS_200') AS TotalLiabilities\n)\n-- Step 2: Debt-to-Equity Ratio for Both Companies\n, DebtEquityRatio AS (\n  SELECT \n    stock_code AS Company, \n    data AS DTER\n  FROM \n    financial_ratio\n  WHERE \n    ratio_code = 'DTER' AND year = 2023 AND quarter = 0 AND stock_code IN ('VNM', 'MSN')\n)\n-- Combine Results\nSELECT \n  FD.Company, \n  FD.NetIncome, \n  FD.TotalAssets, \n  FD.TotalLiabilities, \n  DER.DTER AS DebtToEquityRatio\nFROM \n  FinancialData FD\n  LEFT JOIN DebtEquityRatio DER ON FD.Company = DER.Company\nLIMIT 2;  -- Limit to the two companies of interest\n"
            }
        ],
        "time": 53.342660427093506,
        "evaluate": 0,
        "input_token": 3565,
        "output_token": 1738
    },
    {
        "id": "ccdf4a0a-dd91-4147-a7b5-61cd342fc390",
        "question": "For the year 2021, what were the values of  accounts receivable, and inventory for Mobile World Investment, Vinamilk, and Masan Group?  Additionally, provide a breakdown of the investments in subsidiaries or associated companies for each of these companies, specifying the investment value and the nature of the investment (e.g., equity stake, loan).",
        "answer": "Table 1\n| stock_code   | category                                    |            value |\n|:-------------|:--------------------------------------------|-----------------:|\n| VNM          | Trade receivables                           |      4.36777e+06 |\n| VNM          | Inventories                                 |      6.82049e+06 |\n| MSN          | Trade receivables                           |      2.48022e+06 |\n| MSN          | Inventories                                 |      1.29479e+07 |\n| MWG          | Trade receivables                           | 384236           |\n| MWG          | Inventories                                 |      2.98501e+07 |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in subsidiaries                  |      0           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| VNM          | Investment in associates and joint ventures | 661023           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in subsidiaries                  |      0           |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n| MSN          | Investment in associates and joint ventures |      2.45388e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to get accounts receivable and inventory values for the specified companies\nSELECT \n    nbfr.stock_code,\n    mccnb.en_caption AS category,\n    nbfr.data AS value\nFROM \n    non_bank_financial_report nbfr\nJOIN \n    map_category_code_non_bank mccnb ON nbfr.category_code = mccnb.category_code\nWHERE \n    nbfr.stock_code IN ('MWG', 'VNM', 'MSN')\n    AND nbfr.year = 2021\n    AND nbfr.quarter = 0\n    AND nbfr.category_code IN ('BS_131', 'BS_141')\n\nUNION ALL\n\n-- Query to get investment details for the specified companies\nSELECT \n    s.stock_code,\n    CASE \n        WHEN nbfr.category_code = 'BS_251' THEN 'Investment in subsidiaries'\n        WHEN nbfr.category_code = 'BS_252' THEN 'Investment in associates and joint ventures'\n    END AS category,\n    nbfr.data AS value\nFROM \n    non_bank_financial_report nbfr\nJOIN \n    sub_and_shareholder s ON nbfr.stock_code = s.stock_code\nWHERE \n    nbfr.stock_code IN ('MWG', 'VNM', 'MSN')\n    AND nbfr.year = 2021\n    AND nbfr.quarter = 0\n    AND nbfr.category_code IN ('BS_251', 'BS_252');\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| parent_company   | invested_company   |\n|:-----------------|:-------------------|\n| MSN              | TCB                |\n| SCIC             | VNM                |\n| VNM              | VLC                |\n| VNM              | MCM                |\n| VNM              | SBT                |\n| VNM              | SRF                |\n| VNM              | TDW                |\n| MSN              | MSR                |\n| MSN              | MCH                |\n| MSN              | VCF                |\n| MSN              | QHW                |\n| MSN              | VSN                |\n| MSN              | MML                |\n| MSN              | CMF                |\n\nTable 2\n| stock_code   |   year |   quarter | account_type                         |             data |\n|:-------------|-------:|----------:|:-------------------------------------|-----------------:|\n| VNM          |   2021 |         0 | II. Short-term financial investments |      2.10257e+07 |\n| VNM          |   2021 |         0 | IV. Inventories                      |      6.77307e+06 |\n| MSN          |   2021 |         0 | IV. Inventories                      |      1.28134e+07 |\n| MSN          |   2021 |         0 | II. Short-term financial investments | 332753           |\n| MWG          |   2021 |         0 | II. Short-term financial investments |      1.42366e+07 |\n| MWG          |   2021 |         0 | IV. Inventories                      |      2.91672e+07 |\n\nTable 3\n| parent_company   | invested_company   |\n|:-----------------|:-------------------|\n| MSN              | TCB                |\n| SCIC             | VNM                |\n| VNM              | VLC                |\n| VNM              | MCM                |\n| VNM              | SBT                |\n| VNM              | SRF                |\n| VNM              | TDW                |\n| MSN              | MSR                |\n| MSN              | MCH                |\n| MSN              | VCF                |\n| MSN              | QHW                |\n| MSN              | VSN                |\n| MSN              | MML                |\n| MSN              | CMF                |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  T1.stock_code,\n  T1.year,\n  T1.quarter,\n  T2.en_caption AS account_type,\n  T1.data\nFROM \n  non_bank_financial_report T1\n  JOIN map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code IN ('MWG', 'VNM', 'MSN')\n  AND T1.year = 2021\n  AND T1.quarter = 0  -- For annual reports\n  AND T2.category_code IN ('BS_120', 'BS_140')  -- Hypothetical codes\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  T1.stock_code AS parent_company,\n  T1.invest_on AS invested_company\nFROM \n  sub_and_shareholder T1\nWHERE \n  T1.stock_code IN ('MWG', 'VNM', 'MSN')\n  OR T1.invest_on IN ('MWG', 'VNM', 'MSN')\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "-- **Not Recommended Without Aligning Columns**\n-- (SELECT... Part 1 Query...) \n-- UNION \n-- (SELECT... Part 2 Query...);\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  T1.stock_code,\n  T1.year,\n  T1.quarter,\n  T2.en_caption AS account_type,\n  T1.data\nFROM \n  non_bank_financial_report T1\n  JOIN map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n  T1.stock_code IN ('MWG', 'VNM', 'MSN')\n  AND T1.year = 2021\n  AND T1.quarter = 0  \n  AND T2.category_code IN ('BS_120', 'BS_140')  -- **Replace with Actual Codes**\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  T1.stock_code AS parent_company,\n  T1.invest_on AS invested_company\nFROM \n  sub_and_shareholder T1\nWHERE \n  T1.stock_code IN ('MWG', 'VNM', 'MSN')\n  OR T1.invest_on IN ('MWG', 'VNM', 'MSN')\nLIMIT 100;\n"
            }
        ],
        "time": 50.71770977973938,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "a49609f8-52db-4822-bc87-a6f207297116",
        "question": "What were the Return on Equity (ROE) and Return on Assets (ROA) for Vietcombank, Techcombank, and ACB in 2022?",
        "answer": "Table 1\n| stock_code   | ratio_code   |      data |\n|:-------------|:-------------|----------:|\n| TCB          | ROA          | 0.0292353 |\n| TCB          | ROE          | 0.180176  |\n| VCB          | ROA          | 0.0164951 |\n| ACB          | ROA          | 0.0225181 |\n| ACB          | ROE          | 0.234232  |\n| VCB          | ROE          | 0.220567  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    ratio_code, \n    data \nFROM \n    financial_ratio \nWHERE \n    (stock_code = 'VCB' OR stock_code = 'TCB' OR stock_code = 'ACB') \n    AND (ratio_code = 'ROE' OR ratio_code = 'ROA') \n    AND year = 2022 \n    AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Error in getting the answer",
        "code_response": "Error in getting the code",
        "evaluate": 0,
        "input_token": 715,
        "output_token": 261
    },
    {
        "id": "8dbfe18f-c50c-4fc6-b067-98938f4e5f02",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) exceeding 20% as of Q2 2024, based on their financial statements.",
        "answer": "Table 1\n| stock_code   | industry   | roe   |\n|--------------|------------|-------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE' \n    AND fr.year = 2024 \n    AND fr.quarter = 2 \n    AND fr.data > 20\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | roe_value   |\n|--------------|-------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  ci.stock_code, \n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Return On Equity'  -- Confirming ROE\n  AND fr.year = 2024  -- Specified Year\n  AND fr.quarter = 2  -- Specified Quarter (Q2)\n  AND fr.data > 0.20  -- ROE > 20%\nORDER BY \n  fr.data DESC  -- Ranking by ROE in Descending Order\nLIMIT 5;  -- Limit to Top 5\n"
            }
        ],
        "time": 29.59993577003479,
        "evaluate": 0,
        "input_token": 2199,
        "output_token": 850
    },
    {
        "id": "9bd1bf8b-a936-4ee0-b7ef-3f081505fae5",
        "question": "What were the total current assets and current liabilities for Vietcombank, Techcombank, and VPBank in 2022, and what were their respective current ratios for that year?  Further, provide the details of their significant subsidiaries' contribution to these figures.",
        "answer": "Table 1\n| stock_code   |   total_current_assets |   total_current_liabilities |   current_ratio | subsidiary_stock_code   |   subsidiary_current_assets |   subsidiary_current_liabilities |\n|:-------------|-----------------------:|----------------------------:|----------------:|:------------------------|----------------------------:|---------------------------------:|\n| TCB          |                      0 |              7826           |         3.29776 |                         |                             |                                  |\n| VCB          |                      0 |                 6.73148e+07 |         3.56816 | EIB                     |                           0 |                  48522           |\n| VCB          |                      0 |                 6.73148e+07 |         3.56816 | MBB                     |                           0 |                  63576           |\n| VCB          |                      0 |                 6.73148e+07 |         3.56816 | OCB                     |                           0 |                      5.18926e+06 |\n| VPB          |                      0 |                 1.92923e+06 |         2.24166 |                         |                             |                                  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve total current assets and current liabilities for the specified banks\nWITH bank_assets_liabilities AS (\n    SELECT \n        stock_code,\n        SUM(CASE WHEN category_code = 'BS_100' THEN data ELSE 0 END) AS total_current_assets,\n        SUM(CASE WHEN category_code = 'BS_310' THEN data ELSE 0 END) AS total_current_liabilities\n    FROM \n        bank_financial_report\n    WHERE \n        stock_code IN ('VCB', 'TCB', 'VPB')\n        AND year = 2022\n        AND quarter = 0\n    GROUP BY \n        stock_code\n),\n\n-- Step 2: Retrieve current ratio for the specified banks\nbank_current_ratios AS (\n    SELECT \n        stock_code,\n        data AS current_ratio\n    FROM \n        financial_ratio\n    WHERE \n        ratio_code = 'CurrentR'\n        AND stock_code IN ('VCB', 'TCB', 'VPB')\n        AND year = 2022\n        AND quarter = 0\n),\n\n-- Step 3: Retrieve subsidiaries' contributions\nsubsidiaries_contributions AS (\n    SELECT \n        s.stock_code,\n        s.invest_on,\n        SUM(CASE WHEN f.category_code = 'BS_100' THEN f.data ELSE 0 END) AS subsidiary_current_assets,\n        SUM(CASE WHEN f.category_code = 'BS_310' THEN f.data ELSE 0 END) AS subsidiary_current_liabilities\n    FROM \n        sub_and_shareholder s\n    JOIN \n        bank_financial_report f ON s.invest_on = f.stock_code\n    WHERE \n        s.stock_code IN ('VCB', 'TCB', 'VPB')\n        AND f.year = 2022\n        AND f.quarter = 0\n    GROUP BY \n        s.stock_code, s.invest_on\n)\n\n-- Final output combining all the information\nSELECT \n    a.stock_code,\n    a.total_current_assets,\n    a.total_current_liabilities,\n    r.current_ratio,\n    sc.invest_on AS subsidiary_stock_code,\n    sc.subsidiary_current_assets,\n    sc.subsidiary_current_liabilities\nFROM \n    bank_assets_liabilities a\nJOIN \n    bank_current_ratios r ON a.stock_code = r.stock_code\nLEFT JOIN \n    subsidiaries_contributions sc ON a.stock_code = sc.stock_code\nORDER BY \n    a.stock_code, sc.invest_on;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| subsidiary   |\n|:-------------|\n| PGI          |\n| EIB          |\n| MBB          |\n| HVN          |\n| PVD          |\n| OCB          |\n| SGP          |\n| FDC          |\n| VCG          |\n| HVN          |\n| EIB          |\n| MBB          |\n| OCB          |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Step 1 & 2: Current Assets, Current Liabilities, and Current Ratio for Specified Banks\nWITH \n  -- Define Current Assets and Current Liabilities category codes (Assuming BS_100 and BS_310 based on non-bank table, but should refer to bank table for accuracy)\n  CurrentAssetsCategory AS (SELECT 'BS_XXX' AS category_code),  -- TO BE REPLACED WITH ACTUAL CATEGORY CODE FROM map_category_code_bank FOR CURRENT ASSETS\n  CurrentLiabilitiesCategory AS (SELECT 'BS_XXX' AS category_code),  -- TO BE REPLACED WITH ACTUAL CATEGORY CODE FROM map_category_code_bank FOR CURRENT LIABILITIES\n  CurrentRatioCode AS (SELECT 'CurrentR' AS ratio_code),\n\n  -- Query Financial Data for Banks\n  BankFinancialData AS (\n    SELECT \n      bfr.stock_code,\n      bfr.year,\n      bfr.quarter,\n      bfr.category_code,\n      bfr.data,\n      mccb.en_caption\n    FROM \n      bank_financial_report bfr\n      JOIN map_category_code_bank mccb ON bfr.category_code = mccb.category_code\n    WHERE \n      bfr.stock_code IN ('VCB', 'TCB', 'VPB') \n      AND bfr.year = 2022 \n      AND bfr.quarter = 0\n  ),\n\n  -- Query Current Ratio for Banks\n  BankCurrentRatio AS (\n    SELECT \n      fr.stock_code,\n      fr.year,\n      fr.quarter,\n      fr.data AS current_ratio\n    FROM \n      financial_ratio fr\n      JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n      CROSS JOIN CurrentRatioCode crc\n    WHERE \n      fr.stock_code IN ('VCB', 'TCB', 'VPB') \n      AND fr.year = 2022 \n      AND fr.quarter = 0\n      AND mcr.ratio_code = crc.ratio_code\n  )\n\n-- Combine Results\nSELECT \n  bfd.stock_code,\n  bfd.en_caption,\n  bfd.data,\n  bcr.current_ratio\nFROM \n  BankFinancialData bfd\n  LEFT JOIN BankCurrentRatio bcr ON bfd.stock_code = bcr.stock_code\nWHERE \n  bfd.category_code IN (SELECT category_code FROM CurrentAssetsCategory, CurrentLiabilitiesCategory)  -- This will need adjustment based on actual category codes used\nLIMIT 100;\n\n-- Step 3: Significant Subsidiaries (Contribution calculation not included due to ambiguity)\nSELECT \n  sas.invest_on AS subsidiary\nFROM \n  sub_and_shareholder sas\nWHERE \n  sas.stock_code IN ('VCB', 'TCB', 'VPB')\nLIMIT 100;\n"
            }
        ],
        "time": 44.72107911109924,
        "evaluate": 0,
        "input_token": 4033,
        "output_token": 1720
    },
    {
        "id": "1fc45cfe-d70c-4722-89fc-0e61fb8c08ac",
        "question": "Compare the Debt-to-Equity ratio and the Current Ratio of Vinamilk and Masan Group for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   | ratio_code   |     data |\n|:-------------|:-------------|---------:|\n| MSN          | DTER         | 2.85445  |\n| VNM          | DTER         | 0.503847 |\n| MSN          | CurrentR     | 0.874439 |\n| VNM          | CurrentR     | 2.1016   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    ratio_code, \n    data \nFROM \n    financial_ratio \nWHERE \n    (stock_code = 'VNM' OR stock_code = 'MSN') \n    AND year = 2023 \n    AND quarter = 0 \n    AND (ratio_code = 'DTER' OR ratio_code = 'CurrentR');\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   |   debttoequityratio |   currentratio |\n|:-------------|--------------------:|---------------:|\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| MSN          |            2.85445  |       0.874439 |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n| VNM          |            0.503847 |       2.1016   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  -- Company Identifier\n  fr.stock_code,\n  \n  -- Company Names (Assuming a join with company_info for names, but since names aren't directly requested, we'll skip this for brevity)\n  \n  -- Financial Ratios\n  (SELECT data FROM financial_ratio WHERE stock_code = fr.stock_code AND ratio_code = 'DTER' AND year = 2023 AND quarter = 0) AS DebtToEquityRatio,\n  (SELECT data FROM financial_ratio WHERE stock_code = fr.stock_code AND ratio_code = 'CurrentR' AND year = 2023 AND quarter = 0) AS CurrentRatio\n  \nFROM \n  -- Since we're directly querying financial ratios, we don't necessarily need to join with non_bank_financial_report\n  -- However, to maintain clarity on which companies are being queried (in case of more complex queries), we'll include it\n  non_bank_financial_report fr\n  \nWHERE \n  -- Filter by the companies of interest\n  fr.stock_code IN ('VNM', 'MSN')\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  \n-- Limit for safety, though the query is quite specific\nLIMIT 100;\n"
            }
        ],
        "time": 37.15717792510986,
        "evaluate": 0.5,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "d839218c-d2ce-460b-855c-57b2db066d6b",
        "question": "What were the values of Total Assets, Total Liabilities, and Net Income for Vinamilk, Masan Group, and Mobile World Investment in 2023?",
        "answer": "Table 1\n| stock_code   |   year | category                             |        data |\n|:-------------|-------:|:-------------------------------------|------------:|\n| VNM          |   2023 | Net profit from operating activities | 1.09036e+07 |\n| MSN          |   2023 | Net profit from operating activities | 2.35043e+06 |\n| MSN          |   2023 | TOTAL ASSETS                         | 1.47383e+08 |\n| MSN          |   2023 | C. LIABILITIES                       | 1.09146e+08 |\n| MWG          |   2023 | Net profit from operating activities | 1.04707e+06 |\n| VNM          |   2023 | TOTAL ASSETS                         | 5.26734e+07 |\n| VNM          |   2023 | C. LIABILITIES                       | 1.76476e+07 |\n| MWG          |   2023 | TOTAL ASSETS                         | 6.01112e+07 |\n| MWG          |   2023 | C. LIABILITIES                       | 3.67517e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    nfr.year,\n    mcc.en_caption AS category,\n    nfr.data\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.year = 2023\n    AND nfr.quarter = 0\n    AND nfr.stock_code IN ('VNM', 'MSN', 'MWG')\n    AND nfr.category_code IN ('BS_270', 'BS_300', 'IS_030');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| metric            | stock_code   |   year |   quarter | en_caption            |        data |\n|:------------------|:-------------|-------:|----------:|:----------------------|------------:|\n| Total Assets      | VNM          |   2023 |         0 | A. CURRENT ASSETS     | 3.59359e+07 |\n| Total Assets      | VNM          |   2023 |         0 | B. NON-CURRENT ASSETS | 1.67375e+07 |\n| Total Assets      | MSN          |   2023 |         0 | A. CURRENT ASSETS     | 4.37635e+07 |\n| Total Assets      | MSN          |   2023 |         0 | B. NON-CURRENT ASSETS | 1.0362e+08  |\n| Total Assets      | MWG          |   2023 |         0 | A. CURRENT ASSETS     | 5.19503e+07 |\n| Total Assets      | MWG          |   2023 |         0 | B. NON-CURRENT ASSETS | 8.1609e+06  |\n| Net Income        | MWG          |   2023 |         0 | B. NON-CURRENT ASSETS | 8.1609e+06  |\n| Total Liabilities | MWG          |   2023 |         0 | A. CURRENT ASSETS     | 5.19503e+07 |\n| Total Liabilities | VNM          |   2023 |         0 | A. CURRENT ASSETS     | 3.59359e+07 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    'Total Assets' AS Metric,\n    T1.stock_code,\n    T1.year,\n    T1.quarter,\n    T2.en_caption,\n    T1.data\nFROM \n    non_bank_financial_report T1\nJOIN \n    map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n    T1.stock_code IN ('VNM', 'MSN', 'MWG')\n    AND T1.year = 2023\n    AND T1.quarter = 0  -- For annual reports\n    AND T1.category_code IN ('BS_100', 'BS_200', 'IS_005')\n\nUNION ALL\n\nSELECT \n    'Total Liabilities' AS Metric,\n    T1.stock_code,\n    T1.year,\n    T1.quarter,\n    T2.en_caption,\n    T1.data\nFROM \n    non_bank_financial_report T1\nJOIN \n    map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n    T1.stock_code IN ('VNM', 'MSN', 'MWG')\n    AND T1.year = 2023\n    AND T1.quarter = 0  -- For annual reports\n    AND T1.category_code IN ('BS_100', 'BS_200', 'IS_005')\n\nUNION ALL\n\nSELECT \n    'Net Income' AS Metric,\n    T1.stock_code,\n    T1.year,\n    T1.quarter,\n    T2.en_caption,\n    T1.data\nFROM \n    non_bank_financial_report T1\nJOIN \n    map_category_code_non_bank T2 ON T1.category_code = T2.category_code\nWHERE \n    T1.stock_code IN ('VNM', 'MSN', 'MWG')\n    AND T1.year = 2023\n    AND T1.quarter = 0  -- For annual reports\n    AND T1.category_code IN ('BS_100', 'BS_200', 'IS_005')\n\nLIMIT 9;\n"
            }
        ],
        "time": 56.78001546859741,
        "evaluate": 0,
        "input_token": 1744,
        "output_token": 860
    },
    {
        "id": "92b00988-89ff-42e7-ae1e-2abd01ab7947",
        "question": "What is the trend of the Net Cash Flow from Operating Activities for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | net_cash_flow_operating_activities   |\n|--------------|--------|-----------|--------------------------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS net_cash_flow_operating_activities\nFROM \n    bank_financial_report\nWHERE \n    stock_code IN ('VCB', 'TCB', 'ACB') \n    AND category_code = 'CF_009'\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual reports from 2020 to 2023\n        OR (year = 2024 AND quarter BETWEEN 1 AND 2) -- Quarterly reports for Q1 and Q2 of 2024\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | year   | quarter   | en_caption   | data   |\n|--------------|--------|-----------|--------------|--------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  bfr.stock_code,\n  bfr.year,\n  bfr.quarter,\n  mccb.en_caption,\n  bfr.data\nFROM \n  bank_financial_report bfr\n  INNER JOIN map_category_code_bank mccb ON bfr.category_code = mccb.category_code\nWHERE \n  bfr.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND bfr.category_code = 'CF_009'\n  AND (\n    (bfr.year < 2024 AND bfr.quarter = 0)  -- Annual reports for years before 2024\n    OR (bfr.year = 2024 AND bfr.quarter = 2)  -- Q2 for 2024\n  )\n  AND bfr.year >= 2020\nORDER BY \n  bfr.stock_code, bfr.year, bfr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 39.68239140510559,
        "evaluate": 0,
        "input_token": 2486,
        "output_token": 1025
    },
    {
        "id": "7d5b40dc-a4a2-4e05-96fb-4716676e6d36",
        "question": "Calculate the Debt-to-Equity ratio for  Vinamilk,  Masan Group, and  PetroVietnam Gas in 2023 Q2.  Analyze the relationship between these ratios and the financial health of their respective subsidiaries or investments.",
        "answer": "Table 1\n| stock_code   | en_company_name                            |   year |   quarter |   debt_to_equity_ratio |\n|:-------------|:-------------------------------------------|-------:|----------:|-----------------------:|\n| VNM          | Vietnam Dairy Products Joint Stock Company |   2023 |         2 |               0.390309 |\n| MSN          | Masan Group Corporation                    |   2023 |         2 |               2.75379  |\n| GAS          | PetroVietnam Gas Joint Stock Corporation   |   2023 |         2 |               0.308313 |\n\nTable 2\n| stock_code   | invest_on   | parent_company                           | subsidiary_company                                    |\n|:-------------|:------------|:-----------------------------------------|:------------------------------------------------------|\n| MSN          | TCB         | Masan Group Corporation                  | Vietnam Technological And Commercial Joint Stock Bank |\n| GAS          | PVG         | PetroVietnam Gas Joint Stock Corporation | Petro Vietnam LPG Joint Stock Company                 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve the Debt-to-Equity ratio for the specified companies in 2023 Q2\nSELECT \n    fr.stock_code,\n    ci.en_company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND fr.year = 2023\n    AND fr.quarter = 2\n    AND fr.stock_code IN ('VNM', 'MSN', 'GAS');\n\n-- Step 2: Retrieve the subsidiaries or investments for each company\nSELECT \n    ss.stock_code,\n    ss.invest_on,\n    ci.en_company_name AS parent_company,\n    ci2.en_company_name AS subsidiary_company\nFROM \n    sub_and_shareholder ss\nJOIN \n    company_info ci ON ss.stock_code = ci.stock_code\nJOIN \n    company_info ci2 ON ss.invest_on = ci2.stock_code\nWHERE \n    ss.stock_code IN ('VNM', 'MSN', 'GAS');\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | en_company_name                            |     dter |\n|:-------------|:-------------------------------------------|---------:|\n| VNM          | Vietnam Dairy Products Joint Stock Company | 0.390309 |\n| MSN          | Masan Group Corporation                    | 2.75379  |\n| GAS          | PetroVietnam Gas Joint Stock Corporation   | 0.308313 |\n\nTable 2\n| stock_code   | relationship   | en_company_name                                                              | netincome_2023q2   |\n|:-------------|:---------------|:-----------------------------------------------------------------------------|:-------------------|\n| TCB          | Investment     | Vietnam Technological And Commercial Joint Stock Bank                        |                    |\n| PVN          | Parent         | Vietnam Oil and Gas Group                                                    |                    |\n| PVG          | Investment     | Petro Vietnam LPG Joint Stock Company                                        |                    |\n| SCIC         | Parent         | State Capital Investment and Trading Corporation - Limited Liability Company |                    |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.en_company_name,\n  fr.data AS DTER\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Debt To Equity Ratio'\n  AND fr.stock_code IN ('VNM', 'MSN', 'GAS')\n  AND fr.year = 2023\n  AND fr.quarter = 2  -- Q2\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "-- Retrieve Subsidiaries/Investments\nWITH subsidiaries AS (\n  SELECT \n    s.invest_on AS stock_code,\n    'Investment' AS relationship\n  FROM \n    sub_and_shareholder s\n  WHERE \n    s.stock_code IN ('VNM', 'MSN', 'GAS')\n  UNION ALL\n  SELECT \n    s.stock_code,\n    'Parent' AS relationship\n  FROM \n    sub_and_shareholder s\n  WHERE \n    s.invest_on IN ('VNM', 'MSN', 'GAS')\n)\n-- Join with Financial Data (Example: Net Income, assuming IS_014 is Net Income based on a non-provided mapping)\nSELECT \n  s.stock_code,\n  s.relationship,\n  ci.en_company_name,\n  nfr.data AS NetIncome_2023Q2\nFROM \n  subsidiaries s\n  JOIN company_info ci ON s.stock_code = ci.stock_code\n  LEFT JOIN non_bank_financial_report nfr ON s.stock_code = nfr.stock_code\n    AND nfr.year = 2023 AND nfr.quarter = 2\n    AND nfr.category_code = 'IS_014'  -- Assuming this is Net Income, adjust based on actual mapping\nLIMIT 100;\n"
            }
        ],
        "time": 50.68053579330444,
        "evaluate": 0.5,
        "input_token": 1883,
        "output_token": 863
    },
    {
        "id": "13adfa83-6eb5-4eaf-8f6e-0e57464afbf4",
        "question": "Compare the changes in  Property, Plant, and Equipment (PP&E)  for Vinamilk, Hoa Phat Group, and VinGroup from 2020 to Q2 2024.  Show the net increase/decrease each year.",
        "answer": "Table 1\n| stock_code   |   year |   net_change |\n|:-------------|-------:|-------------:|\n| HPG          |   2020 |  1.31123e+08 |\n| HPG          |   2021 |  7.43837e+06 |\n| HPG          |   2022 |  3.10415e+06 |\n| HPG          |   2023 |  2.33091e+06 |\n| HPG          |   2024 | -3.84744e+06 |\n| VIC          |   2020 |  2.5128e+08  |\n| VIC          |   2021 |  1.01122e+07 |\n| VIC          |   2022 | -2.1907e+07  |\n| VIC          |   2023 |  8.13337e+07 |\n| VIC          |   2024 |  6.03128e+07 |\n| VNM          |   2020 |  2.77076e+07 |\n| VNM          |   2021 | -2.29442e+06 |\n| VNM          |   2022 | -1.60678e+06 |\n| VNM          |   2023 |  1.57289e+06 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH ppe_data AS (\n    SELECT \n        stock_code,\n        year,\n        SUM(data) AS total_ppe\n    FROM \n        non_bank_financial_report\n    WHERE \n        category_code IN ('BS_220', 'BS_221', 'BS_224', 'BS_227', 'BS_263')\n        AND stock_code IN ('VNM', 'HPG', 'VIC')\n        AND ((year BETWEEN 2020 AND 2023 AND quarter = 0) OR (year = 2024 AND quarter = 2))\n    GROUP BY \n        stock_code, year\n),\nppe_change AS (\n    SELECT \n        a.stock_code,\n        a.year,\n        a.total_ppe - COALESCE(b.total_ppe, 0) AS net_change\n    FROM \n        ppe_data a\n    LEFT JOIN \n        ppe_data b ON a.stock_code = b.stock_code AND a.year = b.year + 1\n)\nSELECT \n    stock_code,\n    year,\n    net_change\nFROM \n    ppe_change\nORDER BY \n    stock_code, year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | year   | annual_data   | q2_2024_data   | net_change_annual   | net_change_q2_2024   |\n|--------------|--------|---------------|----------------|---------------------|----------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Annual Reports for 2020 to 2023\nAnnualReports AS (\n  SELECT \n    stock_code,\n    year,\n    data AS annual_data\n  FROM \n    non_bank_financial_report\n  WHERE \n    stock_code IN ('VNM', 'HPG', 'VIC') \n    AND category_code = 'BS_XXX'  -- REPLACE 'BS_XXX' WITH ACTUAL PP&E CATEGORY CODE\n    AND quarter = 0 \n    AND year IN (2020, 2021, 2022, 2023)\n),\n-- Q2 Report for 2024\nQ2Report2024 AS (\n  SELECT \n    stock_code,\n    data AS q2_2024_data\n  FROM \n    non_bank_financial_report\n  WHERE \n    stock_code IN ('VNM', 'HPG', 'VIC') \n    AND category_code = 'BS_XXX'  -- REPLACE 'BS_XXX' WITH ACTUAL PP&E CATEGORY CODE\n    AND quarter = 2 \n    AND year = 2024\n)\n\n-- Combine and Calculate Net Increase/Decrease\nSELECT \n  A.stock_code,\n  A.year,\n  A.annual_data,\n  Q.q2_2024_data,\n  -- Calculate net increase/decrease for each year and for Q2 2024 compared to the previous year\n  CASE \n    WHEN A.year = 2020 THEN NULL  -- No previous year to compare\n    ELSE A.annual_data - LAG(A.annual_data) OVER (PARTITION BY A.stock_code ORDER BY A.year)\n  END AS net_change_annual,\n  -- For Q2 2024, compare with the last available annual report (2023)\n  Q.q2_2024_data - LAG(A.annual_data) OVER (PARTITION BY A.stock_code ORDER BY A.year) AS net_change_q2_2024\nFROM \n  AnnualReports A\n  LEFT JOIN Q2Report2024 Q ON A.stock_code = Q.stock_code\nORDER BY \n  A.stock_code, \n  A.year\nLIMIT 100;  -- Adjust the LIMIT as necessary\n"
            }
        ],
        "time": 42.95782256126404,
        "evaluate": 0,
        "input_token": 1760,
        "output_token": 921
    },
    {
        "id": "e7873bd4-6132-4705-a91f-5c55cd3b9b66",
        "question": "What was the average Return on Equity (ROE) for  Vietcombank, Techcombank, and  VPBank  in 2022, and how did this compare to their respective subsidiaries' average ROE for the same year?",
        "answer": "Table 1\n| bank   |   bank_avg_roe |   subsidiary_avg_roe |\n|:-------|---------------:|---------------------:|\n| TCB    |       0.180176 |           nan        |\n| VCB    |       0.220567 |             0.170252 |\n| VPB    |       0.163367 |           nan        |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_roe AS (\n    SELECT \n        stock_code, \n        AVG(data) AS avg_roe\n    FROM \n        financial_ratio\n    WHERE \n        ratio_code = 'ROE' \n        AND year = 2022 \n        AND quarter = 0\n        AND stock_code IN ('VCB', 'TCB', 'VPB')\n    GROUP BY \n        stock_code\n),\nsubsidiary_roe AS (\n    SELECT \n        s.stock_code, \n        AVG(fr.data) AS avg_roe\n    FROM \n        sub_and_shareholder s\n    JOIN \n        financial_ratio fr ON s.invest_on = fr.stock_code\n    WHERE \n        fr.ratio_code = 'ROE' \n        AND fr.year = 2022 \n        AND fr.quarter = 0\n        AND s.stock_code IN ('VCB', 'TCB', 'VPB')\n    GROUP BY \n        s.stock_code\n)\nSELECT \n    b.stock_code AS bank,\n    b.avg_roe AS bank_avg_roe,\n    s.avg_roe AS subsidiary_avg_roe\nFROM \n    bank_roe b\nLEFT JOIN \n    subsidiary_roe s ON b.stock_code = s.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | company_name                                       |   bank_avg_roe | subsidiary_avg_roe   |\n|:-------------|:---------------------------------------------------|---------------:|:---------------------|\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam    |       0.180176 |                      |\n| VCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Ngo\u1ea1i th\u01b0\u01a1ng Vi\u1ec7t Nam |       0.220567 |                      |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng  |       0.163367 |                      |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Part 1: Average ROE for Vietcombank, Techcombank, and VPBank in 2022\nWITH bank_roe AS (\n  SELECT \n    fr.stock_code,\n    ci.company_name,  -- Assuming company_name exists in company_info for clarity\n    AVG(fr.data) AS avg_roe\n  FROM \n    financial_ratio fr\n  JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\n  JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE \n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year = 2022\n    AND fr.quarter = 0\n    AND ci.stock_code IN ('VCB', 'TCB', 'VPB')\n  GROUP BY \n    fr.stock_code, ci.company_name\n)\n-- Part 2: Average ROE for their Subsidiaries in 2022\n, subsidiary_roe AS (\n  SELECT \n    s.invest_on AS subsidiary_code,\n    AVG(fr.data) AS avg_sub_roe\n  FROM \n    financial_ratio fr\n  JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  JOIN \n    sub_and_shareholder s ON fr.stock_code = s.invest_on\n  WHERE \n    mcr.ratio_name = 'Return On Equity'\n    AND fr.year = 2022\n    AND fr.quarter = 0\n    AND s.stock_code IN ('VCB', 'TCB', 'VPB')  -- Assuming these are the parent companies\n  GROUP BY \n    s.invest_on\n)\n-- Combining Results for Clarity\nSELECT \n  b.stock_code,\n  b.company_name,\n  b.avg_roe AS bank_avg_roe,\n  s.avg_sub_roe AS subsidiary_avg_roe\nFROM \n  bank_roe b\n  LEFT JOIN subsidiary_roe s ON b.stock_code = s.subsidiary_code  -- Note: This join might not be fully accurate without clear subsidiary relationships\nLIMIT 100;  -- To adhere to the query limit requirement\n"
            }
        ],
        "time": 73.17767214775085,
        "evaluate": 0.5,
        "input_token": 2431,
        "output_token": 1199
    },
    {
        "id": "7e2eeae9-63ca-4551-8421-3e02bfd5c000",
        "question": "What is the trend of  operating cash flow for Vietcombank, Techcombank, and Sacombank from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | operating_cash_flow   |\n|--------------|--------|-----------|-----------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    year,\n    quarter,\n    data AS operating_cash_flow\nFROM \n    bank_financial_report\nWHERE \n    stock_code IN ('VCB', 'TCB', 'STB')\n    AND category_code = 'CF_009'\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual reports from 2020 to 2023\n        OR (year = 2024 AND quarter <= 2) -- Quarterly reports for 2024 up to Q2\n    )\nORDER BY \n    stock_code, year, quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name   | year   | quarter   | category   | operating_cash_flow   |\n|--------------|-------------------|--------|-----------|------------|-----------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    bfr.stock_code,\n    ci.en_company_name,\n    bfr.year,\n    bfr.quarter,\n    mccb.en_caption AS category,\n    bfr.data AS operating_cash_flow\nFROM \n    bank_financial_report bfr\nINNER JOIN \n    company_info ci ON bfr.stock_code = ci.stock_code\nINNER JOIN \n    map_category_code_bank mccb ON bfr.category_code = mccb.category_code\nWHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'STB')\n    AND bfr.category_code = 'CF_009'\n    AND (\n        (bfr.year BETWEEN 2020 AND 2023 AND bfr.quarter = 0)  -- Annual reports for 2020 to 2023\n        OR (bfr.year = 2024 AND bfr.quarter = 2)  -- Q2 for 2024\n    )\nORDER BY \n    bfr.stock_code, bfr.year, bfr.quarter\nLIMIT 100;\n"
            }
        ],
        "time": 42.15964388847351,
        "evaluate": 0,
        "input_token": 2123,
        "output_token": 850
    },
    {
        "id": "5b310386-fc27-4cf8-b9c0-421b0979ffb2",
        "question": "Show the change in  total assets and total liabilities for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Calculate the debt-to-asset ratio for each company for each year.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   total_assets |   total_liabilities |   debt_to_asset_ratio |\n|:-------------|-------:|----------:|---------------:|--------------------:|----------------------:|\n| HPG          |   2020 |         0 |    1.31511e+08 |         1.31511e+08 |              0.549699 |\n| HPG          |   2021 |         0 |    1.78236e+08 |         1.78236e+08 |              0.490673 |\n| HPG          |   2022 |         0 |    1.70336e+08 |         1.70336e+08 |              0.435743 |\n| HPG          |   2023 |         0 |    1.87783e+08 |         1.87783e+08 |              0.452364 |\n| HPG          |   2024 |         2 |    2.06609e+08 |         2.06609e+08 |              0.473999 |\n| MSN          |   2020 |         0 |    1.15737e+08 |         1.15737e+08 |              0.783731 |\n| MSN          |   2021 |         0 |    1.26093e+08 |         1.26093e+08 |              0.664244 |\n| MSN          |   2022 |         0 |    1.41343e+08 |         1.41343e+08 |              0.740795 |\n| MSN          |   2023 |         0 |    1.47383e+08 |         1.47383e+08 |              0.74056  |\n| VNM          |   2020 |         0 |    4.84325e+07 |         4.84325e+07 |              0.305278 |\n| VNM          |   2021 |         0 |    5.33324e+07 |         5.33324e+07 |              0.327799 |\n| VNM          |   2022 |         0 |    4.84827e+07 |         4.84827e+07 |              0.323129 |\n| VNM          |   2023 |         0 |    5.26734e+07 |         5.26734e+07 |              0.335039 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH AssetLiabilityData AS (\n    SELECT\n        nfr.stock_code,\n        nfr.year,\n        nfr.quarter,\n        CASE\n            WHEN mccnb.en_caption = 'TOTAL ASSETS' THEN nfr.data\n            ELSE 0\n        END AS total_assets,\n        CASE\n            WHEN mccnb.en_caption = 'TOTAL LIABILITIES AND EQUITY' THEN nfr.data\n            ELSE 0\n        END AS total_liabilities\n    FROM\n        non_bank_financial_report nfr\n    JOIN\n        map_category_code_non_bank mccnb ON nfr.category_code = mccnb.category_code\n    WHERE\n        nfr.stock_code IN ('VNM', 'MSN', 'HPG')\n        AND mccnb.en_caption IN ('TOTAL ASSETS', 'TOTAL LIABILITIES AND EQUITY')\n        AND ((nfr.year BETWEEN 2020 AND 2024 AND nfr.quarter = 0) OR (nfr.year = 2024 AND nfr.quarter = 2))\n),\nAggregatedData AS (\n    SELECT\n        stock_code,\n        year,\n        quarter,\n        SUM(total_assets) AS total_assets,\n        SUM(total_liabilities) AS total_liabilities\n    FROM\n        AssetLiabilityData\n    GROUP BY\n        stock_code, year, quarter\n)\nSELECT\n    ad.stock_code,\n    ad.year,\n    ad.quarter,\n    ad.total_assets,\n    ad.total_liabilities,\n    fr.data AS debt_to_asset_ratio\nFROM\n    AggregatedData ad\nLEFT JOIN\n    financial_ratio fr ON ad.stock_code = fr.stock_code AND ad.year = fr.year AND ad.quarter = fr.quarter\nWHERE\n    fr.ratio_code = 'DTAR'\nORDER BY\n    ad.stock_code, ad.year, ad.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | datatype          |   year |   quarter |       value |       dtar |\n|:-------------|:------------------|-------:|----------:|------------:|-----------:|\n| VNM          | Total Assets      |   2020 |         0 | 5.67473e+07 |   0.305278 |\n| VNM          | Total Assets      |   2020 |         0 | 2.97607e+07 |   0.305278 |\n| VNM          | Total Assets      |   2020 |         0 | 2.96657e+07 |   0.305278 |\n| VNM          | Total Liabilities |   2020 |         0 | 7.47642e+07 |   0.305278 |\n| VNM          | Total Liabilities |   2020 |         0 | 1.87668e+07 |   0.305278 |\n| VNM          | Total Liabilities |   2020 |         0 | 8.59759e+07 |   0.305278 |\n| VNM          | Total Assets      |   2021 |         0 | 9.41549e+07 |   0.327799 |\n| VNM          | Total Assets      |   2021 |         0 | 4.36302e+07 |   0.327799 |\n| VNM          | Total Assets      |   2021 |         0 | 3.61099e+07 |   0.327799 |\n| VNM          | Total Liabilities |   2021 |         0 | 1.72225e+07 |   0.327799 |\n| VNM          | Total Liabilities |   2021 |         0 | 8.24633e+07 |   0.327799 |\n| VNM          | Total Liabilities |   2021 |         0 | 8.40816e+07 |   0.327799 |\n| VNM          | Total Assets      |   2022 |         0 | 3.15604e+07 |   0.323129 |\n| VNM          | Total Assets      |   2022 |         0 | 8.05147e+07 |   0.323129 |\n| VNM          | Total Assets      |   2022 |         0 | 4.76746e+07 |   0.323129 |\n| VNM          | Total Liabilities |   2022 |         0 | 1.69223e+07 |   0.323129 |\n| VNM          | Total Liabilities |   2022 |         0 | 8.98208e+07 |   0.323129 |\n| VNM          | Total Liabilities |   2022 |         0 | 9.36682e+07 |   0.323129 |\n| VNM          | Total Assets      |   2023 |         0 | 3.59359e+07 |   0.335039 |\n| VNM          | Total Assets      |   2023 |         0 | 4.37635e+07 |   0.335039 |\n| VNM          | Total Assets      |   2023 |         0 | 8.27164e+07 |   0.335039 |\n| VNM          | Total Liabilities |   2023 |         0 | 1.05066e+08 |   0.335039 |\n| VNM          | Total Liabilities |   2023 |         0 | 1.67375e+07 |   0.335039 |\n| VNM          | Total Liabilities |   2023 |         0 | 1.0362e+08  |   0.335039 |\n| VNM          | Total Assets      |   2024 |         2 | 8.44668e+07 | nan        |\n| VNM          | Total Liabilities |   2024 |         2 | 1.22142e+08 | nan        |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Part 1: Change in Total Assets and Total Liabilities from 2020 to Q2 2024\nWITH \n  -- Assets and Liabilities for Vinamilk, Masan, and Hoa Phat\n  CompanyData AS (\n    SELECT \n      'VNM' AS stock_code, \n      CASE WHEN category_code = 'BS_100' THEN 'Total Assets' ELSE 'Total Liabilities' END AS DataType,\n      year, \n      quarter, \n      data\n    FROM non_bank_financial_report\n    WHERE stock_code IN ('VNM', 'MSN', 'HPG') \n      AND category_code IN ('BS_100', 'BS_200')  -- Replace with actual codes\n      AND (year BETWEEN 2020 AND 2024 AND (quarter = 0 OR (year = 2024 AND quarter = 2)))\n  ),\n  \n  -- Debt-to-Asset Ratio for the companies\n  DebtToAssetRatio AS (\n    SELECT \n      stock_code, \n      year, \n      quarter, \n      data AS DTAR\n    FROM financial_ratio\n    WHERE ratio_code = 'DTAR' \n      AND stock_code IN ('VNM', 'MSN', 'HPG')\n      AND (year BETWEEN 2020 AND 2024 AND (quarter = 0 OR (year = 2024 AND quarter = 2)))\n  )\n\n-- Combine Results\nSELECT \n  -- From CompanyData CTE\n  CD.stock_code,\n  CD.DataType,\n  CD.year,\n  CD.quarter,\n  CD.data AS Value,\n  \n  -- From DebtToAssetRatio CTE (NULL if not matching year/quarter, adjust join as needed)\n  DTA.DTAR\nFROM CompanyData CD\nLEFT JOIN DebtToAssetRatio DTA ON CD.stock_code = DTA.stock_code AND CD.year = DTA.year AND CD.quarter = DTA.quarter\n\nORDER BY CD.stock_code, CD.year, CD.quarter, CD.DataType\n\nLIMIT 100;  -- Adjust limit as necessary\n"
            }
        ],
        "time": 47.84274935722351,
        "evaluate": 0,
        "input_token": 1822,
        "output_token": 918
    },
    {
        "id": "6332ded8-a846-4f63-9d25-d8dfa9aed104",
        "question": "What is the trend of the Current Ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   current_ratio |\n|:-------------|-------:|----------:|----------------:|\n| ACB          |   2020 |         0 |         3.69815 |\n| ACB          |   2021 |         0 |         3.97544 |\n| ACB          |   2022 |         0 |         3.81624 |\n| ACB          |   2023 |         0 |         3.04283 |\n| ACB          |   2024 |         1 |         3.29123 |\n| TCB          |   2020 |         0 |         2.83619 |\n| TCB          |   2021 |         0 |         4.35343 |\n| TCB          |   2022 |         0 |         3.29776 |\n| TCB          |   2023 |         0 |         2.66367 |\n| TCB          |   2024 |         1 |         2.40445 |\n| TCB          |   2024 |         2 |         2.88946 |\n| VCB          |   2020 |         0 |         7.25011 |\n| VCB          |   2021 |         0 |         6.29498 |\n| VCB          |   2022 |         0 |         3.56816 |\n| VCB          |   2023 |         0 |         4.7828  |\n| VCB          |   2024 |         1 |         3.48899 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS current_ratio\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'CurrentR' \n    AND stock_code IN ('VCB', 'TCB', 'ACB')\n    AND (\n        (year BETWEEN 2020 AND 2023 AND quarter = 0) -- Annual data for 2020 to 2023\n        OR \n        (year = 2024 AND quarter <= 2) -- Quarterly data for 2024 up to Q2\n    )\nORDER BY \n    stock_code, \n    year, \n    quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | year   | quarter   | currentratio   |\n|--------------|--------|-----------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Hypothetical Current Assets and Liabilities Data Extraction\nCurrentData AS (\n  SELECT \n    stock_code,\n    year,\n    quarter,\n    -- Hypothetical category codes for demonstration\n    SUM(CASE WHEN category_code = 'BS_CUR_ASSETS' THEN data ELSE 0 END) AS CurrentAssets,\n    SUM(CASE WHEN category_code = 'BS_CUR_LIABILITIES' THEN data ELSE 0 END) AS CurrentLiabilities\n  FROM \n    bank_financial_report\n  WHERE \n    stock_code IN ('VCB', 'TCB', 'ACB')\n    AND year BETWEEN 2020 AND 2024\n    AND (quarter = 0 OR (year = 2024 AND quarter = 2))  -- Annual data and Q2 2024\n    AND category_code IN ('BS_CUR_ASSETS', 'BS_CUR_LIABILITIES')  -- Hypothetical codes\n  GROUP BY \n    stock_code, year, quarter\n),\n\n-- Calculate Current Ratio\nCurrentRatio AS (\n  SELECT \n    stock_code,\n    year,\n    quarter,\n    CurrentAssets / CurrentLiabilities AS CurrentRatio\n  FROM \n    CurrentData\n  WHERE \n    CurrentLiabilities <> 0  -- Avoid division by zero\n)\n\n-- Final Selection\nSELECT \n  stock_code,\n  year,\n  quarter,\n  CurrentRatio\nFROM \n  CurrentRatio\nORDER BY \n  stock_code, year, quarter\nLIMIT 100;  -- To adhere to the 'must add limit' instruction\n"
            }
        ],
        "time": 47.35343599319458,
        "evaluate": 0,
        "input_token": 2060,
        "output_token": 937
    },
    {
        "id": "77119fb1-1ebd-44db-9398-0e378dc3824d",
        "question": "Rank the top 10 companies by their Return on Equity (ROE) for the fiscal year 2023.",
        "answer": "Table 1\n| stock_code   | industry                      |      roe |\n|:-------------|:------------------------------|---------:|\n| TMB          | Basic Resources               | 0.476625 |\n| SLS          | Food and Beverages            | 0.443074 |\n| CAP          | Basic Resources               | 0.43171  |\n| SAF          | Food and Beverages            | 0.2894   |\n| DGC          | Chemicals                     | 0.269533 |\n| DTD          | Real Estate                   | 0.262679 |\n| FPT          | Information Technology        | 0.260183 |\n| VNM          | Food and Beverages            | 0.257506 |\n| VTP          | Industrial Goods and Services | 0.240244 |\n| HDB          | Banking                       | 0.232433 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2023\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry                      |   roe_value |\n|:-------------|:------------------------------|------------:|\n| TMB          | Basic Resources               |    0.476625 |\n| SLS          | Food and Beverages            |    0.443074 |\n| CAP          | Basic Resources               |    0.43171  |\n| SAF          | Food and Beverages            |    0.2894   |\n| DGC          | Chemicals                     |    0.269533 |\n| DTD          | Real Estate                   |    0.262679 |\n| FPT          | Information Technology        |    0.260183 |\n| VNM          | Food and Beverages            |    0.257506 |\n| VTP          | Industrial Goods and Services |    0.240244 |\n| HDB          | Banking                       |    0.232433 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    ci.industry,\n    fr.data AS ROE_Value\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE'  -- Assuming 'ROE' is the exact code for Return on Equity\n    AND fr.year = 2023\n    AND fr.quarter = 0  -- For annual reports\nORDER BY \n    fr.data DESC  -- Ranking by ROE value in descending order\nLIMIT 10;  -- To get the top 10 companies\n"
            }
        ],
        "time": 34.86188292503357,
        "evaluate": 1,
        "input_token": 2697,
        "output_token": 1404
    },
    {
        "id": "557a8a67-6696-4b97-b5fb-a41f9d3101cd",
        "question": "What are the top 5 companies with the highest Total Assets as of Q2 2024?",
        "answer": "Table 1\n| stock_code   | industry    | is_bank   | is_securities   |   total_assets |\n|:-------------|:------------|:----------|:----------------|---------------:|\n| BID          | Banking     | True      | False           |    2.52105e+09 |\n| TCB          | Banking     | True      | False           |    9.08307e+08 |\n| VPB          | Banking     | True      | False           |    8.64392e+08 |\n| VIC          | Real Estate | False     | False           |    7.22259e+08 |\n| SHB          | Banking     | True      | False           |    6.59767e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to find the top 5 companies with the highest Total Assets as of Q2 2024\n\nSELECT ci.stock_code, ci.industry, ci.is_bank, ci.is_securities, fr.data AS total_assets\nFROM (\n    SELECT stock_code, data\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2024 AND quarter = 2\n    \n    UNION ALL\n    \n    SELECT stock_code, data\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_270' AND year = 2024 AND quarter = 2\n    \n    UNION ALL\n    \n    SELECT stock_code, data\n    FROM securities_financial_report\n    WHERE category_code = 'BS_270' AND year = 2024 AND quarter = 2\n) AS fr\nJOIN company_info ci ON fr.stock_code = ci.stock_code\nORDER BY fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | company_name                                               | type     |   totalassets |\n|:-------------|:-----------------------------------------------------------|:---------|--------------:|\n| BID          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n \u0110\u1ea7u t\u01b0 v\u00e0 Ph\u00e1t tri\u1ec3n Vi\u1ec7t Nam | Bank     |   2.52105e+09 |\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam            | Bank     |   9.08307e+08 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng          | Bank     |   8.64392e+08 |\n| VIC          | T\u1eadp \u0111o\u00e0n Vingroup - C\u00f4ng ty CP                             | Non-Bank |   7.22259e+08 |\n| SHB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n S\u00e0i G\u00f2n \u2013 H\u00e0 N\u1ed9i              | Bank     |   6.59767e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH TotalAssetsReports AS (\n  SELECT stock_code, data AS TotalAssets, 'Bank' AS Type\n  FROM bank_financial_report\n  WHERE year = 2024 AND quarter = 2 AND category_code = 'BS_300'\n  \n  UNION ALL\n  \n  SELECT stock_code, data, 'Non-Bank'\n  FROM non_bank_financial_report\n  WHERE year = 2024 AND quarter = 2 AND category_code = 'BS_270'\n  \n  UNION ALL\n  \n  SELECT stock_code, data, 'Securities'\n  FROM securities_financial_report\n  WHERE year = 2024 AND quarter = 2 AND category_code = 'BS_270'\n)\n\nSELECT \n  TAR.stock_code,\n  CI.company_name,  -- Assuming company_name exists in company_info for demonstration\n  TAR.Type,\n  TAR.TotalAssets\nFROM \n  TotalAssetsReports TAR\n  JOIN company_info CI ON TAR.stock_code = CI.stock_code\nORDER BY \n  TAR.TotalAssets DESC\nLIMIT \n  5;\n"
            }
        ],
        "time": 47.152607679367065,
        "evaluate": 1,
        "input_token": 1961,
        "output_token": 726
    },
    {
        "id": "4bfbed15-327d-43f7-98d4-2ed6b6ac6cca",
        "question": "What were the total assets and total liabilities of Vinamilk and Masan Group at the end of 2023?",
        "answer": "Table 1\n| stock_code   | en_caption   |        data |\n|:-------------|:-------------|------------:|\n| VNM          | TOTAL ASSETS | 5.26734e+07 |\n| MSN          | TOTAL ASSETS | 1.47383e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    mcc.en_caption,\n    nfr.data\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MSN') \n    AND nfr.year = 2023 \n    AND nfr.quarter = 0\n    AND mcc.en_caption IN ('TOTAL ASSETS', 'TOTAL LIABILITIES');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | total_assets   | total_liabilities   |\n|:-------------|:---------------|:--------------------|\n| VNM          |                |                     |\n| MSN          |                |                     |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  'VNM' AS stock_code, \n  -- Assuming TOTAL_ASSETS_CODE and TOTAL_LIABILITIES_CODE are known\n  (SELECT data FROM non_bank_financial_report \n   WHERE stock_code = 'VNM' AND year = 2023 AND quarter = 0 AND category_code = 'TOTAL_ASSETS_CODE') AS Total_Assets,\n  (SELECT data FROM non_bank_financial_report \n   WHERE stock_code = 'VNM' AND year = 2023 AND quarter = 0 AND category_code = 'TOTAL_LIABILITIES_CODE') AS Total_Liabilities\nUNION ALL\nSELECT \n  'MSN' AS stock_code, \n  (SELECT data FROM non_bank_financial_report \n   WHERE stock_code = 'MSN' AND year = 2023 AND quarter = 0 AND category_code = 'TOTAL_ASSETS_CODE') AS Total_Assets,\n  (SELECT data FROM non_bank_financial_report \n   WHERE stock_code = 'MSN' AND year = 2023 AND quarter = 0 AND category_code = 'TOTAL_LIABILITIES_CODE') AS Total_Liabilities\nLIMIT 2;\n"
            }
        ],
        "time": 74.95145988464355,
        "evaluate": 0,
        "input_token": 1877,
        "output_token": 997
    },
    {
        "id": "9f7f3747-ac23-4eb1-8d0c-49469b2186e6",
        "question": "Analyze the changes in  Free Cash Flow to Firm (FCFF) for Vinamilk, Masan Group, and Hoa Phat Group from 2020 to Q2 2024.  Calculate the FCFF using the indirect method.",
        "answer": "Table 1\n|   year |   quarter | stock_code   | en_company_name                            |        fcff |\n|-------:|----------:|:-------------|:-------------------------------------------|------------:|\n|   2020 |         0 | HPG          | Hoa Phat Group Joint Stock Company         | 3.68935e+07 |\n|   2021 |         0 | HPG          | Hoa Phat Group Joint Stock Company         | 8.1097e+07  |\n|   2022 |         0 | HPG          | Hoa Phat Group Joint Stock Company         | 8.79324e+07 |\n|   2023 |         0 | HPG          | Hoa Phat Group Joint Stock Company         | 6.58285e+07 |\n|   2024 |         2 | HPG          | Hoa Phat Group Joint Stock Company         | 3.70183e+07 |\n|   2020 |         0 | MSN          | Masan Group Corporation                    | 1.98463e+07 |\n|   2021 |         0 | MSN          | Masan Group Corporation                    | 1.66562e+07 |\n|   2022 |         0 | MSN          | Masan Group Corporation                    | 1.2966e+07  |\n|   2023 |         0 | MSN          | Masan Group Corporation                    | 3.16468e+07 |\n|   2020 |         0 | VNM          | Vietnam Dairy Products Joint Stock Company | 2.4254e+07  |\n|   2021 |         0 | VNM          | Vietnam Dairy Products Joint Stock Company | 2.20982e+07 |\n|   2022 |         0 | VNM          | Vietnam Dairy Products Joint Stock Company | 2.19656e+07 |\n|   2023 |         0 | VNM          | Vietnam Dairy Products Joint Stock Company | 2.0475e+07  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.year, \n    fr.quarter, \n    ci.stock_code, \n    ci.en_company_name, \n    fr.data AS fcff\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    ci.stock_code IN ('VNM', 'MSN', 'HPG') \n    AND mccr.ratio_name = 'Free Cash Flow'\n    AND ((fr.year BETWEEN 2020 AND 2024 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter = 2))\nORDER BY \n    ci.stock_code, fr.year, fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name                      |   year |   quarter |   fcf_value |\n|:-------------|:----------------------------------|-------:|----------:|------------:|\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2020 |         0 | 3.68935e+07 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2021 |         0 | 8.1097e+07  |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2022 |         0 | 8.79324e+07 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2023 |         0 | 6.58285e+07 |\n| HPG          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n H\u00f2a Ph\u00e1t |   2024 |         2 | 3.70183e+07 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2020 |         0 | 1.98463e+07 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2021 |         0 | 1.66562e+07 |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2022 |         0 | 1.2966e+07  |\n| MSN          | C\u00f4ng ty C\u1ed5 ph\u1ea7n T\u1eadp \u0111o\u00e0n Masan    |   2023 |         0 | 3.16468e+07 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2020 |         0 | 2.4254e+07  |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2021 |         0 | 2.20982e+07 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2022 |         0 | 2.19656e+07 |\n| VNM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n S\u1eefa Vi\u1ec7t Nam      |   2023 |         0 | 2.0475e+07  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Assuming FCF is used as a proxy for FCFF due to query constraints\nFCF_Ratios AS (\n  SELECT \n    fr.stock_code,\n    ci.company_name,\n    fr.year,\n    fr.quarter,\n    fr.data AS FCF_Value\n  FROM \n    financial_ratio fr\n  JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\n  JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  WHERE \n    mcr.ratio_name = 'Free Cash Flow'  -- Using FCF as proxy for FCFF\n    AND fr.stock_code IN ('VNM', 'MSN', 'HPG')\n    AND ((fr.year BETWEEN 2020 AND 2023 AND fr.quarter = 0) OR (fr.year = 2024 AND fr.quarter = 2))\n)\n\n-- Selecting the results\nSELECT \n  stock_code,\n  company_name,\n  year,\n  quarter,\n  FCF_Value\nFROM \n  FCF_Ratios\nORDER BY \n  stock_code, year, quarter\nLIMIT 100;  -- Adding limit as per instructions\n"
            }
        ],
        "time": 76.14657044410706,
        "evaluate": 1,
        "input_token": 1825,
        "output_token": 765
    },
    {
        "id": "3092ddf1-2f29-4297-9476-c590de259f84",
        "question": "What is the trend of the Cash Flow from Operating Activities to Total Assets ratio for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   | year   | quarter   | cash_flow_to_total_assets_ratio   |\n|--------------|--------|-----------|-----------------------------------|\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    fr.year, \n    fr.quarter, \n    fr.data AS cash_flow_to_total_assets_ratio\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VCB', 'TCB', 'ACB')\n    AND mccr.ratio_name = 'Cash Flow from Operating Activities to Total Assets'\n    AND ((fr.year BETWEEN 2020 AND 2024) AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter <= 2)))\nORDER BY \n    fr.stock_code, \n    fr.year, \n    fr.quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name   | year   | quarter   | cashflowtototalassetsratio   |\n|--------------|-------------------|--------|-----------|------------------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    -- Selecting distinct to avoid duplicate company names if any\n    DISTINCT CI.stock_code,\n    CI.en_company_name,\n    BFR.year,\n    BFR.quarter,\n    \n    -- Calculating the ratio\n    (CFR.data / TAR.data) * 100 AS CashFlowToTotalAssetsRatio\n\nFROM \n    company_info CI\nINNER JOIN \n    bank_financial_report BFR ON CI.stock_code = BFR.stock_code\nINNER JOIN \n    bank_financial_report CFR ON BFR.stock_code = CFR.stock_code AND BFR.year = CFR.year AND BFR.quarter = CFR.quarter\nINNER JOIN \n    bank_financial_report TAR ON CFR.stock_code = TAR.stock_code AND CFR.year = TAR.year AND CFR.quarter = TAR.quarter\nINNER JOIN \n    map_category_code_bank MCCB_CF ON CFR.category_code = MCCB_CF.category_code\nINNER JOIN \n    map_category_code_bank MCCB_TA ON TAR.category_code = MCCB_TA.category_code\n\nWHERE \n    -- Filtering by company\n    CI.stock_code IN ('VCB', 'TCB', 'ACB')\n    -- Filtering by category codes for calculation\n    AND CFR.category_code = 'CF_009'\n    AND TAR.category_code = 'BS_300'\n    -- Time frame filter\n    AND BFR.year BETWEEN 2020 AND 2024\n    -- Since we're interested up to Q2 2024, this condition ensures we include Q2 but exclude any potential Q3 and Q4 for 2024\n    AND (BFR.year < 2024 OR (BFR.year = 2024 AND BFR.quarter <= 2))\n    -- Ensuring we're looking at annual reports for the years except for 2024 where we specifically want up to Q2\n    AND ((BFR.year < 2024 AND BFR.quarter = 0) OR (BFR.year = 2024 AND BFR.quarter = 2))\n\nORDER BY \n    CI.stock_code, BFR.year, BFR.quarter\n\nLIMIT 100;\n"
            }
        ],
        "time": 81.15559315681458,
        "evaluate": 0,
        "input_token": 4529,
        "output_token": 1730
    },
    {
        "id": "d4bb52e6-2407-4f6d-9f90-60c654e8c0b2",
        "question": "What is the trend of the Return on Equity (ROE) for Vietcombank, Techcombank, and ACB from 2020 to Q2 2024?",
        "answer": "Table 1\n| stock_code   |   year |   quarter |       roe |\n|:-------------|-------:|----------:|----------:|\n| ACB          |   2020 |         0 | 0.216734  |\n| ACB          |   2021 |         0 | 0.213865  |\n| ACB          |   2022 |         0 | 0.234232  |\n| ACB          |   2023 |         0 | 0.226122  |\n| TCB          |   2020 |         0 | 0.168632  |\n| TCB          |   2021 |         0 | 0.197927  |\n| TCB          |   2022 |         0 | 0.180176  |\n| TCB          |   2023 |         0 | 0.139608  |\n| TCB          |   2024 |         2 | 0.0457096 |\n| VCB          |   2020 |         0 | 0.196318  |\n| VCB          |   2021 |         0 | 0.201059  |\n| VCB          |   2022 |         0 | 0.220567  |\n| VCB          |   2023 |         0 | 0.200315  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    quarter, \n    data AS ROE\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'ROE' AND\n    stock_code IN ('VCB', 'TCB', 'ACB') AND\n    ((year BETWEEN 2020 AND 2023 AND quarter = 0) OR\n     (year = 2024 AND quarter = 2))\nORDER BY \n    stock_code, year, quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry   |   year |   quarter |   roe_value |\n|:-------------|:-----------|-------:|----------:|------------:|\n| ACB          | Banking    |   2020 |         0 |   0.216734  |\n| ACB          | Banking    |   2021 |         0 |   0.213865  |\n| ACB          | Banking    |   2022 |         0 |   0.234232  |\n| ACB          | Banking    |   2023 |         0 |   0.226122  |\n| TCB          | Banking    |   2020 |         0 |   0.168632  |\n| TCB          | Banking    |   2021 |         0 |   0.197927  |\n| TCB          | Banking    |   2022 |         0 |   0.180176  |\n| TCB          | Banking    |   2023 |         0 |   0.139608  |\n| TCB          | Banking    |   2024 |         2 |   0.0457096 |\n| VCB          | Banking    |   2020 |         0 |   0.196318  |\n| VCB          | Banking    |   2021 |         0 |   0.201059  |\n| VCB          | Banking    |   2022 |         0 |   0.220567  |\n| VCB          | Banking    |   2023 |         0 |   0.200315  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  ci.industry, -- Optional, to show industry for context\n  fr.year,\n  fr.quarter,\n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.stock_code IN ('VCB', 'TCB', 'ACB')\n  AND mcr.ratio_name = 'Return On Equity'\n  AND fr.year BETWEEN 2020 AND 2024\n  AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2)) -- Includes annual data and Q2 2024 specifically\nORDER BY \n  fr.stock_code, fr.year, fr.quarter\nLIMIT 100; -- Adjust the limit as necessary\n"
            }
        ],
        "time": 67.56078743934631,
        "evaluate": 0.5,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "916ca955-e277-4c29-8413-c4f9f46fdead",
        "question": "Compare the change in the Free Cash Flow (FCF) to Revenue ratio for Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.  Calculate FCF as Operating Cash Flow - Capital Expenditures.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |   free_cash_flow |          revenue |   fcf_to_revenue_ratio |\n|:-------------|-------:|----------:|-----------------:|-----------------:|-----------------------:|\n| MSN          |   2020 |         0 |      5.02946e+06 |      1.19577e+06 |              4.20603   |\n| MSN          |   2020 |         2 |      1.39238e+06 | 324589           |              4.28967   |\n| MSN          |   2021 |         0 |      3.94934e+06 |      1.12732e+07 |              0.350331  |\n| MSN          |   2021 |         2 |      2.85035e+06 |      1.14379e+06 |              2.49202   |\n| MSN          |   2022 |         0 | 376469           |      5.22274e+06 |              0.0720826 |\n| MSN          |   2022 |         2 |      1.58818e+06 |      1.26951e+06 |              1.25102   |\n| MSN          |   2023 |         0 |      2.72926e+06 |      2.35043e+06 |              1.16117   |\n| MSN          |   2023 |         2 |      1.95534e+06 | 466572           |              4.19085   |\n| SAB          |   2020 |         0 |      4.49605e+06 |      6.07641e+06 |              0.739919  |\n| SAB          |   2020 |         2 |      1.73514e+06 |      1.4662e+06  |              1.18343   |\n| SAB          |   2021 |         0 |      3.84739e+06 |      4.78023e+06 |              0.804855  |\n| SAB          |   2021 |         2 |      1.70659e+06 |      1.3032e+06  |              1.30954   |\n| SAB          |   2022 |         0 |      4.91168e+06 |      6.82966e+06 |              0.719169  |\n| SAB          |   2022 |         2 |      2.38322e+06 |      2.20974e+06 |              1.0785    |\n| SAB          |   2023 |         0 |      2.2238e+06  |      5.40263e+06 |              0.411614  |\n| SAB          |   2023 |         2 |      1.11413e+06 |      1.53609e+06 |              0.725305  |\n| SAB          |   2024 |         2 |      2.30155e+06 |      1.64767e+06 |              1.39685   |\n| VNM          |   2020 |         0 |      1.1445e+07  |      1.35394e+07 |              0.845311  |\n| VNM          |   2020 |         2 |      5.48195e+06 |      3.72152e+06 |              1.47304   |\n| VNM          |   2021 |         0 |      1.0963e+07  |      1.27276e+07 |              0.861355  |\n| VNM          |   2021 |         2 |      4.48222e+06 |      3.51026e+06 |              1.27689   |\n| VNM          |   2022 |         0 |      1.02842e+07 |      1.04911e+07 |              0.980281  |\n| VNM          |   2022 |         2 |      3.59228e+06 |      2.60094e+06 |              1.38115   |\n| VNM          |   2023 |         0 |      9.46706e+06 |      1.09036e+07 |              0.868248  |\n| VNM          |   2023 |         2 |      4.32854e+06 |      5.09154e+06 |              0.850145  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH fcf_calculation AS (\n    SELECT \n        stock_code,\n        year,\n        quarter,\n        SUM(CASE WHEN category_code = 'CF_020' THEN data ELSE 0 END) AS operating_cash_flow,\n        SUM(CASE WHEN category_code = 'CF_021' THEN data ELSE 0 END) AS capital_expenditures,\n        SUM(CASE WHEN category_code = 'IS_030' THEN data ELSE 0 END) AS revenue\n    FROM \n        non_bank_financial_report\n    WHERE \n        stock_code IN ('VNM', 'MSN', 'SAB') AND\n        ((year BETWEEN 2020 AND 2024) AND (quarter = 0 OR quarter = 2))\n    GROUP BY \n        stock_code, year, quarter\n)\nSELECT \n    stock_code,\n    year,\n    quarter,\n    (operating_cash_flow - capital_expenditures) AS free_cash_flow,\n    revenue,\n    CASE \n        WHEN revenue != 0 THEN (operating_cash_flow - capital_expenditures) / revenue\n        ELSE NULL\n    END AS fcf_to_revenue_ratio\nFROM \n    fcf_calculation\nORDER BY \n    stock_code, year, quarter;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | period_type   |         fcf |     revenue |   fcf_to_revenue_ratio |\n|:-------------|:--------------|------------:|------------:|-----------------------:|\n| MSN          | Annual_2020   | 3.6665e+06  | 7.88683e+07 |              0.0464889 |\n| SAB          | Annual_2020   | 5.51837e+06 | 2.81356e+07 |              0.196135  |\n| SAB          | Q2_2024       | 2.66268e+06 | 8.1351e+06  |              0.327308  |\n| VNM          | Annual_2020   | 1.07015e+07 | 5.97229e+07 |              0.179186  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n  -- Calculate FCF for each company in 2020 (Annual) and Q2 2024\n  FCF_Calculations AS (\n    SELECT \n      'Annual_2020' AS Period_Type,\n      T1.stock_code,\n      (T2.data - T3.data) AS FCF,  -- Assuming CF_001 for Operating Cash Flow, CF_002 for Capital Expenditures\n      T4.data AS Revenue\n    FROM \n      company_info T1\n      JOIN non_bank_financial_report T2 ON T1.stock_code = T2.stock_code AND T2.category_code = 'CF_001' AND T2.year = 2020 AND T2.quarter = 0\n      JOIN non_bank_financial_report T3 ON T1.stock_code = T3.stock_code AND T3.category_code = 'CF_002' AND T3.year = 2020 AND T3.quarter = 0\n      JOIN non_bank_financial_report T4 ON T1.stock_code = T4.stock_code AND T4.category_code = 'IS_001' AND T4.year = 2020 AND T4.quarter = 0\n    WHERE \n      T1.stock_code IN ('VNM', 'MSN', 'SAB')\n    \n    UNION ALL\n    \n    SELECT \n      'Q2_2024' AS Period_Type,\n      T1.stock_code,\n      (T2.data - T3.data) AS FCF,\n      T4.data AS Revenue\n    FROM \n      company_info T1\n      JOIN non_bank_financial_report T2 ON T1.stock_code = T2.stock_code AND T2.category_code = 'CF_001' AND T2.year = 2024 AND T2.quarter = 2\n      JOIN non_bank_financial_report T3 ON T1.stock_code = T3.stock_code AND T3.category_code = 'CF_002' AND T3.year = 2024 AND T3.quarter = 2\n      JOIN non_bank_financial_report T4 ON T1.stock_code = T4.stock_code AND T4.category_code = 'IS_001' AND T4.year = 2024 AND T4.quarter = 2\n    WHERE \n      T1.stock_code IN ('VNM', 'MSN', 'SAB')\n  )\n\n-- Calculate and Display the FCF to Revenue Ratio\nSELECT \n  stock_code,\n  Period_Type,\n  FCF,\n  Revenue,\n  (FCF / Revenue) AS FCF_to_Revenue_Ratio\nFROM \n  FCF_Calculations\nORDER BY \n  stock_code, Period_Type\nLIMIT 6;  -- To ensure we get all results for the 3 companies across 2 periods\n"
            }
        ],
        "time": 46.23850226402283,
        "evaluate": 0,
        "input_token": 2070,
        "output_token": 1055
    },
    {
        "id": "210545b9-e52c-408a-9b0a-96e26978bc0d",
        "question": "What are the top 5 companies with the highest operating cash flow in 2022?",
        "answer": "Table 1\n| stock_code   | industry                             |   operating_cash_flow |\n|:-------------|:-------------------------------------|----------------------:|\n| VHM          | Real Estate                          |           3.10035e+07 |\n| VGI          | Telecommunications                   |           1.36636e+07 |\n| GAS          | Utilities (Electricity, Water & Gas) |           1.27921e+07 |\n| HPG          | Basic Resources                      |           1.22776e+07 |\n| VNM          | Food and Beverages                   |           8.82727e+06 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "(\n    SELECT c.stock_code, c.industry, nfr.data AS operating_cash_flow\n    FROM non_bank_financial_report nfr\n    JOIN company_info c ON nfr.stock_code = c.stock_code\n    WHERE nfr.year = 2022 AND nfr.quarter = 0 AND nfr.category_code = 'CF_020'\n)\nUNION ALL\n(\n    SELECT c.stock_code, c.industry, bfr.data AS operating_cash_flow\n    FROM bank_financial_report bfr\n    JOIN company_info c ON bfr.stock_code = c.stock_code\n    WHERE bfr.year = 2022 AND bfr.quarter = 0 AND bfr.category_code = 'CF_009'\n)\nUNION ALL\n(\n    SELECT c.stock_code, c.industry, sfr.data AS operating_cash_flow\n    FROM securities_financial_report sfr\n    JOIN company_info c ON sfr.stock_code = c.stock_code\n    WHERE sfr.year = 2022 AND sfr.quarter = 0 AND sfr.category_code = 'CF_060'\n)\nORDER BY operating_cash_flow DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Error in getting the answer",
        "code_response": "Error in getting the code",
        "evaluate": 0,
        "input_token": 321,
        "output_token": 234
    },
    {
        "id": "65582c45-ca21-4b65-b92a-990a565809d4",
        "question": "Rank the top 10 companies by their total cash and cash equivalents at the end of Q2 2024.",
        "answer": "Table 1\n| stock_code   | industry           | is_bank   | is_securities   |   cash_and_cash_equivalents |\n|:-------------|:-------------------|:----------|:----------------|----------------------------:|\n| BID          | Banking            | True      | False           |                 2.78228e+08 |\n| TCB          | Banking            | True      | False           |                 1.24892e+08 |\n| VPB          | Banking            | True      | False           |                 1.02267e+08 |\n| SHB          | Banking            | True      | False           |                 8.93781e+07 |\n| ABB          | Banking            | True      | False           |                 4.01649e+07 |\n| VIC          | Real Estate        | False     | False           |                 2.85439e+07 |\n| VHM          | Real Estate        | False     | False           |                 1.71802e+07 |\n| PLX          | Oil and Gas        | False     | False           |                 1.55622e+07 |\n| HPG          | Basic Resources    | False     | False           |                 1.3032e+07  |\n| VGI          | Telecommunications | False     | False           |                 1.11629e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT ci.stock_code, ci.industry, ci.is_bank, ci.is_securities, fr.data AS cash_and_cash_equivalents\nFROM (\n    SELECT stock_code, data\n    FROM bank_financial_report\n    WHERE year = 2024 AND quarter = 2 AND category_code = 'CF_045'\n    \n    UNION ALL\n    \n    SELECT stock_code, data\n    FROM non_bank_financial_report\n    WHERE year = 2024 AND quarter = 2 AND category_code = 'CF_070'\n    \n    UNION ALL\n    \n    SELECT stock_code, data\n    FROM securities_financial_report\n    WHERE year = 2024 AND quarter = 2 AND category_code = 'CF_103'\n) AS fr\nJOIN company_info ci ON fr.stock_code = ci.stock_code\nORDER BY fr.data DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Error in getting the answer",
        "code_response": "Error in getting the code",
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "4ac358e0-c6f7-4645-8e8e-fb12eba2bcab",
        "question": "Calculate the return on equity (ROE) for Vinamilk and Masan Group for the fiscal year 2022, and also provide their total equity for the same year.",
        "answer": "Table 1\n| stock_code   |      roe |   total_equity |\n|:-------------|---------:|---------------:|\n| VNM          | 0.26138  |    3.28165e+07 |\n| MSN          | 0.129771 |    3.66367e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Query to get ROE for Vinamilk and Masan Group for the fiscal year 2022\nSELECT \n    fr.stock_code,\n    fr.data AS roe,\n    nbfr.data AS total_equity\nFROM \n    financial_ratio fr\nJOIN \n    non_bank_financial_report nbfr ON fr.stock_code = nbfr.stock_code AND fr.year = nbfr.year\nWHERE \n    fr.ratio_code = 'ROE'\n    AND fr.year = 2022\n    AND fr.quarter = 0\n    AND nbfr.category_code = 'BS_410'\n    AND nbfr.quarter = 0\n    AND fr.stock_code IN ('VNM', 'MSN');\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   year |   quarter |   roe_value |\n|:-------------|-------:|----------:|------------:|\n| MSN          |   2022 |         0 |    0.129771 |\n| VNM          |   2022 |         0 |    0.26138  |\n\nTable 2\n| stock_code   | year   | quarter   | total_equity   |\n|--------------|--------|-----------|----------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  fr.year,\n  fr.quarter,\n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Return On Equity'\n  AND fr.stock_code IN ('VNM', 'MSN')\n  AND fr.year = 2022\n  AND fr.quarter = 0  -- Annual report\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  nfr.stock_code,\n  nfr.year,\n  nfr.quarter,\n  nfr.data AS Total_Equity\nFROM \n  non_bank_financial_report nfr\n  INNER JOIN map_category_code_non_bank mcnb ON nfr.category_code = mcnb.category_code\nWHERE \n  mcnb.en_caption = 'Total Equity'  -- Assuming this is the caption for Total Equity\n  AND nfr.stock_code IN ('VNM', 'MSN')\n  AND nfr.year = 2022\n  AND nfr.quarter = 0  -- Annual report\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  'ROE' AS Metric,\n  ROE.stock_code,\n  ROE.year,\n  ROE.ROE_Value\nFROM (\n  -- ROE Query Here\n) AS ROE\n\nUNION ALL\n\nSELECT \n  'Total Equity' AS Metric,\n  TE.stock_code,\n  TE.year,\n  TE.Total_Equity\nFROM (\n  -- Total Equity Query Here\n) AS TE\nLIMIT 100;\n"
            }
        ],
        "time": 62.82883167266846,
        "evaluate": 0,
        "input_token": 1771,
        "output_token": 804
    },
    {
        "id": "01c004d0-974e-44a8-b591-7d38da1708a0",
        "question": "Compare the current ratio and quick ratio of Vinamilk, Masan Group, and SABECO from 2020 to Q2 2024.  Analyze the changes in their cash and short-term investments during this period.",
        "answer": "Table 1\n| stock_code   |   year |   quarter | ratio_name    |   ratio_value |\n|:-------------|-------:|----------:|:--------------|--------------:|\n| MSN          |   2020 |         0 | Current Ratio |      0.773354 |\n| MSN          |   2020 |         0 | Quick Ratio   |      0.451862 |\n| MSN          |   2022 |         0 | Current Ratio |      0.73558  |\n| MSN          |   2022 |         0 | Quick Ratio   |      0.514436 |\n| SAB          |   2020 |         0 | Current Ratio |      3.79993  |\n| SAB          |   2020 |         0 | Quick Ratio   |      3.52024  |\n| SAB          |   2021 |         0 | Current Ratio |      3.16422  |\n| SAB          |   2021 |         0 | Quick Ratio   |      2.93441  |\n| SAB          |   2023 |         0 | Current Ratio |      3.24947  |\n| SAB          |   2023 |         0 | Quick Ratio   |      2.9677   |\n| VNM          |   2020 |         0 | Current Ratio |      2.09132  |\n| VNM          |   2020 |         0 | Quick Ratio   |      1.7462   |\n| VNM          |   2022 |         0 | Current Ratio |      2.06801  |\n| VNM          |   2022 |         0 | Quick Ratio   |      1.70628  |\n| VNM          |   2024 |         1 | Current Ratio |      2.30115  |\n| VNM          |   2024 |         1 | Quick Ratio   |      1.85779  |\n| MSN          |   2021 |         0 | Current Ratio |      1.27032  |\n| MSN          |   2021 |         0 | Quick Ratio   |      0.899436 |\n| MSN          |   2023 |         0 | Current Ratio |      0.874439 |\n| MSN          |   2023 |         0 | Quick Ratio   |      0.61315  |\n| MSN          |   2024 |         1 | Current Ratio |      0.87025  |\n| MSN          |   2024 |         1 | Quick Ratio   |      0.611971 |\n| SAB          |   2022 |         0 | Current Ratio |      2.93495  |\n| SAB          |   2022 |         0 | Quick Ratio   |      2.69688  |\n| SAB          |   2024 |         1 | Current Ratio |      4.68054  |\n| SAB          |   2024 |         1 | Quick Ratio   |      4.27023  |\n| SAB          |   2024 |         2 | Current Ratio |      3.18639  |\n| SAB          |   2024 |         2 | Quick Ratio   |      2.9152   |\n| VNM          |   2021 |         0 | Current Ratio |      2.11895  |\n| VNM          |   2021 |         0 | Quick Ratio   |      1.72213  |\n| VNM          |   2023 |         0 | Current Ratio |      2.1016   |\n| VNM          |   2023 |         0 | Quick Ratio   |      1.74405  |\n\nTable 2\n| stock_code   |   year |   quarter | en_caption                           |   financial_data |\n|:-------------|-------:|----------:|:-------------------------------------|-----------------:|\n| MSN          |   2020 |         0 | I. Cash and cash equivalents         |      7.72144e+06 |\n| MSN          |   2021 |         0 | I. Cash and cash equivalents         |      2.23048e+07 |\n| MSN          |   2022 |         0 | I. Cash and cash equivalents         |      1.38531e+07 |\n| MSN          |   2023 |         0 | I. Cash and cash equivalents         |      1.01245e+07 |\n| MSN          |   2020 |         0 | II. Short-term financial investments | 447250           |\n| MSN          |   2021 |         0 | II. Short-term financial investments | 332753           |\n| MSN          |   2022 |         0 | II. Short-term financial investments |      3.65918e+06 |\n| MSN          |   2023 |         0 | II. Short-term financial investments |      6.79479e+06 |\n| VNM          |   2024 |         1 | I. Cash and cash equivalents         |      1.78825e+06 |\n| MSN          |   2024 |         1 | I. Cash and cash equivalents         |      8.49273e+06 |\n| MSN          |   2024 |         1 | II. Short-term financial investments |      5.32918e+06 |\n| VNM          |   2020 |         0 | I. Cash and cash equivalents         |      2.11124e+06 |\n| VNM          |   2021 |         0 | I. Cash and cash equivalents         |      2.34855e+06 |\n| VNM          |   2022 |         0 | I. Cash and cash equivalents         |      2.29994e+06 |\n| VNM          |   2023 |         0 | I. Cash and cash equivalents         |      2.91203e+06 |\n| VNM          |   2020 |         0 | II. Short-term financial investments |      1.73137e+07 |\n| VNM          |   2021 |         0 | II. Short-term financial investments |      2.10257e+07 |\n| VNM          |   2022 |         0 | II. Short-term financial investments |      1.74141e+07 |\n| VNM          |   2023 |         0 | II. Short-term financial investments |      2.01372e+07 |\n| SAB          |   2020 |         0 | I. Cash and cash equivalents         |      2.72614e+06 |\n| SAB          |   2021 |         0 | I. Cash and cash equivalents         |      3.60645e+06 |\n| SAB          |   2022 |         0 | I. Cash and cash equivalents         |      4.06946e+06 |\n| SAB          |   2023 |         0 | I. Cash and cash equivalents         |      5.03991e+06 |\n| SAB          |   2020 |         0 | II. Short-term financial investments |      1.45474e+07 |\n| SAB          |   2021 |         0 | II. Short-term financial investments |      1.69912e+07 |\n| SAB          |   2022 |         0 | II. Short-term financial investments |      1.94115e+07 |\n| SAB          |   2023 |         0 | II. Short-term financial investments |      1.77411e+07 |\n| VNM          |   2024 |         1 | II. Short-term financial investments |      2.02681e+07 |\n| SAB          |   2024 |         1 | I. Cash and cash equivalents         |      3.2131e+06  |\n| SAB          |   2024 |         2 | I. Cash and cash equivalents         |      6.0341e+06  |\n| SAB          |   2024 |         1 | II. Short-term financial investments |      1.82025e+07 |\n| SAB          |   2024 |         2 | II. Short-term financial investments |      1.73244e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve Current Ratio and Quick Ratio\nSELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mccr.ratio_name,\n    fr.data AS ratio_value\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    fr.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND mccr.ratio_name IN ('Current Ratio', 'Quick Ratio')\n    AND ((fr.year = 2020 AND fr.quarter = 0) OR \n         (fr.year = 2021 AND fr.quarter = 0) OR \n         (fr.year = 2022 AND fr.quarter = 0) OR \n         (fr.year = 2023 AND fr.quarter = 0) OR \n         (fr.year = 2024 AND fr.quarter IN (1, 2)));\n\n-- Step 2: Analyze changes in cash and short-term investments\nSELECT \n    nbf.stock_code,\n    nbf.year,\n    nbf.quarter,\n    mccnb.en_caption,\n    nbf.data AS financial_data\nFROM \n    non_bank_financial_report nbf\nJOIN \n    map_category_code_non_bank mccnb ON nbf.category_code = mccnb.category_code\nWHERE \n    nbf.stock_code IN ('VNM', 'MSN', 'SAB')\n    AND mccnb.en_caption IN ('I. Cash and cash equivalents', 'II. Short-term financial investments')\n    AND ((nbf.year = 2020 AND nbf.quarter = 0) OR \n         (nbf.year = 2021 AND nbf.quarter = 0) OR \n         (nbf.year = 2022 AND nbf.quarter = 0) OR \n         (nbf.year = 2023 AND nbf.quarter = 0) OR \n         (nbf.year = 2024 AND nbf.quarter IN (1, 2)));\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| type       | stock_code   |   year |   quarter | ratio_name    |             data |\n|:-----------|:-------------|-------:|----------:|:--------------|-----------------:|\n| Financials | MSN          |   2020 |         0 | Cash          |      1.93014e+06 |\n| Ratios     | MSN          |   2020 |         0 | Current Ratio |      0.773354    |\n| Ratios     | MSN          |   2020 |         0 | Quick Ratio   |      0.451862    |\n| Financials | MSN          |   2020 |         2 | Cash          |      2.18825e+06 |\n| Ratios     | MSN          |   2020 |         2 | Quick Ratio   |      0.356423    |\n| Ratios     | MSN          |   2020 |         2 | Current Ratio |      0.671478    |\n| Financials | MSN          |   2021 |         0 | Cash          |      6.88541e+06 |\n| Ratios     | MSN          |   2021 |         0 | Quick Ratio   |      0.899436    |\n| Ratios     | MSN          |   2021 |         0 | Current Ratio |      1.27032     |\n| Financials | MSN          |   2021 |         2 | Cash          |      1.43053e+06 |\n| Ratios     | MSN          |   2021 |         2 | Current Ratio |      0.913651    |\n| Ratios     | MSN          |   2021 |         2 | Quick Ratio   |      0.572475    |\n| Financials | MSN          |   2022 |         0 | Cash          |      1.71848e+06 |\n| Ratios     | MSN          |   2022 |         0 | Quick Ratio   |      0.514436    |\n| Ratios     | MSN          |   2022 |         0 | Current Ratio |      0.73558     |\n| Financials | MSN          |   2022 |         2 | Cash          |      2.86942e+06 |\n| Ratios     | MSN          |   2022 |         2 | Quick Ratio   |      0.44704     |\n| Ratios     | MSN          |   2022 |         2 | Current Ratio |      0.709978    |\n| Financials | MSN          |   2023 |         0 | Cash          |      3.29055e+06 |\n| Ratios     | MSN          |   2023 |         0 | Current Ratio |      0.874439    |\n| Ratios     | MSN          |   2023 |         0 | Quick Ratio   |      0.61315     |\n| Financials | MSN          |   2023 |         2 | Cash          |      2.43494e+06 |\n| Ratios     | MSN          |   2023 |         2 | Current Ratio |      0.804937    |\n| Ratios     | MSN          |   2023 |         2 | Quick Ratio   |      0.563175    |\n| Financials | SAB          |   2020 |         0 | Cash          | 844203           |\n| Ratios     | SAB          |   2020 |         0 | Quick Ratio   |      3.52024     |\n| Ratios     | SAB          |   2020 |         0 | Current Ratio |      3.79993     |\n| Financials | SAB          |   2020 |         2 | Cash          |      1.52176e+06 |\n| Ratios     | SAB          |   2020 |         2 | Current Ratio |      3.32298     |\n| Ratios     | SAB          |   2020 |         2 | Quick Ratio   |      3.0425      |\n| Financials | SAB          |   2021 |         0 | Cash          | 685368           |\n| Ratios     | SAB          |   2021 |         0 | Quick Ratio   |      2.93441     |\n| Ratios     | SAB          |   2021 |         0 | Current Ratio |      3.16422     |\n| Financials | SAB          |   2021 |         2 | Cash          |      1.00481e+06 |\n| Ratios     | SAB          |   2021 |         2 | Current Ratio |      3.85619     |\n| Ratios     | SAB          |   2021 |         2 | Quick Ratio   |      3.55591     |\n| Financials | SAB          |   2022 |         0 | Cash          | 985364           |\n| Ratios     | SAB          |   2022 |         0 | Current Ratio |      2.93495     |\n| Ratios     | SAB          |   2022 |         0 | Quick Ratio   |      2.69688     |\n| Financials | SAB          |   2022 |         2 | Cash          |      1.19007e+06 |\n| Ratios     | SAB          |   2022 |         2 | Current Ratio |      3.83923     |\n| Ratios     | SAB          |   2022 |         2 | Quick Ratio   |      3.53308     |\n| Financials | SAB          |   2023 |         0 | Cash          |      1.42305e+06 |\n| Ratios     | SAB          |   2023 |         0 | Current Ratio |      3.24947     |\n| Ratios     | SAB          |   2023 |         0 | Quick Ratio   |      2.9677      |\n| Financials | SAB          |   2023 |         2 | Cash          | 968132           |\n| Ratios     | SAB          |   2023 |         2 | Current Ratio |      3.45002     |\n| Ratios     | SAB          |   2023 |         2 | Quick Ratio   |      3.13189     |\n| Financials | SAB          |   2024 |         2 | Cash          |      1.81484e+06 |\n| Ratios     | SAB          |   2024 |         2 | Current Ratio |      3.18639     |\n| Ratios     | SAB          |   2024 |         2 | Quick Ratio   |      2.9152      |\n| Financials | VNM          |   2020 |         0 | Cash          | 863853           |\n| Ratios     | VNM          |   2020 |         0 | Quick Ratio   |      1.7462      |\n| Ratios     | VNM          |   2020 |         0 | Current Ratio |      2.09132     |\n| Financials | VNM          |   2020 |         2 | Cash          |      2.04467e+06 |\n| Ratios     | VNM          |   2020 |         2 | Current Ratio |      1.80774     |\n| Ratios     | VNM          |   2020 |         2 | Quick Ratio   |      1.46628     |\n| Financials | VNM          |   2021 |         0 | Cash          |      1.18735e+06 |\n| Ratios     | VNM          |   2021 |         0 | Current Ratio |      2.11895     |\n| Ratios     | VNM          |   2021 |         0 | Quick Ratio   |      1.72213     |\n| Financials | VNM          |   2021 |         2 | Cash          |      1.26148e+06 |\n| Ratios     | VNM          |   2021 |         2 | Quick Ratio   |      1.56154     |\n| Ratios     | VNM          |   2021 |         2 | Current Ratio |      1.93904     |\n| Financials | VNM          |   2022 |         0 | Cash          |      1.32743e+06 |\n| Ratios     | VNM          |   2022 |         0 | Quick Ratio   |      1.70628     |\n| Ratios     | VNM          |   2022 |         0 | Current Ratio |      2.06801     |\n| Financials | VNM          |   2022 |         2 | Cash          |      1.20042e+06 |\n| Ratios     | VNM          |   2022 |         2 | Quick Ratio   |      1.79426     |\n| Ratios     | VNM          |   2022 |         2 | Current Ratio |      2.22061     |\n| Financials | VNM          |   2023 |         0 | Cash          |      1.02549e+06 |\n| Ratios     | VNM          |   2023 |         0 | Quick Ratio   |      1.74405     |\n| Ratios     | VNM          |   2023 |         0 | Current Ratio |      2.1016      |\n| Financials | VNM          |   2023 |         2 | Cash          | 791780           |\n| Ratios     | VNM          |   2023 |         2 | Current Ratio |      2.43804     |\n| Ratios     | VNM          |   2023 |         2 | Quick Ratio   |      1.97817     |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Part 1: Current and Quick Ratios for VNM, MSN, SAB from 2020 to Q2 2024\nRatios as (\n  SELECT \n    fr.stock_code,\n    fr.year,\n    fr.quarter,\n    mcr.ratio_name,\n    fr.data\n  FROM \n    financial_ratio fr\n  JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\n  WHERE \n    fr.year BETWEEN 2020 AND 2024\n    AND fr.quarter IN (0, 2)  -- Annual (0) and Q2 (2)\n    AND mcr.ratio_name IN ('Current Ratio', 'Quick Ratio')\n    AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\n),\n\n-- Part 2: Cash and Short-term Investments for VNM, MSN, SAB\n-- **ASSUMPTION**: Using BS_110 for Cash and BS_120 for Short-term Investments. **VERIFY THESE CODES**.\nFinancials as (\n  SELECT \n    nbr.stock_code,\n    nbr.year,\n    nbr.quarter,\n    mcnb.en_caption,\n    nbr.data\n  FROM \n    non_bank_financial_report nbr\n  JOIN \n    map_category_code_non_bank mcnb ON nbr.category_code = mcnb.category_code\n  JOIN \n    company_info ci ON nbr.stock_code = ci.stock_code\n  WHERE \n    nbr.year BETWEEN 2020 AND 2024\n    AND nbr.quarter IN (0, 2)  -- Annual (0) and Q2 (2)\n    AND mcnb.en_caption IN ('Cash', 'Short-term Investments')  -- **VERIFY THESE EN_CAPTIONS**\n    AND ci.stock_code IN ('VNM', 'MSN', 'SAB')\n)\n\n-- Combining the Results\nSELECT * FROM (\n  SELECT 'Ratios' as Type, * FROM Ratios\n  UNION ALL\n  SELECT 'Financials' as Type, * FROM Financials\n) AS Combined\nORDER BY stock_code, year, quarter, Type\nLIMIT 100;  -- **Adjust the LIMIT as necessary**\n"
            }
        ],
        "time": 46.63641142845154,
        "evaluate": 0,
        "input_token": 2038,
        "output_token": 1183
    },
    {
        "id": "fea4088b-643e-4e03-9bed-1879ba8538f0",
        "question": "What was the Free Cash Flow to Firm (FCFF) for Vietcombank, Techcombank, and ACB in 2022?",
        "answer": "Table 1\n| stock_code   |   year |        fcff |\n|:-------------|-------:|------------:|\n| ACB          |   2022 | 2.17861e+07 |\n| TCB          |   2022 | 5.66533e+07 |\n| VCB          |   2022 | 1.87481e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT stock_code, year, data AS FCFF\nFROM financial_ratio\nWHERE ratio_code = 'FCF'\n  AND stock_code IN ('VCB', 'TCB', 'ACB')\n  AND year = 2022\n  AND quarter = 0;\n"
            }
        ],
        "score": 1,
        "difficulty": 1,
        "response": "Table 1\n| stock_code   | industry   |   year | ratio_name     |   fcf_value |\n|:-------------|:-----------|-------:|:---------------|------------:|\n| ACB          | Banking    |   2022 | Free Cash Flow | 2.17861e+07 |\n| TCB          | Banking    |   2022 | Free Cash Flow | 5.66533e+07 |\n| VCB          | Banking    |   2022 | Free Cash Flow | 1.87481e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    ci.stock_code, \n    ci.industry, \n    fr.year, \n    mcr.ratio_name, \n    fr.data AS FCF_Value\nFROM \n    company_info ci\nINNER JOIN \n    financial_ratio fr ON ci.stock_code = fr.stock_code\nINNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    ci.stock_code IN ('VCB', 'TCB', 'ACB') \n    AND fr.year = 2022 \n    AND fr.quarter = 0  -- For annual reports\n    AND mcr.ratio_name = 'Free Cash Flow'  -- Assuming FCF is the closest to FCFF\nLIMIT 100;\n"
            }
        ],
        "time": 89.12770962715149,
        "evaluate": 0.5,
        "input_token": 2183,
        "output_token": 620
    },
    {
        "id": "aec88c44-7b88-47ca-a04a-e599e1ddaeda",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) from 2020 to Q2 2024, calculated annually.",
        "answer": "Table 1\n| stock_code   | industry                   |   year |        roe |\n|:-------------|:---------------------------|-------:|-----------:|\n| VC3          | Real Estate                |   2022 | nan        |\n| DGC          | Chemicals                  |   2022 |   0.557243 |\n| CAP          | Basic Resources            |   2022 |   0.546075 |\n| L14          | Construction and Materials |   2021 |   0.493854 |\n| CAP          | Basic Resources            |   2021 |   0.479184 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    ci.industry, \n    fr.year, \n    fr.data AS roe\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    mccr.ratio_name = 'Return On Equity'\n    AND fr.year BETWEEN 2020 AND 2024\n    AND fr.quarter = 0\nORDER BY \n    fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | en_company_name                                                         |   year |   roe_value |\n|:-------------|:------------------------------------------------------------------------|-------:|------------:|\n| VC3          | Nam MeKong Group Joint Stock Company                                    |   2022 |  nan        |\n| DGC          | Ducgiang Chemicals Group Joint Stock Company                            |   2022 |    0.557243 |\n| CAP          | Yen Bai Joint Stock Forest Agricultural Products And Foodstuffs Company |   2022 |    0.546075 |\n| L14          | Licogi 14 Joint Stock Company                                           |   2021 |    0.493854 |\n| CAP          | Yen Bai Joint Stock Forest Agricultural Products And Foodstuffs Company |   2021 |    0.479184 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    ci.en_company_name,  -- Assuming en_company_name exists in company_info for clarity\n    fr.year, \n    fr.data AS ROE_Value\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'ROE' \n    AND fr.quarter = 0  -- For annual data\n    AND fr.year BETWEEN 2020 AND 2024\nORDER BY \n    fr.data DESC  -- Sort by ROE value in descending order\nLIMIT \n    5;  -- Get the top 5 companies\n"
            }
        ],
        "time": 25.03196406364441,
        "evaluate": 1,
        "input_token": 2696,
        "output_token": 685
    },
    {
        "id": "b402ce7e-32ae-4413-bf24-57e2a907327e",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) for Q2 2024.",
        "answer": "Table 1\n| stock_code   | industry                      |       roe |\n|:-------------|:------------------------------|----------:|\n| TMB          | Basic Resources               | 0.0752439 |\n| VTP          | Industrial Goods and Services | 0.0581527 |\n| SLS          | Food and Beverages            | 0.0572923 |\n| SAB          | Food and Beverages            | 0.0524845 |\n| VHM          | Real Estate                   | 0.0513036 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT fr.stock_code, ci.industry, fr.data AS roe\nFROM financial_ratio fr\nJOIN map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nJOIN company_info ci ON fr.stock_code = ci.stock_code\nWHERE mccr.ratio_name = 'Return On Equity'\n  AND fr.year = 2024\n  AND fr.quarter = 2\nORDER BY fr.data DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | company_name                                             |   roe_value |\n|:-------------|:---------------------------------------------------------|------------:|\n| TMB          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Kinh doanh Than Mi\u1ec1n B\u1eafc - Vinacomin     |   0.0752439 |\n| VTP          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n B\u01b0u ch\u00ednh Viettel                   |   0.0581527 |\n| SLS          | C\u00f4ng ty C\u1ed5 ph\u1ea7n M\u00eda \u0111\u01b0\u1eddng S\u01a1n La                         |   0.0572923 |\n| SAB          | T\u1ed5ng C\u00f4ng ty C\u1ed5 ph\u1ea7n Bia - R\u01b0\u1ee3u - N\u01b0\u1edbc Gi\u1ea3i kh\u00e1t S\u00e0i G\u00f2n |   0.0524845 |\n| VHM          | C\u00f4ng ty C\u1ed5 ph\u1ea7n Vinhomes                                 |   0.0513036 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code, \n  ci.company_name, \n  fr.data AS ROE_Value\nFROM \n  financial_ratio fr\n  INNER JOIN company_info ci ON fr.stock_code = ci.stock_code\n  INNER JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  fr.year = 2024 \n  AND fr.quarter = 2  -- Q2\n  AND mcr.ratio_name = 'Return On Equity'\nORDER BY \n  fr.data DESC  -- Highest ROE first\nLIMIT 5;\n"
            }
        ],
        "time": 37.33943581581116,
        "evaluate": 1,
        "input_token": 2020,
        "output_token": 586
    },
    {
        "id": "bd8cbad4-191a-45e2-a174-5bbacabaa07b",
        "question": "What are the top 10 companies with the lowest Debt-to-Equity ratio as of Q4 2023?",
        "answer": "Table 1\n| stock_code   | industry                             | is_bank   | is_securities   |   debt_to_equity_ratio |\n|:-------------|:-------------------------------------|:----------|:----------------|-----------------------:|\n| CAP          | Basic Resources                      | False     | False           |               0.102041 |\n| SLS          | Food and Beverages                   | False     | False           |               0.136624 |\n| TCH          | Real Estate                          | False     | False           |               0.17618  |\n| VRE          | Real Estate                          | False     | False           |               0.259786 |\n| DGC          | Chemicals                            | False     | False           |               0.291074 |\n| VCS          | Construction and Materials           | False     | False           |               0.297329 |\n| SAB          | Food and Beverages                   | False     | False           |               0.336332 |\n| GAS          | Utilities (Electricity, Water & Gas) | False     | False           |               0.343894 |\n| YEG          | Media                                | False     | False           |               0.356841 |\n| GVR          | Chemicals                            | False     | False           |               0.428991 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    ci.stock_code,\n    ci.industry,\n    ci.is_bank,\n    ci.is_securities,\n    fr.data AS debt_to_equity_ratio\nFROM \n    financial_ratio fr\nJOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nWHERE \n    fr.ratio_code = 'DTER'\n    AND fr.year = 2023\n    AND fr.quarter = 4\nORDER BY \n    fr.data ASC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | industry                             |   debttoequityratio |\n|:-------------|:-------------------------------------|--------------------:|\n| CAP          | Basic Resources                      |            0.102041 |\n| SLS          | Food and Beverages                   |            0.136624 |\n| TCH          | Real Estate                          |            0.17618  |\n| VRE          | Real Estate                          |            0.259786 |\n| DGC          | Chemicals                            |            0.291074 |\n| VCS          | Construction and Materials           |            0.297329 |\n| SAB          | Food and Beverages                   |            0.336332 |\n| GAS          | Utilities (Electricity, Water & Gas) |            0.343894 |\n| YEG          | Media                                |            0.356841 |\n| GVR          | Chemicals                            |            0.428991 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  ci.stock_code, \n  ci.industry, \n  fr.data AS DebtToEquityRatio\nFROM \n  financial_ratio fr\n  JOIN company_info ci ON fr.stock_code = ci.stock_code\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n  mcr.ratio_name = 'Debt To Equity Ratio'\n  AND fr.year = 2023\n  AND fr.quarter = 4  -- Q4\nORDER BY \n  fr.data ASC  -- Lowest DTER first\nLIMIT 10;\n"
            }
        ],
        "time": 62.70090174674988,
        "evaluate": 1,
        "input_token": 2406,
        "output_token": 642
    },
    {
        "id": "5635fb56-7037-4c79-9db7-8435e6f0e120",
        "question": "Rank the top 5 companies with total assets greater than 100,000 billion VND  based on Return on Equity (ROE) for the period 2020-Q2 2024, showing ROE values for each company.",
        "answer": "Table 1\n| stock_code   | industry    |     avg_roe |\n|:-------------|:------------|------------:|\n| ACB          | Banking     | nan         |\n| VIB          | Banking     |   0.0698803 |\n| VHM          | Real Estate |   0.0646859 |\n| VCB          | Banking     |   0.0624534 |\n| MBB          | Banking     |   0.056319  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH total_assets AS (\n    SELECT stock_code, MAX(data) AS max_total_assets\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'BS_300' AND quarter != 0 AND year BETWEEN 2020 AND 2024\n\n        UNION ALL\n\n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'BS_270' AND quarter != 0 AND year BETWEEN 2020 AND 2024\n\n        UNION ALL\n\n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'BS_270' AND quarter != 0 AND year BETWEEN 2020 AND 2024\n    ) AS combined_assets\n    GROUP BY stock_code\n    HAVING MAX(data) > 100000000\n),\nroe_data AS (\n    SELECT stock_code, AVG(data) AS avg_roe\n    FROM financial_ratio\n    WHERE ratio_code = 'ROE' AND quarter != 0 AND year BETWEEN 2020 AND 2024\n    GROUP BY stock_code\n)\nSELECT ci.stock_code, ci.industry, roe_data.avg_roe\nFROM roe_data\nJOIN total_assets ON roe_data.stock_code = total_assets.stock_code\nJOIN company_info ci ON roe_data.stock_code = ci.stock_code\nORDER BY roe_data.avg_roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | roe   |\n|--------------|-------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine all financial reports to filter companies by total assets\ntotal_assets AS (\n  SELECT 'non_bank' AS company_type, stock_code, year, quarter, data AS total_assets\n  FROM non_bank_financial_report\n  WHERE category_code = 'BS_270' AND data > 100000000000  -- > 100,000 billion VND\n  UNION ALL\n  SELECT 'bank' AS company_type, stock_code, year, quarter, data\n  FROM bank_financial_report\n  WHERE category_code = 'BS_300' AND data > 100000000000  -- > 100,000 billion VND\n  UNION ALL\n  SELECT 'securities' AS company_type, stock_code, year, quarter, data\n  FROM securities_financial_report\n  WHERE category_code = 'BS_270' AND data > 100000000000  -- > 100,000 billion VND\n),\n-- Filter for the specified period (2020-Q2 to 2024, but since we're considering annual reports, quarter = 0)\nfiltered_assets AS (\n  SELECT * FROM total_assets\n  WHERE (year = 2020 AND quarter = 0) OR (year BETWEEN 2021 AND 2024 AND quarter = 0)\n),\n-- Join with financial_ratio to get ROE for these companies\nroe_values AS (\n  SELECT fa.stock_code, fr.data AS roe\n  FROM filtered_assets fa\n  JOIN financial_ratio fr ON fa.stock_code = fr.stock_code AND fr.ratio_code = 'ROE'\n  WHERE fr.year = fa.year AND fr.quarter = fa.quarter\n)\n-- Rank companies by ROE and show top 5\nSELECT stock_code, roe\nFROM roe_values\nORDER BY roe DESC\nLIMIT 5;\n"
            }
        ],
        "time": 73.99295473098755,
        "evaluate": 0,
        "input_token": 2017,
        "output_token": 844
    },
    {
        "id": "ac3dd378-1331-4ca0-babb-f307a8f5378a",
        "question": "Compare the Cash Conversion Cycle (CCC) of Vinamilk and Masan Group in 2023 Q2.  Calculate CCC using the average inventory, accounts receivable, and accounts payable.",
        "answer": "Table 1\n| stock_code   |   inventory |   receivables |    payables |     dio |      dso |      dpo |     ccc |\n|:-------------|------------:|--------------:|------------:|--------:|---------:|---------:|--------:|\n| VNM          | 6.31989e+06 |   4.5048e+06  | 3.48324e+06 | 17314.8 | 12341.9  |  9543.11 | 20113.6 |\n| VNM          | 6.34626e+06 |   4.5048e+06  | 3.48324e+06 | 17387   | 12341.9  |  9543.11 | 20185.8 |\n| MSN          | 1.39022e+07 |   2.38814e+06 | 6.60183e+06 | 38088.2 |  6542.85 | 18087.2  | 26543.8 |\n| MSN          | 1.42982e+07 |   2.38814e+06 | 6.60183e+06 | 39173.2 |  6542.85 | 18087.2  | 27628.8 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH Inventory AS (\n    SELECT stock_code, data AS inventory\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 2 AND category_code IN ('BS_140', 'BS_141')\n      AND stock_code IN ('VNM', 'MSN')\n),\nReceivables AS (\n    SELECT stock_code, data AS receivables\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 2 AND category_code = 'BS_131'\n      AND stock_code IN ('VNM', 'MSN')\n),\nPayables AS (\n    SELECT stock_code, data AS payables\n    FROM non_bank_financial_report\n    WHERE year = 2023 AND quarter = 2 AND category_code = 'BS_311'\n      AND stock_code IN ('VNM', 'MSN')\n)\nSELECT \n    i.stock_code,\n    i.inventory,\n    r.receivables,\n    p.payables,\n    -- Assuming some constants for days in period and cost of goods sold for calculation\n    (i.inventory / 365) AS DIO, \n    (r.receivables / 365) AS DSO,\n    (p.payables / 365) AS DPO,\n    ((i.inventory / 365) + (r.receivables / 365) - (p.payables / 365)) AS CCC\nFROM Inventory i\nJOIN Receivables r ON i.stock_code = r.stock_code\nJOIN Payables p ON i.stock_code = p.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| vnm_ccc   | msn_ccc   |\n|-----------|-----------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Assuming INV_CODE, AR_CODE, AP_CODE are correctly identified from map_category_code_non_bank\nInventoryData AS (\n  SELECT stock_code, data AS Inventory\n  FROM non_bank_financial_report\n  WHERE category_code = 'INV_CODE' AND year = 2023 AND quarter = 2\n),\nReceivableData AS (\n  SELECT stock_code, data AS Receivable\n  FROM non_bank_financial_report\n  WHERE category_code = 'AR_CODE' AND year = 2023 AND quarter = 2\n),\nPayableData AS (\n  SELECT stock_code, data AS Payable\n  FROM non_bank_financial_report\n  WHERE category_code = 'AP_CODE' AND year = 2023 AND quarter = 2\n),\n-- Sales Data for calculation of days (assuming a sales category code, e.g., IS_100 for Income Statement)\nSalesData AS (\n  SELECT stock_code, data AS Sales\n  FROM non_bank_financial_report\n  WHERE category_code = 'IS_100' AND year = 2023 AND quarter = 2\n)\n\n-- Main Query to Calculate CCC\nSELECT \n  COALESCE(VNM.Inventory, 0) + COALESCE(VNM.Receivable, 0) - COALESCE(VNM.Payable, 0) AS VNM_CCC,\n  COALESCE(MSN.Inventory, 0) + COALESCE(MSN.Receivable, 0) - COALESCE(MSN.Payable, 0) AS MSN_CCC\nFROM \n  -- Joining the CTEs for VNM and MSN\n  (SELECT \n     i.Inventory, r.Receivable, p.Payable, \n     -- Calculating days assuming 90 days in Q2 for simplicity\n     (i.Inventory / (s.Sales / 90)) AS InventoryDays, \n     (r.Receivable / (s.Sales / 90)) AS ReceivableDays, \n     (p.Payable / (s.Sales / 90)) AS PayableDays\n   FROM \n     InventoryData i\n   JOIN ReceivableData r ON i.stock_code = r.stock_code\n   JOIN PayableData p ON r.stock_code = p.stock_code\n   JOIN SalesData s ON p.stock_code = s.stock_code\n   WHERE i.stock_code = 'VNM') VNM,\n  \n  (SELECT \n     i.Inventory, r.Receivable, p.Payable, \n     -- Same calculation as above\n     (i.Inventory / (s.Sales / 90)) AS InventoryDays, \n     (r.Receivable / (s.Sales / 90)) AS ReceivableDays, \n     (p.Payable / (s.Sales / 90)) AS PayableDays\n   FROM \n     InventoryData i\n   JOIN ReceivableData r ON i.stock_code = r.stock_code\n   JOIN PayableData p ON r.stock_code = p.stock_code\n   JOIN SalesData s ON p.stock_code = s.stock_code\n   WHERE i.stock_code = 'MSN') MSN\n\n-- Since we're directly selecting, no JOIN is needed between VNM and MSN CTEs\nLIMIT 1;\n"
            }
        ],
        "time": 104.32522988319397,
        "evaluate": 0,
        "input_token": 1780,
        "output_token": 1201
    },
    {
        "id": "6a06e8b7-04a8-4b93-b5a5-7c40198b6678",
        "question": "For the first half of 2024, what were the total assets and total liabilities of Vinamilk and Mobile World Investment?",
        "answer": "Table 1\n| stock_code   |   year |   quarter | en_caption     |   total_value |\n|:-------------|-------:|----------:|:---------------|--------------:|\n| MWG          |   2024 |         1 | C. LIABILITIES |   3.75094e+07 |\n| MWG          |   2024 |         1 | TOTAL ASSETS   |   6.35435e+07 |\n| MWG          |   2024 |         2 | C. LIABILITIES |   3.93931e+07 |\n| MWG          |   2024 |         2 | TOTAL ASSETS   |   6.58698e+07 |\n| VNM          |   2024 |         1 | C. LIABILITIES |   1.57863e+07 |\n| VNM          |   2024 |         1 | TOTAL ASSETS   |   5.16539e+07 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    nfr.stock_code,\n    nfr.year,\n    nfr.quarter,\n    mcc.en_caption,\n    SUM(nfr.data) AS total_value\nFROM \n    non_bank_financial_report nfr\nJOIN \n    map_category_code_non_bank mcc ON nfr.category_code = mcc.category_code\nWHERE \n    nfr.stock_code IN ('VNM', 'MWG')\n    AND nfr.year = 2024\n    AND nfr.quarter IN (1, 2)\n    AND mcc.category_code IN ('BS_270', 'BS_300')\nGROUP BY \n    nfr.stock_code, nfr.year, nfr.quarter, mcc.en_caption\nORDER BY \n    nfr.stock_code, nfr.year, nfr.quarter, mcc.en_caption;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| company                 | financial_item    |       value |\n|:------------------------|:------------------|------------:|\n| Vinamilk                | Total Assets      | 3.50139e+07 |\n| Mobile World Investment | Total Liabilities | 1.34657e+07 |\n| Mobile World Investment | Total Assets      | 1.15948e+08 |\n| Vinamilk                | Total Liabilities | 1.664e+07   |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  'Vinamilk' AS Company, \n  'Total Assets' AS Financial_Item, \n  SUM(data) AS Value\nFROM \n  non_bank_financial_report nbf\n  INNER JOIN company_info ci ON nbf.stock_code = ci.stock_code\n  INNER JOIN map_category_code_non_bank mccnb ON nbf.category_code = mccnb.category_code\nWHERE \n  ci.stock_code = 'VNM' \n  AND nbf.year = 2024 \n  AND nbf.quarter IN (1, 2) \n  AND nbf.category_code = 'BS_100'  -- Assuming this is the code for Total Assets\n\nUNION ALL\n\nSELECT \n  'Vinamilk' AS Company, \n  'Total Liabilities' AS Financial_Item, \n  SUM(data) AS Value\nFROM \n  non_bank_financial_report nbf\n  INNER JOIN company_info ci ON nbf.stock_code = ci.stock_code\n  INNER JOIN map_category_code_non_bank mccnb ON nbf.category_code = mccnb.category_code\nWHERE \n  ci.stock_code = 'VNM' \n  AND nbf.year = 2024 \n  AND nbf.quarter IN (1, 2) \n  AND nbf.category_code = 'BS_200'  -- Assuming this is the code for Total Liabilities\n\nUNION ALL\n\nSELECT \n  'Mobile World Investment' AS Company, \n  'Total Assets' AS Financial_Item, \n  SUM(data) AS Value\nFROM \n  non_bank_financial_report nbf\n  INNER JOIN company_info ci ON nbf.stock_code = ci.stock_code\n  INNER JOIN map_category_code_non_bank mccnb ON nbf.category_code = mccnb.category_code\nWHERE \n  ci.stock_code = 'MWG' \n  AND nbf.year = 2024 \n  AND nbf.quarter IN (1, 2) \n  AND nbf.category_code = 'BS_100'  -- Assuming this is the code for Total Assets\n\nUNION ALL\n\nSELECT \n  'Mobile World Investment' AS Company, \n  'Total Liabilities' AS Financial_Item, \n  SUM(data) AS Value\nFROM \n  non_bank_financial_report nbf\n  INNER JOIN company_info ci ON nbf.stock_code = ci.stock_code\n  INNER JOIN map_category_code_non_bank mccnb ON nbf.category_code = mccnb.category_code\nWHERE \n  ci.stock_code = 'MWG' \n  AND nbf.year = 2024 \n  AND nbf.quarter IN (1, 2) \n  AND nbf.category_code = 'BS_200'  -- Assuming this is the code for Total Liabilities\n\nLIMIT 4;\n"
            }
        ],
        "time": 41.13096499443054,
        "evaluate": 0,
        "input_token": 1704,
        "output_token": 977
    },
    {
        "id": "c0ff8d4c-799a-4af1-97ff-5618152aa69d",
        "question": "For the period 2020-Q2 2024, list the top 10 companies with Net Income exceeding 1,000 billion VND, ranked by their Debt-to-Equity ratio, and provide the Debt-to-Equity ratio for each company.",
        "answer": "Table 1\n| stock_code   | industry   | is_bank   | is_securities   |   debt_to_equity_ratio |\n|:-------------|:-----------|:----------|:----------------|-----------------------:|\n| VCB          | Banking    | True      | False           |                29.2163 |\n| VCB          | Banking    | True      | False           |                30.067  |\n| ACB          | Banking    | True      | False           |               nan      |\n| STB          | Banking    | True      | False           |                16.557  |\n| SHB          | Banking    | True      | False           |                18.2134 |\n| LPB          | Banking    | True      | False           |                16.212  |\n| BID          | Banking    | True      | False           |                16.9862 |\n| BID          | Banking    | True      | False           |                17.6264 |\n| BID          | Banking    | True      | False           |                17.7161 |\n| BID          | Banking    | True      | False           |                17.7451 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH net_income_exceeding AS (\n    SELECT\n        stock_code,\n        SUM(data) AS total_net_income\n    FROM (\n        SELECT stock_code, data\n        FROM bank_financial_report\n        WHERE category_code = 'IS_021' AND year BETWEEN 2020 AND 2024 AND quarter != 0\n\n        UNION ALL\n\n        SELECT stock_code, data\n        FROM non_bank_financial_report\n        WHERE category_code = 'IS_400' AND year BETWEEN 2020 AND 2024 AND quarter != 0\n\n        UNION ALL\n\n        SELECT stock_code, data\n        FROM securities_financial_report\n        WHERE category_code = 'IS_400' AND year BETWEEN 2020 AND 2024 AND quarter != 0\n    ) AS combined_reports\n    GROUP BY stock_code\n    HAVING SUM(data) > 1000000\n),\ntop_companies AS (\n    SELECT\n        fr.stock_code,\n        fr.data AS debt_to_equity_ratio\n    FROM financial_ratio fr\n    JOIN net_income_exceeding nie ON fr.stock_code = nie.stock_code\n    WHERE fr.ratio_code = 'DTER' AND fr.year BETWEEN 2020 AND 2024 AND fr.quarter != 0\n    ORDER BY fr.data DESC\n    LIMIT 10\n)\nSELECT\n    ci.stock_code,\n    ci.industry,\n    ci.is_bank,\n    ci.is_securities,\n    tc.debt_to_equity_ratio\nFROM company_info ci\nJOIN top_companies tc ON ci.stock_code = tc.stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   | industry   | netincome   | dter   |\n|--------------|------------|-------------|--------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Annual Net Income for All Companies (Assuming IS_012 for Banks and IS_030 for Non-Banks/Securities as Net Income)\nNetIncome AS (\n  SELECT \n    'Bank' AS Type, \n    bfr.stock_code, \n    bfr.year, \n    bfr.data AS NetIncome\n  FROM \n    bank_financial_report bfr\n  JOIN \n    map_category_code_bank mccb ON bfr.category_code = mccb.category_code\n  WHERE \n    bfr.quarter = 0 \n    AND bfr.year BETWEEN 2020 AND 2024 \n    AND mccb.en_caption = 'Net profit/(loss) from other activities'  -- Placeholder for Net Income in Banks\n  \n  UNION ALL\n  \n  SELECT \n    'NonBank' AS Type, \n    nbfr.stock_code, \n    nbfr.year, \n    nbfr.data AS NetIncome\n  FROM \n    non_bank_financial_report nbfr\n  JOIN \n    map_category_code_non_bank mccnb ON nbfr.category_code = mccnb.category_code\n  WHERE \n    nbfr.quarter = 0 \n    AND nbfr.year BETWEEN 2020 AND 2024 \n    AND mccnb.en_caption = 'Net profit from operating activities'  -- Placeholder for Net Income in Non-Banks/Securities\n  \n  UNION ALL\n  \n  SELECT \n    'Securities' AS Type, \n    sfr.stock_code, \n    sfr.year, \n    sfr.data AS NetIncome\n  FROM \n    securities_financial_report sfr\n  JOIN \n    map_category_code_securities mccs ON sfr.category_code = mccs.category_code\n  WHERE \n    sfr.quarter = 0 \n    AND sfr.year BETWEEN 2020 AND 2024 \n    -- Assuming a placeholder for Net Income in Securities, adjust based on actual category\n    AND mccs.en_caption = 'Total comprehensive income'\n),\n\n-- Debt-to-Equity Ratio for Companies\nDebtToEquity AS (\n  SELECT \n    fr.stock_code, \n    fr.year, \n    fr.data AS DTER\n  FROM \n    financial_ratio fr\n  WHERE \n    fr.ratio_code = 'DTER' \n    AND fr.year BETWEEN 2020 AND 2024 \n    AND fr.quarter = 0\n)\n\n-- Main Query: Top 10 Companies by Debt-to-Equity Ratio with Net Income > 1,000 billion VND\nSELECT \n  ci.stock_code, \n  ci.industry, \n  ni.NetIncome, \n  de.DTER\nFROM \n  company_info ci\nJOIN \n  NetIncome ni ON ci.stock_code = ni.stock_code AND ni.year = 2024  -- Focusing on 2024 for Net Income Filter\nJOIN \n  DebtToEquity de ON ci.stock_code = de.stock_code AND de.year = 2024  -- Focusing on 2024 for DTER\nWHERE \n  ni.NetIncome > 1000000000000  -- 1,000 billion VND\nORDER BY \n  de.DTER DESC\nLIMIT 10;\n"
            }
        ],
        "time": 81.96486163139343,
        "evaluate": 0,
        "input_token": 2379,
        "output_token": 1543
    },
    {
        "id": "5ee33432-80c6-40b3-9525-1c8791410fae",
        "question": "Rank the top 10 companies by Return on Equity (ROE) for the fiscal year 2022.",
        "answer": "Table 1\n| stock_code   |   roe_value |\n|:-------------|------------:|\n| VC3          |  nan        |\n| DGC          |    0.557243 |\n| CAP          |    0.546075 |\n| TMB          |    0.432194 |\n| DCM          |    0.40744  |\n| SAF          |    0.293575 |\n| TVD          |    0.265397 |\n| VNM          |    0.26138  |\n| VIB          |    0.259372 |\n| FPT          |    0.256007 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    fr.data AS roe_value\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE \n    mccr.ratio_name = 'Return On Equity' \n    AND fr.year = 2022 \n    AND fr.quarter = 0\nORDER BY \n    roe_value DESC\nLIMIT 10;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   |   roe_value | industry               |   issue_share |\n|:-------------|------------:|:-----------------------|--------------:|\n| VC3          |  nan        | Real Estate            |    1.252e+08  |\n| DGC          |    0.557243 | Chemicals              |    3.798e+08  |\n| CAP          |    0.546075 | Basic Resources        |    1.53e+07   |\n| TMB          |    0.432194 | Basic Resources        |    1.5e+07    |\n| DCM          |    0.40744  | Chemicals              |    5.294e+08  |\n| SAF          |    0.293575 | Food and Beverages     |    1.2e+07    |\n| TVD          |    0.265397 | Basic Resources        |    4.5e+07    |\n| VNM          |    0.26138  | Food and Beverages     |    2.09e+09   |\n| VIB          |    0.259372 | Banking                |    2.5368e+09 |\n| FPT          |    0.256007 | Information Technology |    1.4604e+09 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    fr.data AS ROE_Value, \n    ci.industry, \n    ci.issue_share\nFROM \n    financial_ratio fr\nINNER JOIN \n    company_info ci ON fr.stock_code = ci.stock_code\nINNER JOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.year = 2022 \n    AND fr.quarter = 0 \n    AND mcr.ratio_name = 'Return On Equity'\nORDER BY \n    fr.data DESC  -- To rank companies by ROE in descending order\nLIMIT 10;  -- To get the top 10 companies\n"
            }
        ],
        "time": 28.30960774421692,
        "evaluate": 0.5,
        "input_token": 4012,
        "output_token": 1305
    },
    {
        "id": "823d1e17-605a-4502-be5d-4ddcaa72ab21",
        "question": "What are the top 5 companies with the highest Total Assets as of December 31, 2023?",
        "answer": "Table 1\n| stock_code   | industry   |   issue_share |   total_assets |\n|:-------------|:-----------|--------------:|---------------:|\n| BID          | Banking    |    5.7004e+09 |    2.30081e+09 |\n| CTG          | Banking    |    5.37e+09   |    2.03261e+09 |\n| VCB          | Banking    |    5.5891e+09 |    1.83961e+09 |\n| MBB          | Banking    |    5.2871e+09 |    9.44954e+08 |\n| TCB          | Banking    |    7.045e+09  |    8.49482e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Identify the category codes for \"Total Assets\"\n-- For banks, the category code is BS_300\n-- For non-bank corporations, the category code is BS_270\n-- For securities firms, the category code is BS_270\n\n-- Step 2, 3, 4: Retrieve, combine, and order the data\n\nSELECT ci.stock_code, ci.industry, ci.issue_share, total_assets\nFROM (\n    SELECT stock_code, data AS total_assets\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2023 AND quarter = 0\n    \n    UNION ALL\n    \n    SELECT stock_code, data AS total_assets\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n    \n    UNION ALL\n    \n    SELECT stock_code, data AS total_assets\n    FROM securities_financial_report\n    WHERE category_code = 'BS_270' AND year = 2023 AND quarter = 0\n) AS combined_reports\nJOIN company_info ci ON combined_reports.stock_code = ci.stock_code\nORDER BY total_assets DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   |   Total Assets |\n|:-------------|---------------:|\n| BID          |    2.30081e+09 |\n| CTG          |    2.03261e+09 |\n| VCB          |    1.83961e+09 |\n| MBB          |    9.44954e+08 |\n| TCB          |    8.49482e+08 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT stock_code, data AS \"Total Assets\"\nFROM (\n  SELECT bfr.stock_code, bfr.data\n  FROM bank_financial_report bfr\n  JOIN map_category_code_bank mcb ON bfr.category_code = mcb.category_code\n  WHERE mcb.en_caption = 'Total assets' AND bfr.year = 2023 AND bfr.quarter = 0\n  \n  UNION ALL\n  \n  SELECT nbfr.stock_code, nbfr.data\n  FROM non_bank_financial_report nbfr\n  JOIN map_category_code_non_bank mcnb ON nbfr.category_code = mcnb.category_code\n  WHERE mcnb.en_caption = 'TOTAL ASSETS' AND nbfr.year = 2023 AND nbfr.quarter = 0\n  \n  UNION ALL\n  \n  SELECT sfr.stock_code, sfr.data\n  FROM securities_financial_report sfr\n  JOIN map_category_code_securities mcs ON sfr.category_code = mcs.category_code\n  WHERE mcs.en_caption = 'TOTAL ASSETS' AND sfr.year = 2023 AND sfr.quarter = 0\n) AS CombinedReports\nORDER BY \"Total Assets\" DESC\nLIMIT 5;\n"
            }
        ],
        "time": 31.132801055908203,
        "evaluate": 1,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "74b672c5-6a11-41a6-add8-8b866f4f1972",
        "question": "What were the total assets and total liabilities of Vinamilk and Masan Group at the end of 2023?",
        "answer": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| VNM          | BS_270          | 5.26734e+07 |\n| VNM          | BS_300          | 1.76476e+07 |\n| MSN          | BS_270          | 1.47383e+08 |\n| MSN          | BS_300          | 1.09146e+08 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code,\n    category_code,\n    data\nFROM \n    non_bank_financial_report\nWHERE \n    stock_code IN ('VNM', 'MSN') AND\n    year = 2023 AND\n    quarter = 0 AND\n    category_code IN ('BS_270', 'BS_300');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | category_code   |        data |\n|:-------------|:----------------|------------:|\n| MSN          | BS_100          | 4.37635e+07 |\n| MSN          | BS_200          | 1.0362e+08  |\n| VNM          | BS_100          | 3.59359e+07 |\n| VNM          | BS_200          | 1.67375e+07 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  stock_code,\n  category_code,\n  data\nFROM \n  non_bank_financial_report\nWHERE \n  stock_code IN ('VNM', 'MSN')  -- Filter for Vinamilk and Masan Group\n  AND year = 2023                -- Filter for the year 2023\n  AND quarter = 0                 -- Filter for annual reports (end of the year)\n  AND category_code IN ('BS_100', 'BS_200')  -- Filter for Total Assets and Total Liabilities\nLIMIT 100;  -- Add a limit to your query as per the instructions\n"
            }
        ],
        "time": 29.975610971450806,
        "evaluate": 0,
        "input_token": 4148,
        "output_token": 1380
    },
    {
        "id": "e3299b8e-bde9-4386-aead-2aaf40d9c8fb",
        "question": "Rank the top 5 companies with the highest Return on Equity (ROE) among  Vietcombank, Techcombank, ACB, BIDV, and VietinBank for the period from 2020 to Q2 2024,  filtering for companies with total assets exceeding 100 billion VND in each year.",
        "answer": "Table 1\n| stock_code   |   year |   quarter |      roe |\n|:-------------|-------:|----------:|---------:|\n| ACB          |   2022 |         0 | 0.234232 |\n| ACB          |   2023 |         0 | 0.226122 |\n| VCB          |   2022 |         0 | 0.220567 |\n| ACB          |   2020 |         0 | 0.216734 |\n| ACB          |   2021 |         0 | 0.213865 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TotalAssets AS (\n    SELECT \n        stock_code, \n        year, \n        SUM(data) AS total_assets\n    FROM \n        bank_financial_report\n    WHERE \n        category_code = 'BS_300' -- Total assets for banks\n        AND year BETWEEN 2020 AND 2024\n        AND (quarter = 0 OR (year = 2024 AND quarter = 2))\n    GROUP BY \n        stock_code, year\n    HAVING \n        SUM(data) > 100000 -- 100 billion VND\n),\nROEData AS (\n    SELECT \n        fr.stock_code, \n        fr.year, \n        fr.quarter, \n        fr.data AS roe\n    FROM \n        financial_ratio fr\n    JOIN \n        map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE \n        mccr.ratio_name = 'Return On Equity'\n        AND fr.stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'CTG')\n        AND fr.year BETWEEN 2020 AND 2024\n        AND (fr.quarter = 0 OR (fr.year = 2024 AND fr.quarter = 2))\n)\nSELECT \n    roe.stock_code, \n    roe.year, \n    roe.quarter, \n    roe.roe\nFROM \n    ROEData roe\nJOIN \n    TotalAssets ta ON roe.stock_code = ta.stock_code AND roe.year = ta.year\nORDER BY \n    roe.roe DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | company_name   | year   | roe   |\n|--------------|----------------|--------|-------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Filter companies and their total assets\nCompanyAssets AS (\n  SELECT \n    bfr.stock_code,\n    bfr.year,\n    bfr.data AS TotalAssets\n  FROM \n    bank_financial_report bfr\n  INNER JOIN \n    map_category_code_bank mccb ON bfr.category_code = mccb.category_code\n  WHERE \n    bfr.stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'CTG')\n    AND bfr.quarter = 0  -- Annual reports\n    AND mccb.en_caption = 'Total assets'\n    AND bfr.data > 100000000000  -- Total assets exceeding 100 billion VND\n),\n\n-- Calculate ROE for each company\nCompanyROE AS (\n  SELECT \n    fr.stock_code,\n    fr.year,\n    fr.data AS ROE\n  FROM \n    financial_ratio fr\n  INNER JOIN \n    map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n  WHERE \n    fr.stock_code IN ('VCB', 'TCB', 'ACB', 'BID', 'CTG')\n    AND fr.quarter = 0  -- Annual reports\n    AND mccr.ratio_name = 'Return On Equity'\n    AND fr.year BETWEEN 2020 AND 2024\n)\n\n-- Combine and rank companies by ROE\nSELECT \n  CRE.stock_code,\n  CI.company_name,\n  CRE.year,\n  CRE.ROE\nFROM \n  CompanyROE CRE\nINNER JOIN \n  company_info CI ON CRE.stock_code = CI.stock_code\nWHERE \n  CRE.year IN (SELECT year FROM CompanyAssets WHERE stock_code = CRE.stock_code)\nORDER BY \n  CRE.ROE DESC\nLIMIT 5;\n"
            }
        ],
        "time": 45.425066232681274,
        "evaluate": 0,
        "input_token": 0,
        "output_token": 0
    },
    {
        "id": "d791c613-7b95-4157-bde2-61de3fb6bec9",
        "question": "Rank the top 5 companies with the highest operating cash flow in Q2 2024, filtering for companies with total assets exceeding 100 billion VND.",
        "answer": "Table 1\n| stock_code   | industry           |   operating_cash_flow |\n|:-------------|:-------------------|----------------------:|\n| MWG          | Retail             |           7.46094e+06 |\n| VGI          | Telecommunications |           6.99246e+06 |\n| VHM          | Real Estate        |           6.47431e+06 |\n| VND          | Financial Services |           3.45256e+06 |\n| SSI          | Financial Services |           3.20662e+06 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH TotalAssets AS (\n    SELECT stock_code, data AS total_assets\n    FROM bank_financial_report\n    WHERE category_code = 'BS_300' AND year = 2024 AND quarter = 2\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM non_bank_financial_report\n    WHERE category_code = 'BS_270' AND year = 2024 AND quarter = 2\n    UNION ALL\n    SELECT stock_code, data AS total_assets\n    FROM securities_financial_report\n    WHERE category_code = 'BS_270' AND year = 2024 AND quarter = 2\n),\nOperatingCashFlow AS (\n    SELECT stock_code, data AS operating_cash_flow\n    FROM bank_financial_report\n    WHERE category_code = 'CF_009' AND year = 2024 AND quarter = 2\n    UNION ALL\n    SELECT stock_code, data AS operating_cash_flow\n    FROM non_bank_financial_report\n    WHERE category_code = 'CF_020' AND year = 2024 AND quarter = 2\n    UNION ALL\n    SELECT stock_code, data AS operating_cash_flow\n    FROM securities_financial_report\n    WHERE category_code = 'CF_060' AND year = 2024 AND quarter = 2\n)\nSELECT ci.stock_code, ci.industry, ocf.operating_cash_flow\nFROM OperatingCashFlow ocf\nJOIN TotalAssets ta ON ocf.stock_code = ta.stock_code\nJOIN company_info ci ON ocf.stock_code = ci.stock_code\nWHERE ta.total_assets > 100000\nORDER BY ocf.operating_cash_flow DESC\nLIMIT 5;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | operating_cash_flow   |\n|--------------|-----------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Combine financial reports for all company types, filtering for Q2 2024 and total assets > 100B VND\nCombinedReports AS (\n  SELECT \n    'non_bank' AS company_type,\n    nfr.stock_code,\n    nfr.data AS operating_cash_flow,\n    ta.data AS total_assets\n  FROM \n    non_bank_financial_report nfr\n  JOIN \n    map_category_code_non_bank mccnb ON nfr.category_code = mccnb.category_code\n  LEFT JOIN \n    non_bank_financial_report ta ON nfr.stock_code = ta.stock_code AND ta.category_code = 'BS_270'\n  WHERE \n    nfr.year = 2024 AND nfr.quarter = 2 AND mccnb.en_caption = 'Net cash flow from operating activities'\n  AND ta.data > 100000000000  -- Total Assets > 100B VND\n\n  UNION ALL\n\n  SELECT \n    'bank' AS company_type,\n    bfr.stock_code,\n    bfr.data AS operating_cash_flow,\n    ta.data AS total_assets\n  FROM \n    bank_financial_report bfr\n  JOIN \n    map_category_code_bank mccb ON bfr.category_code = mccb.category_code\n  LEFT JOIN \n    bank_financial_report ta ON bfr.stock_code = ta.stock_code AND ta.category_code = 'BS_300'\n  WHERE \n    bfr.year = 2024 AND bfr.quarter = 2 AND mccb.en_caption = 'Net cash flow from operating activities before changes in assets and working capital'\n  AND ta.data > 100000000000  -- Total Assets > 100B VND\n\n  UNION ALL\n\n  SELECT \n    'securities' AS company_type,\n    sfr.stock_code,\n    sfr.data AS operating_cash_flow,\n    ta.data AS total_assets\n  FROM \n    securities_financial_report sfr\n  JOIN \n    map_category_code_securities mccs ON sfr.category_code = mccs.category_code\n  LEFT JOIN \n    securities_financial_report ta ON sfr.stock_code = ta.stock_code AND ta.category_code = 'BS_270'\n  WHERE \n    sfr.year = 2024 AND sfr.quarter = 2 AND mccs.en_caption = 'Net cash flow from operating activities'\n  AND ta.data > 100000000000  -- Total Assets > 100B VND\n),\n\n-- Rank companies by operating cash flow\nRankedCompanies AS (\n  SELECT \n    stock_code,\n    operating_cash_flow,\n    ROW_NUMBER() OVER (ORDER BY operating_cash_flow DESC) AS rank\n  FROM \n    CombinedReports\n)\n\n-- Select top 5 companies\nSELECT \n  stock_code,\n  operating_cash_flow\nFROM \n  RankedCompanies\nWHERE \n  rank <= 5\nLIMIT 5;\n"
            }
        ],
        "time": 76.7690417766571,
        "evaluate": 0,
        "input_token": 1963,
        "output_token": 1063
    },
    {
        "id": "32d92561-df33-4214-ab25-af40d4de6971",
        "question": "What were the Return on Equity (ROE) and Debt-to-Equity ratios for Vietcombank and Techcombank in 2022?",
        "answer": "Table 1\n| stock_code   | ratio_code   | ratio_name           |      data |\n|:-------------|:-------------|:---------------------|----------:|\n| TCB          | DTER         | Debt To Equity Ratio |  5.16295  |\n| VCB          | DTER         | Debt To Equity Ratio | 12.3717   |\n| TCB          | ROE          | Return On Equity     |  0.180176 |\n| VCB          | ROE          | Return On Equity     |  0.220567 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code, \n    fr.ratio_code, \n    mcr.ratio_name, \n    fr.data \nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\nWHERE \n    fr.stock_code IN ('VCB', 'TCB') \n    AND fr.year = 2022 \n    AND fr.quarter = 0 \n    AND fr.ratio_code IN ('ROE', 'DTER');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| ratio_name           | stock_code   |   year |   ratio_value |\n|:---------------------|:-------------|-------:|--------------:|\n| Debt To Equity Ratio | TCB          |   2022 |      5.16295  |\n| Debt To Equity Ratio | VCB          |   2022 |     12.3717   |\n| Return On Equity     | TCB          |   2022 |      0.180176 |\n| Return On Equity     | VCB          |   2022 |      0.220567 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  r.ratio_name, \n  f.stock_code, \n  f.year, \n  f.data AS ratio_value\nFROM \n  financial_ratio f\n  INNER JOIN map_category_code_ratio r ON f.ratio_code = r.ratio_code\nWHERE \n  f.stock_code IN ('VCB', 'TCB')\n  AND f.year = 2022\n  AND f.quarter = 0  -- For annual data\n  AND r.ratio_name IN ('Return On Equity', 'Debt To Equity Ratio')\nLIMIT 4;  -- Assuming each company will have 2 ratios, thus 4 rows max.\n"
            }
        ],
        "time": 33.56930589675903,
        "evaluate": 1,
        "input_token": 2889,
        "output_token": 1111
    },
    {
        "id": "f6998c23-5ecd-44d3-a4ae-bf48c341f901",
        "question": "Compare the Current Ratio and Quick Ratio of Mobile World Investment, Vinamilk, and Masan Group for the first quarter of 2024.",
        "answer": "Table 1\n| stock_code   | ratio_name    |     data |\n|:-------------|:--------------|---------:|\n| MSN          | Current Ratio | 0.87025  |\n| MSN          | Quick Ratio   | 0.611971 |\n| MWG          | Current Ratio | 1.80429  |\n| MWG          | Quick Ratio   | 1.15211  |\n| VNM          | Current Ratio | 2.30115  |\n| VNM          | Quick Ratio   | 1.85779  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    fr.stock_code,\n    mc.ratio_name,\n    fr.data\nFROM \n    financial_ratio fr\nJOIN \n    map_category_code_ratio mc ON fr.ratio_code = mc.ratio_code\nWHERE \n    fr.stock_code IN ('MWG', 'VNM', 'MSN') -- Stock codes for Mobile World Investment, Vinamilk, and Masan Group\n    AND fr.year = 2024\n    AND fr.quarter = 1 -- First quarter\n    AND mc.ratio_name IN ('Current Ratio', 'Quick Ratio');\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | ratio_code   |   ratio_value |   year |   quarter |\n|:-------------|:-------------|--------------:|-------:|----------:|\n| MSN          | CurrentR     |      0.87025  |   2024 |         1 |\n| MSN          | QR           |      0.611971 |   2024 |         1 |\n| MWG          | CurrentR     |      1.80429  |   2024 |         1 |\n| MWG          | QR           |      1.15211  |   2024 |         1 |\n| VNM          | CurrentR     |      2.30115  |   2024 |         1 |\n| VNM          | QR           |      1.85779  |   2024 |         1 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  stock_code,\n  ratio_code,\n  data AS ratio_value,\n  year,\n  quarter\nFROM \n  financial_ratio\nWHERE \n  stock_code IN ('MWG', 'VNM', 'MSN')  -- Companies of Interest\n  AND ratio_code IN ('CurrentR', 'QR')  -- Required Ratios\n  AND year = 2024                       -- Specified Year\n  AND quarter = 1                       -- Specified Quarter\nORDER BY \n  stock_code, ratio_code\nLIMIT \n  100;  -- Adding a limit as per the database access note\n"
            }
        ],
        "time": 41.39937162399292,
        "evaluate": 0.5,
        "input_token": 1796,
        "output_token": 584
    },
    {
        "id": "3b87156b-84ba-4a7a-ac63-78e7629b7a76",
        "question": "What is the Return on Equity (ROE) and Debt-to-Equity Ratio for Vinamilk and Masan Group for the fiscal year 2023, and how do these compare to their respective figures in 2020?  Analyze the change in these ratios over time for each company, considering the impact of both profitability and financial leverage.",
        "answer": "Table 1\n| stock_code   |   year | ratio_code   |   ratio_value |\n|:-------------|-------:|:-------------|--------------:|\n| MSN          |   2020 | DTER         |     3.62386   |\n| MSN          |   2023 | DTER         |     2.85445   |\n| MSN          |   2020 | ROE          |     0.055733  |\n| MSN          |   2023 | ROE          |     0.0489033 |\n| VNM          |   2020 | DTER         |     0.439424  |\n| VNM          |   2023 | DTER         |     0.503847  |\n| VNM          |   2020 | ROE          |     0.333928  |\n| VNM          |   2023 | ROE          |     0.257506  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    stock_code, \n    year, \n    ratio_code, \n    data AS ratio_value\nFROM \n    financial_ratio\nWHERE \n    stock_code IN ('VNM', 'MSN') AND\n    ratio_code IN ('ROE', 'DTER') AND\n    year IN (2023, 2020) AND\n    quarter = 0\nORDER BY \n    stock_code, \n    ratio_code, \n    year;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| company_name   | ratio_name           |   value_2020 |   value_2023 |   absolute_change |   percentage_change |\n|:---------------|:---------------------|-------------:|-------------:|------------------:|--------------------:|\n| Masan Group    | Debt To Equity Ratio |     3.62386  |     2.85445  |        -0.769414  |            -21.2319 |\n| Vinamilk       | Debt To Equity Ratio |     0.439424 |     0.503847 |         0.0644232 |             14.6608 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Define the ratios of interest\nratio_codes AS (\n  SELECT 'ROE' AS ratio_name, 'ROE' AS ratio_code\n  UNION ALL\n  SELECT 'Debt To Equity Ratio', 'DTER'\n),\n\n-- Filter companies of interest\ncompanies AS (\n  SELECT 'VNM' AS stock_code, 'Vinamilk' AS company_name\n  UNION ALL\n  SELECT 'MSN', 'Masan Group'\n),\n\n-- Retrieve financial data for the specified companies, years, and ratios\nfinancial_data AS (\n  SELECT \n    c.company_name,\n    r.ratio_name,\n    f.year,\n    f.data AS ratio_value\n  FROM \n    financial_ratio f\n  JOIN \n    map_category_code_ratio m ON f.ratio_code = m.ratio_code\n  JOIN \n    ratio_codes r ON m.ratio_name = r.ratio_name\n  JOIN \n    companies c ON f.stock_code = c.stock_code\n  WHERE \n    f.year IN (2020, 2023)\n    AND f.quarter = 0  -- Annual data\n)\n\n-- Analyze the change in ratios over time for each company\nSELECT \n  company_name,\n  ratio_name,\n  SUM(CASE WHEN year = 2020 THEN ratio_value END) AS value_2020,\n  SUM(CASE WHEN year = 2023 THEN ratio_value END) AS value_2023,\n  -- Calculate the absolute and percentage change\n  SUM(CASE WHEN year = 2023 THEN ratio_value END) - SUM(CASE WHEN year = 2020 THEN ratio_value END) AS absolute_change,\n  (SUM(CASE WHEN year = 2023 THEN ratio_value END) - SUM(CASE WHEN year = 2020 THEN ratio_value END)) * 100.0 / NULLIF(SUM(CASE WHEN year = 2020 THEN ratio_value END), 0) AS percentage_change\nFROM \n  financial_data\nGROUP BY \n  company_name, ratio_name\nORDER BY \n  company_name, ratio_name\nLIMIT 100;  -- As per the requirement to always add a LIMIT\n"
            }
        ],
        "time": 50.310834646224976,
        "evaluate": 0,
        "input_token": 2039,
        "output_token": 885
    },
    {
        "id": "68482aa2-d5ec-43e5-8f1a-17ba50d8107b",
        "question": "What was the average Return on Equity (ROE) for Vietcombank, Techcombank, and VPBank in Q2 2024, and how does this compare to their respective average ROE for the same quarter in 2020, considering their investments in subsidiaries?",
        "answer": "Table 1\n| stock_code   |   year |   average_roe |\n|:-------------|-------:|--------------:|\n| EIB          |   2020 |    0.00463626 |\n| MBB          |   2020 |    0.0521778  |\n| OCB          |   2020 |    0.039273   |\n| TCB          |   2020 |    0.0428449  |\n| TCB          |   2024 |    0.0457096  |\n| VCB          |   2020 |    0.0515214  |\n| VPB          |   2020 |    0.0621598  |\n| VPB          |   2024 |    0.026311   |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH bank_and_subsidiaries AS (\n    SELECT DISTINCT f.stock_code, f.year, f.quarter, f.data\n    FROM financial_ratio f\n    JOIN map_category_code_ratio m ON f.ratio_code = m.ratio_code\n    LEFT JOIN sub_and_shareholder s ON f.stock_code = s.stock_code OR f.stock_code = s.invest_on\n    WHERE m.ratio_name = 'Return On Equity'\n      AND f.quarter = 2\n      AND f.year IN (2020, 2024)\n      AND (f.stock_code IN ('VCB', 'TCB', 'VPB') OR s.stock_code IN ('VCB', 'TCB', 'VPB'))\n)\nSELECT stock_code, year, AVG(data) AS average_roe\nFROM bank_and_subsidiaries\nGROUP BY stock_code, year\nORDER BY stock_code, year;\n"
            }
        ],
        "score": 1,
        "difficulty": 3,
        "response": "Table 1\n| stock_code   | company_name                                      |   avg_roe_2024_q2 |   avg_roe_2020_q2 |\n|:-------------|:--------------------------------------------------|------------------:|------------------:|\n| TCB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n K\u1ef9 th\u01b0\u01a1ng Vi\u1ec7t Nam   |         0.0457096 |         0.0428449 |\n| VPB          | Ng\u00e2n h\u00e0ng Th\u01b0\u01a1ng m\u1ea1i C\u1ed5 ph\u1ea7n Vi\u1ec7t Nam Th\u1ecbnh V\u01b0\u1ee3ng |         0.026311  |         0.0621598 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH \n-- Define the banks of interest\nBanksOfInterest AS (\n  SELECT 'VCB' AS stock_code UNION\n  SELECT 'TCB' UNION\n  SELECT 'VPB'\n),\n\n-- Confirm the ratio_code for ROE (Assuming 'ROE' from map_category_code_ratio)\nROERatioCode AS (\n  SELECT ratio_code \n  FROM map_category_code_ratio \n  WHERE ratio_name = 'Return On Equity'\n),\n\n-- Calculate Average ROE for Q2 2024\nROE_2024_Q2 AS (\n  SELECT \n    fr.stock_code, \n    AVG(fr.data) AS Avg_ROE\n  FROM \n    financial_ratio fr\n  JOIN \n    BanksOfInterest bi ON fr.stock_code = bi.stock_code\n  JOIN \n    ROERatioCode rc ON fr.ratio_code = rc.ratio_code\n  WHERE \n    fr.year = 2024 AND fr.quarter = 2\n  GROUP BY \n    fr.stock_code\n),\n\n-- Calculate Average ROE for Q2 2020\nROE_2020_Q2 AS (\n  SELECT \n    fr.stock_code, \n    AVG(fr.data) AS Avg_ROE\n  FROM \n    financial_ratio fr\n  JOIN \n    BanksOfInterest bi ON fr.stock_code = bi.stock_code\n  JOIN \n    ROERatioCode rc ON fr.ratio_code = rc.ratio_code\n  WHERE \n    fr.year = 2020 AND fr.quarter = 2\n  GROUP BY \n    fr.stock_code\n)\n\n-- Combine Results for Comparison\nSELECT \n  COI.stock_code,\n  COI.company_name,\n  ROE_2024_Q2.Avg_ROE AS Avg_ROE_2024_Q2,\n  ROE_2020_Q2.Avg_ROE AS Avg_ROE_2020_Q2\nFROM \n  company_info COI\n  JOIN ROE_2024_Q2 ON COI.stock_code = ROE_2024_Q2.stock_code\n  JOIN ROE_2020_Q2 ON COI.stock_code = ROE_2020_Q2.stock_code\nWHERE \n  COI.stock_code IN (SELECT stock_code FROM BanksOfInterest)\nLIMIT 100; -- To adhere to the limit requirement\n"
            }
        ],
        "time": 70.3438618183136,
        "evaluate": 1,
        "input_token": 2560,
        "output_token": 1348
    },
    {
        "id": "78183cf7-204e-4442-b5b1-209c51e9ab3f",
        "question": "For the year 2023, what was the Debt-to-Equity ratio for VinGroup,  and how does this ratio change when considering the consolidated financial statements including its subsidiaries' debt and equity?",
        "answer": "Table 1\n|   standalone_dter |\n|------------------:|\n|           3.50444 |\n\nTable 2\n|   standalone_dter |   consolidated_dter |\n|------------------:|--------------------:|\n|           3.50444 |            0.499221 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "-- Step 1: Retrieve the Debt-to-Equity ratio for VinGroup for the year 2023\nSELECT fr.data AS standalone_dter\nFROM financial_ratio fr\nJOIN map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\nWHERE fr.stock_code = 'VIC'\n  AND fr.year = 2023\n  AND fr.quarter = 0\n  AND mccr.ratio_name = 'Debt To Equity Ratio';\n\n-- Step 2: Identify the subsidiaries of VinGroup\nWITH subsidiaries AS (\n    SELECT invest_on\n    FROM sub_and_shareholder\n    WHERE stock_code = 'VIC'\n)\n\n-- Step 3: Retrieve debt and equity data for VinGroup and its subsidiaries\n, debt_equity_data AS (\n    SELECT stock_code,\n           SUM(CASE WHEN category_code = 'BS_400' THEN data ELSE 0 END) AS total_liabilities,\n           SUM(CASE WHEN category_code IN ('BS_400', 'BS_410', 'BS_420') THEN data ELSE 0 END) AS total_equity\n    FROM non_bank_financial_report\n    WHERE (stock_code = 'VIC' OR stock_code IN (SELECT invest_on FROM subsidiaries))\n      AND year = 2023\n      AND quarter = 0\n    GROUP BY stock_code\n)\n\n-- Step 4: Calculate the consolidated Debt-to-Equity ratio\n, consolidated_dter AS (\n    SELECT SUM(total_liabilities) / NULLIF(SUM(total_equity), 0) AS consolidated_dter\n    FROM debt_equity_data\n)\n\n-- Step 5: Combine results\nSELECT standalone_dter, consolidated_dter\nFROM (\n    SELECT fr.data AS standalone_dter\n    FROM financial_ratio fr\n    JOIN map_category_code_ratio mccr ON fr.ratio_code = mccr.ratio_code\n    WHERE fr.stock_code = 'VIC'\n      AND fr.year = 2023\n      AND fr.quarter = 0\n      AND mccr.ratio_name = 'Debt To Equity Ratio'\n) AS standalone,\nconsolidated_dter;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |   year |   quarter | ratio_name           |   dter_value |\n|:-------------|-------:|----------:|:---------------------|-------------:|\n| VHM          |   2023 |         0 | Debt To Equity Ratio |     1.43451  |\n| VIC          |   2023 |         0 | Debt To Equity Ratio |     3.50444  |\n| VRE          |   2023 |         0 | Debt To Equity Ratio |     0.259786 |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "-- Identify subsidiaries of VinGroup (if any)\nWITH subsidiaries AS (\n  SELECT invest_on AS stock_code\n  FROM sub_and_shareholder\n  WHERE stock_code = 'VIC'\n)\n"
            },
            {
                "language": "sql",
                "code": "-- Main Query to retrieve Debt-to-Equity Ratio for VinGroup and its subsidiaries (if any)\nSELECT \n  fr.stock_code,\n  fr.year,\n  fr.quarter,\n  mcr.ratio_name,\n  fr.data AS DTER_Value\nFROM \n  financial_ratio fr\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  LEFT JOIN subsidiaries s ON fr.stock_code = s.stock_code\nWHERE \n  fr.ratio_code = 'DTER'  -- Debt To Equity Ratio\n  AND fr.year = 2023\n  AND fr.quarter = 0  -- Annual Report\n  AND (fr.stock_code = 'VIC' OR fr.stock_code IN (SELECT stock_code FROM subsidiaries))\nLIMIT 100;  -- Adding Limit as per instructions\n"
            },
            {
                "language": "sql",
                "code": "WITH subsidiaries AS (\n  SELECT invest_on AS stock_code\n  FROM sub_and_shareholder\n  WHERE stock_code = 'VIC'\n)\nSELECT \n  fr.stock_code,\n  fr.year,\n  fr.quarter,\n  mcr.ratio_name,\n  fr.data AS DTER_Value\nFROM \n  financial_ratio fr\n  JOIN map_category_code_ratio mcr ON fr.ratio_code = mcr.ratio_code\n  LEFT JOIN subsidiaries s ON fr.stock_code = s.stock_code\nWHERE \n  fr.ratio_code = 'DTER'  -- Debt To Equity Ratio\n  AND fr.year = 2023\n  AND fr.quarter = 0  -- Annual Report\n  AND (fr.stock_code = 'VIC' OR fr.stock_code IN (SELECT stock_code FROM subsidiaries))\nLIMIT 100;\n"
            }
        ],
        "time": 47.10230541229248,
        "evaluate": 0,
        "input_token": 1712,
        "output_token": 770
    },
    {
        "id": "367dc7bd-7224-409a-a7c9-849e587f88e5",
        "question": "What is the trend of the current ratio for Vietcombank, Techcombank, and Sacombank from 2020 to Q2 2024?",
        "answer": "Table 1\n|   year |   quarter | stock_code   |   current_ratio |\n|-------:|----------:|:-------------|----------------:|\n|   2020 |         0 | STB          |        1.56301  |\n|   2020 |         0 | TCB          |        2.83619  |\n|   2020 |         0 | VCB          |        7.25011  |\n|   2021 |         0 | STB          |        1.02262  |\n|   2021 |         0 | TCB          |        4.35343  |\n|   2021 |         0 | VCB          |        6.29498  |\n|   2022 |         0 | STB          |        1.09035  |\n|   2022 |         0 | TCB          |        3.29776  |\n|   2022 |         0 | VCB          |        3.56816  |\n|   2023 |         0 | STB          |        0.700152 |\n|   2023 |         0 | TCB          |        2.66367  |\n|   2023 |         0 | VCB          |        4.7828   |\n|   2024 |         1 | STB          |        1.0368   |\n|   2024 |         1 | TCB          |        2.40445  |\n|   2024 |         1 | VCB          |        3.48899  |\n|   2024 |         2 | TCB          |        2.88946  |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "SELECT \n    year, \n    quarter, \n    stock_code, \n    data AS current_ratio\nFROM \n    financial_ratio\nWHERE \n    ratio_code = 'CurrentR'\n    AND stock_code IN ('VCB', 'TCB', 'STB')\n    AND (\n        (year = 2020 AND quarter = 0) OR\n        (year = 2021 AND quarter = 0) OR\n        (year = 2022 AND quarter = 0) OR\n        (year = 2023 AND quarter = 0) OR\n        (year = 2024 AND quarter IN (0, 1, 2))\n    )\nORDER BY \n    year, \n    quarter, \n    stock_code;\n"
            }
        ],
        "score": 1,
        "difficulty": 2,
        "response": "Table 1\n| stock_code   | year   | quarter   | en_caption   | liability_data   |\n|--------------|--------|-----------|--------------|------------------|\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "SELECT \n  bfr.stock_code,\n  bfr.year,\n  bfr.quarter,\n  mccb.en_caption,\n  bfr.data AS liability_data\nFROM \n  bank_financial_report bfr\n  INNER JOIN map_category_code_bank mccb ON bfr.category_code = mccb.category_code\nWHERE \n  bfr.stock_code IN ('VCB', 'TCB', 'STB')\n  AND bfr.year BETWEEN 2020 AND 2024\n  AND (bfr.quarter = 0 OR (bfr.year = 2024 AND bfr.quarter = 2))  -- Annual data or Q2 2024\n  AND mccb.en_caption = 'C. LIABILITIES'  -- Focusing on the closest relevant data\nLIMIT 100;\n"
            }
        ],
        "time": 48.81442379951477,
        "evaluate": 0,
        "input_token": 2073,
        "output_token": 804
    },
    {
        "id": "76f8d91f-264c-4654-aad8-17a86d41aafd",
        "question": "For the period 2020-Q2 2024, provide the year-over-year change in cash and cash equivalents, and short-term borrowings for Mobile World Investment, Vinamilk, and PetroVietnam Gas.  Calculate the cash ratio for each company for each year.",
        "answer": "Table 1\n| stock_code   |   year |   yoy_change_cash |   yoy_change_borrowings |   cash_ratio |\n|:-------------|-------:|------------------:|------------------------:|-------------:|\n| GAS          |   2020 |         nan       |                nan      |     5.14732  |\n| GAS          |   2021 |           1.20453 |                -52.3583 |    10.9344   |\n| GAS          |   2022 |          99.0317  |                -90.7175 |   234.451    |\n| GAS          |   2023 |         -46.263   |               3466.5    |     3.5325   |\n| MWG          |   2020 |         nan       |                nan      |     0.470257 |\n| MWG          |   2021 |         -43.6296  |                 57.742  |     0.16805  |\n| MWG          |   2022 |          22.1874  |                -56.636  |     0.473517 |\n| MWG          |   2023 |           6.02021 |                 78.9698 |     0.280508 |\n| VNM          |   2020 |         nan       |                nan      |     0.288559 |\n| VNM          |   2021 |          11.2403  |                 28.2356 |     0.250316 |\n| VNM          |   2022 |          -2.0697  |                -48.1246 |     0.472546 |\n| VNM          |   2023 |          26.613   |                 68.842  |     0.354358 |\n\n",
        "code": [
            {
                "language": "sql",
                "code": "WITH cash_data AS (\n    SELECT \n        stock_code,\n        year,\n        SUM(CASE WHEN category_code = 'BS_110' THEN data ELSE 0 END) AS cash_and_cash_equivalents,\n        SUM(CASE WHEN category_code = 'BS_320' THEN data ELSE 0 END) AS short_term_borrowings\n    FROM \n        non_bank_financial_report\n    WHERE \n        stock_code IN ('MWG', 'VNM', 'GAS') \n        AND year BETWEEN 2020 AND 2024\n        AND quarter = 0\n    GROUP BY \n        stock_code, year\n),\nyear_over_year_change AS (\n    SELECT \n        a.stock_code,\n        a.year,\n        (a.cash_and_cash_equivalents - b.cash_and_cash_equivalents) / NULLIF(b.cash_and_cash_equivalents, 0) * 100 AS yoy_change_cash,\n        (a.short_term_borrowings - b.short_term_borrowings) / NULLIF(b.short_term_borrowings, 0) * 100 AS yoy_change_borrowings\n    FROM \n        cash_data a\n    LEFT JOIN \n        cash_data b ON a.stock_code = b.stock_code AND a.year = b.year + 1\n),\ncash_ratio AS (\n    SELECT \n        stock_code,\n        year,\n        cash_and_cash_equivalents / NULLIF(short_term_borrowings, 0) AS cash_ratio\n    FROM \n        cash_data\n)\nSELECT \n    y.stock_code,\n    y.year,\n    y.yoy_change_cash,\n    y.yoy_change_borrowings,\n    c.cash_ratio\nFROM \n    year_over_year_change y\nJOIN \n    cash_ratio c ON y.stock_code = c.stock_code AND y.year = c.year\nORDER BY \n    y.stock_code, y.year;\n"
            }
        ],
        "score": 1,
        "difficulty": 4,
        "response": "Table 1\n| stock_code   |   year | category_code   |   currentyeardata |   previousyeardata |   yearoveryearchange |\n|:-------------|-------:|:----------------|------------------:|-------------------:|---------------------:|\n| GAS          |   2021 | BS_110          |       5.30033e+06 |        5.23725e+06 |      63084           |\n| GAS          |   2022 | BS_110          |       1.05493e+07 |        5.30033e+06 |          5.24901e+06 |\n| GAS          |   2023 | BS_110          |       5.6689e+06  |        1.05493e+07 |         -4.88044e+06 |\n| GAS          |   2021 | BS_210          |  187718           |   162062           |      25656           |\n| GAS          |   2022 | BS_210          |  168689           |   187718           |     -19029           |\n| GAS          |   2023 | BS_210          |  318104           |   168689           |     149415           |\n| MWG          |   2021 | BS_110          |       4.14202e+06 |        7.34786e+06 |         -3.20584e+06 |\n| MWG          |   2022 | BS_110          |       5.06102e+06 |        4.14202e+06 |     919005           |\n| MWG          |   2023 | BS_110          |       5.3657e+06  |        5.06102e+06 |     304684           |\n| MWG          |   2021 | BS_210          |  482389           |   439493           |      42896           |\n| MWG          |   2022 | BS_210          |  503486           |   482389           |      21097           |\n| MWG          |   2023 | BS_210          |  457569           |   503486           |     -45917           |\n| VNM          |   2021 | BS_110          |       2.34855e+06 |        2.11124e+06 |     237309           |\n| VNM          |   2022 | BS_110          |       2.29994e+06 |        2.34855e+06 |     -48608           |\n| VNM          |   2023 | BS_110          |       2.91203e+06 |        2.29994e+06 |     612084           |\n| VNM          |   2021 | BS_210          |   16695           |    19974           |      -3279           |\n| VNM          |   2022 | BS_210          |   38422           |    16695           |      21727           |\n| VNM          |   2023 | BS_210          |   16131           |    38422           |     -22291           |\n\nTable 2\n| stock_code   |   year |   cashratio |\n|:-------------|-------:|------------:|\n| GAS          |   2021 |    0.320044 |\n| GAS          |   2022 |    0.844761 |\n| MWG          |   2020 |    0.249736 |\n| MWG          |   2021 |    0.097246 |\n| MWG          |   2023 |    0.174408 |\n| VNM          |   2021 |    0.137596 |\n| VNM          |   2023 |    0.16991  |\n| GAS          |   2020 |    0.537221 |\n| GAS          |   2023 |    0.378634 |\n| MWG          |   2022 |    0.194653 |\n| VNM          |   2020 |    0.148547 |\n| VNM          |   2022 |    0.15024  |\n\n",
        "code_response": [
            {
                "language": "sql",
                "code": "WITH AnnualData AS (\n  SELECT \n    nfr.stock_code,\n    nfr.year,\n    nfr.category_code,\n    nfr.data,\n    LAG(nfr.data, 1, 0) OVER (PARTITION BY nfr.stock_code, nfr.category_code ORDER BY nfr.year) AS PreviousYearData\n  FROM \n    non_bank_financial_report nfr\n  WHERE \n    nfr.stock_code IN ('MWG', 'VNM', 'GAS')\n    AND nfr.quarter = 0\n    AND nfr.year BETWEEN 2020 AND 2024\n    AND nfr.category_code IN ('BS_110', 'BS_210')  -- Hypothetical codes\n)\nSELECT \n  stock_code,\n  year,\n  category_code,\n  data AS CurrentYearData,\n  PreviousYearData,\n  (data - PreviousYearData) AS YearOverYearChange\nFROM \n  AnnualData\nWHERE \n  PreviousYearData!= 0  -- To avoid division by zero in real scenarios, though here we're not dividing\nLIMIT 100;\n"
            },
            {
                "language": "sql",
                "code": "SELECT \n  fr.stock_code,\n  fr.year,\n  fr.data AS CashRatio\nFROM \n  financial_ratio fr\nWHERE \n  fr.ratio_code = 'CashR'\n  AND fr.stock_code IN ('MWG', 'VNM', 'GAS')\n  AND fr.quarter = 0\n  AND fr.year BETWEEN 2020 AND 2024\nLIMIT 100;\n"
            }
        ],
        "time": 45.877121686935425,
        "evaluate": 0,
        "input_token": 1875,
        "output_token": 860
    }
]